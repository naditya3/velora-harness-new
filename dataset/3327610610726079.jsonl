{"instance_id": "3327610610726079", "repo": "incatools/pandasaurus", "base_commit": "d8a41b0aedd86425f9e03fff826f235044edefb6", "problem_statement": "Implement tests using these Test cases:\\n1. Cell types from https://cellxgene.cziscience.com/e/21d3e683-80a4-4d9b-bc89-ebb2df513dde.cxg/ + blood_and_immune_upper_slim\\r\\n2. Cell types from https://cellxgene.cziscience.com/e/0b75c598-0893-4216-afe8-5414cab7739d.cxg/ \\r\\n+ contextual enrichment using terms from tissue field e.,g. part_of kidney or part_of 'renal medulla'\\r\\n\\r\\n", "FAIL_TO_PASS": ["test/test_query.py::test_simple_enrichment", "test/test_query.py::test_contextual_slim_enrichment", "test/test_utils/test_sparql_queries.py::test_get_full_enrichment_query", "test/resources/test_term.py::test_eq", "test/resources/test_slim.py::test_str", "test/test_query.py::test_full_slim_enrichment", "test/test_query.py::test_minimal_slim_enrichment", "test/test_curie_validator.py::test_construct_term_list"], "PASS_TO_PASS": ["test/resources/test_slim.py::test_get_term_list", "test/test_curie_validator.py::test_validate_curie_list", "test/test_query.py::test_query", "test/resources/test_slim.py::test_get_description", "test/test_slim_manager.py::test_show_slim_content", "test/test_slim_manager.py::test_find_slim_list", "test/test_curie_validator.py::test_validate_curie_prefixes", "test/test_curie_validator.py::test_find_obsolete_term_replacement", "test/resources/test_term.py::test_get_iri", "test/resources/test_slim.py::test_get_name"], "language": "python", "test_command": "source /saved/ENV || source /saved/*/ENV && pytest --no-header -rA --tb=no -p no:cacheprovider --continue-on-collection-errors", "test_output_parser": "python/parse_log_pytest_v3", "image_storage_uri": "vmvm-registry.fbinfra.net/repomate_image_activ_pytest/incatools_pandasaurus:d8a41b0aedd86425f9e03fff826f235044edefb6", "patch": "[\"diff --git a/src/pandasaurus/curie_validator.py b/src/pandasaurus/curie_validator.py\\nindex f202970..20b0eb1 100644\\n--- a/src/pandasaurus/curie_validator.py\\n+++ b/src/pandasaurus/curie_validator.py\\n@@ -45,7 +45,6 @@ def validate_curie_list(curie_list: List[str]) -> Dict[str, bool]:\\n \\n         \\\"\\\"\\\"\\n         query_string = get_label_query(curie_list)\\n-        # result = self.oi.query(query=query_string, prefixes=get_prefixes(query_string, self.oi.prefix_map().keys()))\\n         result_dict = dict(\\n             [(r.get(\\\"term\\\"), r.get(\\\"label\\\")) for r in run_sparql_query(query_string)]\\n         )\\n@@ -114,7 +113,8 @@ def get_validation_report(term_list: List[Term]):\\n         if obsoleted_terms:\\n             raise ObsoletedTerm(obsoleted_terms)\\n \\n-    def construct_term_list(self, seed_list) -> List[Term]:\\n+    @staticmethod\\n+    def construct_term_list(seed_list) -> List[Term]:\\n         \\\"\\\"\\\"Returns list of Term objects after running validate_curie_list and find_obsolete_terms methods.\\n \\n         Args:\\n@@ -124,8 +124,8 @@ def construct_term_list(self, seed_list) -> List[Term]:\\n             List of Term objects\\n \\n         \\\"\\\"\\\"\\n-        term_validation = self.validate_curie_list(seed_list)\\n-        term_obsoletion = self.find_obsolete_terms(seed_list)\\n+        term_validation = CurieValidator.validate_curie_list(seed_list)\\n+        term_obsoletion = CurieValidator.find_obsolete_terms(seed_list)\\n         term_list: List[Term] = list()\\n         for seed in seed_list:\\n             term = Term(\\n\",\"diff --git a/src/pandasaurus/query.py b/src/pandasaurus/query.py\\nindex d93b6dc..2c72766 100644\\n--- a/src/pandasaurus/query.py\\n+++ b/src/pandasaurus/query.py\\n@@ -44,9 +44,11 @@ def __init__(\\n         \\\"\\\"\\\"\\n         # Might be unnecessary\\n         self.__seed_list = seed_list\\n-        self.__enrichment_property_list = enrichment_property_list\\n+        self.__enrichment_property_list = (\\n+            enrichment_property_list if enrichment_property_list else [\\\"rdfs:subClassOf\\\"]\\n+        )\\n         self.enriched_df: pd.DataFrame = pd.DataFrame()\\n-        self.__term_list: List[Term] = CurieValidator().construct_term_list(seed_list)\\n+        self.__term_list: List[Term] = CurieValidator.construct_term_list(seed_list)\\n         # Validation and reporting\\n         try:\\n             CurieValidator.get_validation_report(self.__term_list)\\n@@ -111,7 +113,6 @@ def minimal_slim_enrichment(self, slim_list: List[str]) -> pd.DataFrame:\\n                     )\\n                 ]\\n             )\\n-\\n         self.enriched_df = pd.DataFrame(s_result, columns=[\\\"s\\\", \\\"s_label\\\", \\\"p\\\", \\\"o\\\", \\\"o_label\\\"])\\n         return self.enriched_df\\n \\n@@ -148,12 +149,13 @@ def contextual_slim_enrichment(self, context: List[str]) -> pd.DataFrame:\\n \\n         Args:\\n             context: Organ/tissue/multicellular anatomical structure list to determine the redundant graph via\\n-            existential restrictions\\n+            existential restrictions. It must be a valid CURIE.\\n \\n         Returns:\\n             Enriched DataFrame\\n \\n         \\\"\\\"\\\"\\n+        # TODO add a curie checking mechanism for context list\\n         logging.info(self.__seed_list)\\n         # Enrichment process\\n         query_string = get_contextual_enrichment_query(context)\\n@@ -173,6 +175,7 @@ def contextual_slim_enrichment(self, context: List[str]) -> pd.DataFrame:\\n             )\\n \\n         self.enriched_df = pd.DataFrame(s_result, columns=[\\\"s\\\", \\\"s_label\\\", \\\"p\\\", \\\"o\\\", \\\"o_label\\\"])\\n+        print(self.enriched_df.to_dict(\\\"records\\\"))\\n         return self.enriched_df\\n \\n     def query(self, column_name: str, query_term: str) -> pd.DataFrame:\\n\",\"diff --git a/src/pandasaurus/resources/slim.py b/src/pandasaurus/resources/slim.py\\nindex dbfd1d7..998d4bc 100644\\n--- a/src/pandasaurus/resources/slim.py\\n+++ b/src/pandasaurus/resources/slim.py\\n@@ -43,4 +43,4 @@ def set_term_list(self, term_list: List[Term]):\\n         self._term_list = term_list\\n \\n     def __str__(self):\\n-        return f\\\"Name:{self.name}, Description: {self.description}\\\"\\n+        return f\\\"Name:{self._name}, Description: {self._description}\\\"\\n\",\"diff --git a/src/pandasaurus/resources/term.py b/src/pandasaurus/resources/term.py\\nindex c2c6b34..ffe4709 100644\\n--- a/src/pandasaurus/resources/term.py\\n+++ b/src/pandasaurus/resources/term.py\\n@@ -80,6 +80,18 @@ def update_obsoleted_term(self):\\n             self.__iri = self.__new_iri\\n             self.__is_obsolete = False\\n \\n+    def __eq__(self, other):\\n+        if isinstance(other, Term):\\n+            return (\\n+                    self.__label == other.__label and\\n+                    self.__iri == other.__iri and\\n+                    self.__is_valid == other.__is_valid and\\n+                    self.__is_obsolete == other.__is_obsolete and\\n+                    self.__new_label == other.__new_label if (self.__is_obsolete and other.__is_obsolete) else True and\\n+                    self.__new_iri == other.__new_iri if (self.__is_obsolete and other.__is_obsolete) else True\\n+            )\\n+        return False\\n+\\n     def __str__(self):\\n         msg = f\\\"IRI: {self.__iri}, Label: {self.__label}, Valid: {self.__is_valid}\\\"\\n         if self.__is_valid:\\n\",\"diff --git a/src/pandasaurus/slim_manager.py b/src/pandasaurus/slim_manager.py\\nindex 4ef38f3..d92cd07 100644\\n--- a/src/pandasaurus/slim_manager.py\\n+++ b/src/pandasaurus/slim_manager.py\\n@@ -10,6 +10,7 @@ class SlimManager:\\n     content.\\n     \\\"\\\"\\\"\\n \\n+    # Might not be needed\\n     @staticmethod\\n     def get_slim_list(ontology: str) -> List[Dict[str, str]]:\\n         \\\"\\\"\\\"Returns name and definition of available slims in given ontology.\\n\",\"diff --git a/src/pandasaurus/utils/pandasaurus_exceptions.py b/src/pandasaurus/utils/pandasaurus_exceptions.py\\nindex 12414ec..4065f6d 100644\\n--- a/src/pandasaurus/utils/pandasaurus_exceptions.py\\n+++ b/src/pandasaurus/utils/pandasaurus_exceptions.py\\n@@ -17,7 +17,7 @@ def __init__(self, term_list: List[Term]):\\n         self.term_list = term_list\\n         self.message = (\\n             f\\\"The following terms are obsoleted: {', '.join([term.get_iri() for term in term_list])}, \\\"\\n-            f\\\"and replaced by following terms: {', '.join([term.get_new_iri() for term in term_list])} \\\"\\n-            f\\\"consider using the new terms\\\"\\n+            f\\\"and replaced by following terms: {', '.join([term.get_new_iri() for term in term_list])}. \\\"\\n+            f\\\"Please consider using the new terms\\\"\\n         )\\n         super().__init__(self.message)\\n\",\"diff --git a/src/pandasaurus/utils/sparql_queries.py b/src/pandasaurus/utils/sparql_queries.py\\nindex 921ec97..9a2092d 100644\\n--- a/src/pandasaurus/utils/sparql_queries.py\\n+++ b/src/pandasaurus/utils/sparql_queries.py\\n@@ -14,15 +14,15 @@ def get_simple_enrichment_query(\\n \\n \\n def get_minimal_enrichment_query(seed_list: List[str]) -> str:\\n-    # TODO Add missing implementation\\n+    # TODO Add missing implementation. Might not be needed\\n     pass\\n \\n \\n def get_full_enrichment_query(s_iri_list: List[str], o_iri_list: List[str]) -> str:\\n     return (\\n-        f\\\"SELECT ?s ?s_label ?p ?o ?o_label WHERE {{ GRAPH <http://reasoner.renci.org/nonredundant> {{\\\"\\n+        f\\\"SELECT DISTINCT ?s ?s_label ?p ?o ?o_label WHERE {{ GRAPH <http://reasoner.renci.org/nonredundant> {{\\\"\\n         f\\\"VALUES ?s {{ {' '.join(s_iri_list)} }} VALUES ?o {{ {' '.join(o_iri_list)} }} \\\"\\n-        f\\\"?s rdfs:subClassOf* ?o. }} ?s rdfs:label ?s_label. ?o rdfs:label ?o_label FILTER(?s != ?o)}}# LIMIT\\\"\\n+        f\\\"?s rdfs:subClassOf* ?o. FILTER(?s != ?o)}} ?s rdfs:label ?s_label. ?o rdfs:label ?o_label }}# LIMIT\\\"\\n     )\\n \\n \\n@@ -35,7 +35,7 @@ def get_contextual_enrichment_query(context_list: List[str]) -> str:\\n \\n \\n def get_curie_prefix_validation_query(seed_list: List[str]) -> str:\\n-    # TODO Add missing implementation\\n+    # TODO Add missing implementation. Might not be needed\\n     pass\\n \\n \\n@@ -48,8 +48,7 @@ def get_label_query(term_iri_list: List[str]) -> str:\\n \\n \\n def get_obsolete_term_query(seed_list: List[str]) -> str:\\n-    # TODO Add missing implementation\\n-    # We probably won't need get_replaced_by_query, we can get the suggestions with the same query\\n+    # TODO Add missing implementation. Might not be needed\\n     pass\\n \\n \\n@@ -62,6 +61,7 @@ def get_replaced_by_query(term_iri_list: List[str]) -> str:\\n     )\\n \\n \\n+# Might not be needed\\n def get_slim_list_query(ontology: str) -> str:\\n     return (\\n         f\\\"SELECT DISTINCT ?slim ?label ?comment WHERE {{ GRAPH ?ontology {{ ?ontology a owl:Ontology. ?ontology \\\"\\n\",\"diff --git a/src/pandasaurus/resources/term.py b/src/pandasaurus/resources/term.py\\nindex ffe4709..b431412 100644\\n--- a/src/pandasaurus/resources/term.py\\n+++ b/src/pandasaurus/resources/term.py\\n@@ -83,12 +83,15 @@ def update_obsoleted_term(self):\\n     def __eq__(self, other):\\n         if isinstance(other, Term):\\n             return (\\n-                    self.__label == other.__label and\\n-                    self.__iri == other.__iri and\\n-                    self.__is_valid == other.__is_valid and\\n-                    self.__is_obsolete == other.__is_obsolete and\\n-                    self.__new_label == other.__new_label if (self.__is_obsolete and other.__is_obsolete) else True and\\n-                    self.__new_iri == other.__new_iri if (self.__is_obsolete and other.__is_obsolete) else True\\n+                self.__label == other.__label\\n+                and self.__iri == other.__iri\\n+                and self.__is_valid == other.__is_valid\\n+                and self.__is_obsolete == other.__is_obsolete\\n+                and self.__new_label == other.__new_label\\n+                if (self.__is_obsolete and other.__is_obsolete)\\n+                else True and self.__new_iri == other.__new_iri\\n+                if (self.__is_obsolete and other.__is_obsolete)\\n+                else True\\n             )\\n         return False\\n \\n\",\"diff --git a/src/pandasaurus/curie_validator.py b/src/pandasaurus/curie_validator.py\\nindex 20b0eb1..9f490b8 100644\\n--- a/src/pandasaurus/curie_validator.py\\n+++ b/src/pandasaurus/curie_validator.py\\n@@ -1,9 +1,9 @@\\n from typing import Dict, List\\n \\n-from .resources.term import Term\\n-from .utils.pandasaurus_exceptions import InvalidTerm, ObsoletedTerm\\n-from .utils.query_utils import run_sparql_query\\n-from .utils.sparql_queries import get_label_query, get_replaced_by_query\\n+from src.pandasaurus.resources.term import Term\\n+from src.pandasaurus.utils.pandasaurus_exceptions import InvalidTerm, ObsoletedTerm\\n+from src.pandasaurus.utils.query_utils import run_sparql_query\\n+from src.pandasaurus.utils.sparql_queries import get_label_query, get_replaced_by_query\\n \\n \\n class CurieValidator:\\n\",\"diff --git a/src/pandasaurus/query.py b/src/pandasaurus/query.py\\nindex 2c72766..12cd142 100644\\n--- a/src/pandasaurus/query.py\\n+++ b/src/pandasaurus/query.py\\n@@ -3,12 +3,12 @@\\n \\n import pandas as pd\\n \\n-from .curie_validator import CurieValidator\\n-from .resources.term import Term\\n-from .slim_manager import SlimManager\\n-from .utils.pandasaurus_exceptions import InvalidTerm, ObsoletedTerm\\n-from .utils.query_utils import chunks, run_sparql_query\\n-from .utils.sparql_queries import (\\n+from src.pandasaurus.curie_validator import CurieValidator\\n+from src.pandasaurus.resources.term import Term\\n+from src.pandasaurus.slim_manager import SlimManager\\n+from src.pandasaurus.utils.pandasaurus_exceptions import InvalidTerm, ObsoletedTerm\\n+from src.pandasaurus.utils.query_utils import chunks, run_sparql_query\\n+from src.pandasaurus.utils.sparql_queries import (\\n     get_contextual_enrichment_query,\\n     get_full_enrichment_query,\\n     get_simple_enrichment_query,\\n\",\"diff --git a/src/pandasaurus/resources/slim.py b/src/pandasaurus/resources/slim.py\\nindex 998d4bc..e06a5a9 100644\\n--- a/src/pandasaurus/resources/slim.py\\n+++ b/src/pandasaurus/resources/slim.py\\n@@ -1,6 +1,6 @@\\n from typing import List, Optional\\n \\n-from .term import Term\\n+from src.pandasaurus.resources.term import Term\\n \\n \\n class Slim:\\n\",\"diff --git a/src/pandasaurus/slim_manager.py b/src/pandasaurus/slim_manager.py\\nindex d92cd07..2f2f85b 100644\\n--- a/src/pandasaurus/slim_manager.py\\n+++ b/src/pandasaurus/slim_manager.py\\n@@ -1,8 +1,8 @@\\n from typing import Dict, List\\n \\n-from .resources.slim import Slim\\n-from .utils.query_utils import run_sparql_query\\n-from .utils.sparql_queries import get_slim_list_query, get_slim_members_query\\n+from src.pandasaurus.resources.slim import Slim\\n+from src.pandasaurus.utils.query_utils import run_sparql_query\\n+from src.pandasaurus.utils.sparql_queries import get_slim_list_query, get_slim_members_query\\n \\n \\n class SlimManager:\\n\",\"diff --git a/src/pandasaurus/utils/pandasaurus_exceptions.py b/src/pandasaurus/utils/pandasaurus_exceptions.py\\nindex 4065f6d..4aecea2 100644\\n--- a/src/pandasaurus/utils/pandasaurus_exceptions.py\\n+++ b/src/pandasaurus/utils/pandasaurus_exceptions.py\\n@@ -1,6 +1,6 @@\\n from typing import List\\n \\n-from pandasaurus.resources.term import Term\\n+from src.pandasaurus.resources.term import Term\\n \\n \\n class InvalidTerm(Exception):\\n\",\"diff --git a/src/pandasaurus/slim_manager.py b/src/pandasaurus/slim_manager.py\\nindex 2f2f85b..571d6d6 100644\\n--- a/src/pandasaurus/slim_manager.py\\n+++ b/src/pandasaurus/slim_manager.py\\n@@ -2,7 +2,10 @@\\n \\n from src.pandasaurus.resources.slim import Slim\\n from src.pandasaurus.utils.query_utils import run_sparql_query\\n-from src.pandasaurus.utils.sparql_queries import get_slim_list_query, get_slim_members_query\\n+from src.pandasaurus.utils.sparql_queries import (\\n+    get_slim_list_query,\\n+    get_slim_members_query,\\n+)\\n \\n \\n class SlimManager:\\n\",\"diff --git a/src/pandasaurus/utils/sparql_queries.py b/src/pandasaurus/utils/sparql_queries.py\\nindex 9a2092d..c8c7c47 100644\\n--- a/src/pandasaurus/utils/sparql_queries.py\\n+++ b/src/pandasaurus/utils/sparql_queries.py\\n@@ -2,9 +2,7 @@\\n \\n \\n # TODO might need to update the enrichment query method names\\n-def get_simple_enrichment_query(\\n-    s_iri_list: List[str], o_iri_list: List[str], property_list: List[str]\\n-) -> str:\\n+def get_simple_enrichment_query(s_iri_list: List[str], o_iri_list: List[str], property_list: List[str]) -> str:\\n     return (\\n         f\\\"SELECT ?s ?s_label ?p ?o ?o_label WHERE {{ GRAPH <http://reasoner.renci.org/redundant> {{\\\"\\n         f\\\"VALUES ?s {{ {' '.join(s_iri_list)} }} VALUES ?o {{ {' '.join(o_iri_list)} }} \\\"\\n@@ -20,9 +18,10 @@ def get_minimal_enrichment_query(seed_list: List[str]) -> str:\\n \\n def get_full_enrichment_query(s_iri_list: List[str], o_iri_list: List[str]) -> str:\\n     return (\\n-        f\\\"SELECT DISTINCT ?s ?s_label ?p ?o ?o_label WHERE {{ GRAPH <http://reasoner.renci.org/nonredundant> {{\\\"\\n-        f\\\"VALUES ?s {{ {' '.join(s_iri_list)} }} VALUES ?o {{ {' '.join(o_iri_list)} }} \\\"\\n-        f\\\"?s rdfs:subClassOf* ?o. FILTER(?s != ?o)}} ?s rdfs:label ?s_label. ?o rdfs:label ?o_label }}# LIMIT\\\"\\n+        f\\\"SELECT DISTINCT ?s ?s_label ?p ?x ?x_label ?o ?o_label WHERE {{ GRAPH \\\"\\n+        f\\\"<http://reasoner.renci.org/nonredundant> {{ VALUES ?s {{ {' '.join(s_iri_list)} }} VALUES ?o {{ \\\"\\n+        f\\\" {' '.join(o_iri_list)} }}  ?s rdfs:subClassOf* ?x. ?x rdfs:subClassOf* ?o. FILTER(?s != ?o)}} ?s  \\\"\\n+        f\\\"rdfs:label ?s_label. ?x rdfs:label  ?x_label. ?o rdfs:label ?o_label }}# LIMIT\\\"\\n     )\\n \\n \\n\",\"diff --git a/pyproject.toml b/pyproject.toml\\nindex a8be60d..f64ede3 100644\\n--- a/pyproject.toml\\n+++ b/pyproject.toml\\n@@ -8,7 +8,7 @@ readme = \\\"README.md\\\"\\n \\n [tool.poetry.dependencies]\\n python = \\\"^3.9\\\"\\n-oaklib = \\\"^0.5.3\\\"\\n+oaklib = \\\"^0.5.8\\\"\\n pandas = \\\"^2.0.1\\\"\\n \\n [tool.poetry.group.dev.dependencies]\\n@@ -24,7 +24,7 @@ requires = [\\\"poetry-core\\\"]\\n build-backend = \\\"poetry.core.masonry.api\\\"\\n \\n [tool.black]\\n-line-length = 100\\n+line-length = 120\\n \\n [tool.isort]\\n profile = \\\"black\\\"\\n\\\\ No newline at end of file\\n\",\"diff --git a/src/pandasaurus/curie_validator.py b/src/pandasaurus/curie_validator.py\\nindex 9f490b8..8dae487 100644\\n--- a/src/pandasaurus/curie_validator.py\\n+++ b/src/pandasaurus/curie_validator.py\\n@@ -45,9 +45,7 @@ def validate_curie_list(curie_list: List[str]) -> Dict[str, bool]:\\n \\n         \\\"\\\"\\\"\\n         query_string = get_label_query(curie_list)\\n-        result_dict = dict(\\n-            [(r.get(\\\"term\\\"), r.get(\\\"label\\\")) for r in run_sparql_query(query_string)]\\n-        )\\n+        result_dict = dict([(r.get(\\\"term\\\"), r.get(\\\"label\\\")) for r in run_sparql_query(query_string)])\\n         return {\\n             curie: {\\n                 \\\"label\\\": result_dict.get(curie) if curie in result_dict else None,\\n@@ -132,9 +130,7 @@ def construct_term_list(seed_list) -> List[Term]:\\n                 term_validation.get(seed).get(\\\"label\\\"),\\n                 seed,\\n                 term_validation.get(seed).get(\\\"valid\\\"),\\n-                term_obsoletion.get(seed).get(\\\"new_term_label\\\")\\n-                if seed in term_obsoletion\\n-                else None,\\n+                term_obsoletion.get(seed).get(\\\"new_term_label\\\") if seed in term_obsoletion else None,\\n                 term_obsoletion.get(seed).get(\\\"new_term\\\") if seed in term_obsoletion else None,\\n             )\\n             term_list.append(term)\\n\",\"diff --git a/src/pandasaurus/query.py b/src/pandasaurus/query.py\\nindex 12cd142..4e64497 100644\\n--- a/src/pandasaurus/query.py\\n+++ b/src/pandasaurus/query.py\\n@@ -44,9 +44,7 @@ def __init__(\\n         \\\"\\\"\\\"\\n         # Might be unnecessary\\n         self.__seed_list = seed_list\\n-        self.__enrichment_property_list = (\\n-            enrichment_property_list if enrichment_property_list else [\\\"rdfs:subClassOf\\\"]\\n-        )\\n+        self.__enrichment_property_list = enrichment_property_list if enrichment_property_list else [\\\"rdfs:subClassOf\\\"]\\n         self.enriched_df: pd.DataFrame = pd.DataFrame()\\n         self.__term_list: List[Term] = CurieValidator.construct_term_list(seed_list)\\n         # Validation and reporting\\n@@ -76,9 +74,7 @@ def simple_enrichment(self) -> pd.DataFrame:\\n         # Enrichment process\\n         source_list = [term.get_iri() for term in self.__term_list]\\n         object_list = [term.get_iri() for term in self.__term_list]\\n-        query_string = get_simple_enrichment_query(\\n-            source_list, object_list, self.__enrichment_property_list\\n-        )\\n+        query_string = get_simple_enrichment_query(source_list, object_list, self.__enrichment_property_list)\\n         self.enriched_df = pd.DataFrame(\\n             [res for res in run_sparql_query(query_string)],\\n             columns=[\\\"s\\\", \\\"s_label\\\", \\\"p\\\", \\\"o\\\", \\\"o_label\\\"],\\n@@ -107,9 +103,7 @@ def minimal_slim_enrichment(self, slim_list: List[str]) -> pd.DataFrame:\\n                 [\\n                     res\\n                     for res in run_sparql_query(\\n-                        get_simple_enrichment_query(\\n-                            source_list, chunk, self.__enrichment_property_list\\n-                        )\\n+                        get_simple_enrichment_query(source_list, chunk, self.__enrichment_property_list)\\n                     )\\n                 ]\\n             )\\n@@ -135,11 +129,9 @@ def full_slim_enrichment(self, slim_list: List[str]) -> pd.DataFrame:\\n         object_list = source_list + SlimManager.get_slim_members(slim_list)\\n         s_result = []\\n         for chunk in chunks(object_list, 90):\\n-            s_result.extend(\\n-                [res for res in run_sparql_query(get_full_enrichment_query(source_list, chunk))]\\n-            )\\n+            s_result.extend([res for res in run_sparql_query(get_full_enrichment_query(source_list, chunk))])\\n \\n-        self.enriched_df = pd.DataFrame(s_result, columns=[\\\"s\\\", \\\"s_label\\\", \\\"p\\\", \\\"o\\\", \\\"o_label\\\"])\\n+        self.enriched_df = pd.DataFrame(s_result, columns=[\\\"s\\\", \\\"s_label\\\", \\\"p\\\", \\\"x\\\", \\\"x_label\\\"])\\n         return self.enriched_df\\n \\n     def contextual_slim_enrichment(self, context: List[str]) -> pd.DataFrame:\\n@@ -167,9 +159,7 @@ def contextual_slim_enrichment(self, context: List[str]) -> pd.DataFrame:\\n                 [\\n                     res\\n                     for res in run_sparql_query(\\n-                        get_simple_enrichment_query(\\n-                            source_list, chunk, self.__enrichment_property_list\\n-                        )\\n+                        get_simple_enrichment_query(source_list, chunk, self.__enrichment_property_list)\\n                     )\\n                 ]\\n             )\\n\",\"diff --git a/src/pandasaurus/slim_manager.py b/src/pandasaurus/slim_manager.py\\nindex 571d6d6..60b7436 100644\\n--- a/src/pandasaurus/slim_manager.py\\n+++ b/src/pandasaurus/slim_manager.py\\n@@ -28,13 +28,8 @@ def get_slim_list(ontology: str) -> List[Dict[str, str]]:\\n         slim_list: Dict[str, Slim] = dict()\\n         result = run_sparql_query(get_slim_list_query(ontology))\\n         for res in result:\\n-            slim_list.update(\\n-                {res.get(\\\"label\\\"): Slim(name=res.get(\\\"label\\\"), description=res.get(\\\"comment\\\"))}\\n-            )\\n-        return [\\n-            {\\\"name\\\": slim.get_name(), \\\"description\\\": slim.get_description()}\\n-            for slim in slim_list.values()\\n-        ]\\n+            slim_list.update({res.get(\\\"label\\\"): Slim(name=res.get(\\\"label\\\"), description=res.get(\\\"comment\\\"))})\\n+        return [{\\\"name\\\": slim.get_name(), \\\"description\\\": slim.get_description()} for slim in slim_list.values()]\\n \\n     @staticmethod\\n     def get_slim_members(slim_list: List[str]) -> List[str]:\\n@@ -48,7 +43,5 @@ def get_slim_members(slim_list: List[str]) -> List[str]:\\n \\n         \\\"\\\"\\\"\\n         return [\\n-            term.get(\\\"term\\\")\\n-            for slim_name in slim_list\\n-            for term in run_sparql_query(get_slim_members_query(slim_name))\\n+            term.get(\\\"term\\\") for slim_name in slim_list for term in run_sparql_query(get_slim_members_query(slim_name))\\n         ]\\n\",\"diff --git a/src/pandasaurus/utils/pandasaurus_exceptions.py b/src/pandasaurus/utils/pandasaurus_exceptions.py\\nindex 4aecea2..40bf4dd 100644\\n--- a/src/pandasaurus/utils/pandasaurus_exceptions.py\\n+++ b/src/pandasaurus/utils/pandasaurus_exceptions.py\\n@@ -6,9 +6,7 @@\\n class InvalidTerm(Exception):\\n     def __init__(self, term_list: List[Term]):\\n         self.term_list = term_list\\n-        self.message = (\\n-            f\\\"The following terms are invalid: {', '.join([term.get_iri() for term in term_list])}\\\"\\n-        )\\n+        self.message = f\\\"The following terms are invalid: {', '.join([term.get_iri() for term in term_list])}\\\"\\n         super().__init__(self.message)\\n \\n \\n\",\"diff --git a/src/pandasaurus/query.py b/src/pandasaurus/query.py\\nindex 4e64497..579a365 100644\\n--- a/src/pandasaurus/query.py\\n+++ b/src/pandasaurus/query.py\\n@@ -131,7 +131,9 @@ def full_slim_enrichment(self, slim_list: List[str]) -> pd.DataFrame:\\n         for chunk in chunks(object_list, 90):\\n             s_result.extend([res for res in run_sparql_query(get_full_enrichment_query(source_list, chunk))])\\n \\n-        self.enriched_df = pd.DataFrame(s_result, columns=[\\\"s\\\", \\\"s_label\\\", \\\"p\\\", \\\"x\\\", \\\"x_label\\\"])\\n+        self.enriched_df = pd.DataFrame(s_result, columns=[\\\"s\\\", \\\"s_label\\\", \\\"p\\\", \\\"x\\\", \\\"x_label\\\"]).rename(\\n+            columns={\\\"x\\\": \\\"o\\\", \\\"x_label\\\": \\\"o_label\\\"}\\n+        )\\n         return self.enriched_df\\n \\n     def contextual_slim_enrichment(self, context: List[str]) -> pd.DataFrame:\\n\"]", "test_patch": "", "hints_text": ""}
