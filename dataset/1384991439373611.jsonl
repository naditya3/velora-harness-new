{"instance_id": "1384991439373611", "repo": "mindsdb/mindsdb_python_sdk", "base_commit": "4c892285b07b5a987b808e2fb7fbe4b9fdf0bf86", "problem_statement": "Getting table from S3 handler:\\n\\r\\nIf handler allows to use table that is not exposed in list of tables:\\r\\nfor example you can call:\\r\\n```sql\\r\\nselect * from iris.S3Object\\r\\n```\\r\\nbut you can't find S3Object table in\\r\\n```sql\\r\\nshow tables from iris\\r\\n```\\r\\n\\r\\nThen it is not possible to get table in sdk via:\\r\\n```python\\r\\ntable=con.databases.iris.tables.S3Object\\r\\n```\\r\\n\\r\\nProposal:\\r\\nDon't check list of tables in database to get table object in both syntaxes:\\r\\n- db.tables.S3Object\\r\\n- db.get_table('S3Object')\\r\\n\\r\\nReference: https://mindsdbcommunity.slack.com/archives/C01S2T35H18/p1698066406012289?thread_ts=1698060076.412459&cid=C01S2T35H18\\r\\n", "FAIL_TO_PASS": ["tests/test_sdk.py::Test::test_flow", "tests/test_sdk.py::TestSimplify::test_flow"], "PASS_TO_PASS": ["tests/test_sdk.py::Test::test_managed_login"], "language": "python", "test_command": "source /saved/ENV || source /saved/*/ENV && pytest --no-header -rA --tb=no -p no:cacheprovider --continue-on-collection-errors", "test_output_parser": "python/parse_log_pytest_v3", "image_storage_uri": "vmvm-registry.fbinfra.net/repomate_image_activ_pytest/mindsdb_mindsdb_python_sdk:4c892285b07b5a987b808e2fb7fbe4b9fdf0bf86", "patch": "[\"diff --git a/README.md b/README.md\\nindex aea6708..d217ec1 100644\\n--- a/README.md\\n+++ b/README.md\\n@@ -107,7 +107,7 @@ https://github.com/mindsdb/mindsdb_python_sdk/tree/staging/examples\\n \\n ## API Documentation\\n \\n-The API documentation for the MindsDB SDK can be found at https://mindsdb.github.io/mindsdb_python_sdk/. You can generate the API documentation locally by following these steps:\\n+The API documentation for the MindsDB SDK can be found at https://mindsdb.github.io/mindsdb_python_sdk/.\\n \\n ### Generating API docs locally:\\n \\n\",\"diff --git a/docs/source/conf.py b/docs/source/conf.py\\nindex a0df610..03b66bf 100644\\n--- a/docs/source/conf.py\\n+++ b/docs/source/conf.py\\n@@ -16,7 +16,11 @@ author = 'MindsDB Inc'\\n # -- General configuration ---------------------------------------------------\\n # https://www.sphinx-doc.org/en/master/usage/configuration.html#general-configuration\\n \\n-extensions = ['sphinx.ext.autodoc', 'sphinx.ext.napoleon']\\n+extensions = [\\n+    'sphinx.ext.autodoc',\\n+    'sphinx.ext.napoleon',\\n+    'sphinx.ext.autosectionlabel'\\n+]\\n \\n templates_path = ['_templates']\\n exclude_patterns = []\\n\",\"diff --git a/docs/source/index.rst b/docs/source/index.rst\\nindex c7705ac..3457c21 100644\\n--- a/docs/source/index.rst\\n+++ b/docs/source/index.rst\\n@@ -90,7 +90,7 @@ Base usage\\n     More\\n \\n More examples\\n------------\\n+-------------\\n \\n `<https://github.com/mindsdb/mindsdb_python_sdk/examples>`_\\n \\n@@ -107,12 +107,13 @@ API documentation\\n    :maxdepth: 1\\n    :caption: Modules:\\n \\n-\\n    server\\n    database\\n+\\n+   project\\n    handlers\\n+\\n    ml_engines\\n-   project\\n    model\\n    tables\\n    views\\n\",\"diff --git a/docs/source/jobs.rst b/docs/source/jobs.rst\\nindex aa47c3e..7fb2858 100644\\n--- a/docs/source/jobs.rst\\n+++ b/docs/source/jobs.rst\\n@@ -1,6 +1,9 @@\\n Jobs\\n -------------------------\\n \\n+.. _my-reference-label:\\n+\\n+\\n .. automodule:: mindsdb_sdk.jobs\\n    :members:\\n    :undoc-members:\\n\",\"diff --git a/docs/source/server.rst b/docs/source/server.rst\\nindex 3c7284c..9d8a942 100644\\n--- a/docs/source/server.rst\\n+++ b/docs/source/server.rst\\n@@ -4,4 +4,7 @@ Server\\n .. automodule:: mindsdb_sdk.server\\n    :members:\\n    :undoc-members:\\n-   :show-inheritance:\\n\\\\ No newline at end of file\\n+   :show-inheritance:\\n+\\n+\\n+   :ref:`jobs<Jobs>`\\n\\\\ No newline at end of file\\n\",\"diff --git a/examples/working_with_tables.py b/examples/working_with_tables.py\\nindex 73ca881..ee2f2fa 100644\\n--- a/examples/working_with_tables.py\\n+++ b/examples/working_with_tables.py\\n@@ -3,21 +3,44 @@ import pandas as pd\\n \\n con = mindsdb_sdk.connect()\\n \\n-# get user's database (connected to mindsdb as rental_db)\\n-db = con.databases.rental_db\\n+# connect to mindsdb example database\\n+example_db = con.databases.create(\\n+    'example_db',\\n+    engine='postgres',\\n+    connection_args={\\n+        \\\"user\\\": \\\"demo_user\\\",\\n+        \\\"password\\\": \\\"demo_password\\\",\\n+        \\\"host\\\": \\\"3.220.66.106\\\",\\n+        \\\"port\\\": \\\"5432\\\",\\n+        \\\"database\\\": \\\"demo\\\"\\n+    }\\n+)\\n \\n-# get table\\n-table1 = db.tables.house_sales\\n+# connect to the empty user database\\n+my_db = con.databases.create(\\n+    'my_db',\\n+    engine='postgres',\\n+    connection_args={\\n+        \\\"user\\\": \\\"postgres\\\",\\n+        \\\"host\\\": \\\"localhost\\\",\\n+        \\\"port\\\": \\\"5432\\\",\\n+        \\\"database\\\": \\\"my_database\\\"\\n+    }\\n+)\\n \\n+# get home_rentals table\\n+table1 = example_db.tables.get('demo_data.home_rentals')\\n \\n # ---- create new table ----\\n \\n-# copy create table house_sales and fill it with rows with type=house\\n-table2 = db.tables.create('house_sales2', table1.filter(type='house'))\\n+# create table home_rentals in user db and fill it with rows with location=great\\n+table2 = my_db.tables.create('home_rentals', table1.filter(location='great'))\\n+\\n \\n # create table from csv file\\n+\\n df = pd.read_csv('my_data.csv')\\n-table3 = db.tables.create('my_table', df)\\n+table3 = my_db.tables.create('my_table', df)\\n \\n \\n # ---- insert into table ----\\n@@ -28,16 +51,16 @@ table2.insert(table1.limit(10))\\n \\n # ---- update data in table ----\\n \\n-# get all rows with type=house from table1 and update values in table2 using key ('saledate', 'type', 'bedrooms')\\n+# get all rows with number_of_rooms=1 from table1 and update values in table2 using key ('location', 'neighborhood')\\n table2.update(\\n-    table1.filter(type='house'),\\n-    on=['saledate', 'type', 'bedrooms']\\n+    table1.filter(number_of_rooms=1),\\n+    on=['location', 'neighborhood']\\n )\\n \\n \\n # ---- delete rows from table ----\\n \\n # delete all rows where bedrooms=2\\n-table2.delete(bedrooms=2)\\n+table2.delete(number_of_rooms=1)\\n \\n \\n\",\"diff --git a/mindsdb_sdk/__about__.py b/mindsdb_sdk/__about__.py\\nindex 186d972..39ac92b 100755\\n--- a/mindsdb_sdk/__about__.py\\n+++ b/mindsdb_sdk/__about__.py\\n@@ -1,6 +1,6 @@\\n __title__ = 'mindsdb_sdk'\\n __package_name__ = 'mindsdb_sdk'\\n-__version__ = '2.0.0'\\n+__version__ = '2.1.0'\\n __description__ = \\\"MindsDB Python SDK, provides an SDK to use a remote mindsdb instance\\\"\\n __email__ = \\\"jorge@mindsdb.com\\\"\\n __author__ = 'MindsDB Inc'\\n\",\"diff --git a/mindsdb_sdk/connect.py b/mindsdb_sdk/connect.py\\nindex 0a5c8ed..af998b4 100644\\n--- a/mindsdb_sdk/connect.py\\n+++ b/mindsdb_sdk/connect.py\\n@@ -20,17 +20,17 @@ def connect(url: str = None, login: str = None, password: str = None, is_managed\\n \\n     Connect to local server\\n \\n-    >>> server = mindsdb_sdk.connect()\\n-    >>> server = mindsdb_sdk.connect('http://127.0.0.1:47334')\\n+    >>> con = mindsdb_sdk.connect()\\n+    >>> con = mindsdb_sdk.connect('http://127.0.0.1:47334')\\n \\n     Connect to cloud server\\n \\n-    >>> server = mindsdb_sdk.connect(login='a@b.com', password='-')\\n-    >>> server = mindsdb_sdk.connect('https://cloud.mindsdb.com', login='a@b.com', password='-')\\n+    >>> con = mindsdb_sdk.connect(login='a@b.com', password='-')\\n+    >>> con = mindsdb_sdk.connect('https://cloud.mindsdb.com', login='a@b.com', password='-')\\n \\n     Connect to MindsDB pro\\n \\n-    >>> server = mindsdb_sdk.connect('http://<YOUR_INSTANCE_IP>', login='a@b.com', password='-', is_managed=True)\\n+    >>> con = mindsdb_sdk.connect('http://<YOUR_INSTANCE_IP>', login='a@b.com', password='-', is_managed=True)\\n \\n     \\\"\\\"\\\"\\n     if url is None:\\n\",\"diff --git a/mindsdb_sdk/connectors/rest_api.py b/mindsdb_sdk/connectors/rest_api.py\\nindex f27f36c..cbbba7f 100644\\n--- a/mindsdb_sdk/connectors/rest_api.py\\n+++ b/mindsdb_sdk/connectors/rest_api.py\\n@@ -124,7 +124,7 @@ class RestAPI:\\n \\n         # convert to file\\n         fd = io.BytesIO()\\n-        df.to_csv(fd)\\n+        df.to_csv(fd, index=False)\\n         fd.seek(0)\\n \\n         url = self.url + f'/api/files/{name}'\\n@@ -139,4 +139,24 @@ class RestAPI:\\n                 'file': fd,\\n             }\\n         )\\n-        _raise_for_status(r)\\n\\\\ No newline at end of file\\n+        _raise_for_status(r)\\n+\\n+    @_try_relogin\\n+    def upload_byom(self, name: str, code: str, requirements: str):\\n+\\n+        url = self.url + f'/api/handlers/byom/{name}'\\n+        r = self.session.put(\\n+            url,\\n+            files={\\n+                'code': code,\\n+                'modules': requirements,\\n+            }\\n+        )\\n+        _raise_for_status(r)\\n+\\n+    def status(self) -> dict:\\n+\\n+        r = self.session.get(self.url + f'/api/status')\\n+        _raise_for_status(r)\\n+\\n+        return r.json()\\n\",\"diff --git a/mindsdb_sdk/databases.py b/mindsdb_sdk/databases.py\\nindex 2e69b7b..f5e0257 100644\\n--- a/mindsdb_sdk/databases.py\\n+++ b/mindsdb_sdk/databases.py\\n@@ -1,4 +1,4 @@\\n-from typing import List\\n+from typing import List, Union\\n \\n from mindsdb_sql.parser.dialects.mindsdb import CreateDatabase\\n from mindsdb_sql.parser.ast import DropDatabase, Identifier\\n@@ -7,6 +7,7 @@ from mindsdb_sdk.utils.objects_collection import CollectionBase\\n \\n from .query import Query\\n from .tables import Tables\\n+from .handlers import Handler\\n \\n \\n class Database:\\n@@ -93,7 +94,7 @@ class Databases(CollectionBase):\\n         \\\"\\\"\\\"\\n         return [Database(self, name) for name in self._list_databases()]\\n \\n-    def create(self, name: str, engine: str, connection_args: dict) -> Database:\\n+    def create(self, name: str, engine: Union[str, Handler], connection_args: dict) -> Database:\\n         \\\"\\\"\\\"\\n         Create new integration and return it\\n \\n@@ -102,6 +103,9 @@ class Databases(CollectionBase):\\n         :param connection_args: {\\\"key\\\": \\\"value\\\"} object with the connection parameters specific for each engine\\n         :return: created Database object\\n         \\\"\\\"\\\"\\n+        if isinstance(engine, Handler):\\n+            engine = engine.name\\n+\\n         ast_query = CreateDatabase(\\n             name=Identifier(name),\\n             engine=engine,\\n\",\"diff --git a/mindsdb_sdk/handlers.py b/mindsdb_sdk/handlers.py\\nindex 31b3472..e2dd361 100644\\n--- a/mindsdb_sdk/handlers.py\\n+++ b/mindsdb_sdk/handlers.py\\n@@ -9,6 +9,9 @@ from mindsdb_sdk.utils.objects_collection import CollectionBase\\n \\n @dataclass(init=False)\\n class Handler:\\n+    \\\"\\\"\\\"\\n+    :meta private:\\n+    \\\"\\\"\\\"\\n     name: str\\n     title: str\\n     version: str\\n@@ -26,26 +29,7 @@ class Handler:\\n \\n class Handlers(CollectionBase):\\n     \\\"\\\"\\\"\\n-       **Handlers colection**\\n-\\n-       Examples of usage:\\n-\\n-       ML handlers:\\n-\\n-       Get list\\n-       >>> con.ml_handlers.list()\\n-\\n-       Get\\n-       >>> openai_handler = con.ml_handlers.openai\\n-\\n-       DATA handlers:\\n-\\n-       Get list\\n-       >>> con.data_handlers.list()\\n-\\n-       Get\\n-       >>> pg_handler = con.data_handlers.postgres\\n-\\n+    :meta private:\\n     \\\"\\\"\\\"\\n \\n     def __init__(self, api, type):\\n@@ -91,3 +75,43 @@ class Handlers(CollectionBase):\\n             if item.name == name:\\n                 return item\\n         raise AttributeError(f\\\"Handler doesn't exist: {name}\\\")\\n+\\n+\\n+class MLHandlers(Handlers):\\n+    \\\"\\\"\\\"\\n+       **ML handlers colection**\\n+\\n+       Examples of usage:\\n+\\n+       Get list\\n+\\n+       >>> con.ml_handlers.list()\\n+\\n+       Get\\n+\\n+       >>> openai_handler = con.ml_handlers.openai\\n+       >>> openai_handler = con.ml_handlers.get('openai')\\n+\\n+    \\\"\\\"\\\"\\n+\\n+    ...\\n+\\n+\\n+class DataHandlers(Handlers):\\n+    \\\"\\\"\\\"\\n+        **DATA handlers colection**\\n+\\n+        Examples of usage:\\n+\\n+        Get list\\n+\\n+        >>> con.data_handlers.list()\\n+\\n+        Get\\n+\\n+        >>> pg_handler = con.data_handlers.postgres\\n+        >>> pg_handler = con.data_handlers.get('postgres')\\n+\\n+    \\\"\\\"\\\"\\n+\\n+    ...\\n\\\\ No newline at end of file\\n\",\"diff --git a/mindsdb_sdk/jobs.py b/mindsdb_sdk/jobs.py\\nindex 222efc0..369a0da 100644\\n--- a/mindsdb_sdk/jobs.py\\n+++ b/mindsdb_sdk/jobs.py\\n@@ -99,7 +99,10 @@ class Jobs(CollectionBase):\\n                    repeat_str: str = None) -> Union[Job, None]:\\n         \\\"\\\"\\\"\\n         Create new job in project and return it.\\n-        If it is not possible (job executed and not accessible anymore): return None\\n+\\n+        If it is not possible (job executed and not accessible anymore):\\n+           return None\\n+\\n         More info: https://docs.mindsdb.com/sql/create/jobs\\n \\n         :param name: name of the job\\n\",\"diff --git a/mindsdb_sdk/ml_engines.py b/mindsdb_sdk/ml_engines.py\\nindex eeb15f2..7cb67b3 100644\\n--- a/mindsdb_sdk/ml_engines.py\\n+++ b/mindsdb_sdk/ml_engines.py\\n@@ -10,6 +10,9 @@ from .handlers import Handler\\n \\n @dataclass\\n class MLEngine:\\n+    \\\"\\\"\\\"\\n+    :meta private:\\n+    \\\"\\\"\\\"\\n     name: str\\n     handler: str\\n     connection_data: dict\\n@@ -23,12 +26,15 @@ class MLEngines(CollectionBase):\\n     Examples of usage:\\n \\n     Get list\\n+\\n     >>> ml_engines = con.ml_engines.list()\\n \\n     Get\\n+\\n     >>> openai_engine = con.ml_engines.openai1\\n \\n     Create\\n+\\n     >>> con.ml_engines.create(\\n     ...    'openai1',\\n     ...    'openai',\\n@@ -36,8 +42,19 @@ class MLEngines(CollectionBase):\\n     ...)\\n \\n     Drop\\n+\\n     >>>  con.ml_engines.drop('openai1')\\n \\n+    Upload BYOM model. After uploading a new ml engin will be availbe to create new model from it.\\n+\\n+    >>> model_code = open('/path/to/model/code').read()\\n+    >>> model_requirements = open('/path/to/model/requirements').read()\\n+    >>> ml_engine = con.ml_engines.create_byom(\\n+    ...    'my_byom_engine',\\n+    ...    code=model_code,\\n+    ...    requirements=model_requirements\\n+    ...)\\n+\\n     \\\"\\\"\\\"\\n \\n     def __init__(self, api):\\n@@ -46,6 +63,7 @@ class MLEngines(CollectionBase):\\n     def list(self) -> List[MLEngine]:\\n         \\\"\\\"\\\"\\n         Returns list of ml engines on server\\n+\\n         :return: list of ml engines\\n         \\\"\\\"\\\"\\n \\n@@ -77,6 +95,7 @@ class MLEngines(CollectionBase):\\n     def create(self, name: str, handler: Union[str, Handler], connection_data: dict = None) -> MLEngine:\\n         \\\"\\\"\\\"\\n         Create new ml engine and return it\\n+\\n         :param name: ml engine name, string\\n         :param handler: handler name, string or Handler\\n         :param connection_data: parameters for ml engine, dict, optional\\n@@ -92,9 +111,29 @@ class MLEngines(CollectionBase):\\n \\n         return MLEngine(name, handler, connection_data)\\n \\n+    def create_byom(self, name: str, code: str, requirements: Union[str, List[str]] = None):\\n+        \\\"\\\"\\\"\\n+        Create new BYOM ML engine and return it\\n+\\n+        :param code: model python code in string\\n+        :param requirements: requirements for model. Optional if there is no special requirements.\\n+           It can be content of 'requirement.txt' file or list of strings (item for every requirement).\\n+        :return: created BYOM ml engine object\\n+        \\\"\\\"\\\"\\n+\\n+        if requirements is None:\\n+            requirements = ''\\n+        elif isinstance(requirements, list):\\n+            requirements = '\\\\n'.join(requirements)\\n+\\n+        self.api.upload_byom(name, code, requirements)\\n+\\n+        return MLEngine(name, 'byom', {})\\n+\\n     def drop(self, name: str):\\n         \\\"\\\"\\\"\\n         Drop ml engine by name\\n+\\n         :param name: name\\n         \\\"\\\"\\\"\\n         ast_query = DropMLEngine(Identifier(name))\\n\",\"diff --git a/mindsdb_sdk/models.py b/mindsdb_sdk/models.py\\nindex ee7cb8b..0ff6f02 100644\\n--- a/mindsdb_sdk/models.py\\n+++ b/mindsdb_sdk/models.py\\n@@ -117,9 +117,11 @@ Usng model\\n         \\\"\\\"\\\"\\n         Make prediction using model\\n \\n-        if data is dataframe it uses /model/predict http method and sends dataframe over it\\n-        if data is select query with one table it replaces table to jon table and predictor\\n-        and sends query over sql/query http method\\n+        if data is dataframe\\n+          it uses /model/predict http method and sends dataframe over it\\n+\\n+        if data is select query with one table\\n+         it replaces table to jon table and predictor and sends query over sql/query http method\\n \\n         if data is select from join other complex query it modifies query to:\\n           'select from (input query) join model' and sends it over sql/query http method\\n@@ -337,6 +339,8 @@ Usng model\\n         \\\"\\\"\\\"\\n         Drop version of the model\\n \\n+        >>> models.rentals_model.drop_version(version=10)\\n+\\n         :param num: version to drop\\n         \\\"\\\"\\\"\\n \\n@@ -390,40 +394,6 @@ class Models(CollectionBase):\\n     >>> model = models.get('model1')\\n     >>> model = models.get('model1', version=2)\\n \\n-    Create\\n-\\n-    Create, using params and qeury as string\\n-\\n-    >>> model = models.create(\\n-    ...   'rentals_model',\\n-    ...   predict='price',\\n-    ...   engine='lightwood',\\n-    ...   database='example_db',\\n-    ...   query='select * from table',\\n-    ...   options={\\n-    ...       'module': 'LightGBM'\\n-    ...   },\\n-    ...   timeseries_options={\\n-    ...       'order': 'date',\\n-    ...       'group': ['a', 'b']\\n-    ...   }\\n-    ...)\\n-\\n-    Create, using deferred query. 'query' will be executed and converted to dataframe on mindsdb backend.\\n-\\n-    >>> query = databases.db.query('select * from table')\\n-    >>> model = models.create(\\n-    ...   'rentals_model',\\n-    ...   predict='price',\\n-    ...   query=query,\\n-    ...)\\n-\\n-\\n-    Drop\\n-\\n-    >>> models.drop('rentals_model')\\n-    >>> models.rentals_model.drop_version(version=10)\\n-\\n     \\\"\\\"\\\"\\n \\n     def __init__(self, project, api):\\n@@ -445,6 +415,32 @@ class Models(CollectionBase):\\n \\n         If query/database is passed, it will be executed on mindsdb side\\n \\n+        Create, using params and qeury as string\\n+\\n+        >>> model = models.create(\\n+        ...   'rentals_model',\\n+        ...   predict='price',\\n+        ...   engine='lightwood',\\n+        ...   database='example_db',\\n+        ...   query='select * from table',\\n+        ...   options={\\n+        ...       'module': 'LightGBM'\\n+        ...   },\\n+        ...   timeseries_options={\\n+        ...       'order': 'date',\\n+        ...       'group': ['a', 'b']\\n+        ...   }\\n+        ...)\\n+    \\n+        Create, using deferred query. 'query' will be executed and converted to dataframe on mindsdb backend.\\n+\\n+        >>> query = databases.db.query('select * from table')\\n+        >>> model = models.create(\\n+        ...   'rentals_model',\\n+        ...   predict='price',\\n+        ...   query=query,\\n+        ...)\\n+\\n         :param name: name of the model\\n         :param predict: prediction target\\n         :param engine: ml engine for new model, default is mindsdb\\n@@ -467,6 +463,9 @@ class Models(CollectionBase):\\n             targets = [Identifier(predict)]\\n         else:\\n             targets = None\\n+        if database is None:\\n+            raise RuntimeError('Database is not defined')\\n+\\n         ast_query = CreatePredictor(\\n             name=Identifier(name),\\n             query_str=query,\\n@@ -537,6 +536,8 @@ class Models(CollectionBase):\\n         \\\"\\\"\\\"\\n         Drop model from project with all versions\\n \\n+        >>> models.drop('rentals_model')\\n+\\n         :param name: name of the model\\n         \\\"\\\"\\\"\\n         ast_query = DropPredictor(name=Identifier(name))\\n@@ -549,8 +550,10 @@ class Models(CollectionBase):\\n         \\\"\\\"\\\"\\n         List models (or model versions) in project\\n \\n-        If with_versions = True it shows all models with version (executes 'select * from models_versions')\\n-        Otherwise it shows only models (executes 'select * from models')\\n+        If with_versions = True\\n+          it shows all models with version (executes 'select * from models_versions')\\n+\\n+          Otherwise it shows only models (executes 'select * from models')\\n \\n         :param with_versions: show model versions\\n         :param name: to show models or versions only with selected name, optional\\n\",\"diff --git a/mindsdb_sdk/projects.py b/mindsdb_sdk/projects.py\\nindex d234ab5..d79deb9 100644\\n--- a/mindsdb_sdk/projects.py\\n+++ b/mindsdb_sdk/projects.py\\n@@ -21,9 +21,9 @@ class Project:\\n     Server instance allows to manipulate project and databases (integration) on mindsdb server\\n \\n     Attributes for accessing to different objects:\\n-        - models\\n-        - views\\n-        - jobs\\n+        - models, see :func:`~mindsdb_sdk.models.Models`\\n+        - views, see :func:`~mindsdb_sdk.views.Views`\\n+        - jobs, see :func:`~mindsdb_sdk.jobs.Jobs`\\n \\n     It is possible to cal queries from project context:\\n \\n@@ -109,23 +109,23 @@ class Projects(CollectionBase):\\n     Projects\\n     ----------\\n \\n-    # list of projects\\n+    list of projects\\n \\n     >>> projects.list()\\n \\n-    # create\\n+    create\\n \\n     >>> project = projects.create('proj')\\n \\n-    # drop\\n+    drop\\n \\n     >>> projects.drop('proj')\\n \\n-    # get existing\\n+    get existing\\n \\n     >>> projects.get('proj')\\n \\n-    # by attribute\\n+    by attribute\\n     >>> projects.proj\\n \\n     \\\"\\\"\\\"\\n\",\"diff --git a/mindsdb_sdk/server.py b/mindsdb_sdk/server.py\\nindex d6e6319..ccb8671 100644\\n--- a/mindsdb_sdk/server.py\\n+++ b/mindsdb_sdk/server.py\\n@@ -9,14 +9,17 @@ class Server(Project):\\n     Server instance allows to manipulate project and databases (integration) on mindsdb server\\n \\n     Attributes for accessing to different objects:\\n-        - projects\\n-        - databases\\n-        - ml_engines\\n \\n-    Server is also root(mindsdb) project and has its attributes\\n-        - models\\n-        - views\\n-        - jobs\\n+        - projects, see :func:`~mindsdb_sdk.projects.Projects`\\n+        - databases, see :func:`~mindsdb_sdk.databases.Databases`\\n+        - ml_engines, see :func:`~mindsdb_sdk.ml_engines.MLEngines`\\n+        - ml_handlers, see :func:`~mindsdb_sdk.handlers.MLHandlers`\\n+        - data_handlers, see :func:`~mindsdb_sdk.handlers.DataHandlers`\\n+\\n+    Server is also root(mindsdb) project and has attributes of project:\\n+        - models, see :func:`~mindsdb_sdk.models.Models`\\n+        - views, see :func:`~mindsdb_sdk.views.Views`\\n+        - jobs, see :func:`~mindsdb_sdk.jobs.Jobs`\\n \\n     \\\"\\\"\\\"\\n \\n@@ -45,6 +48,16 @@ class Server(Project):\\n         self.ml_handlers = Handlers(self.api, 'ml')\\n         self.data_handlers = Handlers(self.api, 'data')\\n \\n+    def status(self) -> dict:\\n+        \\\"\\\"\\\"\\n+        Get server information. It could content version\\n+        Example of getting version for local:\\n+        >>> print(server.status()['mindsdb_version'])\\n+\\n+        :return: server status info\\n+        \\\"\\\"\\\"\\n+        return self.api.status()\\n+\\n     def __repr__(self):\\n         return f'{self.__class__.__name__}({self.api.url})'\\n \\n\",\"diff --git a/mindsdb_sdk/tables.py b/mindsdb_sdk/tables.py\\nindex 78d7f3e..b19fd49 100644\\n--- a/mindsdb_sdk/tables.py\\n+++ b/mindsdb_sdk/tables.py\\n@@ -102,7 +102,9 @@ class Table(Query):\\n \\n     def delete(self, **kwargs):\\n         \\\"\\\"\\\"\\n-        Deletes record from table using filters  table.delete(a=1, b=2)\\n+        Deletes record from table using filters\\n+\\n+        >>> table.delete(a=1, b=2)\\n \\n         :param kwargs: filter\\n         \\\"\\\"\\\"\\n@@ -121,15 +123,16 @@ class Table(Query):\\n     def update(self, values: Union[dict, Query], on: list = None, filters: dict = None):\\n         '''\\n         Update table by condition of from other table.\\n+\\n         If 'values' is a dict:\\n-        - it will be an update by condition\\n-        - 'filters' is required\\n-        - used command: update table set a=1 where x=1\\n+          it will be an update by condition\\n+          'filters' is required\\n+          used command: update table set a=1 where x=1\\n \\n         If 'values' is a Query:\\n-        - it will be an update from select\\n-        - 'on' is required\\n-        - used command: update table on a,b from (query)\\n+          it will be an update from select\\n+          'on' is required\\n+          used command: update table on a,b from (query)\\n \\n         :param values: input for update, can be dict or query\\n         :param on: list of column to map subselect to table ['a', 'b', ...]\\n@@ -233,10 +236,6 @@ class Tables(CollectionBase):\\n         :return: Table object\\n         \\\"\\\"\\\"\\n \\n-        if name not in self._list_tables():\\n-            if '.' not in name:\\n-                # fixme: schemas not visible in 'show tables'\\n-                raise AttributeError(\\\"Table doesn't exist\\\")\\n         return Table(self.database, name)\\n \\n     def create(self, name: str, query: Union[pd.DataFrame, Query], replace: bool = False) -> Table:\\n\",\"diff --git a/mindsdb_sdk/utils/objects_collection.py b/mindsdb_sdk/utils/objects_collection.py\\nindex 054c026..8405824 100644\\n--- a/mindsdb_sdk/utils/objects_collection.py\\n+++ b/mindsdb_sdk/utils/objects_collection.py\\n@@ -19,39 +19,39 @@ class CollectionBase:\\n         return self.get(name)\\n \\n \\n-class MethodCollection(CollectionBase):\\n-\\n-    def __init__(self, name, methods):\\n-        self.name = name\\n-        self.methods = methods\\n-\\n-    def __repr__(self):\\n-        return f'{self.__class__.__name__}({self.name})'\\n-\\n-    def get(self, *args, **kwargs):\\n-        method = self.methods.get('get')\\n-        if method is None:\\n-            raise NotImplementedError()\\n-\\n-        return method(*args, **kwargs)\\n-\\n-    def list(self, *args, **kwargs):\\n-        method = self.methods.get('list')\\n-        if method is None:\\n-            raise NotImplementedError()\\n-\\n-        return method(*args, **kwargs)\\n-\\n-    def create(self, *args, **kwargs):\\n-        method = self.methods.get('create')\\n-        if method is None:\\n-            raise NotImplementedError()\\n-\\n-        return method(*args, **kwargs)\\n-\\n-    def drop(self, name):\\n-        method = self.methods.get('drop')\\n-        if method is None:\\n-            raise NotImplementedError()\\n-\\n-        return method(name)\\n+# class MethodCollection(CollectionBase):\\n+#\\n+#     def __init__(self, name, methods):\\n+#         self.name = name\\n+#         self.methods = methods\\n+#\\n+#     def __repr__(self):\\n+#         return f'{self.__class__.__name__}({self.name})'\\n+#\\n+#     def get(self, *args, **kwargs):\\n+#         method = self.methods.get('get')\\n+#         if method is None:\\n+#             raise NotImplementedError()\\n+#\\n+#         return method(*args, **kwargs)\\n+#\\n+#     def list(self, *args, **kwargs):\\n+#         method = self.methods.get('list')\\n+#         if method is None:\\n+#             raise NotImplementedError()\\n+#\\n+#         return method(*args, **kwargs)\\n+#\\n+#     def create(self, *args, **kwargs):\\n+#         method = self.methods.get('create')\\n+#         if method is None:\\n+#             raise NotImplementedError()\\n+#\\n+#         return method(*args, **kwargs)\\n+#\\n+#     def drop(self, name):\\n+#         method = self.methods.get('drop')\\n+#         if method is None:\\n+#             raise NotImplementedError()\\n+#\\n+#         return method(name)\\n\",\"diff --git a/requirements.txt b/requirements.txt\\nindex eb8d5b6..f6f24fb 100644\\n--- a/requirements.txt\\n+++ b/requirements.txt\\n@@ -1,3 +1,3 @@\\n requests\\n pandas >= 1.3.5\\n-mindsdb-sql >= 0.7.0, < 0.8.0\\n+mindsdb-sql >= 0.7.0, < 0.11.0\\n\"]", "test_patch": "[\"diff --git a/.github/workflows/add_to_pr_review.yml b/.github/workflows/add_to_pr_review.yml\\nnew file mode 100644\\nindex 0000000..384f2be\\n--- /dev/null\\n+++ b/.github/workflows/add_to_pr_review.yml\\n@@ -0,0 +1,16 @@\\n+name: Add Pull Requests to PR review project\\n+\\n+on:\\n+  pull_request:\\n+    types:\\n+      - opened\\n+\\n+jobs:\\n+  add-to-project:\\n+    name: Add issue to project\\n+    runs-on: ubuntu-latest\\n+    steps:\\n+      - uses: actions/add-to-project@v0.5.0\\n+        with:\\n+          project-url: https://github.com/orgs/mindsdb/projects/65\\n+          github-token: ${{ secrets.ADD_TO_PROJECT_PAT }}\\n\",\"diff --git a/.github/workflows/add_to_roadmap_project_v2.yml b/.github/workflows/add_to_roadmap_project_v2.yml\\nnew file mode 100644\\nindex 0000000..240c700\\n--- /dev/null\\n+++ b/.github/workflows/add_to_roadmap_project_v2.yml\\n@@ -0,0 +1,14 @@\\n+name: Add issue to roadmap project\\n+on:\\n+  issues:\\n+    types:\\n+      - opened\\n+jobs:\\n+  add-to-project:\\n+    name: Add issue to roadmap project\\n+    runs-on: ubuntu-latest\\n+    steps:\\n+      - uses: actions/add-to-project@v0.4.0\\n+        with:\\n+          project-url: https://github.com/orgs/mindsdb/projects/53\\n+          github-token: ${{ secrets.ADD_TO_PROJECT_PAT }}\\n\\\\ No newline at end of file\\n\",\"diff --git a/.github/workflows/mindsdb_python_sdk.yml b/.github/workflows/mindsdb_python_sdk.yml\\nindex 79a59f1..24bfae5 100644\\n--- a/.github/workflows/mindsdb_python_sdk.yml\\n+++ b/.github/workflows/mindsdb_python_sdk.yml\\n@@ -1,7 +1,6 @@\\n-name: MindsDB Native workflow\\n+name: PR workflow\\n \\n on:\\n-  push:\\n   pull_request:\\n     branches:\\n       - stable\\n@@ -43,6 +42,8 @@ jobs:\\n     needs: test\\n     if: github.ref != 'refs/heads/stable'\\n     runs-on: ubuntu-latest\\n+    permissions:\\n+      pull-requests: write\\n     steps:\\n       - uses: actions/checkout@v3\\n       - name: Set up Python 3.8\\n@@ -65,25 +66,3 @@ jobs:\\n         with:\\n           pytest-coverage-path: ./pytest-coverage.txt\\n           junitxml-path: ./pytest.xml\\n-\\n-  deploy:\\n-    runs-on: ubuntu-latest\\n-    needs: test\\n-    if: github.ref == 'refs/heads/stable'\\n-    steps:\\n-    - uses: actions/checkout@v2\\n-    - name: Set up Python\\n-      uses: actions/setup-python@v2\\n-      with:\\n-        python-version: '3.7'\\n-    - name: Install dependencies\\n-      run: |\\n-        python -m pip install --upgrade pip==20.2.4\\n-        pip install setuptools wheel twine\\n-    - name: Build and publish\\n-      env:\\n-        TWINE_USERNAME:  __token__\\n-        TWINE_PASSWORD: ${{ secrets.PYPI_PASSWORD }}\\n-      run: |\\n-        python setup.py sdist\\n-        twine upload dist/*\\n\",\"diff --git a/.github/workflows/release.yml b/.github/workflows/release.yml\\nnew file mode 100644\\nindex 0000000..e3c8481\\n--- /dev/null\\n+++ b/.github/workflows/release.yml\\n@@ -0,0 +1,61 @@\\n+name: Release\\n+\\n+on:\\n+  push:\\n+    branches:\\n+      - stable\\n+\\n+jobs:\\n+  test:\\n+    runs-on: ${{ matrix.os }}\\n+    strategy:\\n+      matrix:\\n+        os: [ubuntu-latest]\\n+        python-version: [3.7,3.8,3.9]\\n+    steps:\\n+    - uses: actions/checkout@v2\\n+    - name: Set up Python ${{ matrix.python-version }}\\n+      uses: actions/setup-python@v2\\n+      with:\\n+        python-version: ${{ matrix.python-version }}\\n+    - name: Install dependencies\\n+      run: |\\n+        python -m pip install --upgrade pip==22.0.4\\n+        pip install -r requirements.txt\\n+        pip install --no-cache-dir .\\n+    - name: Run tests\\n+      run: |\\n+        if [ \\\"$RUNNER_OS\\\" == \\\"Linux\\\" ]; then\\n+        \\n+          env PYTHONPATH=./ pytest tests/\\n+\\n+        fi\\n+      shell: bash\\n+      env:\\n+        CHECK_FOR_UPDATES: False\\n+        DATABASE_CREDENTIALS_STRINGIFIED_JSON: ${{ secrets.DATABASE_CREDENTIALS }}\\n+        CLOUD_TEST_EMAIL: ${{ secrets.CLOUD_TEST_EMAIL }}\\n+        CLOUD_TEST_PASSWORD: ${{ secrets.CLOUD_TEST_PASSWORD }}\\n+\\n+\\n+  deploy:\\n+    runs-on: ubuntu-latest\\n+    needs: test\\n+    if: github.ref == 'refs/heads/stable'\\n+    steps:\\n+    - uses: actions/checkout@v2\\n+    - name: Set up Python\\n+      uses: actions/setup-python@v2\\n+      with:\\n+        python-version: '3.7'\\n+    - name: Install dependencies\\n+      run: |\\n+        python -m pip install --upgrade pip==20.2.4\\n+        pip install setuptools wheel twine\\n+    - name: Build and publish\\n+      env:\\n+        TWINE_USERNAME:  __token__\\n+        TWINE_PASSWORD: ${{ secrets.PYPI_PASSWORD }}\\n+      run: |\\n+        python setup.py sdist\\n+        twine upload dist/*\\n\",\"diff --git a/tests/test_sdk.py b/tests/test_sdk.py\\nindex f1013f1..702242b 100644\\n--- a/tests/test_sdk.py\\n+++ b/tests/test_sdk.py\\n@@ -126,16 +126,16 @@ class BaseFlow:\\n             f'Finetune {model.project.name}.{model_name} FROM d1 (select a from t1)'\\n         )\\n \\n-        model.retrain(query, options={ 'x': 2 })\\n+        model.retrain(query, options={'x': 2})\\n         check_sql_call(\\n             mock_post,\\n             f'RETRAIN {model.project.name}.{model_name} FROM {query.database} ({query.sql})  USING x=2'\\n         )\\n \\n-        model.retrain('select a from t1', database='d1')\\n+        model.retrain('select a from t1', database='d1', engine='openai')\\n         check_sql_call(\\n             mock_post,\\n-            f'RETRAIN {model.project.name}.{model_name} FROM d1 (select a from t1)'\\n+            f'RETRAIN {model.project.name}.{model_name} FROM d1 (select a from t1) USING engine=\\\\'openai\\\\''\\n         )\\n \\n         # describe\\n@@ -178,17 +178,29 @@ class BaseFlow:\\n \\n class Test(BaseFlow):\\n \\n+    @patch('requests.Session.get')\\n     @patch('requests.Session.put')\\n     @patch('requests.Session.post')\\n-    def test_flow(self, mock_post, mock_put):\\n+    def test_flow(self, mock_post, mock_put, mock_get):\\n+\\n+        # check local\\n+        server = mindsdb_sdk.connect()\\n+        str(server)\\n+\\n+        assert server.api.url == 'http://127.0.0.1:47334'\\n \\n+        # check cloud login\\n         server = mindsdb_sdk.connect(login='a@b.com')\\n \\n-        # check login\\n         call_args = mock_post.call_args\\n         assert call_args[0][0] == 'https://cloud.mindsdb.com/cloud/login'\\n         assert call_args[1]['json']['email'] == 'a@b.com'\\n \\n+        # server status\\n+        server.status()\\n+        call_args = mock_get.call_args\\n+        assert call_args[0][0] == 'https://cloud.mindsdb.com/api/status'\\n+\\n         # --------- databases -------------\\n         response_mock(mock_post, pd.DataFrame([{'NAME': 'db1'}]))\\n \\n@@ -197,6 +209,7 @@ class Test(BaseFlow):\\n         check_sql_call(mock_post, \\\"select NAME from information_schema.databases where TYPE='data'\\\")\\n \\n         database = databases[0]\\n+        str(database)\\n         assert database.name == 'db1'\\n         self.check_database(database)\\n \\n@@ -364,6 +377,7 @@ class Test(BaseFlow):\\n             f'CREATE PREDICTOR m2 FROM example_db (select * from t1) PREDICT price ORDER BY date GROUP BY a, b WINDOW 10 HORIZON 2 USING module=\\\"LightGBM\\\", `engine`=\\\"lightwood\\\"'\\n         )\\n         assert model.name == 'm2'\\n+        model.wait_complete()\\n         self.check_model(model, database)\\n \\n         # create, using deferred query.\\n@@ -373,6 +387,7 @@ class Test(BaseFlow):\\n             predict='price',\\n             query=query,\\n         )\\n+        str(query)\\n \\n         check_sql_call(\\n             mock_post,\\n@@ -599,6 +614,7 @@ class TestSimplify(BaseFlow):\\n         self.check_project(project, database)\\n \\n         project = con.projects.create('proj1')\\n+        str(project)\\n         check_sql_call(\\n             mock_post, 'CREATE DATABASE proj1 WITH ENGINE = \\\"mindsdb\\\", PARAMETERS = {}')\\n         self.check_project(project, database)\\n@@ -670,9 +686,9 @@ class TestSimplify(BaseFlow):\\n         con.ml_engines.create(\\n             'openai1',\\n             openai_handler,\\n-            connection_data={'api_key': '111'}\\n+            connection_data={'api_key': 'sk-11'}\\n         )\\n-        check_sql_call(mock_post, 'CREATE ML_ENGINE openai1 FROM openai USING api_key = \\\"111\\\"')\\n+        check_sql_call(mock_post, 'CREATE ML_ENGINE openai1 FROM openai USING api_key = \\\\'sk-11\\\\'')\\n \\n         con.ml_engines.create(\\n             'openai1',\\n@@ -684,6 +700,27 @@ class TestSimplify(BaseFlow):\\n         con.ml_engines.drop('openai1')\\n         check_sql_call(mock_post, 'DROP ML_ENGINE openai1')\\n \\n+        # byom\\n+        model = '''\\n+import pandas as pd\\n+\\n+class CustomPredictor():\\n+\\n+    def train(self, df, target_col, args=None):\\n+        \\n+        self.target_col=target_col \\n+        \\n+     def predict(self, df):\\n+        return pd.Dataframe([{'predict': self.target_col}])\\n+'''\\n+        requirements = '''pandas'''\\n+\\n+        con.ml_engines.create_byom('b1', model, requirements)\\n+        call_args = mock_put.call_args\\n+        assert call_args[0][0] == 'https://cloud.mindsdb.com/api/handlers/byom/b1'\\n+        assert call_args[1]['files']['code'] == model\\n+        assert call_args[1]['files']['modules'] == requirements\\n+\\n     def check_project(self, project, database):\\n         self.check_project_views( project, database)\\n \\n@@ -755,6 +792,7 @@ class TestSimplify(BaseFlow):\\n \\n         models = project.models.list()\\n         model = models[0]  # Model object\\n+        str(model)\\n \\n         assert model.name == 'm1'\\n         assert model.get_status() == 'complete'\\n@@ -784,7 +822,7 @@ class TestSimplify(BaseFlow):\\n                 'window': 10,\\n                 'horizon': 2\\n             },\\n-            module = 'LightGBM',  # has to be in options\\n+            module='LightGBM',  # has to be in options\\n         )\\n         check_sql_call(\\n             mock_post,\\n@@ -904,6 +942,11 @@ class TestSimplify(BaseFlow):\\n         table2 = database.tables.create('t2', query)\\n         check_sql_call(mock_post, f'create table {database.name}.t2 (select * from tbl1)')\\n \\n+        # create with replace\\n+        database.tables.create('t2', query, replace=True)\\n+        check_sql_call(mock_post, f'create or replace table {database.name}.t2 (select * from tbl1)')\\n+\\n+\\n         assert table2.name == 't2'\\n         self.check_table(table2)\\n \\n@@ -962,7 +1005,9 @@ class TestSimplify(BaseFlow):\\n         assert job.name == 'job1'\\n         assert job.query_str == 'select 1'\\n \\n+        dir(project.jobs)\\n         job = project.jobs.job1\\n+        str(job)\\n         assert job.name == 'job1'\\n         assert job.query_str == 'select 1'\\n \\n@@ -972,6 +1017,13 @@ class TestSimplify(BaseFlow):\\n             f\\\"select * from jobs where name = 'job1'\\\"\\n         )\\n \\n+        job.get_history()\\n+\\n+        check_sql_call(\\n+            mock_post,\\n+            f\\\"select * from jobs_history where name = 'job1'\\\"\\n+        )\\n+\\n         project.jobs.create(\\n             name='job2',\\n             query_str='retrain m1',\\n@@ -986,6 +1038,17 @@ class TestSimplify(BaseFlow):\\n             call_stack_num=-2\\n         )\\n \\n+        project.jobs.create(\\n+            name='job2',\\n+            query_str='retrain m1'\\n+        )\\n+\\n+        check_sql_call(\\n+            mock_post,\\n+            f\\\"CREATE JOB job2 (retrain m1)\\\",\\n+            call_stack_num=-2\\n+        )\\n+\\n         project.jobs.drop('job2')\\n \\n         check_sql_call(\"]", "hints_text": ""}
