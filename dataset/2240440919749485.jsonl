{"instance_id": "2240440919749485", "repo": "awslabs/seed-farmer", "base_commit": "7340ed63c25b76e1b9bf305b6ecc960df1893a90", "problem_statement": "[FEATURE] Support for custom Path for IAM role and custom Path for IAM Policy:\\n**Is your feature request related to a problem? Please describe.**\\r\\nI am working with an Enterprise customer on ML use cases and exploring the way to orchestrate deploy using [seed-farmer](https://github.com/awslabs/seed-farmer) mlops-sagemaker module and [aws-codeseeder](https://github.com/awslabs/aws-codeseeder). As a security best practice, specifying custom paths for IAM roles and policies during creation is essential. This approach, widely adopted by enterprise customers, enhances security and access control. Providing features to customize IAM role paths and policy paths is highly valuable for aligning with these best practices.\\r\\n\\r\\n\\r\\n**Describe the solution you'd like**\\r\\nI am looking for input parameters for IAM role custom path along with IAM  policy custom path when using [seed-farmer](https://github.com/awslabs/seed-farmer) or any better solution which allow passing these input parameters so they can be used while IAM role and policy are created as part of aws-codeseeder.\\r\\n\\r\\n**Describe alternatives you've considered**\\r\\nI have manually upcating the files and running seedfarmer bootstrap and deploy command\\r\\n\\r\\nUpdate below files before seedfarmer bootstrap \\r\\n\\r\\n- In seedfarmer library, update [toolchain_role.template](https://github.com/awslabs/seed-farmer/blob/main/seedfarmer/resources/toolchain_role.template) and [deployment_role.template ](https://github.com/awslabs/seed-farmer/blob/main/seedfarmer/resources/deployment_role.template) \\r\\n      -> add `Path: /project/service-role/ `for role creation for ToolchainRole and DeploymentRole\\r\\n\\r\\n- In seedfarmer library, update [utils.py](https://github.com/awslabs/seed-farmer/blob/main/seedfarmer/utils.py) update get_deployment_role_arn and get_toolchain_role_arn in role arns \\r\\n     -> add `/project/service-role/ `as path\\r\\n\\r\\nthen run below command \\r\\n```\\r\\nseedfarmer bootstrap toolchain --project aiops --trusted-principal ${ADMIN_ROLE_ARN} \\r\\n--permissions-boundary permissions-boundary_arn --as-target \\r\\n```\\r\\n\\r\\n\\r\\nUpdate below files before seedfarmer apply \\r\\n\\r\\n- In seedfarmer library, update [projectpolicy](https://github.com/awslabs/seed-farmer/blob/main/seedfarmer/resources/projectpolicy.yaml)\\r\\n    -> update ProjectPolicy and add `Path: /project/ `\\r\\n    -> update policydocument for resouce as role/* from role/cdk* and role/${ProjectName}*\"\\r\\n\\r\\n- In seedfarmer library, update [_iam.py ](https://github.com/awslabs/seed-farmer/blob/main/seedfarmer/services/_iam.py)\\r\\n    -> add new args as `path: '/project/service-role/' `  \\r\\n\\r\\n- In seedfarmer library, update [_module_commands.py](https://github.com/awslabs/seed-farmer/blob/main/seedfarmer/commands/_module_commands.py)\\r\\n    ->update codebuild_role_name to `codebuild_role_name=\"arn:aws:iam::<AWS_ACCOUNT>:role/project/service-role/\"+mdo.module_role_name`\\r\\n\\r\\nthen run below command \\r\\n`seedfarmer apply manifests/mlops-sagemaker/deployment.yaml --env-file .env --debug`\\r\\n\\r\\n\\r\\n**Additional context**\\r\\nThis IAM Role and Policy path are used in most of the scenario where security best practice are followed. So this will be very good addition for user of seedfarmer library\\r\\n", "FAIL_TO_PASS": ["test/unit-test/test_commands_deployment.py::test_execute_deploy_with_prefix", "test/unit-test/test_cli_arg.py::test_get_projectpolicy_prefix", "test/unit-test/test_commands_deployment.py::test_execute_destroy", "test/unit-test/test_commands_deployment.py::test_apply_with_prefix", "test/unit-test/test_commands_stack.py::test_create_module_deployment_role[/test/]", "test/unit-test/test_commands_stack.py::test_create_module_deployment_role[None]", "test/unit-test/test_commands_deployment.py::test_create_module_deployment_role[mock_data.mock_deployment_manifest_with_prefix-/test1/]", "test/unit-test/test_commands_deployment.py::test_create_module_deployment_role[mock_data.mock_deployment_manifest_huge-/]", "test/unit-test/test_commands_deployment.py::test_execute_deploy_invalid_spec", "test/unit-test/test_commands_deployment.py::test_execute_deploy", "test/unit-test/test_commands_stack.py::test_create_module_deployment_role[/]", "test/unit-test/test_commands_deployment.py::test_destroy_with_prefix"], "PASS_TO_PASS": ["test/unit-test/test_models.py::test_module_manifest_with_unknown_value_config_no_fail", "test/unit-test/test_models.py::test_module_manifest_with_env_var_resolution_in_path_error", "test/unit-test/test_cli_arg.py::test_store_md5_missing_module_option", "test/unit-test/test_cli_arg.py::test_bootstrap_toolchain_only", "test/unit-test/test_cli_arg.py::test_apply_deployment_dry_run", "test/unit-test/test_models.py::test_module_manifest_with_env_var_resolution_in_script_error", "test/unit-test/test_cli_arg.py::test_store_md5_missing_module_arg", "test/unit-test/test_mgmt_module_info.py::test_does_module_exist", "test/unit-test/test_commands_bootstrap.py::test_bootstrap_target_account_with_qualifier_fail[session0]", "test/unit-test/test_cli_arg.py::test_destroy__deployment_env_variables_no_env_file", "test/unit-test/test_cli_arg.py::test_store_deployspec_missing_module_option", "test/unit-test/test_cli_arg.py::test_store_moduledata_missing_group_option", "test/unit-test/test_commands_network_parameters.py::test_all_from_env", "test/unit-test/test_services.py::test_utils_boto3_client[session1]", "test/unit-test/test_cli_arg.py::test_list_deployments_extra_args", "test/unit-test/test_cli_arg.py::test_store_moduledata_missing_deployment_option", "test/unit-test/test_cli_arg.py::test_destroy_deployment", "test/unit-test/test_mgmt_deploy_utils.py::test_get_deployed_group_ordering_deployed", "test/unit-test/test_cli_arg.py::test_apply_deployment", "test/unit-test/test_mgmt_module_info.py::test_get_deployspec", "test/unit-test/test_utils.py::test_utils", "test/unit-test/test_mgmt_deploy_utils.py::test_filter_destroy_deploy_with_destroy", "test/unit-test/test_models.py::test_module_manifest_with_unknown_value", "test/unit-test/test_cli_arg.py::test_store_md5_missing_group_arg", "test/unit-test/test_mgmt_deploy_utils.py::test_need_to_build_without_force_deploy_yes", "test/unit-test/test_mgmt_module_info.py::test_get_all_deployments_with_manifest", "test/unit-test/test_mgmt_metadata_support.py::test_module_parameter_project", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_dns_path_missing_https", "test/unit-test/test_cli_arg.py::test_remove_missing_module_arg", "test/unit-test/test_mgmt_module_info.py::test_get_all_deployments", "test/unit-test/test_cli_arg.py::test_store_md5_missing_deployment_arg", "test/unit-test/test_session_manager.py::test_singleton", "test/unit-test/test_mgmt_deploy_utils.py::test_generate_deployed_manifest_already_deployed", "test/unit-test/test_mgmt_module_info.py::test_get_deployment_manifest", "test/unit-test/test_services.py::test_codebuild", "test/unit-test/test_cli_arg.py::test_store_deployspec_missing_group_option", "test/unit-test/test_cli_arg.py::test_version", "test/unit-test/test_cli_arg.py::test_store_deployspec_missing_acct", "test/unit-test/test_mgmt_module_info.py::test_get_modulestack_path", "test/unit-test/test_cli_arg.py::test_metadata_add_all_params", "test/unit-test/test_commands_stack.py::test_destroy_seedkit", "test/unit-test/test_commands_stack.py::test_get_module_stack_info", "test/unit-test/test_checksum.py::test_checksum", "test/unit-test/test_mgmt_build_info.py::test_get_build_params", "test/unit-test/test_cli_arg.py::test_apply_missing_deployment_name", "test/unit-test/test_cli_arg.py::test_list_build_env_params_no_dep_manifest", "test/unit-test/test_models.py::test_get_region_mirror_secret", "test/unit-test/test_mgmt.py::test_project_init", "test/unit-test/test_cli_arg.py::test_bootstrap_target_account_with_qualifier", "test/unit-test/test_cli_arg.py::test_metadata_add_kv_missing_value", "test/unit-test/test_cli_arg.py::test_list_deployspec", "test/unit-test/test_mgmt_metadata_support.py::test_module_add_kv_generic", "test/unit-test/test_cli_arg.py::test_apply_deployment__env_variables_single_env_file", "test/unit-test/test_cli_arg.py::test_list_moduledata_no_dep_manifest", "test/unit-test/test_models.py::test_module_manifest_with_value_from_parameters", "test/unit-test/test_commands_module.py::test_generate_export_raw_env_params", "test/unit-test/test_mgmt_metadata_support.py::test_module_add_json_project", "test/unit-test/test_mgmt_metadata_support.py::test_module_depmod_generic", "test/unit-test/test_cli_arg.py::test_store_md5_missing_group_option", "test/unit-test/test_mgmt_module_info.py::test_write_deployed_deployment_manifest", "test/unit-test/test_session_manager.py::test_deployment_session", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_from_https_with_secret[zip_file_data]", "test/unit-test/test_mgmt_metadata_support.py::test_module_init", "test/unit-test/test_commands_bootstrap.py::test_deploy_template", "test/unit-test/test_commands_bootstrap.py::test_apply_deploy_logic", "test/unit-test/test_cli_arg.py::test_list_modules_non_existent_module", "test/unit-test/test_commands_module.py::test_generate_export_env_params", "test/unit-test/test_mgmt.py::test_module_init", "test/unit-test/test_cli_arg.py::test_list_deployspec_missing_session", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_from_s3_non_nested[zip_file_data_not_nested-testing-bucket.s3.amazonaws.com]", "test/unit-test/test_commands_deployment.py::test_destroy_not_found", "test/unit-test/test_models.py::test_deployresponses", "test/unit-test/test_cli_arg.py::test_list_deployspec_deployed_error[None]", "test/unit-test/test_cli_arg.py::test_metadata_param_value_missing", "test/unit-test/test_cli_arg.py::test_list_moduledata_missing_module_arg", "test/unit-test/test_commands_bootstrap.py::test_bootstrap_toolchain_account_with_policies[session0]", "test/unit-test/test_services.py::test_utils_get_account_id", "test/unit-test/test_commands_bootstrap.py::test_bootstrap_toolchain_account_synth_with_invalid_principal[session0]", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_from_s3[zip_file_data-testing-bucket.s3.amazonaws.com]", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_bad_archive_structure[zip_file_data_bad_structure-testing-bucket.s3.us-west-2.amazonaws.com]", "test/unit-test/test_cli_arg.py::test_list_moduledata_mod_not_found", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_from_s3_single_module[zip_file_data_single_module-testing-bucket.s3.us-west-2.amazonaws.com]", "test/unit-test/test_services.py::test_utils_get_region[session1]", "test/unit-test/test_utils.py::test_validate_module_dependencies", "test/unit-test/test_commands_deployment.py::test_apply_violations", "test/unit-test/test_mgmt_deploy_utils.py::test_validate_group_parameters", "test/unit-test/test_mgmt_deploy_utils.py::test_filter_destroy_deploy", "test/unit-test/test_models.py::test_module_manifest_with_env_var_resolution_in_script", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_from_s3_with_error[tar_file_data-testing-bucket.s3.us-west-2.amazonaws.com]", "test/unit-test/test_cli_arg.py::test_list_moduledata_export_envs", "test/unit-test/test_cli_arg.py::test_list_deployments", "test/unit-test/test_mgmt_metadata_support.py::test_module_parameter_generic", "test/unit-test/test_commands_deployment.py::test_process_data_files_error", "test/unit-test/test_cli_arg.py::test_list_help", "test/unit-test/test_mgmt_deploy_utils.py::test_need_to_build_with_force_deploy_yes", "test/unit-test/test_mgmt_module_info.py::test_get_ssm_parameter_version_failure", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_from_s3_single_module[tar_file_data_single_module-testing-bucket.s3.amazonaws.com]", "test/unit-test/test_cli_arg.py::test_init_create_group_module", "test/unit-test/test_commands_deployment.py::test_destroy_clean", "test/unit-test/test_mgmt_metadata_support.py::test_module_parameter_project_error", "test/unit-test/test_commands_bootstrap.py::test_bootstrap_toolchain_account_synth_with_qualifier[session0]", "test/unit-test/test_cli_arg.py::test_metadata_add_kv", "test/unit-test/test_commands_bootstrap.py::test_bootstrap_target_account[session0]", "test/unit-test/test_cli_arg.py::test_remove_missing_group_arg", "test/unit-test/test_commands_module.py::test_deploy_modules_error_deployspec", "test/unit-test/test_mgmt_module_info.py::test_write_deployspec", "test/unit-test/test_cli_arg.py::test_list_build_env_params_no_export_param", "test/unit-test/test_cli_arg.py::test_metadata_convert_file", "test/unit-test/test_commands_stack.py::test_destroy_managed_policy_stack", "test/unit-test/test_cli_arg.py::test_remove_moduledata_bad_account_params", "test/unit-test/test_commands_network_parameters.py::test_vpc_from_regional_parameter", "test/unit-test/test_services.py::test_get_ssm_params", "test/unit-test/test_commands_parameters.py::test_load_parameter_values_missing_metadata", "test/unit-test/test_mgmt_module_info.py::test_write_module_md5", "test/unit-test/test_commands_network_parameters.py::test_too_many_subgroups", "test/unit-test/test_services.py::test_utils_boto3_resource[session1]", "test/unit-test/test_mgmt_metadata_support.py::test_module_convert_cdkexports_generic_jq", "test/unit-test/test_commands_network_parameters.py::test_no_values", "test/unit-test/test_services.py::test_get_ssm_metadata", "test/unit-test/test_mgmt_module_info.py::test_get_deployed_deployment_manifest", "test/unit-test/test_cli_arg.py::test_store_moduledata_missing_module_option", "test/unit-test/test_commands_bootstrap.py::test_apply_deploy_logic_role_not_exists", "test/unit-test/test_commands_parameters.py::test_load_parameter_values", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_bad_archive_structure[tar_file_data_bad_structure-testing-bucket.s3.amazonaws.com]", "test/unit-test/test_cli_arg.py::test_store_moduledata_deployment_arg", "test/unit-test/test_models.py::test_module_manifest_with_both_value_and_value_from_error", "test/unit-test/test_models.py::test_module_manifest_with_defaults", "test/unit-test/test_cli_arg.py::test_store_md5_missing_type_arg", "test/unit-test/test_commands_module.py::test_deploy_modules", "test/unit-test/test_cli_arg.py::test_list_dependencies", "test/unit-test/test_mgmt_module_info.py::test_fetch_helper", "test/unit-test/test_cli_arg.py::test_list_moduledata_non_existent_module", "test/unit-test/test_cli_arg.py::test_store_deployspec_missing_path", "test/unit-test/test_mgmt_module_info.py::test_get_deployspec_path", "test/unit-test/test_mgmt_module_info.py::test_get_deployed_modules", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_from_s3_single_module[tar_file_data_single_module-testing-bucket.s3.us-west-2.amazonaws.com]", "test/unit-test/test_cli_arg.py::test_remove_help", "test/unit-test/test_mgmt_git_support.py::test_clone_module_repo_main", "test/unit-test/test_models.py::test_module_manifest_with_env_var_resolution_in_script_disabled", "test/unit-test/test_mgmt.py::test_module_init_branch", "test/unit-test/test_mgmt_deploy_utils.py::test_need_to_build_no", "test/unit-test/test_commands_network_parameters.py::test_sgs_subnets_from_regional_parameter", "test/unit-test/test_mgmt_deploy_utils.py::test_update_deployspec[session1]", "test/unit-test/test_cli_arg.py::test_store_md5_deployspec", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_from_s3_non_nested[tar_file_data_not_nested-testing-bucket.s3.amazonaws.com]", "test/unit-test/test_commands_network_parameters.py::test_sgs_subnets_from_ssm", "test/unit-test/test_cli_arg.py::test_remove_missing_deployment_argument", "test/unit-test/test_mgmt_module_info.py::test_does_md5_match", "test/unit-test/test_cli_arg.py::test_metadata_add_kv_missing_key", "test/unit-test/test_commands_stack.py::test_deploy_managed_policy_stack_exists", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_dns_path", "test/unit-test/test_cli_arg.py::test_bootstrap_target_account", "test/unit-test/test_mgmt_build_info.py::test_get_module_schema", "test/unit-test/test_cli_arg.py::test_list_moduledata_missing_deployment_arg", "test/unit-test/test_cli_arg.py::test_get_projectpolicy", "test/unit-test/test_mgmt_module_info.py::test_get_module_metadata", "test/unit-test/test_mgmt_module_info.py::test_get_module_stack_names", "test/unit-test/test_cli_arg.py::test_list_deployspec_deployed_error[boto3_client]", "test/unit-test/test_cli_arg.py::test_list_dependencies_no_deployed_manifest", "test/unit-test/test_commands_parameters.py::test_generate_export_raw_env_params", "test/unit-test/test_cli_arg.py::test_remove_missing_module_option", "test/unit-test/test_mgmt_build_info.py::test_get_module_schema_error", "test/unit-test/test_cli_arg.py::test_remove_moduledata", "test/unit-test/test_cli_arg.py::test_list_moduledata", "test/unit-test/test_cli_arg.py::test_destroy__deployment_env_variables_single_env_file", "test/unit-test/test_models.py::test_module_manifest_with_incorrect_value_error", "test/unit-test/test_commands_module.py::test_execute_module_commands", "test/unit-test/test_services.py::test_utils_boto3_client[None]", "test/unit-test/test_mgmt_metadata_support.py::test_module_add_kv_project", "test/unit-test/test_cli_arg.py::test_store_deployspec[None]", "test/unit-test/test_mgmt_deploy_utils.py::test_dependency_maps", "test/unit-test/test_commands_bootstrap.py::test_bootstrap_toolchain_account_synth[session0]", "test/unit-test/test_cli_arg.py::test_bootstrap_toolchain_only_with_qualifier", "test/unit-test/test_mgmt_module_info.py::test_does_md5_match_no", "test/unit-test/test_mgmt_deploy_utils.py::test_write_group_manifest", "test/unit-test/test_mgmt_deploy_utils.py::test_get_deployed_group_ordering_not_deployed", "test/unit-test/test_mgmt_metadata_support.py::test_module_parameter_generic_error", "test/unit-test/test_models.py::test_deployspec", "test/unit-test/test_mgmt_module_info.py::test_write_metadata", "test/unit-test/test_commands_deployment.py::test_deploy_deployment", "test/unit-test/test_commands_stack.py::test_destroy_module_deployment_role", "test/unit-test/test_mgmt_module_info.py::test_get_module_manifest", "test/unit-test/test_commands_module.py::test_destroy_modules", "test/unit-test/test_cli_arg.py::test_list_all_moduledata", "test/unit-test/test_commands_deployment.py::test_destroy_generic_module_deployment_role", "test/unit-test/test_cli_arg.py::test_apply_deployment__env_variables_no_env_file", "test/unit-test/test_mgmt.py::test_module_init_cdkv2", "test/unit-test/test_cli_arg.py::test_metadata_depmod", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_from_s3[tar_file_data-testing-bucket.s3.amazonaws.com]", "test/unit-test/test_session_manager.py::test_failed_creation", "test/unit-test/test_mgmt_deploy_utils.py::test_populate_groups_to_remove", "test/unit-test/test_cli_arg.py::test_apply_missing_deployment_group_name", "test/unit-test/test_mgmt_metadata_support.py::test_module_convert_cdkexports_generic", "test/unit-test/test_cli_arg.py::test_list_build_env_params_export_param", "test/unit-test/test_mgmt_module_info.py::test_get_all_groups", "test/unit-test/test_cli_arg.py::test_store_moduledata_missing_group_arg", "test/unit-test/test_cli_arg.py::test_apply_deployment__env_variables_multiple_env_files[False]", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_from_s3_non_nested[tar_file_data_not_nested-testing-bucket.s3.us-west-2.amazonaws.com]", "test/unit-test/test_mgmt_module_info.py::test_get_secrets_version_with_version_id", "test/unit-test/test_commands_deployment.py::test_process_data_files", "test/unit-test/test_cli_arg.py::test_bootstrap_toolchain_only_with_policies_fail", "test/unit-test/test_cli_arg.py::test_list_deployments_help", "test/unit-test/test_mgmt_metadata_support.py::test_module_convert_cdkexports_project_jq", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_from_s3_with_error[zip_file_data-testing-bucket.s3.amazonaws.com]", "test/unit-test/test_cli_arg.py::test_apply_help", "test/unit-test/test_commands_stack.py::test_destroy_managed_policy_stack_not_exists", "test/unit-test/test_commands_stack.py::test_deploy_module_stack", "test/unit-test/test_cli_arg.py::test_destroy_deployment_dry_run", "test/unit-test/test_commands_bootstrap.py::test_bootstrap_target_account_with_qualifier[session0]", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_dns_path_missing_module", "test/unit-test/test_mgmt_module_info.py::test_get_group_manifest", "test/unit-test/test_cli_arg.py::test_store_deployspec_missing_module_arg", "test/unit-test/test_commands_parameters.py::test_generate_export_env_params", "test/unit-test/test_cli_arg.py::test_store_moduledata", "test/unit-test/test_commands_deployment.py::test_execute_destroy_invalid_spec", "test/unit-test/test_mgmt_deploy_utils.py::test_validate_module_dependencies", "test/unit-test/test_cli_arg.py::test_list_moduledata_help", "test/unit-test/test_models.py::test_deserialize_deployment_manifest", "test/unit-test/test_cli_arg.py::test_get_projectpolicy_debug", "test/unit-test/test_cli_arg.py::test_list_modules_incomplete_subcommand", "test/unit-test/test_commands_module.py::test_destroy_modules_error_deployspec", "test/unit-test/test_cli_arg.py::test_init_create_project", "test/unit-test/test_services.py::test_delete_ssm_param", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_bad_archive_structure[zip_file_data_bad_structure-testing-bucket.s3.amazonaws.com]", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_from_s3_with_error[zip_file_data-testing-bucket.s3.us-west-2.amazonaws.com]", "test/unit-test/test_cli_arg.py::test_store_moduledata_missing_module_arg", "test/unit-test/test_cli_arg.py::test_store_deployspec_missing_group_arg", "test/unit-test/test_commands_stack.py::test_deploy_seedkit_exists", "test/unit-test/test_cli_arg.py::test_store_deployspec_missing_deployment_option", "test/unit-test/test_cli_arg.py::test_metadata_add_jsonstring", "test/unit-test/test_cli_arg.py::test_apply_debug", "test/unit-test/test_cli_arg.py::test_metadata_param_value", "test/unit-test/test_cli_arg.py::test_list_modules", "test/unit-test/test_mgmt_git_support.py::test_clone_module_repo_commit", "test/unit-test/test_cli_arg.py::test_list_build_env_params_no_with_params", "test/unit-test/test_commands_bootstrap.py::test_bootstrap_toolchain_account[session0]", "test/unit-test/test_commands_deployment.py::test_apply_clean", "test/unit-test/test_mgmt_metadata_support.py::test_module_deployspec_error", "test/unit-test/test_commands_stack.py::test_deploy_seedkit_no_exists", "test/unit-test/test_cli_arg.py::test_list_modules_missing_deployment_arg", "test/unit-test/test_cli_arg.py::test_apply_deployment__env_variables_multiple_env_files[True]", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_dns_path_zip", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_from_s3[tar_file_data-testing-bucket.s3.us-west-2.amazonaws.com]", "test/unit-test/test_mgmt_module_info.py::test_get_module_md5", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_from_s3_single_module[zip_file_data_single_module-testing-bucket.s3.amazonaws.com]", "test/unit-test/test_cli_arg.py::test_destroy__deployment_env_variables_multiple_env_files[True]", "test/unit-test/test_mgmt_module_info.py::test_write_module_manifest", "test/unit-test/test_mgmt_deploy_utils.py::test_validate_datafiles", "test/unit-test/test_cli_arg.py::test_list_build_env_params", "test/unit-test/test_cli_arg.py::test_remove_missing_deployment_option", "test/unit-test/test_services.py::test_utils_boto3_resource[None]", "test/unit-test/test_models.py::test_deployment_manifest_name_generator", "test/unit-test/test_mgmt_build_info.py::test_get_deployment_schema", "test/unit-test/test_mgmt_deploy_utils.py::test_prepare_ssm_for_deploy", "test/unit-test/test_services.py::test_list_ssm_param", "test/unit-test/test_commands_stack.py::test_destroy_module_stack", "test/unit-test/test_cli_arg.py::test_apply_missing_deployment", "test/unit-test/test_mgmt_module_info.py::test_write_group_manifest", "test/unit-test/test_cli_arg.py::test_remove_missing_group_option", "test/unit-test/test_mgmt_git_support.py::test_clone_module_repo_tag", "test/unit-test/test_cli_arg.py::test_store_deployspec_deployment_arg", "test/unit-test/test_mgmt_deploy_utils.py::test_validate_group_parameters_failure", "test/unit-test/test_mgmt_deploy_utils.py::test_write_deployed_deployment_manifest", "test/unit-test/test_cli_arg.py::test_list_moduledata_missing_deployment_option", "test/unit-test/test_commands_parameters.py::test_load_parameter_values_missing_param_value", "test/unit-test/test_cli_arg.py::test_store_md5_bundle", "test/unit-test/test_models.py::test_module_manifest_with_env_var_resolution_in_path", "test/unit-test/test_commands_network_parameters.py::test_all_hardcoded_values", "test/unit-test/test_mgmt_metadata_support.py::test_module_convert_cdkexports_project", "test/unit-test/test_cli_arg.py::test_store_moduledata_with_account", "test/unit-test/test_models.py::test_deployment_manifest_get_parameter_with_defaults", "test/unit-test/test_models.py::test_deployment_manifest_with_custom_mirrors", "test/unit-test/test_cli_arg.py::test_store_help", "test/unit-test/test_mgmt_deploy_utils.py::test_update_deployspec[None]", "test/unit-test/test_cli_arg.py::test_list_build_env_params_session_error", "test/unit-test/test_commands_bootstrap.py::test_apply_deploy_logic_stack_not_exists", "test/unit-test/test_cli_arg.py::test_taint", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_from_s3[zip_file_data-testing-bucket.s3.us-west-2.amazonaws.com]", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_dns_path_missing_archive", "test/unit-test/test_commands_bootstrap.py::test_bootstrap_target_account_with_policies[session0]", "test/unit-test/test_models.py::test_deployment_manifest_get_parameter_without_defaults", "test/unit-test/test_mgmt_metadata_support.py::test_module_depmod_project", "test/unit-test/test_mgmt_module_info.py::test_remove_all_info", "test/unit-test/test_cli_arg.py::test_metadata_convert", "test/unit-test/test_commands_stack.py::test_deploy_managed_policy_stack_not_exists", "test/unit-test/test_mgmt_deploy_utils.py::test_generate_deployed_manifest", "test/unit-test/test_models.py::test_module_manifest_with_parameters", "test/unit-test/test_models.py::test_module_manifest_without_defaults", "test/unit-test/test_mgmt_git_support.py::test_clone_module_repo_branch", "test/unit-test/test_cli_arg.py::test_list_modules_help", "test/unit-test/test_services.py::test_iam", "test/unit-test/test_cli_arg.py::test_destroy__deployment_env_variables_multiple_env_files[False]", "test/unit-test/test_commands_bootstrap.py::test_bootstrap_toolchain_account_synth_with_qualifier_fail[session0]", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_from_s3_non_nested[zip_file_data_not_nested-testing-bucket.s3.us-west-2.amazonaws.com]", "test/unit-test/test_cli_arg.py::test_error_messaging", "test/unit-test/test_cli_arg.py::test_metadata_convert_file_jq", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_bad_archive_structure[tar_file_data_bad_structure-testing-bucket.s3.us-west-2.amazonaws.com]", "test/unit-test/test_mgmt_module_info.py::test_get_secrets_version_with_no_ref", "test/unit-test/test_cli_arg.py::test_list_deployspec_deployed_none", "test/unit-test/test_mgmt_metadata_support.py::test_module_add_json_generic", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_from_https_with_secret[tar_file_data]", "test/unit-test/test_cli_arg.py::test_list_moduledata_missing_group_arg", "test/unit-test/test_services.py::test_put_ssm_param", "test/unit-test/test_checksum.py::test_private_methods_checksum", "test/unit-test/test_mgmt_deploy_utils.py::test_need_to_build_yes", "test/unit-test/test_cli_arg.py::test_store_md5_missing_deployment_option", "test/unit-test/test_mgmt_module_info.py::test_get_ssm_parameter_version", "test/unit-test/test_mgmt_module_info.py::test_write_deployment_manifest", "test/unit-test/test_cli_arg.py::test_taint_missing_param", "test/unit-test/test_mgmt_archive_support.py::test_fetch_module_repo_from_s3_with_error[tar_file_data-testing-bucket.s3.amazonaws.com]", "test/unit-test/test_services.py::test_utils_get_region[None]", "test/unit-test/test_mgmt_module_info.py::test_get_secrets_version_with_status", "test/unit-test/test_cli_arg.py::test_list_moduledata_missing_group_option", "test/unit-test/test_commands_network_parameters.py::test_vpc_from_ssm", "test/unit-test/test_mgmt_module_info.py::test_get_all_deployments_with_nothing", "test/unit-test/test_mgmt_deploy_utils.py::test_populate_module_info_index"], "language": "python", "test_command": "source /saved/ENV || source /saved/*/ENV && pytest --no-header -rA --tb=no -p no:cacheprovider --continue-on-collection-errors", "test_output_parser": "python/parse_log_pytest_v3", "image_storage_uri": "vmvm-registry.fbinfra.net/repomate_image_activ_pytest/awslabs_seed-farmer:7340ed63c25b76e1b9bf305b6ecc960df1893a90", "patch": "[\"diff --git a/CHANGELOG.md b/CHANGELOG.md\\nindex 249caa3..e9c0a9a 100644\\n--- a/CHANGELOG.md\\n+++ b/CHANGELOG.md\\n@@ -6,6 +6,8 @@ This project adheres to [Semantic Versioning](http://semver.org/) and [Keep a Ch\\n ## Unreleased\\n \\n ### New \\n+\\n+- adding support for IAM paths\\n - adding support to taint modules to force a redeploy\\n \\n ### Changes\\n\",\"diff --git a/seedfarmer/__main__.py b/seedfarmer/__main__.py\\nindex ec137ca..58f5126 100644\\n--- a/seedfarmer/__main__.py\\n+++ b/seedfarmer/__main__.py\\n@@ -65,6 +65,13 @@ def version() -> None:\\n     required=False,\\n )\\n @click.option(\\n+    \\\"--role-prefix\\\",\\n+    default=None,\\n+    help=\\\"\\\"\\\"An IAM path prefix to use with the seedfarmer roles.\\n+    Use only if bootstrapped with this path\\\"\\\"\\\",\\n+    required=False,\\n+)\\n+@click.option(\\n     \\\"--env-file\\\",\\n     \\\"env_files\\\",\\n     default=[\\\".env\\\"],\\n@@ -129,6 +136,7 @@ def apply(\\n     profile: Optional[str],\\n     region: Optional[str],\\n     qualifier: Optional[str],\\n+    role_prefix: Optional[str],\\n     env_files: List[str],\\n     debug: bool,\\n     dry_run: bool,\\n@@ -154,6 +162,7 @@ def apply(\\n         profile=profile,\\n         region_name=region,\\n         qualifier=qualifier,\\n+        role_prefix=role_prefix,\\n         dryrun=dry_run,\\n         show_manifest=show_manifest,\\n         enable_session_timeout=enable_session_timeout,\\n@@ -201,6 +210,13 @@ def apply(\\n     required=False,\\n )\\n @click.option(\\n+    \\\"--role-prefix\\\",\\n+    default=None,\\n+    help=\\\"\\\"\\\"An IAM path prefix to use with the seedfarmer roles.\\n+    Use only if bootstrapped with this path\\\"\\\"\\\",\\n+    required=False,\\n+)\\n+@click.option(\\n     \\\"--env-file\\\",\\n     \\\"env_files\\\",\\n     default=[\\\".env\\\"],\\n@@ -248,6 +264,7 @@ def destroy(\\n     profile: Optional[str],\\n     region: Optional[str],\\n     qualifier: Optional[str],\\n+    role_prefix: Optional[str],\\n     env_files: List[str],\\n     debug: bool,\\n     enable_session_timeout: bool,\\n@@ -274,6 +291,7 @@ def destroy(\\n         profile=profile,\\n         region_name=region,\\n         qualifier=qualifier,\\n+        role_prefix=role_prefix,\\n         dryrun=dry_run,\\n         show_manifest=show_manifest,\\n         enable_session_timeout=enable_session_timeout,\\n\",\"diff --git a/seedfarmer/cli_groups/_bootstrap_group.py b/seedfarmer/cli_groups/_bootstrap_group.py\\nindex ebeef8c..017b638 100644\\n--- a/seedfarmer/cli_groups/_bootstrap_group.py\\n+++ b/seedfarmer/cli_groups/_bootstrap_group.py\\n@@ -102,6 +102,18 @@ def bootstrap() -> None:\\n     required=False,\\n )\\n @click.option(\\n+    \\\"--role-prefix\\\",\\n+    default=None,\\n+    help=\\\"An IAM path prefix to use with the seedfarmer roles.\\\",\\n+    required=False,\\n+)\\n+@click.option(\\n+    \\\"--policy-prefix\\\",\\n+    default=None,\\n+    help=\\\"An IAM path prefix to use with the seedfarmer policies.\\\",\\n+    required=False,\\n+)\\n+@click.option(\\n     \\\"--policy-arn\\\",\\n     \\\"-pa\\\",\\n     help=\\\"\\\"\\\"ARN of existing Policy to attach to Target Role (Deploymenmt Role)\\n@@ -121,6 +133,8 @@ def bootstrap_toolchain(\\n     profile: Optional[str],\\n     region: Optional[str],\\n     qualifier: Optional[str],\\n+    role_prefix: Optional[str],\\n+    policy_prefix: Optional[str],\\n     as_target: bool,\\n     synth: bool,\\n     debug: bool,\\n@@ -140,6 +154,8 @@ def bootstrap_toolchain(\\n         policy_arns=policy_arn,\\n         profile=profile,\\n         qualifier=qualifier,\\n+        role_prefix=role_prefix,\\n+        policy_prefix=policy_prefix,\\n         region_name=region,\\n         synthesize=synth,\\n         as_target=as_target,\\n@@ -198,6 +214,12 @@ def bootstrap_toolchain(\\n     required=False,\\n )\\n @click.option(\\n+    \\\"--role-prefix\\\",\\n+    default=None,\\n+    help=\\\"An IAM path prefix to use with the seedfarmer roles.\\\",\\n+    required=False,\\n+)\\n+@click.option(\\n     \\\"--policy-arn\\\",\\n     \\\"-pa\\\",\\n     help=\\\"\\\"\\\"ARN of existing Policy to attach to Target Role (Deploymenmt Role)\\n@@ -215,6 +237,7 @@ def bootstrap_target(\\n     profile: Optional[str],\\n     region: Optional[str],\\n     qualifier: Optional[str],\\n+    role_prefix: Optional[str],\\n     synth: bool,\\n     debug: bool,\\n ) -> None:\\n@@ -229,6 +252,7 @@ def bootstrap_target(\\n         profile=profile,\\n         region_name=region,\\n         qualifier=qualifier,\\n+        role_prefix=role_prefix,\\n         permissions_boundary_arn=permissions_boundary,\\n         policy_arns=policy_arn,\\n         synthesize=synth,\\n\",\"diff --git a/seedfarmer/cli_groups/_project_group.py b/seedfarmer/cli_groups/_project_group.py\\nindex ddbe52e..be38d5e 100644\\n--- a/seedfarmer/cli_groups/_project_group.py\\n+++ b/seedfarmer/cli_groups/_project_group.py\\n@@ -37,11 +37,18 @@ def projectpolicy() -> None:\\n     name=\\\"synth\\\",\\n     help=\\\"Synth a Project Policy from seed-farmer.\\\",\\n )\\n+@click.option(\\n+    \\\"--policy-prefix\\\",\\n+    default=\\\"/\\\",\\n+    help=\\\"An IAM path prefix to use with the policy.\\\",\\n+    required=False,\\n+)\\n @click.option(\\\"--debug/--no-debug\\\", default=False, help=\\\"Enable detail logging\\\", show_default=True)\\n def policy_synth(\\n+    policy_prefix: str,\\n     debug: bool,\\n ) -> None:\\n     if debug:\\n         enable_debug(format=DEBUG_LOGGING_FORMAT)\\n \\n-    get_default_project_policy()\\n+    get_default_project_policy(policy_prefix=policy_prefix)\\n\",\"diff --git a/seedfarmer/commands/_bootstrap_commands.py b/seedfarmer/commands/_bootstrap_commands.py\\nindex 5b03ab5..511c5da 100644\\n--- a/seedfarmer/commands/_bootstrap_commands.py\\n+++ b/seedfarmer/commands/_bootstrap_commands.py\\n@@ -39,6 +39,7 @@ def get_toolchain_template(\\n     principal_arn: List[str],\\n     role_name: str,\\n     permissions_boundary_arn: Optional[str] = None,\\n+    role_prefix: Optional[str] = None,\\n ) -> Dict[Any, Any]:\\n     with open((os.path.join(CLI_ROOT, \\\"resources/toolchain_role.template\\\")), \\\"r\\\") as f:\\n         role = yaml.safe_load(f)\\n@@ -48,8 +49,16 @@ def get_toolchain_template(\\n         ] = principal_arn\\n     if permissions_boundary_arn:\\n         role[\\\"Resources\\\"][\\\"ToolchainRole\\\"][\\\"Properties\\\"][\\\"PermissionsBoundary\\\"] = permissions_boundary_arn\\n+    role_prefix = role_prefix if role_prefix else \\\"/\\\"\\n     template = Template(json.dumps(role))\\n-    t = template.render({\\\"project_name\\\": project_name, \\\"role_name\\\": role_name, \\\"seedfarmer_version\\\": __version__})\\n+    t = template.render(\\n+        {\\n+            \\\"project_name\\\": project_name,\\n+            \\\"role_name\\\": role_name,\\n+            \\\"role_prefix\\\": role_prefix,\\n+            \\\"seedfarmer_version\\\": __version__,\\n+        }\\n+    )\\n     return dict(json.loads(t))\\n \\n \\n@@ -59,6 +68,8 @@ def get_deployment_template(\\n     role_name: str,\\n     policy_arns: Optional[List[str]],\\n     permissions_boundary_arn: Optional[str] = None,\\n+    role_prefix: Optional[str] = None,\\n+    policy_prefix: Optional[str] = None,\\n ) -> Dict[Any, Any]:\\n     with open((os.path.join(CLI_ROOT, \\\"resources/deployment_role.template\\\")), \\\"r\\\") as f:\\n         role = yaml.safe_load(f)\\n@@ -66,12 +77,16 @@ def get_deployment_template(\\n         role[\\\"Resources\\\"][\\\"DeploymentRole\\\"][\\\"Properties\\\"][\\\"PermissionsBoundary\\\"] = permissions_boundary_arn\\n     if policy_arns:\\n         role[\\\"Resources\\\"][\\\"DeploymentRole\\\"][\\\"Properties\\\"][\\\"ManagedPolicyArns\\\"] = policy_arns\\n+    role_prefix = role_prefix if role_prefix else \\\"/\\\"\\n+    policy_prefix = policy_prefix if policy_prefix else \\\"/\\\"\\n     template = Template(json.dumps(role))\\n     t = template.render(\\n         {\\n             \\\"toolchain_role_arn\\\": toolchain_role_arn,\\n             \\\"project_name\\\": project_name,\\n             \\\"role_name\\\": role_name,\\n+            \\\"role_prefix\\\": role_prefix,\\n+            \\\"policy_prefix\\\": policy_prefix,\\n             \\\"seedfarmer_version\\\": __version__,\\n         }\\n     )\\n@@ -89,6 +104,8 @@ def bootstrap_toolchain_account(\\n     permissions_boundary_arn: Optional[str] = None,\\n     policy_arns: Optional[List[str]] = None,\\n     qualifier: Optional[str] = None,\\n+    role_prefix: Optional[str] = None,\\n+    policy_prefix: Optional[str] = None,\\n     profile: Optional[str] = None,\\n     region_name: Optional[str] = None,\\n     synthesize: bool = False,\\n@@ -107,11 +124,12 @@ def bootstrap_toolchain_account(\\n         role_name=role_stack_name,\\n         principal_arn=principal_arns,\\n         permissions_boundary_arn=permissions_boundary_arn,\\n+        role_prefix=role_prefix,\\n     )\\n     _logger.debug((json.dumps(template, indent=4)))\\n     if not synthesize:\\n         session = create_new_session(profile=profile, region_name=region_name)\\n-        session_account_id, session_role_arn, partition = get_sts_identity_info(session=session)\\n+        session_account_id, _, _ = get_sts_identity_info(session=session)\\n         apply_deploy_logic(\\n             template=template,\\n             role_name=role_stack_name,\\n@@ -124,6 +142,8 @@ def bootstrap_toolchain_account(\\n                 toolchain_account_id=session_account_id,\\n                 project_name=project_name,\\n                 qualifier=cast(str, qualifier),\\n+                role_prefix=role_prefix,\\n+                policy_prefix=policy_prefix,\\n                 permissions_boundary_arn=permissions_boundary_arn,\\n                 profile=profile,\\n                 region_name=region_name,\\n@@ -152,6 +172,8 @@ def bootstrap_target_account(\\n     project_name: str,\\n     permissions_boundary_arn: Optional[str] = None,\\n     qualifier: Optional[str] = None,\\n+    role_prefix: Optional[str] = None,\\n+    policy_prefix: Optional[str] = None,\\n     profile: Optional[str] = None,\\n     region_name: Optional[str] = None,\\n     session: Optional[Session] = None,\\n@@ -163,7 +185,7 @@ def bootstrap_target_account(\\n \\n     if not session:\\n         session = create_new_session(profile=profile, region_name=region_name)\\n-    session_account_id, session_role_arn, partition = get_sts_identity_info(session=session)\\n+    session_account_id, _, partition = get_sts_identity_info(session=session)\\n \\n     role_stack_name = get_deployment_role_name(project_name=project_name, qualifier=cast(str, qualifier))\\n     toolchain_role_arn = get_toolchain_role_arn(\\n@@ -171,6 +193,7 @@ def bootstrap_target_account(\\n         toolchain_account_id=toolchain_account_id,\\n         project_name=project_name,\\n         qualifier=cast(str, qualifier),\\n+        role_prefix=role_prefix,\\n     )\\n \\n     template = get_deployment_template(\\n@@ -179,6 +202,8 @@ def bootstrap_target_account(\\n         role_name=role_stack_name,\\n         policy_arns=policy_arns if policy_arns else None,\\n         permissions_boundary_arn=permissions_boundary_arn,\\n+        role_prefix=role_prefix,\\n+        policy_prefix=policy_prefix,\\n     )\\n     _logger.debug((json.dumps(template, indent=4)))\\n     if not synthesize:\\n\",\"diff --git a/seedfarmer/commands/_deployment_commands.py b/seedfarmer/commands/_deployment_commands.py\\nindex 74fabd6..09e0755 100644\\n--- a/seedfarmer/commands/_deployment_commands.py\\n+++ b/seedfarmer/commands/_deployment_commands.py\\n@@ -53,7 +53,7 @@ from seedfarmer.output_utils import (\\n     print_modules_build_info,\\n )\\n from seedfarmer.services import get_sts_identity_info\\n-from seedfarmer.services._iam import get_role\\n+from seedfarmer.services._iam import get_role, get_role_arn\\n from seedfarmer.services.session_manager import SessionManager\\n from seedfarmer.utils import get_generic_module_deployment_role_name\\n \\n@@ -132,6 +132,7 @@ def create_generic_module_deployment_role(\\n             region=region,\\n         ),\\n         session=session,\\n+        role_prefix=deployment_manifest.get_account_region_role_prefix(account_id=account_id, region=region),\\n     )\\n     return role_name\\n \\n@@ -187,6 +188,7 @@ def _execute_deploy(\\n         deployment_name=cast(str, mdo.deployment_manifest.name),\\n         region=region,\\n     )\\n+    role_prefix = mdo.deployment_manifest.get_account_region_role_prefix(account_id=account_id, region=region)\\n \\n     if module_stack_path:\\n         _, module_role_name = commands.deploy_module_stack(\\n@@ -199,12 +201,15 @@ def _execute_deploy(\\n             parameters=mdo.parameters,\\n             docker_credentials_secret=mdo.docker_credentials_secret,\\n             permissions_boundary_arn=mdo.permissions_boundary_arn,\\n+            role_prefix=role_prefix,\\n         )\\n \\n-    mdo.module_role_name = module_role_name\\n-\\n     # Get the current module's SSM if it was already loaded...\\n     session = SessionManager().get_or_create().get_deployment_session(account_id=account_id, region_name=region)\\n+\\n+    mdo.module_role_name = module_role_name\\n+    mdo.module_role_arn = get_role_arn(role_name=module_role_name, session=session)\\n+\\n     mdo.module_metadata = json.dumps(\\n         get_module_metadata(cast(str, mdo.deployment_manifest.name), mdo.group_name, mdo.module_name, session=session)\\n     )\\n@@ -239,8 +244,13 @@ def _execute_destroy(mdo: ModuleDeployObject) -> Optional[ModuleDeploymentRespon\\n \\n     target_account_id = cast(str, module_manifest.get_target_account_id())\\n     target_region = cast(str, module_manifest.target_region)\\n+    role_prefix = mdo.deployment_manifest.get_account_region_role_prefix(\\n+        account_id=target_account_id, region=target_region\\n+    )\\n     session = (\\n-        SessionManager().get_or_create().get_deployment_session(account_id=target_account_id, region_name=target_region)\\n+        SessionManager()\\n+        .get_or_create(role_prefix=role_prefix)\\n+        .get_deployment_session(account_id=target_account_id, region_name=target_region)\\n     )\\n     module_metadata = get_module_metadata(\\n         cast(str, mdo.deployment_manifest.name), mdo.group_name, mdo.module_name, session=session\\n@@ -288,6 +298,9 @@ def _execute_destroy(mdo: ModuleDeployObject) -> Optional[ModuleDeploymentRespon\\n             module_role_name=mdo.module_role_name,\\n         )\\n \\n+    mdo.module_role_name = module_role_name\\n+    mdo.module_role_arn = get_role_arn(role_name=module_role_name, session=session)\\n+\\n     resp = commands.destroy_module(mdo)\\n \\n     if resp.status == StatusType.SUCCESS.value and module_stack_exists:\\n@@ -410,12 +423,25 @@ def prime_target_accounts(\\n \\n         params = []\\n         for target_account_region in deployment_manifest.target_accounts_regions:\\n+            account_id = target_account_region[\\\"account_id\\\"]\\n+            region = target_account_region[\\\"region\\\"]\\n+            role_prefix = target_account_region[\\\"role_prefix\\\"]\\n+            policy_prefix = target_account_region[\\\"policy_prefix\\\"]\\n+            permissions_boundary_arn = deployment_manifest.get_permission_boundary_arn(\\n+                target_account=account_id,\\n+                target_region=region,\\n+            )\\n             param_d = {\\n-                \\\"account_id\\\": target_account_region[\\\"account_id\\\"],\\n-                \\\"region\\\": target_account_region[\\\"region\\\"],\\n+                \\\"account_id\\\": account_id,\\n+                \\\"region\\\": region,\\n                 \\\"update_seedkit\\\": update_seedkit,\\n                 \\\"update_project_policy\\\": update_project_policy,\\n+                \\\"permissions_boundary_arn\\\": permissions_boundary_arn,\\n             }\\n+            if role_prefix:\\n+                param_d[\\\"role_prefix\\\"] = role_prefix\\n+            if policy_prefix:\\n+                param_d[\\\"policy_prefix\\\"] = policy_prefix\\n             if target_account_region[\\\"network\\\"] is not None:\\n                 network = commands.load_network_values(\\n                     cast(NetworkMapping, target_account_region[\\\"network\\\"]),\\n@@ -469,7 +495,12 @@ def tear_down_target_accounts(deployment_manifest: DeploymentManifest, remove_se\\n                 commands.destroy_seedkit(**args)\\n \\n         params = [\\n-            {\\\"account_id\\\": target_account_region[\\\"account_id\\\"], \\\"region\\\": target_account_region[\\\"region\\\"]}\\n+            {\\n+                \\\"account_id\\\": target_account_region[\\\"account_id\\\"],\\n+                \\\"region\\\": target_account_region[\\\"region\\\"],\\n+                \\\"role_prefix\\\": target_account_region[\\\"role_prefix\\\"],\\n+                \\\"policy_prefix\\\": target_account_region[\\\"policy_prefix\\\"],\\n+            }\\n             for target_account_region in deployment_manifest.target_accounts_regions\\n         ]\\n         _ = list(workers.map(_teardown_accounts, params))\\n@@ -735,6 +766,7 @@ def apply(\\n     profile: Optional[str] = None,\\n     region_name: Optional[str] = None,\\n     qualifier: Optional[str] = None,\\n+    role_prefix: Optional[str] = None,\\n     dryrun: bool = False,\\n     show_manifest: bool = False,\\n     enable_session_timeout: bool = False,\\n@@ -760,6 +792,9 @@ def apply(\\n     qualifier : str, optional\\n         Any qualifier on the name of toolchain role\\n         Defaults to None\\n+    role_prefix : str, optional\\n+        IAM path prefix on the ARN of the toolchain and deployment roles\\n+        Defaults to '/'\\n     dryrun : bool, optional\\n         This flag indicates that the deployment manifest should be consumed and a\\n         DeploymentManifest object be created (for both apply and destroy) but DOES NOT\\n@@ -799,6 +834,7 @@ def apply(\\n         project_name=config.PROJECT,\\n         profile=profile,\\n         qualifier=qualifier,\\n+        role_prefix=role_prefix,\\n         toolchain_region=deployment_manifest.toolchain_region,\\n         region_name=region_name,\\n         enable_reaper=enable_session_timeout,\\n@@ -879,6 +915,7 @@ def destroy(\\n     profile: Optional[str] = None,\\n     region_name: Optional[str] = None,\\n     qualifier: Optional[str] = None,\\n+    role_prefix: Optional[str] = None,\\n     dryrun: bool = False,\\n     show_manifest: bool = False,\\n     remove_seedkit: bool = False,\\n@@ -900,6 +937,9 @@ def destroy(\\n     qualifier : str, optional\\n         Any qualifier on the name of toolchain role\\n         Defaults to None\\n+    role_prefix : str, optional\\n+        IAM path prefix on the ARN of the toolchain and deployment roles\\n+        Defaults to '/'\\n     dryrun : bool, optional\\n         This flag indicates that the deployment WILL NOT\\n         enact any deployment changes.\\n@@ -934,6 +974,7 @@ def destroy(\\n         profile=profile,\\n         region_name=region_name,\\n         qualifier=qualifier,\\n+        role_prefix=role_prefix,\\n         enable_reaper=enable_session_timeout,\\n         reaper_interval=session_timeout_interval,\\n     )\\n\",\"diff --git a/seedfarmer/commands/_module_commands.py b/seedfarmer/commands/_module_commands.py\\nindex c3f46d4..c263334 100644\\n--- a/seedfarmer/commands/_module_commands.py\\n+++ b/seedfarmer/commands/_module_commands.py\\n@@ -206,7 +206,7 @@ def deploy_module(mdo: ModuleDeployObject) -> ModuleDeploymentResponse:\\n             + store_sf_bundle,\\n             extra_env_vars=env_vars,\\n             codebuild_compute_type=module_manifest.deploy_spec.build_type,\\n-            codebuild_role_name=mdo.module_role_name,\\n+            codebuild_role_name=mdo.module_role_arn,\\n             codebuild_image=active_codebuild_image,\\n             npm_mirror=npm_mirror,\\n             pypi_mirror=pypi_mirror,\\n@@ -311,7 +311,7 @@ def destroy_module(mdo: ModuleDeployObject) -> ModuleDeploymentResponse:\\n             extra_post_build_commands=[\\\"cd module/\\\"] + _phases.post_build.commands + remove_ssm + remove_sf_bundle,\\n             extra_env_vars=env_vars,\\n             codebuild_compute_type=module_manifest.deploy_spec.build_type,\\n-            codebuild_role_name=mdo.module_role_name,\\n+            codebuild_role_name=mdo.module_role_arn,\\n             codebuild_image=active_codebuild_image,\\n             npm_mirror=npm_mirror,\\n             pypi_mirror=pypi_mirror,\\n\",\"diff --git a/seedfarmer/commands/_project_policy_commands.py b/seedfarmer/commands/_project_policy_commands.py\\nindex 4f74fb8..c490347 100644\\n--- a/seedfarmer/commands/_project_policy_commands.py\\n+++ b/seedfarmer/commands/_project_policy_commands.py\\n@@ -13,12 +13,18 @@\\n #    limitations under the License.\\n \\n import os\\n-import shutil\\n import sys\\n \\n+import yaml\\n+\\n from seedfarmer import CLI_ROOT, DEFAULT_PROJECT_POLICY_PATH\\n \\n \\n-def get_default_project_policy() -> None:\\n+def get_default_project_policy(policy_prefix: str = \\\"/\\\") -> None:\\n     with open(os.path.join(CLI_ROOT, DEFAULT_PROJECT_POLICY_PATH), \\\"rb\\\") as f:\\n-        shutil.copyfileobj(f, sys.stdout.buffer)\\n+        policy = yaml.safe_load(f)\\n+\\n+        if policy_prefix:\\n+            policy[\\\"Resources\\\"][\\\"ProjectPolicy\\\"][\\\"Properties\\\"][\\\"Path\\\"] = policy_prefix\\n+\\n+        sys.stdout.write(yaml.dump(policy))\\n\",\"diff --git a/seedfarmer/commands/_stack_commands.py b/seedfarmer/commands/_stack_commands.py\\nindex 51fce1b..e7d5954 100644\\n--- a/seedfarmer/commands/_stack_commands.py\\n+++ b/seedfarmer/commands/_stack_commands.py\\n@@ -18,9 +18,11 @@ import os\\n import time\\n from typing import Any, Dict, List, Optional, Tuple, cast\\n \\n+import aws_codeseeder as cs\\n import boto3\\n from aws_codeseeder import EnvVar, EnvVarType, codeseeder, commands, services\\n from cfn_tools import load_yaml\\n+from packaging import version\\n \\n import seedfarmer.errors\\n import seedfarmer.services._iam as iam\\n@@ -130,6 +132,7 @@ def create_module_deployment_role(\\n     docker_credentials_secret: Optional[str] = None,\\n     permissions_boundary_arn: Optional[str] = None,\\n     session: Optional[boto3.Session] = None,\\n+    role_prefix: Optional[str] = None,\\n ) -> None:\\n     iam.create_check_iam_role(\\n         project_name=config.PROJECT,\\n@@ -145,6 +148,7 @@ def create_module_deployment_role(\\n         role_name=role_name,\\n         permissions_boundary_arn=permissions_boundary_arn,\\n         session=session,\\n+        role_prefix=role_prefix,\\n     )\\n \\n     policies = []\\n@@ -219,9 +223,7 @@ def deploy_bucket_storage_stack(\\n     account_id: str\\n         The Account Id where the module is deployed\\n     region: str\\n-        The region\\n-\\n-\\n+        The region where the module is deployed\\n \\n     Returns\\n     -------\\n@@ -272,7 +274,7 @@ def deploy_managed_policy_stack(\\n     account_id: str\\n         The Account Id where the module is deployed\\n     region: str\\n-        The region\\n+        The region where the module is deployed\\n     update_project_policy: bool\\n         Force update the project policy if already deployed\\n     \\\"\\\"\\\"\\n@@ -307,7 +309,7 @@ def destroy_bucket_storage_stack(\\n ) -> None:\\n     \\\"\\\"\\\"\\n     destroy_bucket_storage_stack\\n-        This function destroys the buckeet stack for SeedFarmer\\n+        This function destroys the bucket stack for SeedFarmer\\n \\n     Parameters\\n     ----------\\n@@ -342,7 +344,7 @@ def destroy_bucket_storage_stack(\\n             return\\n \\n \\n-def destroy_managed_policy_stack(account_id: str, region: str) -> None:\\n+def destroy_managed_policy_stack(account_id: str, region: str, **kwargs: Any) -> None:\\n     \\\"\\\"\\\"\\n     destroy_managed_policy_stack\\n         This function destroys the deployment-specific policy.\\n@@ -352,7 +354,7 @@ def destroy_managed_policy_stack(account_id: str, region: str) -> None:\\n     account_id: str\\n         The Account Id where the module is deployed\\n     region: str\\n-        The region wher\\n+        The region where the module is deployed\\n     \\\"\\\"\\\"\\n     # Determine if managed policy stack already deployed\\n     session = SessionManager().get_or_create().get_deployment_session(account_id=account_id, region_name=region)\\n@@ -440,6 +442,7 @@ def deploy_module_stack(\\n     parameters: List[ModuleParameter],\\n     docker_credentials_secret: Optional[str] = None,\\n     permissions_boundary_arn: Optional[str] = None,\\n+    role_prefix: Optional[str] = None,\\n ) -> Tuple[str, str]:\\n     \\\"\\\"\\\"\\n     deploy_module_stack\\n@@ -470,7 +473,11 @@ def deploy_module_stack(\\n \\n     _logger.debug(module_stack_path)\\n \\n-    session = SessionManager().get_or_create().get_deployment_session(account_id=account_id, region_name=region)\\n+    session = (\\n+        SessionManager()\\n+        .get_or_create(role_prefix=role_prefix)\\n+        .get_deployment_session(account_id=account_id, region_name=region)\\n+    )\\n     module_stack_name, module_role_name = get_module_stack_names(\\n         deployment_name, group_name, module_name, session=session\\n     )\\n@@ -483,6 +490,7 @@ def deploy_module_stack(\\n         docker_credentials_secret=docker_credentials_secret,\\n         permissions_boundary_arn=permissions_boundary_arn,\\n         session=session,\\n+        role_prefix=role_prefix,\\n     )\\n \\n     _logger.debug(\\\"module_role_name %s\\\", module_role_name)\\n@@ -581,6 +589,9 @@ def deploy_seedkit(\\n     private_subnet_ids: Optional[List[str]] = None,\\n     security_group_ids: Optional[List[str]] = None,\\n     update_seedkit: Optional[bool] = False,\\n+    role_prefix: Optional[str] = None,\\n+    policy_prefix: Optional[str] = None,\\n+    permissions_boundary_arn: Optional[str] = None,\\n     **kwargs: Any,\\n ) -> Dict[str, Any]:\\n     \\\"\\\"\\\"\\n@@ -599,6 +610,12 @@ def deploy_seedkit(\\n         The Subnet IDs to associate seedkit with (codebuild)\\n     security_group_ids: Optional[List[str]]\\n         The Security Group IDs to associate seedkit with (codebuild)\\n+    role_prefix: Optional[str]\\n+        The IAM Path Prefix to use for seedkit role\\n+    policy_prefix: Optional[str]\\n+        The IAM Path Prefix to use for seedkit policy\\n+    permissions_boundary_arn: Optional[str]\\n+        The ARN of the permissions boundary to attach to seedkit role\\n     \\\"\\\"\\\"\\n     session = SessionManager().get_or_create().get_deployment_session(account_id=account_id, region_name=region)\\n     stack_exists, _, stack_outputs = commands.seedkit_deployed(seedkit_name=config.PROJECT, session=session)\\n@@ -607,14 +624,25 @@ def deploy_seedkit(\\n         _logger.debug(\\\"SeedKit exists and not updating for Account/Region: %s/%s\\\", account_id, region)\\n     else:\\n         _logger.debug(\\\"Initializing / Updating SeedKit for Account/Region: %s/%s\\\", account_id, region)\\n-        commands.deploy_seedkit(\\n-            seedkit_name=config.PROJECT,\\n-            deploy_codeartifact=deploy_codeartifact,\\n-            session=session,\\n-            vpc_id=vpc_id,\\n-            subnet_ids=private_subnet_ids,\\n-            security_group_ids=security_group_ids,\\n-        )\\n+\\n+        seedkit_args = {\\n+            \\\"seedkit_name\\\": config.PROJECT,\\n+            \\\"deploy_codeartifact\\\": deploy_codeartifact,\\n+            \\\"session\\\": session,\\n+            \\\"vpc_id\\\": vpc_id,\\n+            \\\"subnet_ids\\\": private_subnet_ids,\\n+            \\\"security_group_ids\\\": security_group_ids,\\n+        }\\n+\\n+        if version.parse(cs.__version__) >= version.parse(\\\"1.3.0\\\"):\\n+            if role_prefix:\\n+                seedkit_args[\\\"role_prefix\\\"] = role_prefix\\n+            if policy_prefix:\\n+                seedkit_args[\\\"policy_prefix\\\"] = policy_prefix\\n+            if permissions_boundary_arn:\\n+                seedkit_args[\\\"permissions_boundary_arn\\\"] = permissions_boundary_arn\\n+\\n+        commands.deploy_seedkit(**seedkit_args)\\n         # Go get the outputs and return them\\n         _, _, stack_outputs = commands.seedkit_deployed(seedkit_name=config.PROJECT, session=session)\\n     return dict(stack_outputs)\\n@@ -630,7 +658,8 @@ def destroy_seedkit(account_id: str, region: str) -> None:\\n     account_id: str\\n         The Account Id where the module is deployed\\n     region: str\\n-        The region wher\\\"\\\"\\\"\\n+        The region where the module is deployed\\n+    \\\"\\\"\\\"\\n     session = SessionManager().get_or_create().get_deployment_session(account_id=account_id, region_name=region)\\n     _logger.debug(\\\"Destroying SeedKit for Account/Region: %s/%s\\\", account_id, region)\\n     commands.destroy_seedkit(seedkit_name=config.PROJECT, session=session)\\n\",\"diff --git a/seedfarmer/mgmt/deploy_utils.py b/seedfarmer/mgmt/deploy_utils.py\\nindex 38588b6..9971cbd 100644\\n--- a/seedfarmer/mgmt/deploy_utils.py\\n+++ b/seedfarmer/mgmt/deploy_utils.py\\n@@ -96,8 +96,10 @@ def populate_module_info_index(deployment_manifest: DeploymentManifest) -> Modul\\n     with concurrent.futures.ThreadPoolExecutor(max_workers=len(deployment_manifest.target_accounts_regions)) as workers:\\n \\n         def _get_module_info(args: Dict[str, Any]) -> None:\\n+            role_prefix = args.pop(\\\"role_prefix\\\", \\\"/\\\")\\n             session = (\\n                 SessionManager()\\n+                .get_or_create(role_prefix=role_prefix)\\n                 .get_or_create()\\n                 .get_deployment_session(account_id=args[\\\"account_id\\\"], region_name=args[\\\"region\\\"])\\n             )\\n@@ -113,7 +115,11 @@ def populate_module_info_index(deployment_manifest: DeploymentManifest) -> Modul\\n                 )\\n \\n         params = [\\n-            {\\\"account_id\\\": target_account_region[\\\"account_id\\\"], \\\"region\\\": target_account_region[\\\"region\\\"]}\\n+            {\\n+                \\\"account_id\\\": target_account_region[\\\"account_id\\\"],\\n+                \\\"region\\\": target_account_region[\\\"region\\\"],\\n+                \\\"role_prefix\\\": target_account_region[\\\"role_prefix\\\"],\\n+            }\\n             for target_account_region in deployment_manifest.target_accounts_regions\\n         ]\\n         _ = list(workers.map(_get_module_info, params))\\n\",\"diff --git a/seedfarmer/models/manifests/_deployment_manifest.py b/seedfarmer/models/manifests/_deployment_manifest.py\\nindex 2a50d44..3cc5c5f 100644\\n--- a/seedfarmer/models/manifests/_deployment_manifest.py\\n+++ b/seedfarmer/models/manifests/_deployment_manifest.py\\n@@ -63,6 +63,8 @@ class RegionMapping(CamelModel):\\n     npm_mirror_secret: Optional[str] = None\\n     seedkit_metadata: Optional[Dict[str, Any]] = None\\n     seedfarmer_artifact_bucket: Optional[str] = None\\n+    role_prefix: Optional[str] = None\\n+    policy_prefix: Optional[str] = None\\n \\n \\n class TargetAccountMapping(CamelModel):\\n@@ -83,6 +85,8 @@ class TargetAccountMapping(CamelModel):\\n     pypi_mirror_secret: Optional[str] = None\\n     _default_region: Optional[RegionMapping] = PrivateAttr(default=None)\\n     _region_index: Dict[str, RegionMapping] = PrivateAttr(default_factory=dict)\\n+    role_prefix: Optional[str] = None\\n+    policy_prefix: Optional[str] = None\\n \\n     def __init__(self, **kwargs: Any) -> None:\\n         super().__init__(**kwargs)\\n@@ -230,16 +234,19 @@ class DeploymentManifest(CamelModel):\\n             self._accounts_regions = []\\n             for target_account in self.target_account_mappings:\\n                 for region in target_account.region_mappings:\\n-                    self._accounts_regions.append(\\n-                        {\\n-                            \\\"alias\\\": target_account.alias,\\n-                            \\\"account_id\\\": target_account.actual_account_id,\\n-                            \\\"region\\\": region.region,\\n-                            \\\"network\\\": region.network,  # type: ignore\\n-                            \\\"parameters_regional\\\": region.parameters_regional,  # type: ignore\\n-                            \\\"codebuild_image\\\": cast(str, region.codebuild_image),\\n-                        }\\n-                    )\\n+                    role_prefix = region.role_prefix if region.role_prefix else target_account.role_prefix\\n+                    policy_prefix = region.policy_prefix if region.policy_prefix else target_account.policy_prefix\\n+                    account_region_args = {\\n+                        \\\"alias\\\": target_account.alias,\\n+                        \\\"account_id\\\": target_account.actual_account_id,\\n+                        \\\"region\\\": region.region,\\n+                        \\\"network\\\": region.network,\\n+                        \\\"parameters_regional\\\": region.parameters_regional,\\n+                        \\\"codebuild_image\\\": cast(str, region.codebuild_image),\\n+                        \\\"role_prefix\\\": role_prefix,\\n+                        \\\"policy_prefix\\\": policy_prefix,\\n+                    }\\n+                    self._accounts_regions.append(account_region_args)  # type: ignore\\n         return self._accounts_regions\\n \\n     def get_parameter_value(\\n@@ -445,6 +452,36 @@ class DeploymentManifest(CamelModel):\\n         else:\\n             return None\\n \\n+    def get_account_region_role_prefix(\\n+        self,\\n+        *,\\n+        account_alias: Optional[str] = None,\\n+        account_id: Optional[str] = None,\\n+        region: Optional[str] = None,\\n+    ) -> str:\\n+        if account_alias is not None and account_id is not None:\\n+            raise seedfarmer.errors.InvalidManifestError(\\\"Only one of 'account_alias' and 'account_id' is allowed\\\")\\n+\\n+        use_default_account = account_alias is None and account_id is None\\n+        use_default_region = region is None\\n+        default_prefix = \\\"/\\\"\\n+        for target_account in self.target_account_mappings:\\n+            if (\\n+                account_alias == target_account.alias\\n+                or account_id == target_account.actual_account_id\\n+                or (use_default_account and target_account.default)\\n+            ):\\n+                for region_mapping in target_account.region_mappings:\\n+                    if region == region_mapping.region or (use_default_region and region_mapping.default):\\n+                        role_prefix = (\\n+                            region_mapping.role_prefix\\n+                            if region_mapping.role_prefix is not None\\n+                            else target_account.role_prefix\\n+                        )\\n+                        return role_prefix if role_prefix else default_prefix\\n+        else:\\n+            return default_prefix\\n+\\n     def get_permission_boundary_arn(self, target_account: str, target_region: str) -> Optional[str]:\\n         permissions_boundary_name = self.get_parameter_value(\\n             \\\"permissionsBoundaryName\\\",\\n\",\"diff --git a/seedfarmer/models/transfer/_module_deploy_object.py b/seedfarmer/models/transfer/_module_deploy_object.py\\nindex a77d0f5..dff99d4 100644\\n--- a/seedfarmer/models/transfer/_module_deploy_object.py\\n+++ b/seedfarmer/models/transfer/_module_deploy_object.py\\n@@ -14,6 +14,7 @@ class ModuleDeployObject(CamelModel):\\n     docker_credentials_secret: Optional[str] = None\\n     permissions_boundary_arn: Optional[str] = None\\n     module_role_name: Optional[str] = None\\n+    module_role_arn: Optional[str] = None\\n     codebuild_image: Optional[str] = None\\n     npm_mirror: Optional[str] = None\\n     npm_mirror_secret: Optional[str] = None\\n\",\"diff --git a/seedfarmer/resources/deployment_role.template b/seedfarmer/resources/deployment_role.template\\nindex e9aecfa..7971097 100644\\n--- a/seedfarmer/resources/deployment_role.template\\n+++ b/seedfarmer/resources/deployment_role.template\\n@@ -14,7 +14,7 @@ Resources:\\n             Effect: Allow\\n             Principal:\\n                 AWS: \\\"{{ toolchain_role_arn }}\\\"\\n-      Path: /\\n+      Path: \\\"{{ role_prefix }}\\\"\\n       Policies:\\n         - PolicyName: InlineToolchain\\n           PolicyDocument:\\n@@ -68,6 +68,10 @@ Resources:\\n                 - Fn::Sub: \\\"arn:${AWS::Partition}:iam::${AWS::AccountId}:role/codeseeder-{{ project_name }}-*\\\"\\n                 - Fn::Sub: \\\"arn:${AWS::Partition}:iam::${AWS::AccountId}:policy/{{ project_name }}-*\\\"\\n                 - Fn::Sub: \\\"arn:${AWS::Partition}:iam::${AWS::AccountId}:policy/codeseeder-{{ project_name }}-*\\\"\\n+                - Fn::Sub: \\\"arn:${AWS::Partition}:iam::${AWS::AccountId}:role/*/{{ project_name }}-*\\\"\\n+                - Fn::Sub: \\\"arn:${AWS::Partition}:iam::${AWS::AccountId}:role/*/codeseeder-{{ project_name }}-*\\\"\\n+                - Fn::Sub: \\\"arn:${AWS::Partition}:iam::${AWS::AccountId}:policy/*/{{ project_name }}-*\\\"\\n+                - Fn::Sub: \\\"arn:${AWS::Partition}:iam::${AWS::AccountId}:policy/*/codeseeder-{{ project_name }}-*\\\"\\n               Sid: DeploymentIAM\\n             - Action:\\n               - codebuild:Update*\\n@@ -117,6 +121,7 @@ Resources:\\n               Effect: Allow\\n               Resource:\\n               - Fn::Sub: \\\"arn:${AWS::Partition}:iam::*:role/{{ project_name }}-*\\\"\\n+              - Fn::Sub: \\\"arn:${AWS::Partition}:iam::*:role/*/{{ project_name }}-*\\\"\\n               Sid: DeploymentSTS\\n             - Action:\\n               - ssm:Put*\\n\",\"diff --git a/seedfarmer/resources/projectpolicy.yaml b/seedfarmer/resources/projectpolicy.yaml\\nindex 8c74e86..3aad027 100644\\n--- a/seedfarmer/resources/projectpolicy.yaml\\n+++ b/seedfarmer/resources/projectpolicy.yaml\\n@@ -44,7 +44,7 @@ Resources:\\n               - ssm:DeleteParameter\\n               - ssm:DeleteParameters\\n             Resource:\\n-              -  !Sub \\\"arn:${AWS::Partition}:ssm:${AWS::Region}:${AWS::AccountId}:parameter/${ProjectName}*\\\"\\n+              - Fn::Sub: \\\"arn:${AWS::Partition}:ssm:${AWS::Region}:${AWS::AccountId}:parameter/${ProjectName}*\\\"\\n           - Effect: Allow\\n             Action:\\n               - logs:CreateLogStream\\n@@ -54,23 +54,23 @@ Resources:\\n               - logs:GetLogGroupFields\\n               - logs:GetQueryResults\\n             Resource:\\n-              - !Sub \\\"arn:${AWS::Partition}:logs:${AWS::Region}:${AWS::AccountId}:log-group:/aws/codebuild/codeseeder-${ProjectName}*\\\"\\n+              - Fn::Sub: \\\"arn:${AWS::Partition}:logs:${AWS::Region}:${AWS::AccountId}:log-group:/aws/codebuild/codeseeder-${ProjectName}*\\\"\\n           - Effect: Allow\\n             Action:\\n               - ssm:GetParameter\\n             Resource:\\n-              -  !Sub \\\"arn:${AWS::Partition}:ssm:${AWS::Region}:${AWS::AccountId}:parameter/cdk-bootstrap*\\\"\\n+              - Fn::Sub: \\\"arn:${AWS::Partition}:ssm:${AWS::Region}:${AWS::AccountId}:parameter/cdk-bootstrap*\\\"\\n           - Effect: Allow\\n             Action:\\n               - iam:UpdateAssumeRolePolicy\\n             Resource:\\n-              -  !Sub \\\"arn:${AWS::Partition}:iam::${AWS::AccountId}:role/${ProjectName}*\\\"\\n+              - Fn::Sub: \\\"arn:${AWS::Partition}:iam::${AWS::AccountId}:role/${ProjectName}*\\\"\\n           - Effect: Allow\\n             Action:\\n               - \\\"iam:PassRole\\\"\\n               - \\\"sts:AssumeRole\\\"\\n             Resource:\\n-              - !Sub \\\"arn:${AWS::Partition}:iam::${AWS::AccountId}:role/cdk*\\\"\\n+              - Fn::Sub: \\\"arn:${AWS::Partition}:iam::${AWS::AccountId}:role/cdk*\\\"\\n           - Action:\\n             - s3:Delete*\\n             - s3:Put*\\n@@ -85,5 +85,5 @@ Resources:\\n \\n Outputs:\\n   ProjectPolicyARN:\\n-    Value: !Ref 'ProjectPolicy'\\n-\\n+    Value:\\n+      Ref: ProjectPolicy\\n\",\"diff --git a/seedfarmer/resources/toolchain_role.template b/seedfarmer/resources/toolchain_role.template\\nindex 2ea880e..f5320fe 100644\\n--- a/seedfarmer/resources/toolchain_role.template\\n+++ b/seedfarmer/resources/toolchain_role.template\\n@@ -14,7 +14,7 @@ Resources:\\n             Effect: Allow\\n             Principal:\\n                 AWS: []\\n-      Path: /\\n+      Path: \\\"{{ role_prefix }}\\\"\\n       Policies:\\n         - PolicyName: InlineToolchain\\n           PolicyDocument:\\n@@ -25,7 +25,8 @@ Resources:\\n               - sts:GetSessionToken\\n               Effect: Allow\\n               Resource:\\n-                Fn::Sub: \\\"arn:${AWS::Partition}:iam::*:role/seedfarmer-{{ project_name }}*\\\"\\n+                - Fn::Sub: \\\"arn:${AWS::Partition}:iam::*:role/seedfarmer-{{ project_name }}*\\\"\\n+                - Fn::Sub: \\\"arn:${AWS::Partition}:iam::*:role/*/seedfarmer-{{ project_name }}*\\\"\\n               Sid: ToolChainSTS\\n             - Action:\\n               - ssm:Put*\\n\",\"diff --git a/seedfarmer/services/_iam.py b/seedfarmer/services/_iam.py\\nindex d24963f..1a5780f 100644\\n--- a/seedfarmer/services/_iam.py\\n+++ b/seedfarmer/services/_iam.py\\n@@ -18,6 +18,7 @@ from typing import Any, Dict, List, Optional, cast\\n \\n from boto3 import Session\\n \\n+import seedfarmer.errors\\n from seedfarmer.services._service_utils import boto3_client, boto3_resource, get_region\\n \\n _logger: logging.Logger = logging.getLogger(__name__)\\n@@ -33,6 +34,15 @@ def get_role(role_name: str, session: Optional[Session] = None) -> Optional[Dict\\n         return None\\n \\n \\n+def get_role_arn(role_name: str, session: Optional[Session] = None) -> str:\\n+    role = get_role(role_name=role_name, session=session)\\n+\\n+    if not role:\\n+        raise seedfarmer.errors.InvalidConfigurationError(f\\\"Role {role_name} does not exist\\\")\\n+\\n+    return cast(str, role[\\\"Role\\\"][\\\"Arn\\\"])\\n+\\n+\\n def create_check_iam_role(\\n     project_name: str,\\n     deployment_name: str,\\n@@ -42,6 +52,7 @@ def create_check_iam_role(\\n     group_name: Optional[str] = None,\\n     module_name: Optional[str] = None,\\n     session: Optional[Session] = None,\\n+    role_prefix: Optional[str] = None,\\n ) -> None:\\n     _logger.debug(\\\"Creating IAM Role with name: %s \\\", role_name)\\n     iam_client = boto3_client(\\\"iam\\\", session=session)\\n@@ -50,6 +61,7 @@ def create_check_iam_role(\\n     except iam_client.exceptions.NoSuchEntityException:\\n         args: Dict[str, Any] = {\\n             \\\"RoleName\\\": role_name,\\n+            \\\"Path\\\": role_prefix if role_prefix else \\\"/\\\",\\n             \\\"AssumeRolePolicyDocument\\\": json.dumps(trust_policy),\\n             \\\"Description\\\": f\\\"deployment-role for {role_name}\\\",\\n             \\\"Tags\\\": [\\n\",\"diff --git a/seedfarmer/services/session_manager.py b/seedfarmer/services/session_manager.py\\nindex f247fc4..5293ec8 100644\\n--- a/seedfarmer/services/session_manager.py\\n+++ b/seedfarmer/services/session_manager.py\\n@@ -49,6 +49,7 @@ class ISessionManager(object):\\n         region_name: Optional[str] = None,\\n         toolchain_region: Optional[str] = None,\\n         qualifier: Optional[str] = None,\\n+        role_prefix: Optional[str] = None,\\n         profile: Optional[str] = None,\\n         enable_reaper: bool = False,\\n         **kwargs: Optional[Any],\\n@@ -86,6 +87,7 @@ class SessionManager(ISessionManager, metaclass=SingletonMeta):\\n         profile: Optional[str] = None,\\n         toolchain_region: Optional[str] = None,\\n         qualifier: Optional[str] = None,\\n+        role_prefix: Optional[str] = None,\\n         reaper_interval: Optional[int] = None,\\n         enable_reaper: bool = False,\\n         **kwargs: Optional[Any],\\n@@ -100,6 +102,7 @@ class SessionManager(ISessionManager, metaclass=SingletonMeta):\\n             self.config[\\\"profile\\\"] = profile\\n             self.config[\\\"toolchain_region\\\"] = toolchain_region\\n             self.config[\\\"qualifier\\\"] = qualifier if qualifier else None\\n+            self.config[\\\"role_prefix\\\"] = role_prefix if role_prefix else \\\"/\\\"\\n             self.config = {**self.config, **kwargs}\\n             self.toolchain_role_name = get_toolchain_role_name(project_name, cast(str, qualifier))\\n \\n@@ -140,6 +143,7 @@ class SessionManager(ISessionManager, metaclass=SingletonMeta):\\n         session_key = f\\\"{account_id}-{region_name}\\\"\\n         project_name = self.config[\\\"project_name\\\"]\\n         qualifier = self.config.get(\\\"qualifier\\\") if self.config.get(\\\"qualifier\\\") else None\\n+        role_prefix = self.config.get(\\\"role_prefix\\\")\\n         toolchain_region = self.config.get(\\\"toolchain_region\\\")\\n         if not self.created:\\n             raise seedfarmer.errors.InvalidConfigurationError(\\\"The SessionManager object was never properly created...\\\")\\n@@ -161,6 +165,7 @@ class SessionManager(ISessionManager, metaclass=SingletonMeta):\\n                 deployment_account_id=account_id,\\n                 project_name=project_name,\\n                 qualifier=cast(str, qualifier),\\n+                role_prefix=role_prefix,\\n             )\\n             _logger.debug(\\n                 f\\\"\\\"\\\"The assumed toolchain role {toolchain_role[\\\"AssumedRoleUser\\\"][\\\"Arn\\\"]} will\\n@@ -207,6 +212,7 @@ class SessionManager(ISessionManager, metaclass=SingletonMeta):\\n         profile_name = self.config.get(\\\"profile\\\")\\n         project_name = self.config.get(\\\"project_name\\\")\\n         qualifier = self.config.get(\\\"qualifier\\\") if self.config.get(\\\"qualifier\\\") else None\\n+        role_prefix = self.config.get(\\\"role_prefix\\\")\\n         toolchain_region = self.config.get(\\\"toolchain_region\\\")\\n         _logger.debug(\\n             f\\\"\\\"\\\"Creating a local session with the following info passed in:\\n@@ -226,6 +232,7 @@ class SessionManager(ISessionManager, metaclass=SingletonMeta):\\n             toolchain_account_id=user_account_id,\\n             project_name=cast(str, project_name),\\n             qualifier=cast(str, qualifier),\\n+            role_prefix=role_prefix,\\n         )\\n         _logger.debug(\\n             f\\\"\\\"\\\"The active user session will assume the toolchain role\\n\",\"diff --git a/seedfarmer/utils.py b/seedfarmer/utils.py\\nindex 078bbb7..5d863b2 100644\\n--- a/seedfarmer/utils.py\\n+++ b/seedfarmer/utils.py\\n@@ -144,9 +144,17 @@ def get_toolchain_role_name(project_name: str, qualifier: Optional[str] = None) \\n \\n \\n def get_toolchain_role_arn(\\n-    partition: str, toolchain_account_id: str, project_name: str, qualifier: Optional[str] = None\\n+    partition: str,\\n+    toolchain_account_id: str,\\n+    project_name: str,\\n+    qualifier: Optional[str] = None,\\n+    role_prefix: Optional[str] = None,\\n ) -> str:\\n-    return f\\\"arn:{partition}:iam::{toolchain_account_id}:role/{get_toolchain_role_name(project_name, qualifier)}\\\"\\n+    role_prefix = role_prefix if role_prefix else \\\"/\\\"\\n+    return (\\n+        f\\\"arn:{partition}:iam::{toolchain_account_id}:role{role_prefix}\\\"\\n+        f\\\"{get_toolchain_role_name(project_name, qualifier)}\\\"\\n+    )\\n \\n \\n def get_deployment_role_name(project_name: str, qualifier: Optional[str] = None) -> str:\\n@@ -155,9 +163,17 @@ def get_deployment_role_name(project_name: str, qualifier: Optional[str] = None)\\n \\n \\n def get_deployment_role_arn(\\n-    partition: str, deployment_account_id: str, project_name: str, qualifier: Optional[str] = None\\n+    partition: str,\\n+    deployment_account_id: str,\\n+    project_name: str,\\n+    qualifier: Optional[str] = None,\\n+    role_prefix: Optional[str] = None,\\n ) -> str:\\n-    return f\\\"arn:{partition}:iam::{deployment_account_id}:role/{get_deployment_role_name(project_name, qualifier)}\\\"\\n+    role_prefix = role_prefix if role_prefix else \\\"/\\\"\\n+    return (\\n+        f\\\"arn:{partition}:iam::{deployment_account_id}:role{role_prefix}\\\"\\n+        f\\\"{get_deployment_role_name(project_name, qualifier)}\\\"\\n+    )\\n \\n \\n def get_generic_module_deployment_role_name(\\n\"]", "test_patch": "[\"diff --git a/docs/source/bootstrapping.md b/docs/source/bootstrapping.md\\nindex 051a9e4..be74599 100644\\n--- a/docs/source/bootstrapping.md\\n+++ b/docs/source/bootstrapping.md\\n@@ -26,6 +26,10 @@ Options:\\n   --region TEXT                   AWS region to use\\n   --qualifier TEXT                A qualifier to append to toolchain role\\n                                   (alpha-numeric char max length of 6)\\n+  --role-prefix TEXT              An IAM path prefix to use with the\\n+                                  seedfarmer roles.\\n+  --policy-prefix TEXT            An IAM path prefix to use with the\\n+                                  seedfarmer policies.\\n   -pa, --policy-arn TEXT          ARN of existing Policy to attach to Target\\n                                   Role (Deploymenmt Role) This can be use\\n                                   multiple times, but EACH policy MUST be\\n@@ -65,6 +69,8 @@ Options:\\n   --region TEXT                   AWS region to use\\n   --qualifier TEXT                A qualifier to append to target role (alpha-\\n                                   numeric char max length of 6)\\n+  --role-prefix TEXT              An IAM path prefix to use with the seedfarmer\\n+                                  roles.\\n   -pa, --policy-arn TEXT          ARN of existing Policy to attach to Target\\n                                   Role (Deploymenmt Role) This can be use\\n                                   multiple times to create a list, but EACH\\n@@ -84,6 +90,11 @@ We have added support for the use of a qualifier for the toolchain role and the \\n The qualifier post-pends a 6 chars alpha-numeric string to the deployment role and toolchain role.  The qualifier **MUST BE THE SAME ON THE TOOLCHAIN ROLE AND EACH TARGET ROLE.**\\n \\n \\n+## IAM Paths Prefixes for Toolchain, Target Roles, and Policies\\n+We have added support for the use of a IAM Paths for the toolchain role, target account deployment role(s), and policie(s). Using IAM Paths you can create groupings and design a logical separation to simplify permissions management. A common example in organizations is using Service Control Policies enforcing logical separation by team e.g. `/legal/` or `/sales/`, or project name.\\n+\\n+A `--role-prefix` and `--policy-prefix` can be used if you want to provide IAM Paths to the roles and policies created by `seed-farmer`. IAM Paths must begin and end with a `/`. More information in [IAM identifiers](https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_identifiers.html).\\n+\\n ## Prepping the Account / Region\\n `seedfarmer` leverages the AWS CDKv2.  This must be bootstrapped in each account/region combination to be used of each target account.\\n \\n\",\"diff --git a/docs/source/manifests.md b/docs/source/manifests.md\\nindex 5bbc44d..8844ef5 100644\\n--- a/docs/source/manifests.md\\n+++ b/docs/source/manifests.md\\n@@ -34,6 +34,8 @@ targetAccountMappings:\\n     npmMirrorSecret: /something/aws-addf-mirror-credentials\\n     pypiMirror: https://pypi.python.org/simple\\n     pypiMirrorSecret: /something/aws-addf-mirror-mirror-credentials\\n+    rolePrefix: /\\n+    policyPrefix: /\\n     parametersGlobal:\\n       dockerCredentialsSecret: nameofsecret\\n       permissionsBoundaryName: policyname\\n@@ -108,6 +110,8 @@ targetAccountMappings:\\n   - **npmMirrorSecret** - the AWS SecretManager to use when setting the mirror (see [Mirror Override](mirroroverride))\\n   - **pypiMirror** - the Pypi mirror to use (see [Mirror Override](mirroroverride))\\n   - **pypiMirrorSecret** - the AWS SecretManager to use when setting the mirror (see [Mirror Override](mirroroverride))\\n+  - **rolePrefix** - IAM path prefix to use with seedfarmer roles (see [IAM Path Prefixes](iamprefixes))\\n+  - **policyPrefix** - IAM path prefix to use with seedfarmer policies (see [IAM Path Prefixes](iamprefixes))\\n   - **parametersGlobal** - these are parameters that apply to all region mappings unless otherwise overridden at the region level\\n     - **dockerCredentialsSecret** - please see [Docker Credentials Secret](dockerCredentialsSecret)\\n     - **permissionsBoundaryName** - the name of the [permissions boundary](https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_boundaries.html) policy to apply to all module-specific roles created\\n@@ -118,6 +122,8 @@ targetAccountMappings:\\n     - **npmMirror** - the NPM registry mirror to use (see [Mirror Override](mirroroverride))\\n     - **pypiMirror** - the Pypi mirror to use (see [Mirror Override](mirroroverride))\\n     - **pypiMirrorSecret** - the AWS SecretManager to use when setting the mirror (see [Mirror Override](mirroroverride))\\n+    - **rolePrefix** - IAM path prefix to use with seedfarmer roles (see [IAM Path Prefixes](iamprefixes))\\n+    - **policyPrefix** - IAM path prefix to use with seedfarmer policies (see [IAM Path Prefixes](iamprefixes))\\n     - **parametersRegional** - these are parameters that apply to all region mappings unless otherwise overridden at the region level\\n       - **dockerCredentialsSecret** - please see [Docker Credentials Secret](dockerCredentialsSecret)\\n         - This is a NAMED PARAMETER...in that `dockerCredentialsSecret` is recognized by `seed-farmer`\\n@@ -531,6 +537,19 @@ This would result in the creation of an `_auth` entry in npm config (`.npmrc`) w\\n npm config set //the-mirror-dns/npm/:_auth=\\\"mybase64encodedssltoken\\\"\\n ```\\n \\n+(iamprefixes)=\\n+## IAM Path Prefixes\\n+Using IAM Paths you can create groupings and design a logical separation to simplify permissions management. A common example in organizations is using Service Control Policies enforcing logical separation by team e.g. `/legal/` or `/sales/`, or project name.\\n+\\n+It is possible to override the default paths of `/` for `seed-farmer` IAM roles and policies using the deployment manifest using `rolePrefix` and `policyPrefix` at the account/region level. IAM Paths must begin and end with a `/`. More information in [IAM identifiers](https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_identifiers.html).\\n+\\n+There is a level of logic that is followed:\\n+1. if a prefix is defined at the region level --- USE IT... ELSE\\n+2. if a prefix is defined at the account level --- USE IT... ELSE\\n+4. use default `/` prefix\\n+\\n+NOTE: the prefixes provided must match the prefixes provided during bootstrap, unless a custom bootstrap is used.\\n+\\n (archivesecret)=\\n ### Archive Secret\\n \\n\",\"diff --git a/test/unit-test/mock_data/manifests/module-test/deployment-prefix.yaml b/test/unit-test/mock_data/manifests/module-test/deployment-prefix.yaml\\nnew file mode 100644\\nindex 0000000..fcdfedc\\n--- /dev/null\\n+++ b/test/unit-test/mock_data/manifests/module-test/deployment-prefix.yaml\\n@@ -0,0 +1,16 @@\\n+name: example-test-dev\\n+toolchainRegion: us-west-2\\n+groups:\\n+  - name: test\\n+    path: test/unit-test/mock_data/manifests/module-test/test-modules.yaml\\n+targetAccountMappings:\\n+  - alias: primary\\n+    accountId: 123456789012\\n+    default: true\\n+    rolePrefix: /test1/\\n+    policyPrefix: /test2/\\n+    regionMappings:\\n+      - region: us-west-2\\n+        default: true\\n+        parametersRegional:\\n+          someKey: someValue\\n\",\"diff --git a/test/unit-test/mock_data/mock_deployment_manifest_with_prefix.py b/test/unit-test/mock_data/mock_deployment_manifest_with_prefix.py\\nnew file mode 100644\\nindex 0000000..7678fc8\\n--- /dev/null\\n+++ b/test/unit-test/mock_data/mock_deployment_manifest_with_prefix.py\\n@@ -0,0 +1,39 @@\\n+deployment_manifest = {\\n+    \\\"name\\\": \\\"mlops\\\",\\n+    \\\"toolchain_region\\\": \\\"us-east-1\\\",\\n+    \\\"groups\\\": [\\n+        {\\n+            \\\"name\\\": \\\"optionals\\\",\\n+            \\\"path\\\": \\\"manifests/mlops/optional-modules.yaml\\\",\\n+            \\\"modules\\\": [\\n+                {\\n+                    \\\"name\\\": \\\"networking\\\",\\n+                    \\\"path\\\": \\\"modules/optionals/networking/\\\",\\n+                    \\\"parameters\\\": [{\\\"name\\\": \\\"internet-accessible\\\", \\\"value\\\": True}],\\n+                    \\\"target_account\\\": \\\"primary\\\",\\n+                    \\\"target_region\\\": \\\"us-east-1\\\",\\n+                },\\n+            ],\\n+        },\\n+    ],\\n+    \\\"target_account_mappings\\\": [\\n+        {\\n+            \\\"alias\\\": \\\"primary\\\",\\n+            \\\"account_id\\\": \\\"123456789012\\\",\\n+            \\\"default\\\": True,\\n+            \\\"parameters_global\\\": {\\n+                \\\"dockerCredentialsSecret\\\": \\\"aws-addf-docker-credentials\\\",\\n+                \\\"permissionsBoundaryName\\\": \\\"boundary\\\",\\n+            },\\n+            \\\"rolePrefix\\\": \\\"/test1/\\\",\\n+            \\\"policyPrefix\\\": \\\"/test2/\\\",\\n+            \\\"region_mappings\\\": [\\n+                {\\n+                    \\\"region\\\": \\\"us-east-1\\\",\\n+                    \\\"default\\\": True,\\n+                    \\\"parameters_regional\\\": {},\\n+                }\\n+            ],\\n+        }\\n+    ],\\n+}\\n\",\"diff --git a/test/unit-test/test_cli_arg.py b/test/unit-test/test_cli_arg.py\\nindex ad315b5..0c899a4 100644\\n--- a/test/unit-test/test_cli_arg.py\\n+++ b/test/unit-test/test_cli_arg.py\\n@@ -1471,6 +1471,11 @@ def test_get_projectpolicy_debug():\\n     _test_command(sub_command=projectpolicy, options=[\\\"synth\\\", \\\"--debug\\\"], exit_code=0)\\n \\n \\n+@pytest.mark.projectpolicy\\n+def test_get_projectpolicy_prefix():\\n+    _test_command(sub_command=projectpolicy, options=[\\\"synth\\\", \\\"--policy-prefix\\\", \\\"/test/\\\"], exit_code=0)\\n+\\n+\\n @pytest.mark.metadata\\n def test_metadata_param_value(mocker):\\n     mocker.patch(\\n\",\"diff --git a/test/unit-test/test_commands_deployment.py b/test/unit-test/test_commands_deployment.py\\nindex a66cad8..29fdc4c 100644\\n--- a/test/unit-test/test_commands_deployment.py\\n+++ b/test/unit-test/test_commands_deployment.py\\n@@ -4,6 +4,7 @@ from unittest.mock import ANY\\n \\n import mock_data.mock_deployment_manifest_for_destroy as mock_deployment_manifest_for_destroy\\n import mock_data.mock_deployment_manifest_huge as mock_deployment_manifest_huge\\n+import mock_data.mock_deployment_manifest_with_prefix as mock_deployment_manifest_with_prefix\\n import mock_data.mock_deployspec as mock_deployspec\\n import mock_data.mock_manifests as mock_manifests\\n import mock_data.mock_module_info_huge as mock_module_info_huge\\n@@ -82,6 +83,24 @@ def test_apply_violations(session_manager, mocker):\\n \\n @pytest.mark.commands\\n @pytest.mark.commands_deployment\\n+def test_apply_with_prefix(session_manager, mocker):\\n+    mocker.patch(\\\"seedfarmer.commands._deployment_commands.write_deployment_manifest\\\", return_value=None)\\n+    mocker.patch(\\\"seedfarmer.commands._deployment_commands.prime_target_accounts\\\", return_value=None)\\n+    mocker.patch(\\\"seedfarmer.commands._deployment_commands.du.populate_module_info_index\\\", return_value=None)\\n+    mocker.patch(\\\"seedfarmer.commands._deployment_commands.du.filter_deploy_destroy\\\", return_value=None)\\n+    mocker.patch(\\\"seedfarmer.commands._deployment_commands.write_deployment_manifest\\\", return_value=None)\\n+    mocker.patch(\\\"seedfarmer.commands._deployment_commands.du.validate_module_dependencies\\\", return_value=None)\\n+    mocker.patch(\\\"seedfarmer.commands._deployment_commands.destroy_deployment\\\", return_value=None)\\n+    mocker.patch(\\\"seedfarmer.commands._deployment_commands.deploy_deployment\\\", return_value=None)\\n+    dc.apply(\\n+        deployment_manifest_path=\\\"test/unit-test/mock_data/manifests/module-test/deployment-prefix.yaml\\\",\\n+        role_prefix=\\\"/test1/\\\",\\n+        dryrun=True,\\n+    )\\n+\\n+\\n+@pytest.mark.commands\\n+@pytest.mark.commands_deployment\\n def test_destroy_clean(session_manager, mocker):\\n     mocker.patch(\\n         \\\"seedfarmer.commands._deployment_commands.du.generate_deployed_manifest\\\",\\n@@ -108,6 +127,18 @@ def test_destroy_not_found(session_manager, mocker):\\n     dc.destroy(deployment_name=\\\"myapp\\\", dryrun=True, remove_seedkit=False)\\n \\n \\n+@pytest.mark.commands\\n+@pytest.mark.commands_deployment\\n+def test_destroy_with_prefix(session_manager, mocker):\\n+    mocker.patch(\\n+        \\\"seedfarmer.commands._deployment_commands.du.generate_deployed_manifest\\\",\\n+        return_value=DeploymentManifest(**mock_deployment_manifest_for_destroy.destroy_manifest),\\n+    )\\n+    mocker.patch(\\\"seedfarmer.commands._deployment_commands.destroy_deployment\\\", return_value=None)\\n+\\n+    dc.destroy(deployment_name=\\\"myapp\\\", role_prefix=\\\"/test/\\\", dryrun=True, remove_seedkit=False)\\n+\\n+\\n # @pytest.mark.commands\\n # @pytest.mark.commands_deployment\\n # def test_tear_down_target_accounts(session_manager,mocker):\\n@@ -173,6 +204,10 @@ def test_execute_deploy_invalid_spec(session_manager, mocker):\\n         return_value=(\\\"stack_name\\\", \\\"role_name\\\"),\\n     )\\n     mocker.patch(\\\"seedfarmer.commands._deployment_commands.get_module_metadata\\\", return_value=None)\\n+    mocker.patch(\\n+        \\\"seedfarmer.commands._deployment_commands.get_role_arn\\\",\\n+        return_value=\\\"role_arn\\\",\\n+    )\\n     mocker.patch(\\\"seedfarmer.commands._deployment_commands.du.prepare_ssm_for_deploy\\\", return_value=None)\\n     dep = DeploymentManifest(**mock_deployment_manifest_huge.deployment_manifest)\\n     dep.validate_and_set_module_defaults()\\n@@ -192,6 +227,10 @@ def test_execute_deploy(session_manager, mocker):\\n         return_value=(\\\"stack_name\\\", \\\"role_name\\\"),\\n     )\\n     mocker.patch(\\\"seedfarmer.commands._deployment_commands.get_module_metadata\\\", return_value=None)\\n+    mocker.patch(\\n+        \\\"seedfarmer.commands._deployment_commands.get_role_arn\\\",\\n+        return_value=\\\"role_arn\\\",\\n+    )\\n     mocker.patch(\\\"seedfarmer.commands._deployment_commands.du.prepare_ssm_for_deploy\\\", return_value=None)\\n     mocker.patch(\\\"seedfarmer.commands._deployment_commands.commands.deploy_module\\\", return_value=None)\\n     dep = DeploymentManifest(**mock_deployment_manifest_huge.deployment_manifest)\\n@@ -205,6 +244,47 @@ def test_execute_deploy(session_manager, mocker):\\n \\n @pytest.mark.commands\\n @pytest.mark.commands_deployment\\n+def test_execute_deploy_with_prefix(session_manager, mocker):\\n+    mocker.patch(\\\"seedfarmer.commands._deployment_commands.load_parameter_values\\\", return_value=None)\\n+    mocker.patch(\\n+        \\\"seedfarmer.commands._deployment_commands.get_modulestack_path\\\",\\n+        return_value=\\\"path\\\",\\n+    )\\n+    deploy_module_stack_mock = mocker.patch(\\n+        \\\"seedfarmer.commands._deployment_commands.commands.deploy_module_stack\\\",\\n+        return_value=(\\\"stack_name\\\", \\\"role_name\\\"),\\n+    )\\n+    mocker.patch(\\\"seedfarmer.commands._deployment_commands.get_module_metadata\\\", return_value=None)\\n+    mocker.patch(\\n+        \\\"seedfarmer.commands._deployment_commands.get_role_arn\\\",\\n+        return_value=\\\"role_arn\\\",\\n+    )\\n+    mocker.patch(\\\"seedfarmer.commands._deployment_commands.du.prepare_ssm_for_deploy\\\", return_value=None)\\n+    mocker.patch(\\\"seedfarmer.commands._deployment_commands.commands.deploy_module\\\", return_value=None)\\n+    dep = DeploymentManifest(**mock_deployment_manifest_with_prefix.deployment_manifest)\\n+    dep.validate_and_set_module_defaults()\\n+    group = dep.groups[0]\\n+    module_manifest = group.modules[0]\\n+    module_manifest.deploy_spec = DeploySpec(**mock_deployspec.dummy_deployspec)\\n+    mdo = ModuleDeployObject(deployment_manifest=dep, group_name=dep.groups[0].name, module_name=module_manifest.name)\\n+    dc._execute_deploy(mdo)\\n+\\n+    deploy_module_stack_mock.assert_called_with(\\n+        module_stack_path=\\\"path\\\",\\n+        deployment_name=\\\"mlops\\\",\\n+        group_name=\\\"optionals\\\",\\n+        module_name=\\\"networking\\\",\\n+        account_id=\\\"123456789012\\\",\\n+        region=\\\"us-east-1\\\",\\n+        parameters=None,\\n+        docker_credentials_secret=\\\"aws-addf-docker-credentials\\\",\\n+        permissions_boundary_arn=\\\"arn:aws:iam::123456789012:policy/boundary\\\",\\n+        role_prefix=\\\"/test1/\\\",\\n+    )\\n+\\n+\\n+@pytest.mark.commands\\n+@pytest.mark.commands_deployment\\n def test_execute_destroy_invalid_spec(session_manager, mocker):\\n     from seedfarmer.models.deploy_responses import ModuleDeploymentResponse\\n \\n@@ -240,6 +320,10 @@ def test_execute_destroy(session_manager, mocker):\\n         \\\"seedfarmer.commands._deployment_commands.commands.get_module_stack_info\\\",\\n         return_value=(\\\"stack_name\\\", \\\"role_name\\\", True),\\n     )\\n+    mocker.patch(\\n+        \\\"seedfarmer.commands._deployment_commands.get_role_arn\\\",\\n+        return_value=\\\"role_arn\\\",\\n+    )\\n     mocker.patch(\\\"seedfarmer.commands._deployment_commands.commands.destroy_module\\\", return_value=mod_resp)\\n     mocker.patch(\\\"seedfarmer.commands._deployment_commands.commands.destroy_module_stack\\\", return_value=None)\\n     mocker.patch(\\\"seedfarmer.commands._deployment_commands.commands.force_manage_policy_attach\\\", return_value=None)\\n@@ -289,7 +373,11 @@ def test_deploy_deployment(session_manager, mocker):\\n \\n @pytest.mark.commands\\n @pytest.mark.commands_deployment\\n-def test_create_module_deployment_role(session_manager, mocker):\\n+@pytest.mark.parametrize(\\n+    (\\\"manifest\\\", \\\"expected_role_prefix\\\"),\\n+    [(mock_deployment_manifest_huge, \\\"/\\\"), (mock_deployment_manifest_with_prefix, \\\"/test1/\\\")],\\n+)\\n+def test_create_module_deployment_role(session_manager, mocker, manifest, expected_role_prefix):\\n     mocker.patch(\\n         \\\"seedfarmer.commands._deployment_commands.get_generic_module_deployment_role_name\\\",\\n         return_value=\\\"generic-module-deployment-role\\\",\\n@@ -298,7 +386,7 @@ def test_create_module_deployment_role(session_manager, mocker):\\n         \\\"seedfarmer.commands._deployment_commands.create_module_deployment_role\\\", return_value=None\\n     )\\n \\n-    dep = DeploymentManifest(**mock_deployment_manifest_huge.deployment_manifest)\\n+    dep = DeploymentManifest(**manifest.deployment_manifest)\\n     dep.validate_and_set_module_defaults()\\n \\n     dc.create_generic_module_deployment_role(\\n@@ -313,6 +401,7 @@ def test_create_module_deployment_role(session_manager, mocker):\\n         permissions_boundary_arn=\\\"arn:aws:iam::123456789012:policy/boundary\\\",\\n         docker_credentials_secret=None,\\n         session=ANY,\\n+        role_prefix=expected_role_prefix,\\n     )\\n \\n \\n\",\"diff --git a/test/unit-test/test_commands_stack.py b/test/unit-test/test_commands_stack.py\\nindex ecd6e12..335a19a 100644\\n--- a/test/unit-test/test_commands_stack.py\\n+++ b/test/unit-test/test_commands_stack.py\\n@@ -1,4 +1,5 @@\\n import os\\n+from unittest.mock import ANY\\n \\n import pytest\\n import yaml\\n@@ -149,12 +150,15 @@ def test_deploy_module_stack(session_manager, mocker):\\n \\n @pytest.mark.commands\\n @pytest.mark.commands_stack\\n-def test_create_module_deployment_role(session_manager, mocker):\\n+@pytest.mark.parametrize(\\\"role_prefix\\\", [None, \\\"/\\\", \\\"/test/\\\"])\\n+def test_create_module_deployment_role(session_manager, mocker, role_prefix):\\n     mocker.patch(\\n         \\\"seedfarmer.commands._stack_commands.services.cfn.does_stack_exist\\\",\\n         return_value=(True, {\\\"ProjectPolicyARN\\\": \\\"arn\\\"}),\\n     )\\n-    mocker.patch(\\\"seedfarmer.commands._stack_commands.iam.create_check_iam_role\\\", return_value=None)\\n+    create_iam_role_mock = mocker.patch(\\n+        \\\"seedfarmer.commands._stack_commands.iam.create_check_iam_role\\\", return_value=None\\n+    )\\n     mocker.patch(\\n         \\\"seedfarmer.commands._stack_commands.commands.seedkit_deployed\\\",\\n         return_value=(True, \\\"stackname\\\", {\\\"SeedkitResourcesPolicyArn\\\": \\\"arn\\\"}),\\n@@ -171,6 +175,19 @@ def test_create_module_deployment_role(session_manager, mocker):\\n         group_name=\\\"group\\\",\\n         module_name=\\\"module\\\",\\n         docker_credentials_secret=\\\"fsfasdfsad\\\",\\n+        role_prefix=role_prefix,\\n+    )\\n+\\n+    create_iam_role_mock.assert_called_once_with(\\n+        project_name=\\\"myapp\\\",\\n+        deployment_name=\\\"myapp\\\",\\n+        group_name=\\\"group\\\",\\n+        module_name=\\\"module\\\",\\n+        trust_policy=ANY,\\n+        role_name=\\\"module-deployment-role\\\",\\n+        permissions_boundary_arn=None,\\n+        session=ANY,\\n+        role_prefix=role_prefix,\\n     )\\n \\n \"]", "hints_text": ""}
