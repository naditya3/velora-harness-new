{"instance_id": "1378354743464325", "repo": "opensearch-project/opensearch-sdk-py", "base_commit": "4e2af358705d020b16dbec428b97f88f234f7845", "problem_statement": "[BUG] StreamInput integer types are unsigned:\\n### What is the bug?\\r\\n\\r\\nThe `read_byte()`, `read_short()`, `read_int()`, and `read_long()` methods in `StreamInput` return unsigned integers.\\r\\n\\r\\n### How can one reproduce the bug?\\r\\n\\r\\nAttempt to deserialize any value with a negative sign bit, for example\\r\\n```py\\r\\ninput = StreamInput(b\"\\xff\")\\r\\nself.assertEqual(input.read_byte(), -1)\\r\\n```\\r\\n> AssertionError: 255 != -1\\r\\n\\r\\n```py\\r\\ninput = StreamInput(b\"\\xff\\xff\\xff\\xff\\\")\\r\\nself.assertEqual(input.read_int(), -1)\\r\\n```\\r\\n> AssertionError: 4294967295 != -1\\r\\n\\r\\n### What is the expected behavior?\\r\\n\\r\\nPython `int` value matches the signed Java value from OpenSearch\\r\\n\\r\\n### Do you have any additional context?\\r\\n\\r\\n![image](https://github.com/opensearch-project/opensearch-sdk-py/assets/9291703/4d665dc6-fd8b-42fe-a94b-a62750136165)\\r\\n", "FAIL_TO_PASS": ["tests/actions/test_response_handlers.py::TestResponseHandlers::test_register_handlers", "tests/transport/test_stream_input.py::TestStreamInput::test_read_long", "tests/actions/internal/test_register_rest_actions_response_handler.py::TestRegisterRestActionsResponseHandler::test_register_rest_actions_response_handler", "tests/actions/test_response_handlers.py::TestResponseHandlers::test_handle_unregistered", "tests/transport/test_stream_output.py::TestStreamOutput::test_write_byte_array", "tests/transport/test_stream_input.py::TestStreamInput::test_read_int", "tests/transport/test_stream_input.py::TestStreamInput::test_read_generic_value", "tests/transport/test_stream_output.py::TestStreamOutput::test_write_generic_value", "tests/transport/test_stream_input.py::TestStreamInput::test_read_short", "tests/transport/test_stream_input.py::TestStreamInput::test_read_optional_long", "tests/transport/test_stream_input.py::TestStreamInput::test_read_byte", "tests/transport/test_stream_input.py::TestStreamInput::test_read_optional_int", "tests/actions/test_response_handlers.py::TestResponseHandlers::test_handle", "tests/transport/test_stream_output.py::TestStreamOutput::test_write_array_list"], "PASS_TO_PASS": ["tests/transport/test_stream_input.py::TestStreamInput::test_read_v_int", "tests/transport/test_tcp_header.py::TestTcpHeader::test_tcp_header_stream", "tests/transport/test_transport_request.py::TestTransportRequest::test_transport_request", "tests/protobuf/test_register_rest_actions_proto.py::TestRegisterRestActionsProto_pb2::test_register_rest_actions", "tests/server/test_async_extension_host.py::TestAsyncExtensionHost::test_assigns_port", "tests/server/test_async_host.py::TestAsyncHost::test_init", "tests/transport/test_transport_address.py::TestTransportAddress::test_address_with_host", "tests/transport/test_thread_context_struct.py::TestThreadContextStruct::test_thread_context_struct_size", "tests/rest/test_extension_rest_response.py::TestExtensionRestResponse::test_initialize_extension_response", "tests/api/test_action_extension.py::TestActionExtension::test_named_routes", "tests/transport/test_stream_input.py::TestStreamInput::test_read_enum", "tests/transport/test_outbound_message_request.py::TestOutboundMessageRequest::test_outbound_message_request_stream", "tests/server/test_async_extension_host.py::TestAsyncExtensionHost::test_error_response", "tests/transport/test_stream_input.py::TestStreamInput::test_read_optional_string", "tests/transport/test_stream_input.py::TestStreamInput::test_read_string_to_string_array_dict", "tests/rest/test_named_route.py::TestNamedRoute::test_named_route", "tests/transport/test_outbound_message.py::TestOutboundMessage::test_outbound_message", "tests/transport/test_outbound_message_request.py::TestOutboundMessageRequest::test_custom_outbound_message_request", "tests/transport/test_initialize_extension_request.py::TestInitializeExtensionRequest::test_read_write", "tests/transport/test_stream_input.py::TestStreamInput::test_read_string_array", "tests/rest/test_extension_rest_handlers.py::TestExtensionRestHandlers::test_register_conflicts", "tests/transport/test_outbound_message_response.py::TestOutboundMessageResponse::test_outbound_message_response_stream", "tests/actions/internal/test_action_not_found_request_error_handler.py::TestActionNotFoundRequestHandler::test_handle", "tests/rest/test_rest_execute_on_extension_response.py::TestRestExecuteOnExtensionResponse::test_rest_execute_on_extension_request", "tests/rest/test_extension_rest_handlers.py::TestExtensionRestHandlers::test_register_handlers", "tests/transport/test_version.py::TestVersion::test_2_10_0_99_data", "tests/transport/test_outbound_message.py::TestOutboundMessage::test_outbound_message_message_bytes", "tests/server/test_async_host.py::TestAsyncHost::test_run", "tests/transport/test_acknowledged_response.py::TestAcknowledgedResponse::test_initialize_extension_response", "tests/transport/test_stream_input.py::TestStreamInput::test_read_string_to_string_set_dict", "tests/transport/test_tcp_header.py::TestTcpHeader::test_request_id", "tests/transport/test_transport_address.py::TestTransportAddress::test_address_invalid", "tests/transport/test_outbound_message_response.py::TestOutboundMessageResponse::test_custom_outbound_message_response", "tests/transport/test_dicovery_node.py::TestDiscoveryNode::test_discovery_node_read_write", "tests/transport/test_stream_output.py::TestStreamOutput::test_write_string_to_string_dict", "tests/actions/internal/test_action_not_found_request_error_handler.py::TestActionNotFoundRequestHandler::test_init", "tests/transport/test_stream_output.py::TestStreamOutput::test_write_string", "tests/transport/test_outbound_message.py::TestOutboundMessage::test_outbound_message_variable_bytes", "tests/transport/test_stream_output.py::TestStreamOutput::test_write_version", "tests/transport/test_transport_address.py::TestTransportAddress::test_address_no_host", "tests/transport/test_stream_output.py::TestStreamOutput::test_write_string_to_string_array_dict", "tests/transport/test_dicovery_node_role.py::TestDiscoveryNodeRole::test_role_dict", "tests/transport/test_stream_input.py::TestStreamInput::test_read_boolean", "tests/transport/test_thread_context_struct.py::TestThreadContextStruct::test_empty_thread_context_struct", "tests/transport/test_version.py::TestVersion::test_empty", "tests/transport/test_stream_output.py::TestStreamOutput::test_write_version_zero", "tests/transport/test_stream_input.py::TestStreamInput::test_read_v_long", "tests/rest/test_extension_rest_handler.py::TestExtensionRestHandler::test_default_handler", "tests/transport/test_stream_input.py::TestStreamInput::test_read_string", "tests/transport/test_stream_output.py::TestStreamOutput::test_write_enum", "tests/actions/test_request_handlers.py::TestRequestHandlers::test_handle", "tests/transport/test_stream_output.py::TestStreamOutput::test_write_boolean", "tests/rest/test_extension_rest_request.py::TestExtensionRestRequest::test_consuming", "tests/transport/test_dicovery_extension_node.py::TestDiscoveryExtensionNode::test_discovery_extension_node", "tests/transport/test_stream_input.py::TestStreamInput::test_read_array_size", "tests/protobuf/test_extension_identity_proto.py::TestExtensionIdentityProto_pb2::test_identity", "tests/server/test_async_host.py::TestAsyncHost::test_handle_error", "tests/transport/test_transport_service_handshake_request.py::TestTransportServiceHandshakeRequest::test_read_write_transport_handshake_request", "tests/transport/test_transport_service_handshake_response.py::TestTransportServiceHandshakeResponse::test_read_write_transport_handshake_response", "tests/transport/test_dicovery_node.py::TestDiscoveryNode::test_discovery_node", "tests/transport/test_stream_input.py::TestStreamInput::test_read_version", "tests/transport/test_transport_service_handshake_request.py::TestTransportServiceHandshakeRequest::test_transport_request", "tests/transport/test_network_message.py::TestNetworkMessage::test_network_message", "tests/rest/test_extension_rest_handlers.py::TestExtensionRestHandlers::test_register_wildcard_handlers", "tests/transport/test_outbound_message.py::TestOutboundMessage::test_outbound_message_stream", "tests/transport/test_transport_service_handshake_response.py::TestTransportServiceHandshakeResponse::test_transport_service_handshake_response", "tests/transport/test_initialize_extension_response.py::TestInitializeExtensionResponse::test_initialize_extension_response", "tests/server/test_async_extension_host.py::TestAsyncExtensionHost::test_run_unhandled_request_error", "tests/transport/test_task_id.py::TestTaskId::test_empty_task_id", "tests/actions/internal/test_request_error_handler.py::TestRequestErrorHandler::test_request_error_handler", "tests/server/test_async_extension_host.py::TestAsyncExtensionHost::test_init", "tests/test_extension.py::TestExtension::test_implemented_interfaces", "tests/transport/test_extension_dependency.py::TestExtensionDependency::test_extension_dependency", "tests/transport/test_stream_input.py::TestStreamInput::test_read_bytes", "tests/actions/internal/test_extensions_rest_request_handler.py::TestExtensionsRestRequestHandler::test_extension_rest_request_handler", "tests/transport/test_stream_output.py::TestStreamOutput::test_write_v_int", "tests/server/test_host.py::TestHost::test_init", "tests/rest/test_extension_rest_request.py::TestExtensionRestRequest::test_extension_rest_request", "tests/transport/test_transport_handshaker_handshake_response.py::TestTransportHandshakerHandshakeResponse::test_transport_handshaker_handshake_response", "tests/transport/test_outbound_message_response.py::TestOutboundMessageResponse::test_outbound_message_response_with_init", "tests/actions/internal/test_transport_handshake_request_handler.py::TestTransportHandshakeRequestHandler::test_transport_handhsake_request_handler", "tests/transport/test_stream_output.py::TestStreamOutput::test_write_string_array", "tests/actions/test_request_handlers.py::TestRequestHandlers::test_register_handlers", "tests/transport/test_thread_context_struct.py::TestThreadContextStruct::test_thread_context_struct_read", "tests/transport/test_transport_handshaker_handshake_request.py::TestTransportHandshakerHandshakeRequest::test_read_write", "tests/transport/test_outbound_message_response.py::TestOutboundMessageResponse::test_outbound_message_response", "tests/transport/test_stream_input.py::TestStreamInput::test_read_optional_v_long", "tests/transport/test_stream_output.py::TestStreamOutput::test_version_size", "tests/api/test_action_extension.py::TestActionExtension::test_implemented_interfaces", "tests/transport/test_version.py::TestVersion::test_2_10_0_99", "tests/server/test_async_host.py::TestAsyncHost::test_run_calls_async_run", "tests/transport/test_outbound_message_request.py::TestOutboundMessageRequest::test_outbound_message_request", "tests/transport/test_stream_input.py::TestStreamInput::test_read_string_to_string_dict", "tests/transport/test_tcp_header.py::TestTcpHeader::test_read_write", "tests/transport/test_thread_context_struct.py::TestThreadContextStruct::test_thread_context_struct_write", "tests/transport/test_stream_output.py::TestStreamOutput::test_write_int", "[", "tests/server/test_async_extension_host.py::TestAsyncExtensionHost::test_discovery_extensions_request", "tests/transport/test_initialize_extension_request.py::TestInitializeExtensionRequest::test_initialize_extension_request", "tests/transport/test_stream_input.py::TestStreamInput::test_read_optional_boolean", "tests/server/test_async_extension_host.py::TestAsyncExtensionHost::test_acknowledged_response", "tests/transport/test_register_rest_actions_request.py::TestRegisterRestActionsRequest::test_register_rest_actions_request", "tests/transport/test_transport_handshaker_handshake_request.py::TestTransportHandshakerHandshakeRequest::test_transport_request", "tests/transport/test_task_id.py::TestTaskId::test_task_id", "tests/transport/test_tcp_header.py::TestTcpHeader::test_auto_increment_id", "tests/transport/test_stream_input.py::TestStreamInput::test_read_optional_string_array", "tests/transport/test_stream_output.py::TestStreamOutput::test_write_string_to_string_set_dict", "tests/transport/test_tcp_header.py::TestTcpHeader::test_tcp_header", "tests/transport/test_stream_output.py::TestStreamOutput::test_write_byte", "tests/transport/test_stream_output.py::TestStreamOutput::test_version_zero_size", "tests/transport/test_stream_output.py::TestStreamOutput::test_write_long", "tests/actions/internal/test_tcp_handshake_request_handler.py::TestTcpHandshakeRequestHandler::test_tcp_handhsake_request_handler"], "language": "python", "test_command": "source /saved/ENV || source /saved/*/ENV && pytest --no-header -rA --tb=no -p no:cacheprovider --continue-on-collection-errors", "test_output_parser": "python/parse_log_pytest_v3", "image_storage_uri": "vmvm-registry.fbinfra.net/repomate_image_activ_pytest/opensearch-project_opensearch-sdk-py:4e2af358705d020b16dbec428b97f88f234f7845", "patch": "", "test_patch": "[\"diff --git a/tests/actions/internal/test_register_rest_actions_response_handler.py b/tests/actions/internal/test_register_rest_actions_response_handler.py\\nindex e019878..48fea29 100644\\n--- a/tests/actions/internal/test_register_rest_actions_response_handler.py\\n+++ b/tests/actions/internal/test_register_rest_actions_response_handler.py\\n@@ -23,13 +23,14 @@ class TestRegisterRestActionsResponseHandler(unittest.TestCase):\\n     def test_register_rest_actions_response_handler(self) -> None:\\n         input = StreamInput(bytes(OutboundMessageRequest(version=Version(2100099), message=AcknowledgedResponse(status=True))))\\n         omr = OutboundMessageRequest().read_from(input)\\n+        request = OutboundMessageRequest()\\n         next_handler = FakeResponseHandler()\\n-        output = RegisterRestActionsResponseHandler(next_handler).handle(omr, input)\\n+        output = RegisterRestActionsResponseHandler(next_handler, request).handle(omr, input)\\n         self.assertEqual(output, b\\\"test\\\")\\n \\n         input = StreamInput(bytes(OutboundMessageRequest(version=Version(2100099), message=AcknowledgedResponse(status=False))))\\n         omr = OutboundMessageRequest().read_from(input)\\n-        output = RegisterRestActionsResponseHandler(next_handler).handle(omr, input)\\n+        output = RegisterRestActionsResponseHandler(next_handler, request).handle(omr, input)\\n         self.assertIsNone(output)\\n \\n \\n@@ -37,5 +38,5 @@ class FakeResponseHandler(ResponseHandler):\\n     def handle(self, request: OutboundMessageRequest, input: StreamInput = None) -> Optional[bytes]:\\n         pass\\n \\n-    def send(self) -> StreamOutput:\\n+    def send(self, request: OutboundMessageRequest) -> StreamOutput:\\n         return b\\\"test\\\"\\n\",\"diff --git a/tests/actions/test_response_handlers.py b/tests/actions/test_response_handlers.py\\nindex 4c5033f..1e93498 100644\\n--- a/tests/actions/test_response_handlers.py\\n+++ b/tests/actions/test_response_handlers.py\\n@@ -11,7 +11,7 @@\\n from typing import Optional\\n \\n from opensearch_sdk_py.actions.internal.register_rest_actions_response_handler import RegisterRestActionsResponseHandler\\n-from opensearch_sdk_py.actions.request_handler import RequestHandler\\n+from opensearch_sdk_py.actions.response_handler import ResponseHandler\\n from opensearch_sdk_py.actions.response_handlers import ResponseHandlers\\n from opensearch_sdk_py.extension import Extension\\n from opensearch_sdk_py.transport.acknowledged_response import AcknowledgedResponse\\n@@ -30,8 +30,9 @@ def __init__(self) -> None:\\n     def setUp(self) -> None:\\n         self.extension = TestResponseHandlers.MyExtension()\\n         self.response_handlers = ResponseHandlers(self.extension)\\n-        next_handler = FakeRequestHandler(self.extension)\\n-        self.response_handlers.register(123, RegisterRestActionsResponseHandler(next_handler))\\n+        self.next_handler = FakeResponseHandler()\\n+        request = OutboundMessageRequest()\\n+        self.response_handlers.register(123, RegisterRestActionsResponseHandler(self.next_handler, request))\\n \\n     def test_register_handlers(self) -> None:\\n         self.assertEqual(len(self.response_handlers), 1)\\n@@ -42,8 +43,8 @@ def test_handle(self) -> None:\\n         input = StreamInput(bytes(AcknowledgedResponse(status=True)))\\n         output = self.response_handlers.handle(response, input)\\n         self.assertEqual(len(self.response_handlers), 0)\\n-        self.assertEqual(output, None)\\n-        self.assertEqual(self.extension.test, \\\"modified\\\")\\n+        self.assertIsNone(output)\\n+        self.assertEqual(self.next_handler.test, \\\"modified\\\")\\n \\n     def test_handle_unregistered(self) -> None:\\n         response = OutboundMessageResponse(request_id=1234)\\n@@ -52,13 +53,10 @@ def test_handle_unregistered(self) -> None:\\n         self.assertIsNone(output)\\n \\n \\n-class FakeRequestHandler(RequestHandler):\\n-    def __init__(self, extension: Extension) -> None:\\n-        super().__init__(\\\"test-extension\\\", extension)\\n-\\n+class FakeResponseHandler(ResponseHandler):\\n     def handle(self, request: OutboundMessageRequest, input: StreamInput = None) -> Optional[bytes]:\\n         return None\\n \\n-    def send(self) -> StreamOutput:\\n-        self.extension.test = \\\"modified\\\"\\n+    def send(self, request: OutboundMessageRequest) -> StreamOutput:\\n+        self.test = \\\"modified\\\"\\n         return None\\n\",\"diff --git a/tests/server/test_async_extension_host.py b/tests/server/test_async_extension_host.py\\nindex c51ea46..b350815 100644\\n--- a/tests/server/test_async_extension_host.py\\n+++ b/tests/server/test_async_extension_host.py\\n@@ -21,10 +21,11 @@\\n from opensearch_sdk_py.rest.rest_status import RestStatus\\n from opensearch_sdk_py.server.async_extension_host import AsyncExtensionHost\\n from opensearch_sdk_py.transport.acknowledged_response import AcknowledgedResponse\\n-from opensearch_sdk_py.transport.initialize_extension_response import InitializeExtensionResponse\\n+from opensearch_sdk_py.transport.extension_transport_request import ExtensionTransportRequest\\n from opensearch_sdk_py.transport.outbound_message_request import OutboundMessageRequest\\n from opensearch_sdk_py.transport.outbound_message_response import OutboundMessageResponse\\n from opensearch_sdk_py.transport.register_rest_actions_request import RegisterRestActionsRequest\\n+from opensearch_sdk_py.transport.request_type import RequestType\\n from opensearch_sdk_py.transport.stream_input import StreamInput\\n from opensearch_sdk_py.transport.tcp_header import TcpHeader\\n from opensearch_sdk_py.transport.version import Version\\n@@ -140,8 +141,8 @@ def test_acknowledged_response(self) -> None:\\n         assert responses[1] is not None\\n         reply: TestAsyncExtensionHost.Response = responses[1]\\n         self.assertEqual(reply.response.thread_context_struct.request_headers, {\\\"_system_index_access_allowed\\\": \\\"false\\\"})\\n-        init_response = InitializeExtensionResponse().read_from(reply.remaining_input)\\n-        self.assertEqual(init_response.name, \\\"hello-world\\\")\\n+        extension_request = ExtensionTransportRequest(RequestType.GET_SETTINGS).read_from(reply.remaining_input)\\n+        self.assertEqual(extension_request.er.requestType, RequestType.REQUEST_EXTENSION_ENVIRONMENT_SETTINGS.value)\\n \\n     def test_error_response(self) -> None:\\n         request1 = NettyTraceData.load(\\\"tests/transport/data/transport_service_handshake_request.txt\\\").data\\n\",\"diff --git a/tests/protobuf/test_extension_request_proto.py b/tests/protobuf/test_extension_request_proto.py\\nnew file mode 100644\\nindex 0000000..c51e4d8\\n--- /dev/null\\n+++ b/tests/protobuf/test_extension_request_proto.py\\n@@ -0,0 +1,36 @@\\n+#\\n+# Copyright OpenSearch Contributors\\n+# SPDX-License-Identifier: Apache-2.0\\n+#\\n+# The OpenSearch Contributors require contributions made to\\n+# this file be licensed under the Apache-2.0 license or a\\n+# compatible open source license.\\n+#\\n+\\n+import unittest\\n+\\n+from opensearch_sdk_py.protobuf import ExtensionRequestProto_pb2\\n+from opensearch_sdk_py.transport.request_type import RequestType\\n+\\n+\\n+class TestExtensionRequestProto_pb2(unittest.TestCase):\\n+    def test_extension_request(self) -> None:\\n+        request = ExtensionRequestProto_pb2.ExtensionRequest()\\n+        request.requestType = RequestType.GET_SETTINGS.value\\n+        request.identity.uniqueId = \\\"test\\\"\\n+        serialized_str = request.SerializeToString()\\n+\\n+        parsed_request = ExtensionRequestProto_pb2.ExtensionRequest()\\n+        parsed_request.ParseFromString(serialized_str)\\n+        self.assertEqual(parsed_request.requestType, RequestType.GET_SETTINGS.value)\\n+        self.assertEqual(parsed_request.identity.uniqueId, \\\"test\\\")\\n+\\n+    def test_extension_request_no_id(self) -> None:\\n+        request = ExtensionRequestProto_pb2.ExtensionRequest()\\n+        request.requestType = RequestType.GET_SETTINGS.value\\n+        serialized_str = request.SerializeToString()\\n+\\n+        parsed_request = ExtensionRequestProto_pb2.ExtensionRequest()\\n+        parsed_request.ParseFromString(serialized_str)\\n+        self.assertEqual(parsed_request.requestType, RequestType.GET_SETTINGS.value)\\n+        self.assertEqual(parsed_request.identity.uniqueId, \\\"\\\")\\n\",\"diff --git a/tests/transport/test_extension_transport_request.py b/tests/transport/test_extension_transport_request.py\\nnew file mode 100644\\nindex 0000000..3fcd15d\\n--- /dev/null\\n+++ b/tests/transport/test_extension_transport_request.py\\n@@ -0,0 +1,45 @@\\n+#\\n+# Copyright OpenSearch Contributors\\n+# SPDX-License-Identifier: Apache-2.0\\n+#\\n+# The OpenSearch Contributors require contributions made to\\n+# this file be licensed under the Apache-2.0 license or a\\n+# compatible open source license.\\n+#\\n+\\n+import unittest\\n+\\n+from opensearch_sdk_py.transport.extension_transport_request import ExtensionTransportRequest\\n+from opensearch_sdk_py.transport.request_type import RequestType\\n+from opensearch_sdk_py.transport.stream_input import StreamInput\\n+from opensearch_sdk_py.transport.stream_output import StreamOutput\\n+\\n+\\n+class TestExtensionTransportRequest(unittest.TestCase):\\n+    def test_extension_transport_request(self) -> None:\\n+        etr = ExtensionTransportRequest(RequestType.REQUEST_EXTENSION_ENVIRONMENT_SETTINGS, \\\"test\\\")\\n+        self.assertEqual(etr.er.requestType, RequestType.REQUEST_EXTENSION_ENVIRONMENT_SETTINGS.value)\\n+        self.assertEqual(etr.er.identity.uniqueId, \\\"test\\\")\\n+\\n+        out = StreamOutput()\\n+        etr.write_to(out)\\n+        etr = ExtensionTransportRequest(RequestType.GET_SETTINGS)\\n+        self.assertEqual(etr.er.requestType, RequestType.GET_SETTINGS.value)\\n+        self.assertEqual(etr.er.identity.uniqueId, \\\"\\\")\\n+        etr.read_from(input=StreamInput(out.getvalue()))\\n+        self.assertEqual(etr.er.requestType, RequestType.REQUEST_EXTENSION_ENVIRONMENT_SETTINGS.value)\\n+        self.assertEqual(etr.er.identity.uniqueId, \\\"test\\\")\\n+\\n+    def test_extension_transport_request_no_id(self) -> None:\\n+        etr = ExtensionTransportRequest(RequestType.REQUEST_EXTENSION_ENVIRONMENT_SETTINGS)\\n+        self.assertEqual(etr.er.requestType, RequestType.REQUEST_EXTENSION_ENVIRONMENT_SETTINGS.value)\\n+        self.assertEqual(etr.er.identity.uniqueId, \\\"\\\")\\n+\\n+        out = StreamOutput()\\n+        etr.write_to(out)\\n+        etr = ExtensionTransportRequest(RequestType.GET_SETTINGS)\\n+        self.assertEqual(etr.er.requestType, RequestType.GET_SETTINGS.value)\\n+        self.assertEqual(etr.er.identity.uniqueId, \\\"\\\")\\n+        etr.read_from(input=StreamInput(out.getvalue()))\\n+        self.assertEqual(etr.er.requestType, RequestType.REQUEST_EXTENSION_ENVIRONMENT_SETTINGS.value)\\n+        self.assertEqual(etr.er.identity.uniqueId, \\\"\\\")\\n\",\"diff --git a/tests/transport/test_stream_input.py b/tests/transport/test_stream_input.py\\nindex a4841fe..45869de 100644\\n--- a/tests/transport/test_stream_input.py\\n+++ b/tests/transport/test_stream_input.py\\n@@ -167,6 +167,42 @@ def test_read_string_to_string_set_dict(self) -> None:\\n         self.assertSetEqual(dict[\\\"foo\\\"], {\\\"bar\\\", \\\"baz\\\"})\\n         self.assertSetEqual(dict[\\\"qux\\\"], set())\\n \\n+    def test_read_generic_value(self) -> None:\\n+        # -1\\n+        input = StreamInput(b\\\"\\\\xff\\\")\\n+        self.assertIsNone(input.read_generic_value())\\n+        # 0\\n+        input = StreamInput(b\\\"\\\\x00\\\\x04test\\\")\\n+        self.assertEqual(input.read_generic_value(), \\\"test\\\")\\n+        # 1\\n+        input = StreamInput(b\\\"\\\\x01\\\\x00\\\\x00\\\\x00\\\\x2a\\\")\\n+        self.assertEqual(input.read_generic_value(), 42)\\n+        # 2\\n+        input = StreamInput(b\\\"\\\\x02\\\\x00\\\\x00\\\\x00\\\\x01\\\\x02\\\\x03\\\\x04\\\\x05\\\")\\n+        self.assertEqual(input.read_generic_value(), 4328719365)\\n+        # 5\\n+        input = StreamInput(b\\\"\\\\x05\\\\x01\\\")\\n+        self.assertEqual(input.read_generic_value(), True)\\n+        # 6\\n+        input = StreamInput(b\\\"\\\\x06\\\\x00\\\")\\n+        self.assertEqual(input.read_generic_value(), b\\\"\\\")\\n+        input = StreamInput(b\\\"\\\\x06\\\\x03\\\\x27\\\\x10\\\\x42\\\")\\n+        self.assertEqual(input.read_generic_value(), b\\\"\\\\x27\\\\x10\\\\x42\\\")\\n+        # 7\\n+        input = StreamInput(b\\\"\\\\x07\\\\x00\\\")\\n+        self.assertEqual(input.read_generic_value(), [])\\n+        input = StreamInput(b\\\"\\\\x07\\\\x02\\\\x00\\\\x03foo\\\\x00\\\\x03bar\\\")\\n+        self.assertEqual(input.read_generic_value(), [\\\"foo\\\", \\\"bar\\\"])\\n+        # 11\\n+        input = StreamInput(b\\\"\\\\x0b\\\\x2a\\\")\\n+        self.assertEqual(input.read_generic_value(), 42)\\n+        # 16\\n+        input = StreamInput(b\\\"\\\\x10\\\\x00\\\\x2a\\\")\\n+        self.assertEqual(input.read_generic_value(), 42)\\n+        # not implemented\\n+        input = StreamInput(b\\\"\\\\xfe\\\")\\n+        self.assertRaises(Exception, input.read_generic_value)\\n+\\n     def test_read_enum(self) -> None:\\n         TestEnum = Enum(\\\"TestEnum\\\", [\\\"FOO\\\", \\\"BAR\\\", \\\"BAZ\\\"], start=0)\\n         input = StreamInput(b\\\"\\\\x01\\\")\\n\",\"diff --git a/tests/transport/test_stream_input.py b/tests/transport/test_stream_input.py\\nindex 45869de..04419b2 100644\\n--- a/tests/transport/test_stream_input.py\\n+++ b/tests/transport/test_stream_input.py\\n@@ -15,24 +15,23 @@\\n \\n class TestStreamInput(unittest.TestCase):\\n     def test_read_byte(self) -> None:\\n-        input = StreamInput(b\\\"\\\\x2a\\\")\\n+        input = StreamInput(b\\\"\\\\x2a\\\\xff\\\")\\n         self.assertEqual(input.read_byte(), 42)\\n+        self.assertEqual(input.read_byte(), -1)\\n \\n     def test_read_bytes(self) -> None:\\n         input = StreamInput(b\\\"\\\\x27\\\\x10\\\\x42\\\")\\n         self.assertEqual(input.read_bytes(3), b\\\"\\\\x27\\\\x10\\\\x42\\\")\\n \\n     def test_read_int(self) -> None:\\n-        input = StreamInput(b\\\"\\\\x00\\\\x00\\\\x00\\\\x2a\\\\x00\\\\x00\\\\x00\\\\x2a\\\\x00\\\")\\n-        self.assertEqual(input.read_int(), 42)\\n+        input = StreamInput(b\\\"\\\\x00\\\\x00\\\\x00\\\\x2a\\\\xff\\\\xff\\\\xff\\\\xff\\\")\\n         self.assertEqual(input.read_int(), 42)\\n-        self.assertRaises(IndexError, input.read_int)\\n+        self.assertEqual(input.read_int(), -1)\\n \\n     def test_read_short(self) -> None:\\n-        input = StreamInput(b\\\"\\\\x12\\\\x34\\\\x56\\\\x78\\\\x90\\\")\\n+        input = StreamInput(b\\\"\\\\x12\\\\x34\\\\xff\\\\xff\\\")\\n         self.assertEqual(input.read_short(), 4660)\\n-        self.assertEqual(input.read_short(), 22136)\\n-        self.assertRaises(IndexError, input.read_short)\\n+        self.assertEqual(input.read_short(), -1)\\n \\n     def test_read_boolean(self) -> None:\\n         input = StreamInput(b\\\"\\\\x00\\\\x01\\\\x02\\\")\\n@@ -68,16 +67,15 @@ def test_read_version(self) -> None:\\n         self.assertEqual(str(v), \\\"2.10.0.99\\\")\\n \\n     def test_read_optional_int(self) -> None:\\n-        input = StreamInput(b\\\"\\\\x01\\\\x00\\\\x00\\\\x00\\\\x2a\\\\x00\\\\x01\\\")\\n+        input = StreamInput(b\\\"\\\\x01\\\\x00\\\\x00\\\\x00\\\\x2a\\\\x01\\\\xff\\\\xff\\\\xff\\\\xff\\\\x00\\\")\\n         self.assertEqual(input.read_optional_int(), 42)\\n+        self.assertEqual(input.read_optional_int(), -1)\\n         self.assertEqual(input.read_optional_int(), None)\\n-        self.assertRaises(IndexError, input.read_optional_int)\\n \\n     def test_read_long(self) -> None:\\n-        input = StreamInput(b\\\"\\\\x00\\\\x00\\\\x00\\\\x01\\\\x02\\\\x03\\\\x04\\\\x05\\\\x00\\\\x00\\\\x00\\\\x01\\\\x02\\\\x03\\\\x04\\\\x05\\\\x00\\\")\\n-        self.assertEqual(input.read_long(), 4328719365)\\n+        input = StreamInput(b\\\"\\\\x00\\\\x00\\\\x00\\\\x01\\\\x02\\\\x03\\\\x04\\\\x05\\\\xff\\\\xff\\\\xff\\\\xff\\\\xff\\\\xff\\\\xff\\\\xff\\\")\\n         self.assertEqual(input.read_long(), 4328719365)\\n-        self.assertRaises(IndexError, input.read_long)\\n+        self.assertEqual(input.read_long(), -1)\\n \\n     def test_read_v_long(self) -> None:\\n         input = StreamInput(b\\\"\\\\x2a\\\")\\n@@ -112,10 +110,10 @@ def test_read_optional_v_long(self) -> None:\\n         self.assertRaises(Exception, input.read_optional_v_long)\\n \\n     def test_read_optional_long(self) -> None:\\n-        input = StreamInput(b\\\"\\\\x01\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x2a\\\\x00\\\\x01\\\")\\n+        input = StreamInput(b\\\"\\\\x01\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x2a\\\\x01\\\\xff\\\\xff\\\\xff\\\\xff\\\\xff\\\\xff\\\\xff\\\\xff\\\\x00\\\")\\n         self.assertEqual(input.read_optional_long(), 42)\\n+        self.assertEqual(input.read_optional_long(), -1)\\n         self.assertEqual(input.read_optional_long(), None)\\n-        self.assertRaises(IndexError, input.read_optional_long)\\n \\n     def test_read_optional_string(self) -> None:\\n         input = StreamInput(b\\\"\\\\x01\\\\x04test\\\")\\n\",\"diff --git a/tests/transport/test_stream_output.py b/tests/transport/test_stream_output.py\\nindex 94df965..93ffa19 100644\\n--- a/tests/transport/test_stream_output.py\\n+++ b/tests/transport/test_stream_output.py\\n@@ -100,6 +100,11 @@ def test_write_long(self) -> None:\\n         out.write_long(5409454583320448)\\n         self.assertEqual(out.getvalue(), b\\\"\\\\x00\\\\x13\\\\x37\\\\xde\\\\xca\\\\xde\\\\x0f\\\\x80\\\")\\n \\n+    def test_write_byte_array(self) -> None:\\n+        out = StreamOutput()\\n+        out.write_byte_array(b\\\"test\\\")\\n+        self.assertEqual(out.getvalue(), b\\\"\\\\x04test\\\")\\n+\\n     def test_write_string(self) -> None:\\n         out = StreamOutput()\\n         out.write_string(\\\"test\\\")\\n@@ -149,6 +154,23 @@ def test_write_string_to_string_set_dict(self) -> None:\\n         )\\n         self.assertEqual(StreamOutput.string_to_string_collection_dict_size(d), len(out.getvalue()))\\n \\n+    def test_write_array_list(self) -> None:\\n+        out = StreamOutput()\\n+        out.write_array_list([\\\"foo\\\", \\\"bar\\\"])\\n+        self.assertEqual(out.getvalue(), b\\\"\\\\x02\\\\x00\\\\x03foo\\\\x00\\\\x03bar\\\")\\n+\\n+    def test_write_generic_value(self) -> None:\\n+        out = StreamOutput()\\n+        out.write_generic_value(None)\\n+        out.write_generic_value(\\\"test\\\")\\n+        out.write_generic_value(42)\\n+        out.write_generic_value(True)\\n+        self.assertEqual(out.getvalue(), b\\\"\\\\xff\\\\x00\\\\x04test\\\\x02\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x2a\\\\05\\\\01\\\")\\n+        out = StreamOutput()\\n+        out.write_generic_value(b\\\"test\\\")\\n+        out.write_generic_value([\\\"foo\\\", \\\"bar\\\"])\\n+        self.assertEqual(out.getvalue(), b\\\"\\\\x06\\\\x04test\\\\x07\\\\x02\\\\x00\\\\x03foo\\\\x00\\\\x03bar\\\")\\n+\\n     def test_write_enum(self) -> None:\\n         TestEnum = Enum(\\\"TestEnum\\\", [\\\"FOO\\\", \\\"BAR\\\", \\\"BAZ\\\"], start=0)\\n         out = StreamOutput()\\n\",\"diff --git a/tests/settings/test_settings.py b/tests/settings/test_settings.py\\nnew file mode 100644\\nindex 0000000..d179a8c\\n--- /dev/null\\n+++ b/tests/settings/test_settings.py\\n@@ -0,0 +1,46 @@\\n+#\\n+# Copyright OpenSearch Contributors\\n+# SPDX-License-Identifier: Apache-2.0\\n+#\\n+# The OpenSearch Contributors require contributions made to\\n+# this file be licensed under the Apache-2.0 license or a\\n+# compatible open source license.\\n+#\\n+\\n+import unittest\\n+\\n+from opensearch_sdk_py.settings.settings import Settings\\n+from opensearch_sdk_py.transport.stream_input import StreamInput\\n+from opensearch_sdk_py.transport.stream_output import StreamOutput\\n+\\n+\\n+class TestSettings(unittest.TestCase):\\n+    def test_settings(self) -> None:\\n+        settings = Settings()\\n+        self.assertIsNone(settings.get(\\\"bar\\\"))\\n+        self.assertEqual(settings.get(\\\"bar\\\", \\\"baz\\\"), \\\"baz\\\")\\n+\\n+    def test_settings_read_write(self) -> None:\\n+        settings = Settings({\\\"foo\\\": \\\"bar\\\", \\\"baz\\\": 42, \\\"qux\\\": True, \\\"bytes\\\": b\\\"test\\\", \\\"list\\\": [\\\"a\\\", \\\"b\\\", \\\"c\\\"]})\\n+        self.assertIsNone(settings.get(\\\"bar\\\"))\\n+        self.assertEqual(settings.get(\\\"bar\\\", \\\"baz\\\"), \\\"baz\\\")\\n+        self.assertEqual(settings.get(\\\"foo\\\"), \\\"bar\\\")\\n+        self.assertEqual(settings.get(\\\"foo\\\", \\\"baz\\\"), \\\"bar\\\")\\n+        self.assertEqual(settings.get(\\\"baz\\\"), \\\"42\\\")\\n+        self.assertEqual(settings.get(\\\"qux\\\"), \\\"True\\\")\\n+        self.assertEqual(settings.get(\\\"bytes\\\"), \\\"b'test'\\\")\\n+        self.assertEqual(settings.get(\\\"list\\\"), \\\"['a', 'b', 'c']\\\")\\n+\\n+        output = StreamOutput()\\n+        settings.write_to(output)\\n+        input = StreamInput(output.getvalue())\\n+        settings = Settings().read_from(input)\\n+\\n+        self.assertIsNone(settings.get(\\\"bar\\\"))\\n+        self.assertEqual(settings.get(\\\"bar\\\", \\\"baz\\\"), \\\"baz\\\")\\n+        self.assertEqual(settings.get(\\\"foo\\\"), \\\"bar\\\")\\n+        self.assertEqual(settings.get(\\\"foo\\\", \\\"baz\\\"), \\\"bar\\\")\\n+        self.assertEqual(settings.get(\\\"baz\\\"), \\\"42\\\")\\n+        self.assertEqual(settings.get(\\\"qux\\\"), \\\"True\\\")\\n+        self.assertEqual(settings.get(\\\"bytes\\\"), \\\"b'test'\\\")\\n+        self.assertEqual(settings.get(\\\"list\\\"), \\\"['a', 'b', 'c']\\\")\\n\",\"diff --git a/tests/transport/test_environment_settings_response.py b/tests/transport/test_environment_settings_response.py\\nnew file mode 100644\\nindex 0000000..94dc9f0\\n--- /dev/null\\n+++ b/tests/transport/test_environment_settings_response.py\\n@@ -0,0 +1,32 @@\\n+#\\n+# Copyright OpenSearch Contributors\\n+# SPDX-License-Identifier: Apache-2.0\\n+#\\n+# The OpenSearch Contributors require contributions made to\\n+# this file be licensed under the Apache-2.0 license or a\\n+# compatible open source license.\\n+#\\n+\\n+import unittest\\n+\\n+from opensearch_sdk_py.settings.settings import Settings\\n+from opensearch_sdk_py.transport.environment_settings_response import EnvironmentSettingsResponse\\n+from opensearch_sdk_py.transport.stream_input import StreamInput\\n+from opensearch_sdk_py.transport.stream_output import StreamOutput\\n+\\n+\\n+class TestEnvironmentSettingsResponse(unittest.TestCase):\\n+    def test_environment_settings_response(self) -> None:\\n+        esr = EnvironmentSettingsResponse()\\n+        self.assertIsNone(esr.environment_settings)\\n+\\n+        settings = Settings({\\\"foo\\\": \\\"bar\\\"})\\n+        esr = EnvironmentSettingsResponse(settings)\\n+        self.assertEqual(esr.environment_settings.get(\\\"foo\\\"), \\\"bar\\\")\\n+\\n+        out = StreamOutput()\\n+        esr.write_to(out)\\n+        input = StreamInput(out.getvalue())\\n+        esr = EnvironmentSettingsResponse().read_from(input)\\n+\\n+        self.assertEqual(esr.environment_settings.get(\\\"foo\\\"), \\\"bar\\\")\\n\",\"diff --git a/tests/actions/internal/test_environment_settings_response_handler.py b/tests/actions/internal/test_environment_settings_response_handler.py\\nnew file mode 100644\\nindex 0000000..c21f8fc\\n--- /dev/null\\n+++ b/tests/actions/internal/test_environment_settings_response_handler.py\\n@@ -0,0 +1,38 @@\\n+#\\n+# Copyright OpenSearch Contributors\\n+# SPDX-License-Identifier: Apache-2.0\\n+#\\n+# The OpenSearch Contributors require contributions made to\\n+# this file be licensed under the Apache-2.0 license or a\\n+# compatible open source license.\\n+#\\n+\\n+import unittest\\n+from typing import Optional\\n+\\n+from opensearch_sdk_py.actions.internal.environment_settings_response_handler import EnvironmentSettingsResponseHandler\\n+from opensearch_sdk_py.actions.response_handler import ResponseHandler\\n+from opensearch_sdk_py.settings.settings import Settings\\n+from opensearch_sdk_py.transport.environment_settings_response import EnvironmentSettingsResponse\\n+from opensearch_sdk_py.transport.outbound_message_request import OutboundMessageRequest\\n+from opensearch_sdk_py.transport.stream_input import StreamInput\\n+from opensearch_sdk_py.transport.stream_output import StreamOutput\\n+from opensearch_sdk_py.transport.version import Version\\n+\\n+\\n+class TestEnvironmentSettingsResponseHandler(unittest.TestCase):\\n+    def test_environment_settings_response_handler(self) -> None:\\n+        settings = Settings({\\\"foo\\\": \\\"bar\\\"})\\n+        input = StreamInput(bytes(OutboundMessageRequest(version=Version(2100099), message=EnvironmentSettingsResponse(settings))))\\n+        omr = OutboundMessageRequest().read_from(input)\\n+        next_handler = FakeResponseHandler()\\n+        output = EnvironmentSettingsResponseHandler(next_handler).handle(omr, input)\\n+        self.assertEqual(output, b\\\"test\\\")\\n+\\n+\\n+class FakeResponseHandler(ResponseHandler):\\n+    def handle(self, input: StreamInput = None) -> Optional[bytes]:\\n+        pass\\n+\\n+    def send(self) -> StreamOutput:\\n+        return b\\\"test\\\"\"]", "hints_text": ""}
