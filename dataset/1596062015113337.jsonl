{"instance_id": "1596062015113337", "repo": "xnuinside/simple-ddl-parser", "base_commit": "b467444e32e4c0fc09b9758cf284fcb73e232f12", "problem_statement": "ALTER Constraint UNIQUE must be showed in column also:\\nIssue was reported here: https://github.com/xnuinside/simple-ddl-parser/issues/99\\r\\n\\r\\nThis is a big help. It parses without throwing an exception now! I think there's still room for improvement in understanding the meaning of the Postgres schema. For example, the DDL contains\\r\\n\\r\\nALTER TABLE ONLY public.accounts ADD CONSTRAINT accounts_username_key UNIQUE (username);\\r\\n\\r\\nBut in the parsed output, we see:\\r\\n\\r\\n   {'name': 'username',\\r\\n    'type': 'character varying',\\r\\n    'size': 50,\\r\\n    'references': None,\\r\\n    'unique': False, <======= should be True?\\r\\n    'nullable': False,\\r\\n    'default': None,\\r\\n    'check': None},\\r\\nBut the bug I reported is fixed, so closing this issue.", "FAIL_TO_PASS": ["tests/test_mssql_specific.py::test_output_separated_by_go_and_textimage", "tests/test_indexes.py::test_clustered_index", "tests/test_mssql_specific.py::test_with_on_with_properties", "tests/test_mssql_specific.py::test_int_identity_type", "tests/test_mssql_specific.py::test_defaults_in_alter", "tests/test_alter_statements.py::test_alter_table_if_exists", "tests/test_mssql_specific.py::test_constraint_unique", "tests/test_simple_ddl_parser.py::test_ddl_properties", "tests/test_comments.py::test_inline_comment", "tests/test_simple_ddl_parser.py::test_defaults_with_comments", "tests/test_comments.py::test_mysql_comments_support", "tests/test_mssql_specific.py::test_two_unique_constructs", "tests/test_indexes.py::test_several_indexes_types", "tests/test_mssql_specific.py::test_foreign_keys", "tests/test_mssql_specific.py::test_with_on_table_level", "tests/test_mssql_specific.py::test_constraint_with_with", "tests/test_mssql_specific.py::test_primary_key_clustered", "tests/test_mssql_specific.py::test_constraint_unique_none", "tests/test_mssql_specific.py::test_mssql_foreign_ref_in_column", "tests/test_mssql_specific.py::test_alter_unique", "tests/test_alter_statements.py::test_alter_table_only", "tests/test_comments.py::test_block_comments"], "PASS_TO_PASS": ["tests/test_bigquery.py::test_cluster_by_without_brackets", "tests/test_simple_ddl_parser.py::test_default_null", "tests/test_simple_ddl_parser.py::test_parser_multiple_tables", "tests/test_redshift_dialect.py::test_distkey_sortkey", "tests/test_comments.py::test_two_defices_in_string_work_ok", "tests/test_hql_output_mode.py::test_partitioned_by_multiple_columns", "tests/test_snowflake.py::test_clone_table", "tests/test_bigquery.py::test_option_in_create_table", "tests/test_snowflake.py::test_clone_db", "tests/test_after_columns_statements.py::test_location_parsed_but_not_showed", "tests/test_mssql_specific.py::test_with_on", "tests/test_bigquery.py::test_two_options_values", "tests/test_hql_output_mode.py::test_skewed_by", "tests/test_mssql_specific.py::test_on_primary_on_table_level", "tests/test_redshift_dialect.py::test_base_encode", "tests/test_simple_ddl_parser.py::test_schema_with_authorisation", "tests/test_after_columns_statements.py::test_fields_terminated_by_not_showed", "tests/test_ddl_settings.py::test_parse_validly_tables_after_set", "tests/test_mssql_specific.py::test_period_for_system_time", "tests/test_mysql.py::test_on_update_with_fcall", "tests/test_hql_output_mode.py::test_allow_use_tags_in_column_names", "tests/test_snowflake.py::test_clone_schema", "tests/test_hql_output_mode.py::test_comment_and_lines", "tests/test_redshift_dialect.py::test_distyle", "tests/test_custom_types_and_domains.py::test_custom_enum", "tests/test_simple_ddl_parser.py::test_like_statement", "tests/test_mssql_specific.py::test_max_supported_as_column_size", "tests/test_simple_ddl_parser.py::test_generated_always", "tests/test_redshift_dialect.py::test_encode_for_full_table", "tests/test_redshift_dialect.py::test_like_in_parath", "tests/test_bigquery.py::test_ars_in_arrays_in_option", "tests/test_simple_ddl_parser.py::test_unique_statement_in_columns", "tests/test_after_columns_statements.py::test_map_keys_terminated_not_showed", "tests/test_after_columns_statements.py::test_tablespace_statement", "tests/test_hql_output_mode.py::test_fields_terminated_by_hql", "tests/test_oracle.py::test_oracle_output_mode", "tests/test_bigquery.py::test_options_in_column", "tests/test_hql_output_mode.py::test_comment_without_null_statement", "tests/test_after_columns_statements.py::test_stored_as_parsed_but_not_showed", "tests/test_alter_statements.py::test_alter_check", "tests/test_after_columns_statements.py::test_row_format_is_not_showed", "tests/test_bigquery.py::test_multiple_options_statements", "tests/test_simple_ddl_parser.py::test_run_postgres_first_query", "tests/test_after_columns_statements.py::test_collection_items_terminated_by_not_showed", "tests/test_alter_statements.py::test_alter_check_combine_all_variants", "tests/test_simple_ddl_parser.py::test_domains", "tests/test_references.py::test_defferable_initially", "tests/test_simple_ddl_parser.py::test_generated_always_with_concat", "tests/test_bigquery.py::test_simple_struct", "tests/test_redshift_dialect.py::test_create_temp_table", "tests/test_simple_ddl_parser.py::test_tabs_not_fails_ddl", "tests/test_simple_ddl_parser.py::test_comments_in_columns", "tests/test_simple_ddl_parser.py::test_escaping_symbols_normal_str", "tests/test_simple_ddl_parser.py::test_default_and_primary_inline", "tests/test_alter_statements.py::test_alter_foreign_with_multiple_ids", "tests/test_hql_output_mode.py::test_map_keys_terminated_by_hql", "tests/test_after_columns_statements.py::test_partitioned_by_postgresql", "tests/test_read_from_file.py::test_parse_from_file_one_table", "tests/test_bigquery.py::test_project_id_in_alter_and_references", "tests/test_indexes.py::test_indexes_in_table_wint_no_schema", "tests/test_custom_types_and_domains.py::test_create_type_as_object", "tests/test_references.py::test_references", "tests/test_simple_ddl_parser.py::test_schema_with_project_name", "tests/test_simple_ddl_parser.py::test_default_expression", "tests/test_bigquery.py::test_table_name_with_project_id", "tests/test_simple_ddl_parser.py::test_run_query_caps_in_columns", "tests/test_bigquery.py::test_two_options_in_create_table", "tests/test_indexes.py::test_indexes_in_table", "tests/test_hql_output_mode.py::test_complex_structure_test_hql", "tests/test_after_columns_statements.py::test_partition_by_without_parths", "tests/test_sequences.py::test_only_sequence", "tests/test_hql_output_mode.py::test_special_characters_in_comment", "tests/test_simple_ddl_parser.py::test_schema", "tests/test_hql_output_mode.py::test_stored_as_hql_showed", "tests/test_simple_ddl_parser.py::test_check_with_constraint", "tests/test_sequences.py::test_sequence_with_by", "tests/non_statement_tests/test_args.py::test_json_dump_arg", "tests/test_custom_types_and_domains.py::test_create_type_with_input_properties", "tests/test_alter_statements.py::test_several_alter_fk_for_same_table", "tests/test_references.py::test_references_on", "tests/test_read_from_file.py::test_parse_from_file_two_statements", "tests/test_simple_ddl_parser.py::test_collate", "tests/test_simple_ddl_parser.py::test_column_names_with_names_like_tokens_works_well", "tests/test_references.py::test_ref_in_alter", "tests/test_oracle.py::test_partition_by", "tests/test_hql_output_mode.py::test_collection_items_terminated_by_hql", "tests/non_statement_tests/test_common.py::test_no_unexpected_logs", "tests/test_hql_output_mode.py::test_table_properties", "tests/test_mssql_specific.py::test_constraint_primary_key", "tests/test_oracle.py::test_storage", "tests/test_simple_ddl_parser.py::test_tablespaces_temporary", "tests/test_simple_ddl_parser.py::test_parse_table_name_table", "tests/test_sequences.py::test_add_support_no_value", "tests/test_simple_ddl_parser.py::test_method_in_check", "tests/test_snowflake.py::test_cluster_by", "tests/test_mssql_specific.py::test_next_value_for", "tests/test_simple_ddl_parser.py::test_enum_in_lowercase", "tests/test_oracle.py::test_encrypt", "tests/test_alter_statements.py::test_alter_foreiggn_with_constraint", "tests/test_simple_ddl_parser.py::test_unique_statement_separate_line", "tests/test_alter_statements.py::test_alter_without_constraint_and_constraint_in_table", "tests/test_simple_ddl_parser.py::test_output_without_separator_in_statements", "tests/test_simple_ddl_parser.py::test_check_in_column", "tests/test_after_columns_statements.py::test_tablespace_with_properties", "tests/test_bigquery.py::test_multiple_options", "tests/test_hql_output_mode.py::test_simple_serde", "tests/test_alter_statements.py::test_alter_check_with_constraint", "tests/test_simple_ddl_parser.py::test_tablespace_small_big", "tests/test_hql_output_mode.py::test_output_input_format", "tests/test_hql_output_mode.py::test_with_serde_properties", "tests/test_simple_ddl_parser.py::test_create_database", "tests/test_bigquery.py::test_long_string_in_option", "tests/test_simple_ddl_parser.py::test_quotes", "tests/test_simple_ddl_parser.py::test_arrays", "tests/test_after_columns_statements.py::test_partitioned_by_hql", "tests/test_custom_types_and_domains.py::test_as_table", "tests/test_mysql.py::test_simple_on_update", "tests/test_hql_output_mode.py::test_hql_row_format", "tests/test_ddl_settings.py::test_sets_with_dot_and_comma", "tests/test_bigquery.py::test_dataset_in_output", "tests/test_simple_ddl_parser.py::test_added_create_tablespace", "tests/test_simple_ddl_parser.py::test_group_by_type_output", "tests/test_create_database.py::test_parse_properties_in_create_db", "tests/test_bigquery.py::test_schema_options", "tests/test_redshift_dialect.py::test_interleaved_sortkey_also_ok", "tests/test_hql_output_mode.py::test_location_showed", "tests/test_simple_ddl_parser.py::test_lines_starts_with_statement_keys", "tests/test_references.py::test_deferrable_initially_not", "tests/test_alter_statements.py::test_combo_with_alter_and_table_constraints", "tests/test_mssql_specific.py::test_mysql_constraint_pk", "tests/test_custom_types_and_domains.py::test_custom_enum_wihtout_schema", "tests/test_hql_output_mode.py::test_partitioned_by_hql_output_mode_hql", "tests/test_simple_ddl_parser.py::test_do_not_fail_on_brackets_in_default", "tests/test_sequences.py::test_sequence_and_table", "tests/test_alter_statements.py::test_alter_table_initial_support", "tests/test_snowflake.py::test_enforced", "tests/test_references.py::test_references_with_schema", "tests/test_simple_ddl_parser.py::test_escaping_symbols_raw_string"], "language": "python", "test_command": "source /saved/ENV || source /saved/*/ENV && pytest --no-header -rA --tb=no -p no:cacheprovider --continue-on-collection-errors", "test_output_parser": "python/parse_log_pytest_v3", "image_storage_uri": "vmvm-registry.fbinfra.net/repomate_image_activ_pytest/xnuinside_simple-ddl-parser:b467444e32e4c0fc09b9758cf284fcb73e232f12", "patch": "", "test_patch": "[\"diff --git a/tests/test_comments.py b/tests/test_comments.py\\nindex df30476..380ab7a 100644\\n--- a/tests/test_comments.py\\n+++ b/tests/test_comments.py\\n@@ -98,7 +98,8 @@ def test_inline_comment():\\n             \\\"partitioned_by\\\": [],\\n             \\\"table_name\\\": \\\"user_history\\\",\\n             \\\"tablespace\\\": None,\\n-        }\\n+        },\\n+        {\\\"comments\\\": [\\\" group_id or role_id\\\"]},\\n     ]\\n     assert expected == parse_result\\n \\n@@ -173,7 +174,8 @@ def test_block_comments():\\n             \\\"partitioned_by\\\": [],\\n             \\\"table_name\\\": \\\"A\\\",\\n             \\\"tablespace\\\": None,\\n-        }\\n+        },\\n+        {\\\"comments\\\": [\\\" outer comment start\\\", \\\" inner comment */\\\"]},\\n     ]\\n     assert expected == parse_result\\n \\n@@ -198,7 +200,7 @@ def test_mysql_comments_support():\\n     );\\n     \\\"\\\"\\\"\\n     parse_result = DDLParser(ddl).run()\\n-    expected = expected = [\\n+    expected = [\\n         {\\n             \\\"columns\\\": [\\n                 {\\n@@ -250,7 +252,8 @@ def test_mysql_comments_support():\\n             \\\"partitioned_by\\\": [],\\n             \\\"table_name\\\": \\\"A\\\",\\n             \\\"tablespace\\\": None,\\n-        }\\n+        },\\n+        {\\\"comments\\\": [\\\" outer comment start\\\", \\\" inner comment */\\\"]},\\n     ]\\n     assert expected == parse_result\\n \\n\",\"diff --git a/tests/test_indexes.py b/tests/test_indexes.py\\nindex 11ed936..cd1b52b 100644\\n--- a/tests/test_indexes.py\\n+++ b/tests/test_indexes.py\\n@@ -40,6 +40,7 @@ def test_several_indexes_types():\\n \\n     result = DDLParser(ddl).run(group_by_type=True, output_mode=\\\"mssql\\\")\\n     expected = {\\n+        \\\"comments\\\": [\\\" NOTE THE IDENTITY\\\"],\\n         \\\"sequences\\\": [],\\n         \\\"ddl_properties\\\": [],\\n         \\\"domains\\\": [],\\n@@ -374,6 +375,7 @@ def test_clustered_index():\\n \\n     result = DDLParser(ddl).run(group_by_type=True, output_mode=\\\"mssql\\\")\\n     expected = {\\n+        \\\"comments\\\": [\\\" NOTE\\\"],\\n         \\\"sequences\\\": [],\\n         \\\"domains\\\": [],\\n         \\\"schemas\\\": [],\\n\",\"diff --git a/tests/test_mssql_specific.py b/tests/test_mssql_specific.py\\nindex 450e6f1..32ff3f8 100644\\n--- a/tests/test_mssql_specific.py\\n+++ b/tests/test_mssql_specific.py\\n@@ -12,6 +12,7 @@ def test_int_identity_type():\\n \\n     result = DDLParser(ddl).run(group_by_type=True)\\n     expected = {\\n+        \\\"comments\\\": [\\\" NOTE\\\"],\\n         \\\"ddl_properties\\\": [],\\n         \\\"sequences\\\": [],\\n         \\\"domains\\\": [],\\n@@ -68,6 +69,7 @@ def test_mssql_foreign_ref_in_column():\\n \\n     result = DDLParser(ddl).run(group_by_type=True)\\n     expected = {\\n+        \\\"comments\\\": [\\\" NOTE\\\"],\\n         \\\"ddl_properties\\\": [],\\n         \\\"sequences\\\": [],\\n         \\\"domains\\\": [],\\n@@ -194,6 +196,7 @@ def test_constraint_unique():\\n \\n     result = DDLParser(ddl).run(group_by_type=True)\\n     expected = {\\n+        \\\"comments\\\": [\\\" NOTE\\\"],\\n         \\\"sequences\\\": [],\\n         \\\"ddl_properties\\\": [],\\n         \\\"domains\\\": [],\\n@@ -268,6 +271,7 @@ def test_constraint_unique_none():\\n \\n     result = DDLParser(ddl).run(group_by_type=True, output_mode=\\\"mssql\\\")\\n     expected = {\\n+        \\\"comments\\\": [\\\" NOTE\\\"],\\n         \\\"sequences\\\": [],\\n         \\\"ddl_properties\\\": [],\\n         \\\"domains\\\": [],\\n@@ -365,6 +369,7 @@ def test_two_unique_constructs():\\n \\n     result = DDLParser(ddl).run(group_by_type=True)\\n     expected = {\\n+        \\\"comments\\\": [\\\" NOTE\\\"],\\n         \\\"sequences\\\": [],\\n         \\\"ddl_properties\\\": [],\\n         \\\"domains\\\": [],\\n@@ -748,6 +753,7 @@ def test_foreign_keys():\\n \\n     result = DDLParser(ddl).run(group_by_type=True)\\n     expected = {\\n+        \\\"comments\\\": [\\\" NOTE\\\"],\\n         \\\"sequences\\\": [],\\n         \\\"domains\\\": [],\\n         \\\"schemas\\\": [],\\n@@ -1096,6 +1102,7 @@ def test_alter_unique():\\n \\n     result = DDLParser(ddl).run(group_by_type=True)\\n     expected = {\\n+        \\\"comments\\\": [\\\" NOTE\\\"],\\n         \\\"sequences\\\": [],\\n         \\\"ddl_properties\\\": [],\\n         \\\"domains\\\": [],\\n@@ -1481,6 +1488,7 @@ def test_defaults_in_alter():\\n \\n     result = DDLParser(ddl).run(group_by_type=True, output_mode=\\\"mssql\\\")\\n     expected = {\\n+        \\\"comments\\\": [\\\" NOTE\\\"],\\n         \\\"sequences\\\": [],\\n         \\\"ddl_properties\\\": [],\\n         \\\"domains\\\": [],\\n@@ -1867,6 +1875,10 @@ def test_constraint_with_with():\\n         ALLOW_PAGE_LOCKS = ON))\\\"\\\"\\\"\\n     result = DDLParser(ddl).run(group_by_type=True)\\n     expected = {\\n+        \\\"comments\\\": [\\n+            \\\"***** Object:  Table [dbo].[users_WorkSchedule]    Script Date: \\\"\\n+            \\\"9/29/2021 9:55:26 PM ******/\\\"\\n+        ],\\n         \\\"ddl_properties\\\": [\\n             {\\\"name\\\": \\\"ANSI_NULLS\\\", \\\"value\\\": \\\"ON\\\"},\\n             {\\\"name\\\": \\\"QUOTED_IDENTIFIER\\\", \\\"value\\\": \\\"ON\\\"},\\n@@ -2360,6 +2372,10 @@ def test_with_on_table_level():\\n     )\\\"\\\"\\\"\\n     result = DDLParser(ddl).run(group_by_type=True)\\n     expected = {\\n+        \\\"comments\\\": [\\n+            \\\"***** Object:  Table [dbo].[users_WorkSchedule]    Script Date: \\\"\\n+            \\\"9/29/2021 9:55:26 PM ******/\\\"\\n+        ],\\n         \\\"ddl_properties\\\": [\\n             {\\\"name\\\": \\\"ANSI_NULLS\\\", \\\"value\\\": \\\"ON\\\"},\\n             {\\\"name\\\": \\\"QUOTED_IDENTIFIER\\\", \\\"value\\\": \\\"ON\\\"},\\n@@ -2447,6 +2463,10 @@ def test_with_on_with_properties():\\n )\\\"\\\"\\\"\\n     result = DDLParser(ddl).run(group_by_type=True)\\n     expected = {\\n+        \\\"comments\\\": [\\n+            \\\"***** Object:  Table [dbo].[users_WorkSchedule]    Script Date: \\\"\\n+            \\\"9/29/2021 9:55:26 PM ******/\\\"\\n+        ],\\n         \\\"ddl_properties\\\": [\\n             {\\\"name\\\": \\\"ANSI_NULLS\\\", \\\"value\\\": \\\"ON\\\"},\\n             {\\\"name\\\": \\\"QUOTED_IDENTIFIER\\\", \\\"value\\\": \\\"ON\\\"},\\n@@ -2590,6 +2610,10 @@ def test_output_separated_by_go_and_textimage():\\n GO\\\"\\\"\\\"\\n     result = DDLParser(ddl).run(group_by_type=True)\\n     expected = {\\n+        \\\"comments\\\": [\\n+            \\\"***** Object:  Table [dbo].[TO_Requests]    Script Date: \\\"\\n+            \\\"9/29/2021 9:55:26 PM ******/\\\"\\n+        ],\\n         \\\"ddl_properties\\\": [\\n             {\\\"name\\\": \\\"ANSI_NULLS\\\", \\\"value\\\": \\\"ON\\\"},\\n             {\\\"name\\\": \\\"QUOTED_IDENTIFIER\\\", \\\"value\\\": \\\"ON\\\"},\\n@@ -2959,6 +2983,10 @@ def test_primary_key_clustered():\\n     GO\\\"\\\"\\\"\\n     result = DDLParser(ddl).run(group_by_type=True)\\n     expected = {\\n+        \\\"comments\\\": [\\n+            \\\"***** Object:  Table [aud].[tcal_tgt]    Script Date: \\\"\\n+            \\\"11/11/2021 11:18:41 AM ******/\\\"\\n+        ],\\n         \\\"ddl_properties\\\": [\\n             {\\\"name\\\": \\\"ANSI_NULLS\\\", \\\"value\\\": \\\"ON\\\"},\\n             {\\\"name\\\": \\\"QUOTED_IDENTIFIER\\\", \\\"value\\\": \\\"ON\\\"},\\n\",\"diff --git a/tests/test_simple_ddl_parser.py b/tests/test_simple_ddl_parser.py\\nindex 669e1d0..3de64cb 100644\\n--- a/tests/test_simple_ddl_parser.py\\n+++ b/tests/test_simple_ddl_parser.py\\n@@ -888,7 +888,8 @@ def test_defaults_with_comments():\\n             \\\"schema\\\": \\\"v2\\\",\\n             \\\"table_name\\\": \\\"entitlement_requests\\\",\\n             \\\"tablespace\\\": None,\\n-        }\\n+        },\\n+        {\\\"comments\\\": [\\\" inline comment\\\", \\\" inline comment\\\", \\\" inline comment\\\"]},\\n     ]\\n     assert expected == result\\n \\n@@ -2137,6 +2138,9 @@ def test_ddl_properties():\\n         \\\"sequences\\\": [],\\n         \\\"tables\\\": [],\\n         \\\"types\\\": [],\\n+        \\\"comments\\\": [\\n+            \\\"***** Object:  Table [dbo].[users_WorkSchedule]    Script Date: 9/29/2021 9:55:26 PM ******/\\\"\\n+        ],\\n     }\\n \\n     assert result == expected\\n\",\"diff --git a/tests/test_alter_statements.py b/tests/test_alter_statements.py\\nindex d640a94..f4531ce 100644\\n--- a/tests/test_alter_statements.py\\n+++ b/tests/test_alter_statements.py\\n@@ -1433,3 +1433,215 @@ def test_several_alter_fk_for_same_table():\\n         },\\n     ]\\n     assert expected == parse_results\\n+\\n+\\n+def test_alter_table_only():\\n+    ddl = \\\"\\\"\\\"\\n+        \\n+    CREATE TABLE public.accounts (\\n+        user_id integer NOT NULL,\\n+        username character varying(50) NOT NULL,\\n+        password character varying(50) NOT NULL,\\n+        email character varying(255) NOT NULL,\\n+        created_on timestamp without time zone NOT NULL,\\n+        last_login timestamp without time zone\\n+    );\\n+    ALTER TABLE ONLY public.accounts\\n+        ADD CONSTRAINT accounts_username_key UNIQUE (username);\\n+        \\\"\\\"\\\"\\n+    result = DDLParser(ddl).run(group_by_type=True, output_mode=\\\"bigquery\\\")\\n+    expected = {\\n+        \\\"ddl_properties\\\": [],\\n+        \\\"domains\\\": [],\\n+        \\\"schemas\\\": [],\\n+        \\\"sequences\\\": [],\\n+        \\\"tables\\\": [\\n+            {\\n+                \\\"alter\\\": {\\n+                    \\\"uniques\\\": [\\n+                        {\\n+                            \\\"columns\\\": [\\\"username\\\"],\\n+                            \\\"constraint_name\\\": \\\"accounts_username_key\\\",\\n+                        }\\n+                    ]\\n+                },\\n+                \\\"checks\\\": [],\\n+                \\\"columns\\\": [\\n+                    {\\n+                        \\\"check\\\": None,\\n+                        \\\"default\\\": None,\\n+                        \\\"name\\\": \\\"user_id\\\",\\n+                        \\\"nullable\\\": False,\\n+                        \\\"references\\\": None,\\n+                        \\\"size\\\": None,\\n+                        \\\"type\\\": \\\"integer\\\",\\n+                        \\\"unique\\\": False,\\n+                    },\\n+                    {\\n+                        \\\"check\\\": None,\\n+                        \\\"default\\\": None,\\n+                        \\\"name\\\": \\\"username\\\",\\n+                        \\\"nullable\\\": False,\\n+                        \\\"references\\\": None,\\n+                        \\\"size\\\": 50,\\n+                        \\\"type\\\": \\\"character varying\\\",\\n+                        \\\"unique\\\": True,\\n+                    },\\n+                    {\\n+                        \\\"check\\\": None,\\n+                        \\\"default\\\": None,\\n+                        \\\"name\\\": \\\"password\\\",\\n+                        \\\"nullable\\\": False,\\n+                        \\\"references\\\": None,\\n+                        \\\"size\\\": 50,\\n+                        \\\"type\\\": \\\"character varying\\\",\\n+                        \\\"unique\\\": False,\\n+                    },\\n+                    {\\n+                        \\\"check\\\": None,\\n+                        \\\"default\\\": None,\\n+                        \\\"name\\\": \\\"email\\\",\\n+                        \\\"nullable\\\": False,\\n+                        \\\"references\\\": None,\\n+                        \\\"size\\\": 255,\\n+                        \\\"type\\\": \\\"character varying\\\",\\n+                        \\\"unique\\\": False,\\n+                    },\\n+                    {\\n+                        \\\"check\\\": None,\\n+                        \\\"default\\\": None,\\n+                        \\\"name\\\": \\\"created_on\\\",\\n+                        \\\"nullable\\\": False,\\n+                        \\\"references\\\": None,\\n+                        \\\"size\\\": None,\\n+                        \\\"type\\\": \\\"timestamp without time zone\\\",\\n+                        \\\"unique\\\": False,\\n+                    },\\n+                    {\\n+                        \\\"check\\\": None,\\n+                        \\\"default\\\": None,\\n+                        \\\"name\\\": \\\"last_login\\\",\\n+                        \\\"nullable\\\": True,\\n+                        \\\"references\\\": None,\\n+                        \\\"size\\\": None,\\n+                        \\\"type\\\": \\\"timestamp without time zone\\\",\\n+                        \\\"unique\\\": False,\\n+                    },\\n+                ],\\n+                \\\"dataset\\\": \\\"public\\\",\\n+                \\\"index\\\": [],\\n+                \\\"partitioned_by\\\": [],\\n+                \\\"primary_key\\\": [],\\n+                \\\"table_name\\\": \\\"accounts\\\",\\n+                \\\"tablespace\\\": None,\\n+            }\\n+        ],\\n+        \\\"types\\\": [],\\n+    }\\n+    assert expected == result\\n+\\n+\\n+def test_alter_table_if_exists():\\n+    ddl = \\\"\\\"\\\"\\n+       \\n+    CREATE TABLE public.accounts (\\n+        user_id integer NOT NULL,\\n+        username character varying(50) NOT NULL,\\n+        password character varying(50) NOT NULL,\\n+        email character varying(255) NOT NULL,\\n+        created_on timestamp without time zone NOT NULL,\\n+        last_login timestamp without time zone\\n+    );\\n+    ALTER TABLE IF EXISTS public.accounts\\n+        ADD CONSTRAINT accounts_username_key UNIQUE (username);\\n+        \\\"\\\"\\\"\\n+    result = DDLParser(ddl).run(group_by_type=True, output_mode=\\\"bigquery\\\")\\n+    expected = {\\n+        \\\"ddl_properties\\\": [],\\n+        \\\"domains\\\": [],\\n+        \\\"schemas\\\": [],\\n+        \\\"sequences\\\": [],\\n+        \\\"tables\\\": [\\n+            {\\n+                \\\"alter\\\": {\\n+                    \\\"uniques\\\": [\\n+                        {\\n+                            \\\"columns\\\": [\\\"username\\\"],\\n+                            \\\"constraint_name\\\": \\\"accounts_username_key\\\",\\n+                        }\\n+                    ]\\n+                },\\n+                \\\"checks\\\": [],\\n+                \\\"columns\\\": [\\n+                    {\\n+                        \\\"check\\\": None,\\n+                        \\\"default\\\": None,\\n+                        \\\"name\\\": \\\"user_id\\\",\\n+                        \\\"nullable\\\": False,\\n+                        \\\"references\\\": None,\\n+                        \\\"size\\\": None,\\n+                        \\\"type\\\": \\\"integer\\\",\\n+                        \\\"unique\\\": False,\\n+                    },\\n+                    {\\n+                        \\\"check\\\": None,\\n+                        \\\"default\\\": None,\\n+                        \\\"name\\\": \\\"username\\\",\\n+                        \\\"nullable\\\": False,\\n+                        \\\"references\\\": None,\\n+                        \\\"size\\\": 50,\\n+                        \\\"type\\\": \\\"character varying\\\",\\n+                        \\\"unique\\\": True,\\n+                    },\\n+                    {\\n+                        \\\"check\\\": None,\\n+                        \\\"default\\\": None,\\n+                        \\\"name\\\": \\\"password\\\",\\n+                        \\\"nullable\\\": False,\\n+                        \\\"references\\\": None,\\n+                        \\\"size\\\": 50,\\n+                        \\\"type\\\": \\\"character varying\\\",\\n+                        \\\"unique\\\": False,\\n+                    },\\n+                    {\\n+                        \\\"check\\\": None,\\n+                        \\\"default\\\": None,\\n+                        \\\"name\\\": \\\"email\\\",\\n+                        \\\"nullable\\\": False,\\n+                        \\\"references\\\": None,\\n+                        \\\"size\\\": 255,\\n+                        \\\"type\\\": \\\"character varying\\\",\\n+                        \\\"unique\\\": False,\\n+                    },\\n+                    {\\n+                        \\\"check\\\": None,\\n+                        \\\"default\\\": None,\\n+                        \\\"name\\\": \\\"created_on\\\",\\n+                        \\\"nullable\\\": False,\\n+                        \\\"references\\\": None,\\n+                        \\\"size\\\": None,\\n+                        \\\"type\\\": \\\"timestamp without time zone\\\",\\n+                        \\\"unique\\\": False,\\n+                    },\\n+                    {\\n+                        \\\"check\\\": None,\\n+                        \\\"default\\\": None,\\n+                        \\\"name\\\": \\\"last_login\\\",\\n+                        \\\"nullable\\\": True,\\n+                        \\\"references\\\": None,\\n+                        \\\"size\\\": None,\\n+                        \\\"type\\\": \\\"timestamp without time zone\\\",\\n+                        \\\"unique\\\": False,\\n+                    },\\n+                ],\\n+                \\\"dataset\\\": \\\"public\\\",\\n+                \\\"index\\\": [],\\n+                \\\"partitioned_by\\\": [],\\n+                \\\"primary_key\\\": [],\\n+                \\\"table_name\\\": \\\"accounts\\\",\\n+                \\\"tablespace\\\": None,\\n+            }\\n+        ],\\n+        \\\"types\\\": [],\\n+    }\\n+    assert expected == result\\n\",\"diff --git a/tests/test_alter_statements.py b/tests/test_alter_statements.py\\nindex f4531ce..86c0deb 100644\\n--- a/tests/test_alter_statements.py\\n+++ b/tests/test_alter_statements.py\\n@@ -1437,7 +1437,6 @@ def test_several_alter_fk_for_same_table():\\n \\n def test_alter_table_only():\\n     ddl = \\\"\\\"\\\"\\n-        \\n     CREATE TABLE public.accounts (\\n         user_id integer NOT NULL,\\n         username character varying(50) NOT NULL,\\n@@ -1543,7 +1542,6 @@ def test_alter_table_only():\\n \\n def test_alter_table_if_exists():\\n     ddl = \\\"\\\"\\\"\\n-       \\n     CREATE TABLE public.accounts (\\n         user_id integer NOT NULL,\\n         username character varying(50) NOT NULL,\\n\",\"diff --git a/README.md b/README.md\\nindex 5be2938..ef609ac 100644\\n--- a/README.md\\n+++ b/README.md\\n@@ -388,6 +388,22 @@ for help with debugging & testing support for BigQuery dialect DDLs:\\n \\n \\n ## Changelog\\n+**v0.23.0**\\n+\\n+Big refactoring: less code complexity & increase code coverage. Radon added to pre-commit hooks.\\n+\\n+### Fixes:\\n+\\n+1. Fix for issue with ALTER UNIQUE - https://github.com/xnuinside/simple-ddl-parser/issues/101 \\n+\\n+### New Features\\n+\\n+1. SQL Comments string from DDL now parsed to \\\"comments\\\" key in output.\\n+\\n+PostgreSQL:\\n+\\n+2. Added support for ALTER TABLE ONLY | ALTER TABLE IF EXISTS\\n+\\n **v0.22.5**\\n ### Fixes:\\n \\n\",\"diff --git a/docs/README.rst b/docs/README.rst\\nindex 3b31516..b8c6e4d 100644\\n--- a/docs/README.rst\\n+++ b/docs/README.rst\\n@@ -25,7 +25,7 @@ Build with ply (lex & yacc in python). A lot of samples in 'tests/.\\n Is it Stable?\\n ^^^^^^^^^^^^^\\n \\n-Yes, library already has about 7000+ downloads per day - https://pypistats.org/packages/simple-ddl-parser.\\n+Yes, library already has about 7000+ downloads per day.\\n \\n As maintainer, I guarantee that any backward incompatible changes will not be done in patch or minor version. Only additionals & new features.\\n \\n@@ -297,7 +297,7 @@ Supported Statements\\n   STATEMENTS: PRIMARY KEY, CHECK, FOREIGN KEY in table defenitions (in create table();)\\n \\n * \\n-  ALTER TABLE STATEMENTS: ADD CHECK (with CONSTRAINT), ADD FOREIGN KEY (with CONSTRAINT), ADD UNIQUE, ADD DEFAULT FOR\\n+  ALTER TABLE STATEMENTS: ADD CHECK (with CONSTRAINT), ADD FOREIGN KEY (with CONSTRAINT), ADD UNIQUE, ADD DEFAULT FOR, ALTER TABLE ONLY, ALTER TABLE IF EXISTS\\n \\n * \\n   PARTITION BY statement\\n@@ -447,6 +447,27 @@ for help with debugging & testing support for BigQuery dialect DDLs:\\n Changelog\\n ---------\\n \\n+**v0.23.0**\\n+\\n+Big refactoring: less code complexity & increase code coverage. Radon added to pre-commit hooks.\\n+\\n+Fixes:\\n+^^^^^^\\n+\\n+\\n+#. Fix for issue with ALTER UNIQUE - https://github.com/xnuinside/simple-ddl-parser/issues/101 \\n+\\n+New Features\\n+^^^^^^^^^^^^\\n+\\n+\\n+#. SQL Comments string from DDL now parsed to \\\"comments\\\" key in output.\\n+\\n+PostgreSQL:\\n+\\n+\\n+#. Added support for ALTER TABLE ONLY | ALTER TABLE IF EXISTS\\n+\\n **v0.22.5**\\n \\n Fixes:\\n\",\"diff --git a/README.md b/README.md\\nindex ef609ac..49c9297 100644\\n--- a/README.md\\n+++ b/README.md\\n@@ -6,7 +6,7 @@ Build with ply (lex & yacc in python). A lot of samples in 'tests/.\\n \\n ### Is it Stable?\\n \\n-Yes, library already has about 7000+ downloads per day.\\n+Yes, library already has about 7000+ downloads per day  - https://pypistats.org/packages/simple-ddl-parser..\\n \\n As maintainer, I guarantee that any backward incompatible changes will not be done in patch or minor version. Only additionals & new features.\\n \"]", "hints_text": ""}
