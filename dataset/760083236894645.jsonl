{"instance_id": "760083236894645", "repo": "redhatinsights/insights-core", "base_commit": "a003d6f00d817a6d2a1fba4ba7321ab433943de7", "problem_statement": "FileListing: `.` in file_path of the top dir was converted to slash '/':\\n        Hey @mohitkumarrh - I think this is a bug in the cooperation between the insights core vs the base module `ls_parser`, the insights core used the following `mangle` logic and replaced all of the `/` to `.` as the filename in the insights-archive:\\r\\nhttps://github.com/RedHatInsights/insights-core/blob/8656cccc1cbe78e208ac5d1336503b33d447ef99/insights/util/mangle.py#L40\\r\\nBut it didn't record which `.` is a `mangled` dot from the slash.\\r\\n\\r\\nHowever, the `FileListing` converted all the `.` back to the `/` and didn't consider whether it's an original `.` in the `file_path`:\\r\\nhttps://github.com/RedHatInsights/insights-core/blob/8656cccc1cbe78e208ac5d1336503b33d447ef99/insights/core/__init__.py#L1722\\r\\n\\r\\nSo the path `/var/lib/pcp/pmdas/openmetrics/config.d` in the parser result was stored as `/var/lib/pcp/pmdas/openmetrics/config/d` by mistake.\\r\\n\\r\\nSince recently, we met a couple of issues in the `ls_parser`, I'm planning to do some enhancement on it. \\r\\nCould you please wait for a while?\\r\\n\\r\\nSorry about the inconvenience.\\r\\n\\r\\n_Originally posted by @xiangce in https://github.com/RedHatInsights/insights-core/issues/3620#issuecomment-1354458782_\\r\\n      ", "FAIL_TO_PASS": ["insights/tests/test_ls_parser.py::test_parse_multiple_directories", "insights/tests/test_ls_parser.py::test_parse_multiple_directories_with_break"], "PASS_TO_PASS": [], "language": "python", "test_command": "source /saved/ENV || source /saved/*/ENV && pytest --no-header -rA --tb=no -p no:cacheprovider --continue-on-collection-errors", "test_output_parser": "python/parse_log_pytest_v3", "image_storage_uri": "vmvm-registry.fbinfra.net/repomate_image_activ_pytest/redhatinsights_insights-core:a003d6f00d817a6d2a1fba4ba7321ab433943de7", "patch": "", "test_patch": "[\"diff --git a/insights/tests/datasources/test_ls.py b/insights/tests/datasources/test_ls.py\\nnew file mode 100644\\nindex 0000000000..032eab8337\\n--- /dev/null\\n+++ b/insights/tests/datasources/test_ls.py\\n@@ -0,0 +1,93 @@\\n+import pytest\\n+\\n+from insights.core import filters\\n+from insights.core.exceptions import SkipComponent\\n+from insights.specs import Specs\\n+from insights.specs.datasources.ls import (\\n+        list_with_la, list_with_la_filtered,\\n+        list_with_lan, list_with_lan_filtered,\\n+        list_with_lanL, list_with_lanR, list_with_lanRL,\\n+        list_with_lanRZ, list_with_lanZ)\\n+\\n+\\n+def setup_function(func):\\n+    if func is test_la_empty:\\n+        pass\\n+    if func is test_la:\\n+        filters.add_filter(Specs.ls_la_dirs, [\\\"/\\\"])\\n+    if func is test_la_filterd:\\n+        filters.add_filter(Specs.ls_la_filtered_dirs, [\\\"/\\\", '/boot'])\\n+    if func is test_lan:\\n+        filters.add_filter(Specs.ls_lan_dirs, [\\\"/\\\", '/boot'])\\n+    if func is test_lan_filterd:\\n+        filters.add_filter(Specs.ls_lan_filtered_dirs, [\\\"/\\\"])\\n+    if func is test_lanL:\\n+        filters.add_filter(Specs.ls_lanL_dirs, [\\\"/\\\", '/boot'])\\n+    if func is test_lanR:\\n+        filters.add_filter(Specs.ls_lanR_dirs, [\\\"/\\\"])\\n+    if func is test_lanRL:\\n+        filters.add_filter(Specs.ls_lanRL_dirs, [\\\"/\\\", '/boot'])\\n+    if func is test_lanRZ:\\n+        filters.add_filter(Specs.ls_lanRZ_dirs, ['/boot'])\\n+    if func is test_lanZ:\\n+        filters.add_filter(Specs.ls_lanZ_dirs, [\\\"/\\\", '/mnt'])\\n+\\n+\\n+def teardown_function(func):\\n+    for spec in (\\n+            Specs.ls_la_dirs, Specs.ls_la_filtered, Specs.ls_la_filtered_dirs,\\n+            Specs.ls_lan_dirs, Specs.ls_lan_filtered, Specs.ls_lan_filtered_dirs,\\n+            Specs.ls_lanL_dirs, Specs.ls_lanR_dirs, Specs.ls_lanRL_dirs,\\n+            Specs.ls_lanRZ_dirs, Specs.ls_lanZ_dirs):\\n+        if spec in filters._CACHE:\\n+            del filters._CACHE[spec]\\n+\\n+\\n+def test_la_empty():\\n+    with pytest.raises(SkipComponent):\\n+        list_with_la({})\\n+\\n+\\n+def test_la():\\n+    ret = list_with_la({})\\n+    assert ret == '/ _non_existing_'\\n+\\n+\\n+def test_la_filterd():\\n+    ret = list_with_la_filtered({})\\n+    assert ret == '/ /boot'\\n+\\n+\\n+def test_lan():\\n+    ret = list_with_lan({})\\n+    assert ret == '/ /boot'\\n+\\n+\\n+def test_lan_filterd():\\n+    ret = list_with_lan_filtered({})\\n+    assert ret == '/ _non_existing_'\\n+\\n+\\n+def test_lanL():\\n+    ret = list_with_lanL({})\\n+    assert ret == '/ /boot'\\n+\\n+\\n+def test_lanR():\\n+    ret = list_with_lanR({})\\n+    assert ret == '/'\\n+\\n+\\n+def test_lanRL():\\n+    ret = list_with_lanRL({})\\n+    assert ret == '/ /boot'\\n+\\n+\\n+def test_lanRZ():\\n+    ret = list_with_lanRZ({})\\n+    assert ret == '/boot'\\n+\\n+\\n+def test_lanZ():\\n+    ret = list_with_lanZ({})\\n+    assert ret == '/ /mnt'\\n\",\"diff --git a/insights/tests/parsers/test_ls.py b/insights/tests/parsers/test_ls.py\\nnew file mode 100644\\nindex 0000000000..acf792320e\\n--- /dev/null\\n+++ b/insights/tests/parsers/test_ls.py\\n@@ -0,0 +1,332 @@\\n+from insights.parsers.ls import (LSla, LSlaFiltered, LSlan, LSlanFiltered,\\n+                                 LSlanL, LSlanR, LSlanRL, LSlanRZ, LSlanZ)\\n+from insights.tests import context_wrap\\n+\\n+LS_LA = \\\"\\\"\\\"\\n+ls: cannot access '_non_existing_': No such file or directory\\n+/boot:\\n+total 187380\\n+dr-xr-xr-x.  3 root root     4096 Mar  4 16:19 .\\n+dr-xr-xr-x. 19 root root     4096 Jul 14 09:10 ..\\n+-rw-r--r--.  1 root root   123891 Aug 25  2015 config-3.10.0-229.14.1.el7.x86_64\\n+drwxr-xr-x.  6 root root      111 Jun 15 09:51 grub2\\n+\\n+/boot/grub2:\\n+total 36\\n+drwxr-xr-x. 6 root root  104 Mar  4 16:16 .\\n+dr-xr-xr-x. 3 root root 4096 Mar  4 16:19 ..\\n+lrwxrwxrwx. 1 root root   11 Aug  4  2014 menu.lst -> ./grub.cfg\\n+-rw-r--r--. 1 root root   64 Sep 18  2015 device.map\\n+-rw-r--r--. 1 root root 7040 Mar 29 13:30 grub.cfg\\n+\\\"\\\"\\\"\\n+\\n+LS_LAN = \\\"\\\"\\\"\\n+/boot:\\n+total 187380\\n+dr-xr-xr-x.  3 0 0     4096 Mar  4 16:19 .\\n+dr-xr-xr-x. 19 0 0     4096 Jul 14 09:10 ..\\n+-rw-r--r--.  1 0 0   123891 Aug 25  2015 config-3.10.0-229.14.1.el7.x86_64\\n+drwxr-xr-x.  6 0 0      111 Jun 15 09:51 grub2\\n+\\n+/boot/grub2:\\n+total 36\\n+drwxr-xr-x. 6 0 0  104 Mar  4 16:16 .\\n+dr-xr-xr-x. 3 0 0 4096 Mar  4 16:19 ..\\n+lrwxrwxrwx. 1 0 0   11 Aug  4  2014 menu.lst -> ./grub.cfg\\n+-rw-r--r--. 1 0 0   64 Sep 18  2015 device.map\\n+-rw-r--r--. 1 0 0 7040 Mar 29 13:30 grub.cfg\\n+\\\"\\\"\\\"\\n+\\n+\\n+LS_LANL = \\\"\\\"\\\"\\n+ls: cannot access '_non_existing_': No such file or directory\\n+/boot:\\n+total 187380\\n+dr-xr-xr-x.  3 0 0     4096 Mar  4 16:19 .\\n+dr-xr-xr-x. 19 0 0     4096 Jul 14 09:10 ..\\n+-rw-r--r--.  1 0 0   123891 Aug 25  2015 config-3.10.0-229.14.1.el7.x86_64\\n+drwxr-xr-x.  6 0 0      111 Jun 15 09:51 grub2\\n+\\n+/boot/grub2:\\n+total 32\\n+drwx------. 4 0 0   83 Jun 27 11:01 .\\n+dr-xr-xr-x. 5 0 0 4096 Jun  5 09:14 ..\\n+-rw-r--r--. 1 0 0   11 Aug  4  2014 menu.lst\\n+-rw-r--r--. 1 0 0   64 Jan 17 16:10 device.map\\n+-rw-------. 1 0 0 6529 Jan 17 16:10 grub.cfg\\n+\\\"\\\"\\\"\\n+\\n+LS_LANR = \\\"\\\"\\\"\\n+ls: cannot access '_non_existing_': No such file or directory\\n+/dev:\\n+total 0\\n+drwxr-xr-x. 21 0  0     3100 Jun 27 10:58 .\\n+dr-xr-xr-x. 17 0  0      224 Apr 17 16:45 ..\\n+crw-r--r--.  1 0  0  10, 235 Jun 27 10:58 autofs\\n+drwxr-xr-x.  2 0  0      160 Jun 27 10:58 block\\n+lrwxrwxrwx.  1 0  0        3 Jun 27 10:58 cdrom -> sr0\\n+\\n+/dev/vfio:\\n+total 0\\n+drwxr-xr-x.  2 0 0      60 Jun 27 10:58 .\\n+drwxr-xr-x. 21 0 0    3100 Jun 27 10:58 ..\\n+crw-------.  1 0 0 10, 196 Jun 27 10:58 vfio\\n+\\n+/dev/virtio-ports:\\n+total 0\\n+drwxr-xr-x.  2 0 0   80 Jun 27 10:58 .\\n+drwxr-xr-x. 21 0 0 3100 Jun 27 10:58 ..\\n+lrwxrwxrwx.  1 0 0   11 Jun 27 10:58 com.redhat.spice.0 -> ../vport2p2\\n+lrwxrwxrwx.  1 0 0   11 Jun 27 10:58 org.qemu.guest_agent.0 -> ../vport2p1\\n+\\\"\\\"\\\"\\n+\\n+LS_LANRL = \\\"\\\"\\\"\\n+/dev:\\n+total 0\\n+drwxr-xr-x. 21    0  0            3100 Jun 27 10:58 .\\n+dr-xr-xr-x. 17    0  0             224 Apr 17 16:45 ..\\n+crw-r--r--.  1    0  0         10, 235 Jun 27 10:58 autofs\\n+drwxr-xr-x.  2    0  0             160 Jun 27 10:58 block\\n+brw-rw----.  1    0 11         11,   0 Jun 27 10:58 cdrom\\n+\\n+/dev/vfio:\\n+total 0\\n+drwxr-xr-x.  2 0 0      60 Jun 27 10:58 .\\n+drwxr-xr-x. 21 0 0    3100 Jun 27 10:58 ..\\n+crw-------.  1 0 0 10, 196 Jun 27 10:58 vfio\\n+\\n+/dev/virtio-ports:\\n+total 0\\n+drwxr-xr-x.  2 0 0     80 Jun 27 10:58 .\\n+drwxr-xr-x. 21 0 0   3100 Jun 27 10:58 ..\\n+crw-------.  1 0 0 243, 2 Jun 27 10:58 com.redhat.spice.0\\n+crw-------.  1 0 0 243, 1 Jun 27 10:58 org.qemu.guest_agent.0\\n+\\\"\\\"\\\"\\n+\\n+LS_LANRZ = \\\"\\\"\\\"\\n+/dev:\\n+total 0\\n+drwxr-xr-x. 21 0  0 system_u:object_r:device_t:s0                  3100 Jun 27 10:58 .\\n+dr-xr-xr-x. 17 0  0 system_u:object_r:root_t:s0                     224 Apr 17 16:45 ..\\n+crw-r--r--.  1 0  0 system_u:object_r:autofs_device_t:s0            235 Jun 27 10:58 autofs\\n+drwxr-xr-x.  2 0  0 system_u:object_r:device_t:s0                   160 Jun 27 10:58 block\\n+lrwxrwxrwx.  1 0  0 system_u:object_r:device_t:s0                     3 Jun 27 10:58 cdrom -> sr0\\n+\\n+/dev/vfio:\\n+total 0\\n+drwxr-xr-x.  2 0 0 system_u:object_r:device_t:s0           60 Jun 27 10:58 .\\n+drwxr-xr-x. 21 0 0 system_u:object_r:device_t:s0         3100 Jun 27 10:58 ..\\n+crw-------.  1 0 0 system_u:object_r:vfio_device_t:s0     196 Jun 27 10:58 vfio\\n+\\n+/dev/virtio-ports:\\n+total 0\\n+drwxr-xr-x.  2 0 0 system_u:object_r:device_t:s0   80 Jun 27 10:58 .\\n+drwxr-xr-x. 21 0 0 system_u:object_r:device_t:s0 3100 Jun 27 10:58 ..\\n+lrwxrwxrwx.  1 0 0 system_u:object_r:device_t:s0   11 Jun 27 10:58 com.redhat.spice.0 -> ../vport2p2\\n+lrwxrwxrwx.  1 0 0 system_u:object_r:device_t:s0   11 Jun 27 10:58 org.qemu.guest_agent.0 -> ../vport2p1\\n+\\\"\\\"\\\"\\n+\\n+LS_LANZ = \\\"\\\"\\\"\\n+/dev:\\n+total 0\\n+drwxr-xr-x. 21 0  0 system_u:object_r:device_t:s0          3100 Jun 27 10:58 .\\n+dr-xr-xr-x. 17 0  0 system_u:object_r:root_t:s0             224 Apr 17 16:45 ..\\n+crw-r--r--.  1 0  0 system_u:object_r:autofs_device_t:s0    235 Jun 27 10:58 autofs\\n+drwxr-xr-x.  2 0  0 system_u:object_r:device_t:s0           160 Jun 27 10:58 block\\n+lrwxrwxrwx.  1 0  0 system_u:object_r:device_t:s0             3 Jun 27 10:58 cdrom -> sr0\\n+\\\"\\\"\\\"\\n+\\n+\\n+def test_ls_la():\\n+    ls = LSla(context_wrap(LS_LA))\\n+    assert '/boot' in ls\\n+    assert '/boot/grub2' in ls\\n+    assert ls.dirs_of('/boot') == ['.', '..', 'grub2']\\n+\\n+    grub2_files = ls.files_of('/boot/grub2')\\n+    assert 'menu.lst' in grub2_files\\n+    assert 'device.map' in grub2_files\\n+    assert 'grub.cfg' in grub2_files\\n+    assert len(grub2_files) == 3\\n+\\n+    boot_files = ls.files_of('/boot')\\n+    assert \\\"config-3.10.0-229.14.1.el7.x86_64\\\" in boot_files\\n+    assert len(boot_files) == 1\\n+\\n+    boot_listings = ls.listing_of('/boot')\\n+    assert \\\"config-3.10.0-229.14.1.el7.x86_64\\\" in boot_listings\\n+    assert boot_listings[\\\"config-3.10.0-229.14.1.el7.x86_64\\\"]['owner'] == 'root'\\n+\\n+    grub_listings = ls.listing_of('/boot/grub2')\\n+    assert \\\"menu.lst\\\" in grub_listings\\n+    assert grub_listings[\\\"menu.lst\\\"]['group'] == 'root'\\n+    assert 'link' in grub_listings[\\\"menu.lst\\\"]\\n+    assert grub_listings[\\\"menu.lst\\\"]['link'] == './grub.cfg'\\n+\\n+\\n+def test_ls_la_filtered():\\n+    ls = LSlaFiltered(context_wrap(LS_LA))\\n+    assert '/boot' in ls\\n+    assert '/boot/grub2' in ls\\n+    assert ls.dirs_of('/boot') == ['.', '..', 'grub2']\\n+\\n+    grub2_files = ls.files_of('/boot/grub2')\\n+    assert 'menu.lst' in grub2_files\\n+    assert 'device.map' in grub2_files\\n+    assert 'grub.cfg' in grub2_files\\n+    assert len(grub2_files) == 3\\n+\\n+    boot_files = ls.files_of('/boot')\\n+    assert \\\"config-3.10.0-229.14.1.el7.x86_64\\\" in boot_files\\n+    assert len(boot_files) == 1\\n+\\n+    boot_listings = ls.listing_of('/boot')\\n+    assert \\\"config-3.10.0-229.14.1.el7.x86_64\\\" in boot_listings\\n+    assert boot_listings[\\\"config-3.10.0-229.14.1.el7.x86_64\\\"]['owner'] == 'root'\\n+\\n+    grub_listings = ls.listing_of('/boot/grub2')\\n+    assert \\\"menu.lst\\\" in grub_listings\\n+    assert grub_listings[\\\"menu.lst\\\"]['group'] == 'root'\\n+    assert 'link' in grub_listings[\\\"menu.lst\\\"]\\n+    assert grub_listings[\\\"menu.lst\\\"]['link'] == './grub.cfg'\\n+\\n+\\n+def test_ls_lan():\\n+    ls = LSlan(context_wrap(LS_LAN))\\n+    assert '/boot' in ls\\n+    assert '/boot/grub2' in ls\\n+    assert ls.dirs_of('/boot') == ['.', '..', 'grub2']\\n+\\n+    grub2_files = ls.files_of('/boot/grub2')\\n+    assert 'menu.lst' in grub2_files\\n+    assert 'device.map' in grub2_files\\n+    assert 'grub.cfg' in grub2_files\\n+    assert len(grub2_files) == 3\\n+\\n+    boot_files = ls.files_of('/boot')\\n+    assert \\\"config-3.10.0-229.14.1.el7.x86_64\\\" in boot_files\\n+    assert len(boot_files) == 1\\n+\\n+    boot_listings = ls.listing_of('/boot')\\n+    assert \\\"config-3.10.0-229.14.1.el7.x86_64\\\" in boot_listings\\n+    assert boot_listings[\\\"config-3.10.0-229.14.1.el7.x86_64\\\"]['owner'] == '0'\\n+\\n+    grub_listings = ls.listing_of('/boot/grub2')\\n+    assert \\\"menu.lst\\\" in grub_listings\\n+    assert grub_listings[\\\"menu.lst\\\"]['group'] == '0'\\n+    assert 'link' in grub_listings[\\\"menu.lst\\\"]\\n+    assert grub_listings[\\\"menu.lst\\\"]['link'] == './grub.cfg'\\n+\\n+\\n+def test_ls_lan_filtered():\\n+    ls = LSlanFiltered(context_wrap(LS_LAN))\\n+    assert '/boot' in ls\\n+    assert '/boot/grub2' in ls\\n+    assert ls.dirs_of('/boot') == ['.', '..', 'grub2']\\n+\\n+    grub2_files = ls.files_of('/boot/grub2')\\n+    assert 'menu.lst' in grub2_files\\n+    assert 'device.map' in grub2_files\\n+    assert 'grub.cfg' in grub2_files\\n+    assert len(grub2_files) == 3\\n+\\n+    boot_files = ls.files_of('/boot')\\n+    assert \\\"config-3.10.0-229.14.1.el7.x86_64\\\" in boot_files\\n+    assert len(boot_files) == 1\\n+\\n+    boot_listings = ls.listing_of('/boot')\\n+    assert \\\"config-3.10.0-229.14.1.el7.x86_64\\\" in boot_listings\\n+    assert boot_listings[\\\"config-3.10.0-229.14.1.el7.x86_64\\\"]['owner'] == '0'\\n+\\n+    grub_listings = ls.listing_of('/boot/grub2')\\n+    assert \\\"menu.lst\\\" in grub_listings\\n+    assert grub_listings[\\\"menu.lst\\\"]['group'] == '0'\\n+    assert 'link' in grub_listings[\\\"menu.lst\\\"]\\n+    assert grub_listings[\\\"menu.lst\\\"]['link'] == './grub.cfg'\\n+\\n+\\n+def test_ls_lanL():\\n+    ls = LSlanL(context_wrap(LS_LANL))\\n+    assert '/boot' in ls\\n+    assert '/boot/grub2' in ls\\n+    assert ls.dirs_of('/boot') == ['.', '..', 'grub2']\\n+\\n+    grub2_files = ls.files_of('/boot/grub2')\\n+    assert 'menu.lst' in grub2_files\\n+    assert 'device.map' in grub2_files\\n+    assert 'grub.cfg' in grub2_files\\n+    assert len(grub2_files) == 3\\n+\\n+    boot_files = ls.files_of('/boot')\\n+    assert \\\"config-3.10.0-229.14.1.el7.x86_64\\\" in boot_files\\n+    assert len(boot_files) == 1\\n+\\n+    boot_listings = ls.listing_of('/boot')\\n+    assert \\\"config-3.10.0-229.14.1.el7.x86_64\\\" in boot_listings\\n+    assert boot_listings[\\\"config-3.10.0-229.14.1.el7.x86_64\\\"]['owner'] == '0'\\n+\\n+    grub_listings = ls.listing_of('/boot/grub2')\\n+    assert \\\"menu.lst\\\" in grub_listings\\n+    assert grub_listings[\\\"menu.lst\\\"]['group'] == '0'\\n+    assert 'link' not in grub_listings[\\\"menu.lst\\\"]\\n+\\n+\\n+def test_ls_lanR():\\n+    ls = LSlanR(context_wrap(LS_LANR))\\n+    assert '/dev' in ls\\n+    assert '/dev/vfio' in ls\\n+    assert '/dev/virtio-ports' in ls\\n+    assert ls.dirs_of('/dev') == ['.', '..', 'block']\\n+\\n+    dev_listings = ls.listing_of('/dev')\\n+    assert \\\"cdrom\\\" in dev_listings\\n+    assert 'link' in dev_listings[\\\"cdrom\\\"]\\n+    assert dev_listings[\\\"cdrom\\\"]['link'] == 'sr0'\\n+\\n+    assert 'link' in ls.listing_of('/dev/virtio-ports')['com.redhat.spice.0']\\n+\\n+\\n+def test_ls_lanRL():\\n+    ls = LSlanRL(context_wrap(LS_LANRL))\\n+    assert '/dev' in ls\\n+    assert '/dev/vfio' in ls\\n+    assert '/dev/virtio-ports' in ls\\n+    assert ls.dirs_of('/dev') == ['.', '..', 'block']\\n+\\n+    dev_listings = ls.listing_of('/dev')\\n+    assert \\\"cdrom\\\" in dev_listings\\n+    assert 'link' not in dev_listings[\\\"cdrom\\\"]\\n+\\n+    assert 'link' not in ls.listing_of('/dev/virtio-ports')['com.redhat.spice.0']\\n+\\n+\\n+def test_ls_lanRZ():\\n+    ls = LSlanRZ(context_wrap(LS_LANRZ))\\n+    assert '/dev' in ls\\n+    assert '/dev/vfio' in ls\\n+    assert '/dev/virtio-ports' in ls\\n+    assert ls.dirs_of('/dev') == ['.', '..', 'block']\\n+\\n+    dev_listings = ls.listing_of('/dev')\\n+    assert \\\"cdrom\\\" in dev_listings\\n+    assert 'link' in dev_listings[\\\"cdrom\\\"]\\n+    assert dev_listings[\\\"cdrom\\\"]['link'] == 'sr0'\\n+    assert 'se_type' in dev_listings[\\\"cdrom\\\"]\\n+    assert dev_listings[\\\"cdrom\\\"]['se_type'] == 'device_t'\\n+\\n+    assert 'link' in ls.listing_of('/dev/virtio-ports')['com.redhat.spice.0']\\n+\\n+\\n+def test_ls_lanZ():\\n+    ls = LSlanZ(context_wrap(LS_LANZ))\\n+    assert '/dev' in ls\\n+    assert '/dev/vfio' not in ls\\n+    assert '/dev/virtio-ports' not in ls\\n+    assert ls.dirs_of('/dev') == ['.', '..', 'block']\\n+\\n+    dev_listings = ls.listing_of('/dev')\\n+    assert \\\"cdrom\\\" in dev_listings\\n+    assert 'link' in dev_listings[\\\"cdrom\\\"]\\n+    assert dev_listings[\\\"cdrom\\\"]['link'] == 'sr0'\\n+    assert 'se_type' in dev_listings[\\\"cdrom\\\"]\\n+    assert dev_listings[\\\"cdrom\\\"]['se_type'] == 'device_t'\\n\",\"diff --git a/insights/tests/parsers/test_ls_file_listing.py b/insights/tests/parsers/test_ls_file_listing.py\\nnew file mode 100644\\nindex 0000000000..239af48464\\n--- /dev/null\\n+++ b/insights/tests/parsers/test_ls_file_listing.py\\n@@ -0,0 +1,315 @@\\n+# -*- coding: UTF-8 -*-\\n+import doctest\\n+\\n+from insights.parsers import ls as ls_module\\n+from insights.parsers.ls import FileListing\\n+from insights.tests import context_wrap\\n+\\n+SINGLE_DIRECTORY = \\\"\\\"\\\"\\n+ls: cannot access ' _non_existing_': No such file or directory\\n+/etc/pki/tls:\\n+total 32\\n+drwxr-xr-x.  5 root root  4096 Jun 28  2017 .\\n+drwxr-xr-x. 15 root root  4096 Aug 10 09:42 ..\\n+lrwxrwxrwx.  1 root root    49 Jun 28  2017 cert.pem -> /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\n+drwxr-xr-x.  2 root root  4096 Jun 28  2017 certs\\n+drwxr-xr-x.  2 root root  4096 Mar 29  2017 misc\\n+-rw-r--r--.  1 root root 10923 Feb  7  2017 openssl.cnf\\n+drwxr-xr-x.  2 root root  4096 Feb  7  2017 private\\n+\\\"\\\"\\\"\\n+\\n+MULTIPLE_DIRECTORIES = \\\"\\\"\\\"\\n+/etc/sysconfig:\\n+total 96\\n+drwxr-xr-x.  7 0 0 4096 Jul  6 23:41 .\\n+drwxr-xr-x. 77 0 0 8192 Jul 13 03:55 ..\\n+drwxr-xr-x.  2 0 0   41 Jul  6 23:32 cbq\\n+drwxr-xr-x.  2 0 0    6 Sep 16  2015 console\\n+-rw-------.  1 0 0 1390 Mar  4  2014 ebtables-config\\n+-rw-r--r--.  1 0 0   72 Sep 15  2015 firewalld\\n+lrwxrwxrwx.  1 0 0   17 Jul  6 23:32 grub -> /etc/default/grub\\n+\\n+/etc/rc.d/rc3.d:\\n+total 4\\n+drwxr-xr-x.  2 0 0   58 Jul  6 23:32 .\\n+drwxr-xr-x. 10 0 0 4096 Sep 16  2015 ..\\n+lrwxrwxrwx.  1 0 0   20 Jul  6 23:32 K50netconsole -> ../init.d/netconsole\\n+lrwxrwxrwx.  1 0 0   17 Jul  6 23:32 S10network -> ../init.d/network\\n+lrwxrwxrwx.  1 0 0   15 Jul  6 23:32 S97rhnsd -> ../init.d/rhnsd\\n+\\\"\\\"\\\"\\n+\\n+COMPLICATED_FILES = \\\"\\\"\\\"\\n+/tmp:\\n+total 16\\n+dr-xr-xr-x.  2 0 0     4096 Mar  4 16:19 .\\n+dr-xr-xr-x. 10 0 0     4096 Mar  4 16:19 ..\\n+-rw-r--r--.  1 0 0   123891 Aug 25  2015 config-3.10.0-229.14.1.el7.x86_64\\n+lrwxrwxrwx.  1 0 0       11 Aug  4  2014 menu.lst -> ./grub.conf\\n+brw-rw----.  1 0 6 253,  10 Aug  4 16:56 dm-10\\n+crw-------.  1 0 0 10,  236 Jul 25 10:00 control\\n+srw-------.  1 26214 17738 0 Oct 19 08:48 geany_socket.c46453c2\\n+-rw-rw-r--.  1 24306 24306 13895 Oct 21 15:42 File name with spaces in it!\\n+-rw-rw-r--.  1 24306 24306 13895 Oct 21 15:42 Unicode ÅÍÎÏÓÔÒÚÆ☃ madness.txt\\n+drwxr-xr-x+  2 0 0       41 Jul  6 23:32 additional_ACLs\\n+-rw-rw----.  1 0 6 253,  10 Aug  4 16:56 comma in size currently valid\\n+brw-rw----.  1 0 6  1048576 Aug  4 16:56 block dev with no comma also valid\\n+-rwxr-xr-x.  2 0 0     1024 Jul  6 23:32 file_name_ending_with_colon:\\n+lrwxrwxrwx.  1 0 0       11 Aug  4  2014 link with spaces -> ../file with spaces\\n+\\\"\\\"\\\"\\n+\\n+SELINUX_DIRECTORY = \\\"\\\"\\\"\\n+/boot:\\n+total 3\\n+-rw-r--r--. root root system_u:object_r:boot_t:s0      config-3.10.0-267\\n+drwxr-xr-x. root root system_u:object_r:boot_t:s0      grub2\\n+-rw-r--r--. root root system_u:object_r:boot_t:s0      initramfs-0-rescue\\n+\\\"\\\"\\\"\\n+\\n+FILES_CREATED_WITH_SELINUX_DISABLED = \\\"\\\"\\\"\\n+/dev/mapper:\\n+total 2\\n+lrwxrwxrwx 1 0 0 7 Apr 27 05:34 lv_cpwtk001_data01 -> ../dm-7\\n+lrwxrwxrwx 1 0 0 7 Apr 27 05:34 lv_cpwtk001_redo01 -> ../dm-8\\n+\\\"\\\"\\\"\\n+\\n+BAD_DIRECTORY_ENTRIES = \\\"\\\"\\\"\\n+dr-xr-xr-x.  2 0 0     4096 Mar  4 16:19 dir entry with no dir header\\n+total 3\\n+\\n+/badness:\\n+    -rwxr-xr-x. 0 0    1 Sep 12 2010 indented entry\\n+xr-xr--r--. 0 0        1 Sep 12  2010 bad file type\\n+-rxr-xr-x.  0 0        1 Sep 12  2010 missing user w permission\\n+-rwxr-xr-x  0 0        1 Sep 12  2010 missing ACL dot\\n+-rw-r--r--. user with spaces group 2 Oct 3 2011 user with spaces\\n+-rw-r--r--. user group with spaces 2 Oct 3 2011 group with spaces\\n+dr-xr-xr-x. -42 -63 1271 Jan  6  2008 Negative user and group numbers\\n+dr-xr-xr-x. 1 7 123, 124, 125 Jan 6 2008 Three comma blocks in size\\n+brw-rw----. 1 0 6 123456 Aug 4 16:56 two size blocks\\n+prw-rw----. 1000 1000  0  6 2007 Month missing\\n+prw-rw----. 1000 1000  0 No 6 2007 Month too short\\n+prw-rw----. 1000 1000  0 November 6 2007 Month too long\\n+prw-rw----. 1000 1000  0 Nov  2007 Day too long\\n+prw-rw----. 1000 1000  0 Nov 126 2007 Day too long\\n+prw-rw----. 1000 1000  0 Nov 126  Year missing\\n+prw-rw----. 1000 1000  0 Nov 126 20107 Year too long\\n+prw-rw----. 1000 1000  0 Nov 12 :56 Missing hour\\n+prw-rw----. 1000 1000  0 Nov 12 723:56 Hour too long\\n+prw-rw----. 1000 1000  0 Nov 12 23: Missing minute\\n+prw-rw----. 1000 1000  0 Nov 12 23:3 Minute too short\\n+prw-rw----. 1000 1000  0 Nov 12 23:357 Minute too long\\n+-rw------ 1 root root 762 Sep 23 002 permission too short\\n+bash: ls: command not found\\n+-rw------ 1 root root 762 Se\\n+-rw------- 1 ro:t root 762 Sep 23 002 colon in uid\\n+-rw------- 1 root r:ot 762 Sep 23 002 colon in gid\\n+-rwasdfas- 1 root root 762 Sep 23 002 bad permissions block\\n+-rwx/----- 1 root root 762 Sep 23 002 slash in permissions block\\n+-rwx------ 1 root root 762 Sep 23 002 /slashes/in/filename\\n+/rwasdfas- 1 root root 762 Sep 23 002 slash in file type and no colon on end\\n+/usr/bin/ls: cannot access /boot/grub2/grub.cfg: No such file or directory\\n+cannot access /boot/grub2/grub.cfg: No such file or directory\\n+No such file or directory\\n+adsf\\n+\\\"\\\"\\\"\\n+\\n+FILE_LISTING_DOC = '''\\n+        /boot:\\n+        total 187380\\n+        dr-xr-xr-x.  3 0 0   4096 Mar  4 16:19 .\\n+        dr-xr-xr-x. 19 0 0   4096 Jul 14 09:10 ..\\n+        -rw-r--r--.  1 0 0 123891 Aug 25  2015 config-3.10.0-229.14.1.el7.x86_64\\n+\\n+        /etc/sysconfig:\\n+        total 96\\n+        drwxr-xr-x.  7 0 0 4096 Jul  6 23:41 .\\n+        drwxr-xr-x. 77 0 0 8192 Jul 13 03:55 ..\\n+        drwxr-xr-x.  2 0 0   41 Jul  6 23:32 cbq\\n+        drwxr-xr-x.  2 0 0    6 Sep 16  2015 console\\n+        -rw-------.  1 0 0 1390 Mar  4  2014 ebtables-config\\n+        -rw-r--r--.  1 0 0   72 Sep 15  2015 firewalld\\n+        lrwxrwxrwx.  1 0 0   17 Jul  6 23:32 grub -> /etc/default/grub\\n+'''\\n+\\n+# Note - should we test for anomalous but parseable entries?  E.g. block\\n+# devices without a major/minor number?  Or non-devices that have a comma in\\n+# the size?  Permissions that don't make sense?  Dates that don't make sense\\n+# but still fit the patterns?  What should the parser do with such entries?\\n+\\n+\\n+def test_single_directory():\\n+    # ctx = context_wrap(SINGLE_DIRECTORY, path='ls_-la_.etc.pki.tls')\\n+    ctx = context_wrap(SINGLE_DIRECTORY)\\n+    dirs = FileListing(ctx)\\n+\\n+    assert '/etc/pki/tls' in dirs\\n+    assert '/etc/pki/tls/certs' not in dirs\\n+    assert '/etc/pki' not in dirs\\n+    assert '/etc' not in dirs\\n+    assert dirs['/etc/pki/tls']['name'] == '/etc/pki/tls'\\n+\\n+    assert dirs.files_of('/etc/pki/tls') == ['cert.pem', 'openssl.cnf']\\n+    assert dirs.dirs_of('/etc/pki/tls') == ['.', '..', 'certs', 'misc', 'private']\\n+    assert dirs.total_of('/etc/pki/tls') == 32\\n+\\n+\\n+def test_multiple_directories():\\n+    dirs = FileListing(context_wrap(MULTIPLE_DIRECTORIES, path='ls_-la_.etc'))\\n+\\n+    assert '/etc/sysconfig' in dirs\\n+    assert '/etc/rc.d/rc3.d' in dirs\\n+    assert '/etc/rc.d/rc4.d' not in dirs\\n+\\n+    esc = dirs['/etc/sysconfig']\\n+    assert sorted(esc.keys()) == sorted(['entries', 'files', 'dirs', 'specials', 'total', 'name'])\\n+\\n+    assert dirs.files_of('/etc/sysconfig') == ['ebtables-config', 'firewalld', 'grub']\\n+    assert dirs.dirs_of('/etc/sysconfig') == ['.', '..', 'cbq', 'console']\\n+    assert dirs.specials_of('/etc/sysconfig') == []\\n+\\n+    # Testing the main features\\n+    listing = dirs.listing_of('/etc/sysconfig')\\n+    assert listing['..'] == {\\n+        'type': 'd', 'perms': 'rwxr-xr-x.', 'links': 77, 'owner': '0',\\n+        'group': '0', 'size': 8192, 'date': 'Jul 13 03:55', 'name': '..',\\n+        'raw_entry': 'drwxr-xr-x. 77 0 0 8192 Jul 13 03:55 ..',\\n+        'dir': '/etc/sysconfig'\\n+    }\\n+    assert listing['cbq'] == {\\n+        'type': 'd', 'perms': 'rwxr-xr-x.', 'links': 2, 'owner': '0',\\n+        'group': '0', 'size': 41, 'date': 'Jul  6 23:32', 'name': 'cbq',\\n+        'raw_entry': 'drwxr-xr-x.  2 0 0   41 Jul  6 23:32 cbq',\\n+        'dir': '/etc/sysconfig'\\n+    }\\n+    assert listing['firewalld'] == {\\n+        'type': '-', 'perms': 'rw-r--r--.', 'links': 1, 'owner': '0',\\n+        'group': '0', 'size': 72, 'date': 'Sep 15  2015',\\n+        'name': 'firewalld', 'raw_entry':\\n+        '-rw-r--r--.  1 0 0   72 Sep 15  2015 firewalld',\\n+        'dir': '/etc/sysconfig'\\n+    }\\n+    assert listing['grub'] == {\\n+        'type': 'l', 'perms': 'rwxrwxrwx.', 'links': 1, 'owner': '0',\\n+        'group': '0', 'size': 17, 'date': 'Jul  6 23:32', 'name': 'grub',\\n+        'link': '/etc/default/grub', 'raw_entry':\\n+        'lrwxrwxrwx.  1 0 0   17 Jul  6 23:32 grub -> /etc/default/grub',\\n+        'dir': '/etc/sysconfig'\\n+    }\\n+\\n+    listing = dirs.listing_of('/etc/rc.d/rc3.d')\\n+    assert listing['..'] == {\\n+        'type': 'd', 'perms': 'rwxr-xr-x.', 'links': 10, 'owner': '0',\\n+        'group': '0', 'size': 4096, 'date': 'Sep 16  2015', 'name': '..',\\n+        'raw_entry': 'drwxr-xr-x. 10 0 0 4096 Sep 16  2015 ..',\\n+        'dir': '/etc/rc.d/rc3.d'\\n+    }\\n+    assert listing['K50netconsole'] == {\\n+        'type': 'l', 'perms': 'rwxrwxrwx.', 'links': 1, 'owner': '0',\\n+        'group': '0', 'size': 20, 'date': 'Jul  6 23:32',\\n+        'name': 'K50netconsole', 'link': '../init.d/netconsole', 'raw_entry':\\n+        'lrwxrwxrwx.  1 0 0   20 Jul  6 23:32 K50netconsole -> ../init.d/netconsole',\\n+        'dir': '/etc/rc.d/rc3.d'\\n+    }\\n+\\n+    assert dirs.total_of('/etc/sysconfig') == 96\\n+    assert dirs.total_of('/etc/rc.d/rc3.d') == 4\\n+\\n+    assert dirs.dir_contains('/etc/sysconfig', 'firewalld')\\n+    assert dirs.dir_entry('/etc/sysconfig', 'grub') == {\\n+        'type': 'l', 'perms': 'rwxrwxrwx.', 'links': 1, 'owner': '0',\\n+        'group': '0', 'size': 17, 'date': 'Jul  6 23:32', 'name': 'grub',\\n+        'link': '/etc/default/grub', 'raw_entry':\\n+        'lrwxrwxrwx.  1 0 0   17 Jul  6 23:32 grub -> /etc/default/grub',\\n+        'dir': '/etc/sysconfig'\\n+    }\\n+\\n+    assert dirs.path_entry('/etc/sysconfig/cbq') == {\\n+        'type': 'd', 'perms': 'rwxr-xr-x.', 'links': 2, 'owner': '0',\\n+        'group': '0', 'size': 41, 'date': 'Jul  6 23:32', 'name': 'cbq',\\n+        'raw_entry': 'drwxr-xr-x.  2 0 0   41 Jul  6 23:32 cbq',\\n+        'dir': '/etc/sysconfig'\\n+    }\\n+    assert dirs.path_entry('no_slash') is None\\n+    assert dirs.path_entry('/') is None\\n+    assert dirs.path_entry('/foo') is None\\n+    assert dirs.path_entry('/etc/sysconfig/notfound') is None\\n+\\n+\\n+def test_complicated_directory():\\n+    dirs = FileListing(context_wrap(COMPLICATED_FILES))\\n+\\n+    # Test the things we expect to be different:\\n+    listing = dirs.listing_of('/tmp')\\n+    assert listing['config-3.10.0-229.14.1.el7.x86_64']['type'] == '-'\\n+    assert listing['menu.lst']['type'] == 'l'\\n+    assert listing['menu.lst']['link'] == './grub.conf'\\n+    assert dirs.dir_entry('/tmp', 'dm-10') == {\\n+        'type': 'b', 'perms': 'rw-rw----.', 'links': 1, 'owner': '0',\\n+        'group': '6', 'major': 253, 'minor': 10, 'date': 'Aug  4 16:56',\\n+        'name': 'dm-10', 'dir': '/tmp', 'raw_entry':\\n+        'brw-rw----.  1 0 6 253,  10 Aug  4 16:56 dm-10'\\n+    }\\n+    assert listing['dm-10']['type'] == 'b'\\n+    assert listing['dm-10']['major'] == 253\\n+    assert listing['dm-10']['minor'] == 10\\n+    assert listing['control']['type'] == 'c'\\n+    assert listing['control']['major'] == 10\\n+    assert listing['control']['minor'] == 236\\n+    assert listing['geany_socket.c46453c2']['type'] == 's'\\n+    assert listing['geany_socket.c46453c2']['size'] == 0\\n+    assert listing['link with spaces']['type'] == 'l'\\n+    assert listing['link with spaces']['link'] == '../file with spaces'\\n+\\n+    # Check that things that _shouldn't_ be there _aren't_\\n+    assert 'size' not in listing['dm-10']\\n+    assert 'size' not in listing['control']\\n+\\n+    # Tricky file names\\n+    assert 'File name with spaces in it!' in listing\\n+    assert 'Unicode ÅÍÎÏÓÔÒÚÆ☃ madness.txt' in listing\\n+    assert 'file_name_ending_with_colon:' in listing\\n+    assert dirs.dir_contains('/tmp', 'File name with spaces in it!')\\n+    assert dirs.dir_contains('/tmp', 'Unicode ÅÍÎÏÓÔÒÚÆ☃ madness.txt')\\n+    assert dirs.dir_contains('/tmp', 'file_name_ending_with_colon:')\\n+\\n+    # For devices missing a comma in their 'size', size is also unconverted\\n+    assert 'block dev with no comma also valid' in listing\\n+    assert listing['block dev with no comma also valid']['size'] == 1048576\\n+    assert 'major' not in listing['block dev with no comma also valid']\\n+    assert 'minor' not in listing['block dev with no comma also valid']\\n+\\n+    # Extended ACLs\\n+    assert 'additional_ACLs' in listing\\n+    assert listing['additional_ACLs']['perms'] == 'rwxr-xr-x+'\\n+\\n+\\n+def test_selinux_directory():\\n+    dirs = FileListing(context_wrap(SELINUX_DIRECTORY))\\n+\\n+    # Test that one entry is exactly what we expect it to be.\\n+    expected = {\\n+        'type': 'd', 'perms': 'rwxr-xr-x.', 'owner': 'root', 'group': 'root',\\n+        'se_user': 'system_u', 'se_role': 'object_r', 'se_type': 'boot_t',\\n+        'se_mls': 's0', 'name': 'grub2', 'raw_entry':\\n+        'drwxr-xr-x. root root system_u:object_r:boot_t:s0      grub2',\\n+        'dir': '/boot'\\n+    }\\n+    actual = dirs.dir_entry('/boot', 'grub2')\\n+    assert actual == expected\\n+\\n+\\n+def test_files_created_with_selinux_disabled():\\n+    dirs = FileListing(context_wrap(FILES_CREATED_WITH_SELINUX_DISABLED))\\n+\\n+    # Test that one entry is exactly what we expect it to be.\\n+    assert dirs.dir_entry('/dev/mapper', 'lv_cpwtk001_data01') == {\\n+        'group': '0', 'name': 'lv_cpwtk001_data01', 'links': 1, 'perms': 'rwxrwxrwx',\\n+        'raw_entry': 'lrwxrwxrwx 1 0 0 7 Apr 27 05:34 lv_cpwtk001_data01 -> ../dm-7', 'owner': '0',\\n+        'link': '../dm-7', 'date': 'Apr 27 05:34', 'type': 'l', 'dir': '/dev/mapper', 'size': 7\\n+    }\\n+\\n+\\n+def test_doc_example():\\n+    env = {'ls_lan': FileListing(context_wrap(FILE_LISTING_DOC))}\\n+    failed, total = doctest.testmod(ls_module, globs=env)\\n+    assert failed == 0\\n\",\"diff --git a/insights/tests/test_ls_parser.py b/insights/tests/test_ls_parser.py\\nindex 4dd5e90897..32ffa26182 100644\\n--- a/insights/tests/test_ls_parser.py\\n+++ b/insights/tests/test_ls_parser.py\\n@@ -14,7 +14,20 @@\\n drwxr-xr-x.  2 root root  4096 Feb  7  2017 private\\n \\\"\\\"\\\"\\n \\n+SINGLE_DIRECTORY_WITH_ENTRY = \\\"\\\"\\\"\\n+/etc:\\n+total 32\\n+drwxr-xr-x.  5 root root  4096 Jun 28  2017 .\\n+drwxr-xr-x. 15 root root  4096 Aug 10 09:42 ..\\n+lrwxrwxrwx.  1 root root    49 Jun 28  2017 cert.pem -> /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\n+drwxr-xr-x.  2 root root  4096 Jun 28  2017 certs\\n+drwxr-xr-x.  2 root root  4096 Mar 29  2017 misc\\n+-rw-r--r--.  1 root root 10923 Feb  7  2017 openssl.cnf\\n+drwxr-xr-x.  2 root root  4096 Feb  7  2017 private\\n+\\\"\\\"\\\"\\n+\\n MULTIPLE_DIRECTORIES = \\\"\\\"\\\"\\n+ls: cannot access '_non_existing_': No such file or directory\\n /etc/sysconfig:\\n total 96\\n drwxr-xr-x.  7 0 0 4096 Jul  6 23:41 .\\n@@ -35,6 +48,7 @@\\n \\\"\\\"\\\"\\n \\n MULTIPLE_DIRECTORIES_WITH_BREAK = \\\"\\\"\\\"\\n+ls: cannot access '_non_existing_': No such file or directory\\n /etc:\\n total 1652\\n drwxr-xr-x. 102   0   0  12288 Nov  6 09:12 .\\n@@ -68,6 +82,7 @@\\n \\n \\n COMPLICATED_FILES = \\\"\\\"\\\"\\n+ls: cannot access '_non_existing_': No such file or directory\\n /tmp:\\n total 16\\n dr-xr-xr-x.  2 0 0     4096 Mar  4 16:19 .\\n@@ -202,6 +217,21 @@ def test_parse_single_directory():\\n     assert res[\\\"links\\\"] == 1\\n     assert res[\\\"dir\\\"] == \\\"/etc\\\"\\n \\n+    results = parse(SINGLE_DIRECTORY_WITH_ENTRY.splitlines())\\n+    stanza = results[\\\"/etc\\\"]\\n+    assert stanza[\\\"name\\\"] == \\\"/etc\\\"\\n+    assert stanza[\\\"total\\\"] == 32\\n+    assert len(stanza[\\\"entries\\\"]) == 7\\n+    res = stanza[\\\"entries\\\"][\\\"cert.pem\\\"]\\n+    assert res[\\\"type\\\"] == \\\"l\\\"\\n+    assert res[\\\"owner\\\"] == \\\"root\\\"\\n+    assert res[\\\"group\\\"] == \\\"root\\\"\\n+    assert res[\\\"date\\\"] == \\\"Jun 28  2017\\\"\\n+    assert res[\\\"name\\\"] == \\\"cert.pem\\\"\\n+    assert res[\\\"link\\\"] == \\\"/etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\\"\\n+    assert res[\\\"links\\\"] == 1\\n+    assert res[\\\"dir\\\"] == \\\"/etc\\\"\\n+\\n \\n def test_parse_multiple_directories():\\n     results = parse(MULTIPLE_DIRECTORIES.splitlines(), None)\\n@@ -232,6 +262,8 @@ def test_parse_multiple_directories_with_break():\\n     assert results[\\\"/etc\\\"][\\\"total\\\"] == 1652\\n     assert results[\\\"/etc/rc.d/rc3.d\\\"][\\\"name\\\"] == \\\"/etc/rc.d/rc3.d\\\"\\n     assert results[\\\"/etc/rc.d/rc3.d\\\"][\\\"total\\\"] == 4\\n+    assert 'chrony.keys' in results['/etc']['files']\\n+    assert 'cifs-utils' in results['/etc']['dirs']\\n \\n     res = results[\\\"/etc\\\"][\\\"entries\\\"][\\\"chrony.conf.20180210135613\\\"]\\n     assert res[\\\"type\\\"] == \\\"-\\\"\"]", "hints_text": ""}
