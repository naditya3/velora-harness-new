{"instance_id": "2156251068116099", "repo": "mothertongues/mothertongues", "base_commit": "dd823394fa12001c1be918b1fe8534b479ccd577", "problem_statement": "Validation errors are not reported in JSON parsing:\\nSo, the issue with the Turtle Mountain Dictionary is that there are some extra fields in the JSON which aren't being accepted by Pydantic (since, presumably, they aren't in the `DictionaryEntry` model).  That's a separate issue from this one! (actually just #16)\\r\\n\\r\\nBut the only way for me to know this was to dive into the class hierarchy leaving a trail of logging statements until I finally got to the place where `ValidationError` is being caught and its contents summarily discarded (in `mothertongues/parsers/__init__.py` line 115):\\r\\n\\r\\n```python\\r\\n            try:\\r\\n                data[i] = DictionaryEntry(**data[i])  # type: ignore\\r\\n            except ValidationError as err:\\r\\n                unparsable.append(data[i])\\r\\n                del data[i]\\r\\n                continue\\r\\n```\\r\\n\\r\\nI think that at the very least these should be logged.  You can log them at `TRACE` level if you like... as long as you mention in the documentation how to see them in the output, which [loguru, inexplicably, does not... sigh](https://github.com/Delgan/loguru/issues/138#issuecomment-525594566), i.e `export LOGURU_LEVEL=TRACE`.", "FAIL_TO_PASS": ["test_dictionary_data.DictionaryDataTest.test_validation_error", "test_dictionary_data.DictionaryDataTest.test_validation_error_json"], "PASS_TO_PASS": ["test_dictionary_data.DictionaryDataTest.test_minimal", "test_index.DictionaryIndexBuilderTest.test_speed", "test_parsers.DictionaryParserTest.test_no_parser", "test_configuration.ConfigurationTest.test_example_sentences_same_length", "test_dictionary_data.DictionaryDataTest.test_missing_definitions", "test_dictionary_data.DictionaryDataTest.test_missing_chars", "test_cli.CommandLineTest.test_new_project_help", "test_dictionary_data.DictionaryDataTest.test_info", "test_cli.CommandLineTest.test_export_validate_happyPath", "test_cli.CommandLineTest.test_export_missingConfigFileArg", "test_configuration.ConfigurationTest.test_string_to_callable_conversion", "test_configuration.ConfigurationTest.test_build_identifier", "test_cli.CommandLineTest.test_export_missingOutputDirArg", "test_configuration.ConfigurationTest.test_paths", "test_index.DictionaryIndexBuilderTest.test_score_brown_corpus", "test_parsers.DictionaryParserTest.test_misconfigured_parser", "test_cli.CommandLineTest.test_schema", "test_parsers.DictionaryParserTest.test_basic_tabular_parsers", "test_configuration.ConfigurationTest.test_targets_are_valid", "test_cli.CommandLineTest.test_export_configFileDoesNotExist", "test_cli.CommandLineTest.test_new_project_duplicateConfigFile_withOverwrite", "test_parsers.DictionaryParserTest.test_xlsx_specifics", "test_configuration.ConfigurationTest.test_alphabet", "test_dictionary_data.DictionaryDataTest.test_multiple_sources", "test_sorter.SorterTest.test_digraph_sorting", "test_configuration.ConfigurationTest.test_transducers", "test_configuration.ConfigurationTest.test_config_does_not_raise_unexpected_errors", "test_cli.CommandLineTest.test_new_project_duplicateDataFile_withOverwrite", "test_cli.CommandLineTest.test_new_project_outputDir", "test_sorter.SorterTest.test_sort_ignorables", "test_sorter.SorterTest.test_sort_formats", "test_cli.CommandLineTest.test_export_outputDirDoesNotExist", "test_cli.CommandLineTest.test_new_project_duplicateConfigFile_noOverwrite", "test_dictionary_data.DictionaryDataTest.test_no_data", "test_dictionary_data.DictionaryDataTest.test_duplicates", "test_sorter.SorterTest.test_sort_in_dictionary", "test_exporter.DictionaryExporterTest.test_export_data", "test_parsers.DictionaryParserTest.test_unparsable_data", "test_sorter.SorterTest.test_sort_oov_characters", "test_configuration.ConfigurationTest.test_no_file_config", "test_parsers.DictionaryParserTest.test_prepending_paths", "test_parsers.DictionaryParserTest.test_json_parser", "test_dictionary_data.DictionaryDataTest.test_missing_required_fields", "test_sorter.SorterTest.test_sort_unicode_df", "test_parsers.DictionaryParserTest.test_custom_parser", "test_cli.CommandLineTest.test_new_project_duplicateDataFile_noOverwrite", "test_sorter.SorterTest.test_sort_unicode", "test_index.DictionaryIndexBuilderTest.test_build_index", "test_cli.CommandLineTest.test_app_basic", "test_configuration.ConfigurationTest.test_data_source_is_parsable", "test_exporter.DictionaryExporterTest.test_empty_export", "test_cli.CommandLineTest.test_export_help", "test_configuration.ConfigurationTest.test_lev_weights", "test_index.DictionaryIndexBuilderTest.test_score"], "language": "python", "test_command": "source /saved/ENV || source /saved/*/ENV && /opt/hostedtoolcache/Python/3.9.22/x64/bin/python3 /app/repo/unittest_loader_no_traceback.py ./mothertongues/tests ;", "test_output_parser": "python/parse_log_unittest", "image_storage_uri": "vmvm-registry.fbinfra.net/repomate_image_activ_python_unittest/mothertongues_mothertongues:dd823394fa12001c1be918b1fe8534b479ccd577", "patch": "", "test_patch": "[\"diff --git a/mothertongues/tests/data/data_invalid.json b/mothertongues/tests/data/data_invalid.json\\nnew file mode 100644\\nindex 0000000..2e90aa8\\n--- /dev/null\\n+++ b/mothertongues/tests/data/data_invalid.json\\n@@ -0,0 +1,4 @@\\n+[{\\n+  \\\"definition\\\": \\\"tree\\\",\\n+  \\\"word\\\": 42\\n+}]\\n\",\"diff --git a/mothertongues/tests/test_dictionary_data.py b/mothertongues/tests/test_dictionary_data.py\\nindex 338be34..c6122cb 100644\\n--- a/mothertongues/tests/test_dictionary_data.py\\n+++ b/mothertongues/tests/test_dictionary_data.py\\n@@ -1,25 +1,35 @@\\n+from contextlib import contextmanager\\n from copy import deepcopy\\n+from loguru import logger\\n \\n from mothertongues.config.models import (\\n     CheckableParserTargetFieldNames,\\n     LanguageConfiguration,\\n     MTDConfiguration,\\n     ResourceManifest,\\n+    ParserEnum,\\n+    ParserTargets,\\n )\\n from mothertongues.dictionary import DataSource, MTDictionary\\n from mothertongues.tests.base_test_case import BasicTestCase\\n from mothertongues.utils import load_mtd_configuration\\n \\n \\n+# See https://loguru.readthedocs.io/en/latest/resources/migration.html#replacing-assertlogs-method-from-unittest-library\\n+@contextmanager\\n+def capture_logs(level=\\\"INFO\\\", format=\\\"{level}:{name}:{message}\\\"):\\n+    \\\"\\\"\\\"Capture loguru-based logs.\\\"\\\"\\\"\\n+    output = []\\n+    handler_id = logger.add(output.append, level=level, format=format)\\n+    yield output\\n+    logger.remove(handler_id)\\n+\\n+\\n class DictionaryDataTest(BasicTestCase):\\n     \\\"\\\"\\\"Test Dictionary Data Checks\\\"\\\"\\\"\\n \\n     def setUp(self):\\n         super().setUp()\\n-        language_config_path = self.data_dir / \\\"config_data_check.json\\\"\\n-        config = load_mtd_configuration(language_config_path)\\n-        self.mtd_config = MTDConfiguration(**config)\\n-        self.dictionary = MTDictionary(self.mtd_config)\\n \\n     def test_no_data(self):\\n         empty_data = DataSource(manifest=ResourceManifest(), resource=[])\\n@@ -27,6 +37,38 @@ def test_no_data(self):\\n         dictionary = MTDictionary(config)\\n         self.assertEqual(len(dictionary), 0)\\n \\n+    def test_validation_error(self):\\n+        bad_data = DataSource(\\n+            manifest=ResourceManifest(),\\n+            resource=[{\\\"word\\\": \\\"foo\\\", \\\"definition\\\": 42}]\\n+        )\\n+        config = MTDConfiguration(\\n+            config=LanguageConfiguration(sorting_field=\\\"word\\\"), data=bad_data\\n+        )\\n+        with capture_logs(\\\"DEBUG\\\") as logs:\\n+            dictionary = MTDictionary(config)\\n+            self.assertEqual(len(dictionary), 0)\\n+        self.assertIn(\\\"validation error\\\", \\\"\\\".join(logs))\\n+\\n+    def test_validation_error_json(self):\\n+        bad_data = DataSource(\\n+            manifest=ResourceManifest(\\n+                file_type=ParserEnum.json,\\n+                targets=ParserTargets(\\n+                    word=\\\"word\\\",\\n+                    definition=\\\"definition\\\",\\n+                ),\\n+            ),\\n+            resource=self.data_dir / \\\"data_invalid.json\\\",\\n+        )\\n+        config = MTDConfiguration(\\n+            config=LanguageConfiguration(sorting_field=\\\"word\\\"), data=bad_data\\n+        )\\n+        with capture_logs(\\\"DEBUG\\\") as logs:\\n+            dictionary = MTDictionary(config)\\n+            self.assertEqual(len(dictionary), 0)\\n+        self.assertIn(\\\"validation error\\\", \\\"\\\".join(logs))\\n+\\n     def test_missing_definitions(self):\\n         empty_data = DataSource(\\n             manifest=ResourceManifest(),\\n@@ -62,13 +104,22 @@ def test_multiple_sources(self):\\n         # The second entry from the second data source (entry override of source label 'test3')\\n         self.assertEqual(dictionary.data[2][\\\"entryID\\\"], \\\"test311\\\")\\n \\n+    def read_data_check(self):\\n+        language_config_path = self.data_dir / \\\"config_data_check.json\\\"\\n+        config = load_mtd_configuration(language_config_path)\\n+        self.mtd_config = MTDConfiguration(**config)\\n+        self.dictionary = MTDictionary(self.mtd_config)\\n+\\n     def test_missing_chars(self):\\n+        self.read_data_check()\\n         self.assertIn(\\\"üòÄ\\\", self.dictionary.sorter.oovs)\\n \\n     def test_duplicates(self):\\n+        self.read_data_check()\\n         self.assertCountEqual(self.dictionary.duplicates, [\\\"4\\\", \\\"6\\\", \\\"9\\\"])\\n \\n     def test_info(self):\\n+        self.read_data_check()\\n         self.assertEqual(self.dictionary[0][\\\"entryID\\\"], \\\"5\\\")\\n \\n     def test_minimal(self):\\n@@ -79,6 +130,7 @@ def test_minimal(self):\\n         self.assertEqual(dictionary.data[0][\\\"entryID\\\"], \\\"words00\\\")\\n \\n     def test_missing_required_fields(self):\\n+        self.read_data_check()\\n         self.assertCountEqual([\\\"7\\\", \\\"6\\\", \\\"9\\\"], self.dictionary.missing_data)\\n         looser_config = deepcopy(self.mtd_config)\\n         looser_config.config.required_fields = [CheckableParserTargetFieldNames.theme]\\n\",\"diff --git a/mothertongues/tests/test_dictionary_data.py b/mothertongues/tests/test_dictionary_data.py\\nindex c6122cb..f63a893 100644\\n--- a/mothertongues/tests/test_dictionary_data.py\\n+++ b/mothertongues/tests/test_dictionary_data.py\\n@@ -1,14 +1,15 @@\\n from contextlib import contextmanager\\n from copy import deepcopy\\n+\\n from loguru import logger\\n \\n from mothertongues.config.models import (\\n     CheckableParserTargetFieldNames,\\n     LanguageConfiguration,\\n     MTDConfiguration,\\n-    ResourceManifest,\\n     ParserEnum,\\n     ParserTargets,\\n+    ResourceManifest,\\n )\\n from mothertongues.dictionary import DataSource, MTDictionary\\n from mothertongues.tests.base_test_case import BasicTestCase\\n@@ -39,8 +40,7 @@ def test_no_data(self):\\n \\n     def test_validation_error(self):\\n         bad_data = DataSource(\\n-            manifest=ResourceManifest(),\\n-            resource=[{\\\"word\\\": \\\"foo\\\", \\\"definition\\\": 42}]\\n+            manifest=ResourceManifest(), resource=[{\\\"word\\\": \\\"foo\\\", \\\"definition\\\": 42}]\\n         )\\n         config = MTDConfiguration(\\n             config=LanguageConfiguration(sorting_field=\\\"word\\\"), data=bad_data\\n\",\"diff --git a/mothertongues/tests/test_cli.py b/mothertongues/tests/test_cli.py\\nindex 62fcd20..3c4ffdc 100644\\n--- a/mothertongues/tests/test_cli.py\\n+++ b/mothertongues/tests/test_cli.py\\n@@ -10,7 +10,7 @@\\n     MTDExportFormat,\\n )\\n from mothertongues.tests.base_test_case import BasicTestCase\\n-from mothertongues.utils import capture_logs\\n+from mothertongues.tests.utils import capture_logs\\n \\n \\n class CommandLineTest(BasicTestCase):\\n\",\"diff --git a/mothertongues/tests/test_dictionary_data.py b/mothertongues/tests/test_dictionary_data.py\\nindex f63a893..947ae91 100644\\n--- a/mothertongues/tests/test_dictionary_data.py\\n+++ b/mothertongues/tests/test_dictionary_data.py\\n@@ -1,8 +1,5 @@\\n-from contextlib import contextmanager\\n from copy import deepcopy\\n \\n-from loguru import logger\\n-\\n from mothertongues.config.models import (\\n     CheckableParserTargetFieldNames,\\n     LanguageConfiguration,\\n@@ -13,25 +10,41 @@\\n )\\n from mothertongues.dictionary import DataSource, MTDictionary\\n from mothertongues.tests.base_test_case import BasicTestCase\\n+from mothertongues.tests.utils import capture_logs\\n from mothertongues.utils import load_mtd_configuration\\n \\n \\n-# See https://loguru.readthedocs.io/en/latest/resources/migration.html#replacing-assertlogs-method-from-unittest-library\\n-@contextmanager\\n-def capture_logs(level=\\\"INFO\\\", format=\\\"{level}:{name}:{message}\\\"):\\n-    \\\"\\\"\\\"Capture loguru-based logs.\\\"\\\"\\\"\\n-    output = []\\n-    handler_id = logger.add(output.append, level=level, format=format)\\n-    yield output\\n-    logger.remove(handler_id)\\n-\\n-\\n class DictionaryDataTest(BasicTestCase):\\n     \\\"\\\"\\\"Test Dictionary Data Checks\\\"\\\"\\\"\\n \\n     def setUp(self):\\n         super().setUp()\\n \\n+    def read_data_check(self):\\n+        language_config_path = self.data_dir / \\\"config_data_check.json\\\"\\n+        config = load_mtd_configuration(language_config_path)\\n+        self.mtd_config = MTDConfiguration(**config)\\n+        self.dictionary = MTDictionary(self.mtd_config)\\n+\\n+    def test_extra_fields(self):\\n+        ds1 = DataSource(\\n+            manifest=ResourceManifest(),\\n+            resource=[\\n+                {\\\"word\\\": \\\"test1\\\", \\\"definition\\\": \\\"test1\\\", \\\"foo\\\": \\\"bar\\\"},\\n+                {\\\"word\\\": \\\"test2\\\", \\\"definition\\\": \\\"test2\\\", \\\"bar\\\": \\\"foo\\\"},\\n+            ],\\n+        )\\n+        config = MTDConfiguration(\\n+            config=LanguageConfiguration(sorting_field=\\\"word\\\"), data=[ds1]\\n+        )\\n+        dictionary = MTDictionary(config)\\n+        self.assertEqual(len(dictionary), 2)\\n+        self.assertEqual(dictionary[0][\\\"foo\\\"], \\\"bar\\\")\\n+        self.assertEqual(dictionary[1][\\\"bar\\\"], \\\"foo\\\")\\n+        # Extra fields aren't guaranteed to be on every entry\\n+        with self.assertRaises(KeyError):\\n+            dictionary[0][\\\"bar\\\"]\\n+\\n     def test_no_data(self):\\n         empty_data = DataSource(manifest=ResourceManifest(), resource=[])\\n         config = MTDConfiguration(config=LanguageConfiguration(), data=empty_data)\\n@@ -104,12 +117,6 @@ def test_multiple_sources(self):\\n         # The second entry from the second data source (entry override of source label 'test3')\\n         self.assertEqual(dictionary.data[2][\\\"entryID\\\"], \\\"test311\\\")\\n \\n-    def read_data_check(self):\\n-        language_config_path = self.data_dir / \\\"config_data_check.json\\\"\\n-        config = load_mtd_configuration(language_config_path)\\n-        self.mtd_config = MTDConfiguration(**config)\\n-        self.dictionary = MTDictionary(self.mtd_config)\\n-\\n     def test_missing_chars(self):\\n         self.read_data_check()\\n         self.assertIn(\\\"üòÄ\\\", self.dictionary.sorter.oovs)\\n\",\"diff --git a/mothertongues/tests/utils.py b/mothertongues/tests/utils.py\\nnew file mode 100644\\nindex 0000000..012585b\\n--- /dev/null\\n+++ b/mothertongues/tests/utils.py\\n@@ -0,0 +1,13 @@\\n+from contextlib import contextmanager\\n+\\n+from loguru import logger\\n+\\n+\\n+# See https://loguru.readthedocs.io/en/latest/resources/migration.html#replacing-assertlogs-method-from-unittest-library\\n+@contextmanager\\n+def capture_logs(level=\\\"INFO\\\", format=\\\"{level}:{name}:{message}\\\"):\\n+    \\\"\\\"\\\"Capture loguru-based logs. Particularly useful for unit testing\\\"\\\"\\\"\\n+    output = []\\n+    handler_id = logger.add(output.append, level=level, format=format)\\n+    yield output\\n+    logger.remove(handler_id)\\n\",\"diff --git a/mothertongues/utils.py b/mothertongues/utils.py\\nindex 64027d9..4898678 100644\\n--- a/mothertongues/utils.py\\n+++ b/mothertongues/utils.py\\n@@ -184,12 +184,3 @@ def string_to_callable(string: Union[Callable, str]) -> Union[str, Callable]:\\n             f\\\"Cannot find method '{function}' in module '{module}'\\\"\\n         ) from exc\\n     return function\\n-\\n-\\n-@contextmanager\\n-def capture_logs(level=\\\"INFO\\\", format=\\\"{level}:{name}:{message}\\\"):\\n-    \\\"\\\"\\\"Capture loguru-based logs. Particularly useful for unit testing\\\"\\\"\\\"\\n-    output = []\\n-    handler_id = logger.add(output.append, level=level, format=format)\\n-    yield output\\n-    logger.remove(handler_id)\\n\",\"diff --git a/mothertongues/tests/data/config_csv_multi.json b/mothertongues/tests/data/config_csv_multi.json\\nnew file mode 100644\\nindex 0000000..ffc3095\\n--- /dev/null\\n+++ b/mothertongues/tests/data/config_csv_multi.json\\n@@ -0,0 +1,13 @@\\n+{\\n+    \\\"config\\\": {\\n+        \\\"L1\\\": \\\"Danish\\\",\\n+        \\\"L2\\\": \\\"English\\\",\\n+        \\\"build\\\": \\\"mothertongues.utils.get_current_time\\\",\\n+        \\\"optional_field_name\\\": \\\"Optional Info\\\",\\n+        \\\"alphabet\\\": \\\"./alphabet.json\\\"\\n+    },\\n+    \\\"data\\\": [{\\n+        \\\"manifest\\\": \\\"./manifest_csv_multi.json\\\",\\n+        \\\"resource\\\": \\\"./data_multi.csv\\\"\\n+    }]\\n+}\\n\",\"diff --git a/mothertongues/tests/data/data_multi.csv b/mothertongues/tests/data/data_multi.csv\\nnew file mode 100644\\nindex 0000000..47650d2\\n--- /dev/null\\n+++ b/mothertongues/tests/data/data_multi.csv\\n@@ -0,0 +1,2 @@\\n+entryID,definition,word,audio1_description,audio1_filename,theme,pos,example_sentence1,example_definition1,example1_audio1_description,example1_audio1_filename,example1_audio2_description,example1_audio2_filename\\n+1,tree,tr√¶,Aidan Pine,tree.mp3,plants,noun,Har du r√∏de √∏jne?,Do you have red eyes?,Aidan Pine,rode1.mp3,Aidan Pine,rode2.mp3\\n\",\"diff --git a/mothertongues/tests/data/manifest_csv_multi.json b/mothertongues/tests/data/manifest_csv_multi.json\\nnew file mode 100644\\nindex 0000000..ac28a91\\n--- /dev/null\\n+++ b/mothertongues/tests/data/manifest_csv_multi.json\\n@@ -0,0 +1,37 @@\\n+{\\n+    \\\"file_type\\\": \\\"csv\\\",\\n+    \\\"skip_header\\\": true,\\n+    \\\"name\\\": \\\"words\\\",\\n+    \\\"transducers\\\": [{\\n+        \\\"input_field\\\": \\\"word\\\",\\n+        \\\"output_field\\\": \\\"sort_form\\\",\\n+        \\\"lower\\\": true\\n+    }],\\n+    \\\"targets\\\": {\\n+        \\\"entryID\\\": \\\"0\\\",\\n+        \\\"definition\\\": \\\"1\\\",\\n+        \\\"word\\\": \\\"2\\\",\\n+        \\\"audio\\\": [{\\n+            \\\"description\\\": \\\"3\\\",\\n+            \\\"filename\\\": \\\"4\\\"\\n+        }],\\n+        \\\"theme\\\": \\\"5\\\",\\n+        \\\"optional\\\": {\\n+            \\\"Part of Speech\\\": \\\"6\\\"\\n+        },\\n+        \\\"example_sentence\\\": [\\\"7\\\"],\\n+        \\\"example_sentence_definition\\\": [\\\"8\\\"],\\n+        \\\"example_sentence_audio\\\": [\\n+            [\\n+                {\\n+                    \\\"description\\\": \\\"9\\\",\\n+                    \\\"filename\\\": \\\"10\\\"\\n+                },\\n+                {\\n+                    \\\"description\\\": \\\"11\\\",\\n+                    \\\"filename\\\": \\\"12\\\"\\n+                }\\n+            ]\\n+        ]\\n+    }\\n+}\\n\",\"diff --git a/mothertongues/tests/test_dictionary_data.py b/mothertongues/tests/test_dictionary_data.py\\nindex 947ae91..604f5c9 100644\\n--- a/mothertongues/tests/test_dictionary_data.py\\n+++ b/mothertongues/tests/test_dictionary_data.py\\n@@ -117,6 +117,40 @@ def test_multiple_sources(self):\\n         # The second entry from the second data source (entry override of source label 'test3')\\n         self.assertEqual(dictionary.data[2][\\\"entryID\\\"], \\\"test311\\\")\\n \\n+    def test_multiple_example_audio(self):\\n+        language_config_path = self.data_dir / \\\"config_csv_multi.json\\\"\\n+        config = load_mtd_configuration(language_config_path)\\n+        mtd_config = MTDConfiguration(**config)\\n+        dictionary = MTDictionary(mtd_config)\\n+        self.assertEqual(len(dictionary), 1)\\n+        entry = dictionary.data[0]\\n+        self.assertEqual(\\n+            entry,\\n+            {\\n+                \\\"word\\\": \\\"tr√¶\\\",\\n+                \\\"definition\\\": \\\"tree\\\",\\n+                \\\"entryID\\\": \\\"1\\\",\\n+                \\\"theme\\\": \\\"plants\\\",\\n+                \\\"secondary_theme\\\": \\\"\\\",\\n+                \\\"img\\\": \\\"\\\",\\n+                \\\"audio\\\": [{\\\"description\\\": \\\"Aidan Pine\\\", \\\"filename\\\": \\\"tree.mp3\\\"}],\\n+                \\\"definition_audio\\\": [],\\n+                \\\"example_sentence\\\": [\\\"Har du r√∏de √∏jne?\\\"],\\n+                \\\"example_sentence_definition\\\": [\\\"Do you have red eyes?\\\"],\\n+                \\\"example_sentence_audio\\\": [\\n+                    [\\n+                        {\\\"description\\\": \\\"Aidan Pine\\\", \\\"filename\\\": \\\"rode1.mp3\\\"},\\n+                        {\\\"description\\\": \\\"Aidan Pine\\\", \\\"filename\\\": \\\"rode2.mp3\\\"},\\n+                    ]\\n+                ],\\n+                \\\"example_sentence_definition_audio\\\": [],\\n+                \\\"optional\\\": {\\\"Part of Speech\\\": \\\"noun\\\"},\\n+                \\\"source\\\": \\\"words\\\",\\n+                \\\"sort_form\\\": \\\"tr√¶\\\",\\n+                \\\"sorting_form\\\": [19, 17, 26],\\n+            },\\n+        )\\n+\\n     def test_missing_chars(self):\\n         self.read_data_check()\\n         self.assertIn(\\\"üòÄ\\\", self.dictionary.sorter.oovs)\\n\",\"diff --git a/mothertongues/tests/test_parsers.py b/mothertongues/tests/test_parsers.py\\nindex 14995e7..76791ed 100644\\n--- a/mothertongues/tests/test_parsers.py\\n+++ b/mothertongues/tests/test_parsers.py\\n@@ -200,6 +200,9 @@ def test_basic_tabular_parsers(self):\\n             self.assertEqual(dictionary.data[3][\\\"word\\\"], \\\"tr√¶\\\")\\n             data = self._correct_data(dictionary.data)\\n             self.assertCountEqual(data, self.parsed_data)\\n+            mtd_config.data[0].manifest.skip_header = True\\n+            dictionary = MTDictionary(mtd_config)\\n+            self.assertEqual(len(dictionary.data), len(self.parsed_data) - 1)\\n \\n     def test_xlsx_specifics(self):\\n         language_config_path = self.data_dir / \\\"config_xlsx.json\\\"\\n\",\"diff --git a/mothertongues/tests/data/manifest_json.json b/mothertongues/tests/data/manifest_json.json\\nindex 90378d4..9e5effa 100644\\n--- a/mothertongues/tests/data/manifest_json.json\\n+++ b/mothertongues/tests/data/manifest_json.json\\n@@ -17,10 +17,17 @@\\n                 \\\"filename\\\": \\\"filename\\\"\\n             }\\n         },\\n-        \\\"example_sentence\\\": [\\n-            \\\"example_sentence_1\\\",\\n-            \\\"example_sentence_2\\\"\\n-        ],\\n+        \\\"example_sentence\\\": [\\\"example_sentence_1\\\", \\\"example_sentence_2\\\"],\\n+        \\\"example_sentence_audio\\\": {\\n+            \\\"listof\\\": \\\"example_sentence_audio\\\",\\n+            \\\"value\\\": {\\n+                \\\"listof\\\": \\\"$\\\",\\n+                \\\"value\\\": {\\n+                    \\\"description\\\": \\\"speaker\\\",\\n+                    \\\"filename\\\": \\\"filename\\\"\\n+                }\\n+            }\\n+        },\\n         \\\"example_sentence_definition\\\": [\\n             \\\"example_sentence_definition_1\\\",\\n             \\\"example_sentence_definition_2\\\"\\n\",\"diff --git a/mothertongues/tests/test_dictionary_data.py b/mothertongues/tests/test_dictionary_data.py\\nindex 604f5c9..8614171 100644\\n--- a/mothertongues/tests/test_dictionary_data.py\\n+++ b/mothertongues/tests/test_dictionary_data.py\\n@@ -118,10 +118,38 @@ def test_multiple_sources(self):\\n         self.assertEqual(dictionary.data[2][\\\"entryID\\\"], \\\"test311\\\")\\n \\n     def test_multiple_example_audio(self):\\n-        language_config_path = self.data_dir / \\\"config_csv_multi.json\\\"\\n-        config = load_mtd_configuration(language_config_path)\\n-        mtd_config = MTDConfiguration(**config)\\n-        dictionary = MTDictionary(mtd_config)\\n+        dictionary = self.create_test_dictionary_from_config(\\\"config_csv_multi.json\\\")\\n+        self.assertEqual(len(dictionary), 1)\\n+        entry = dictionary.data[0]\\n+        self.assertEqual(\\n+            entry,\\n+            {\\n+                \\\"word\\\": \\\"tr√¶\\\",\\n+                \\\"definition\\\": \\\"tree\\\",\\n+                \\\"entryID\\\": \\\"1\\\",\\n+                \\\"theme\\\": \\\"plants\\\",\\n+                \\\"secondary_theme\\\": \\\"\\\",\\n+                \\\"img\\\": \\\"\\\",\\n+                \\\"audio\\\": [{\\\"description\\\": \\\"Aidan Pine\\\", \\\"filename\\\": \\\"tree.mp3\\\"}],\\n+                \\\"definition_audio\\\": [],\\n+                \\\"example_sentence\\\": [\\\"Har du r√∏de √∏jne?\\\"],\\n+                \\\"example_sentence_definition\\\": [\\\"Do you have red eyes?\\\"],\\n+                \\\"example_sentence_audio\\\": [\\n+                    [\\n+                        {\\\"description\\\": \\\"Aidan Pine\\\", \\\"filename\\\": \\\"rode1.mp3\\\"},\\n+                        {\\\"description\\\": \\\"Aidan Pine\\\", \\\"filename\\\": \\\"rode2.mp3\\\"},\\n+                    ]\\n+                ],\\n+                \\\"example_sentence_definition_audio\\\": [],\\n+                \\\"optional\\\": {\\\"Part of Speech\\\": \\\"noun\\\"},\\n+                \\\"source\\\": \\\"words\\\",\\n+                \\\"sort_form\\\": \\\"tr√¶\\\",\\n+                \\\"sorting_form\\\": [19, 17, 26],\\n+            },\\n+        )\\n+\\n+    def test_multiple_sentences(self):\\n+        dictionary = self.create_test_dictionary_from_config(\\\"config_csv_multi.json\\\")\\n         self.assertEqual(len(dictionary), 1)\\n         entry = dictionary.data[0]\\n         self.assertEqual(\\n@@ -164,12 +192,15 @@ def test_info(self):\\n         self.assertEqual(self.dictionary[0][\\\"entryID\\\"], \\\"5\\\")\\n \\n     def test_minimal(self):\\n-        config_path = self.data_dir / \\\"config_minimal.json\\\"\\n-        config = load_mtd_configuration(config_path)\\n-        mtd_config = MTDConfiguration(**config)\\n-        dictionary = MTDictionary(mtd_config)\\n+        dictionary = self.create_test_dictionary_from_config(\\\"config_minimal.json\\\")\\n         self.assertEqual(dictionary.data[0][\\\"entryID\\\"], \\\"words00\\\")\\n \\n+    def create_test_dictionary_from_config(self, config):\\n+        language_config_path = self.data_dir / config\\n+        config = load_mtd_configuration(language_config_path)\\n+        mtd_config = MTDConfiguration(**config)\\n+        return MTDictionary(mtd_config)\\n+\\n     def test_missing_required_fields(self):\\n         self.read_data_check()\\n         self.assertCountEqual([\\\"7\\\", \\\"6\\\", \\\"9\\\"], self.dictionary.missing_data)\\n\",\"diff --git a/mothertongues/tests/test_parsers.py b/mothertongues/tests/test_parsers.py\\nindex 76791ed..dc6ee75 100644\\n--- a/mothertongues/tests/test_parsers.py\\n+++ b/mothertongues/tests/test_parsers.py\\n@@ -169,7 +169,16 @@ def setUp(self):\\n                     \\\"Do you have red eyes?\\\",\\n                     \\\"Dead, red, red-eyed, rotten, smoked trout.\\\",\\n                 ],\\n-                \\\"example_sentence_audio\\\": [],\\n+                \\\"example_sentence_audio\\\": [\\n+                    [\\n+                        {\\\"description\\\": \\\"AP\\\", \\\"filename\\\": \\\"ap_sent1.mp3\\\"},\\n+                        {\\\"description\\\": \\\"AR\\\", \\\"filename\\\": \\\"ar_sent1.mp3\\\"},\\n+                    ],\\n+                    [\\n+                        {\\\"description\\\": \\\"AP\\\", \\\"filename\\\": \\\"ap_sent2.mp3\\\"},\\n+                        {\\\"description\\\": \\\"AR\\\", \\\"filename\\\": \\\"ar_sent2.mp3\\\"},\\n+                    ],\\n+                ],\\n                 \\\"example_sentence_definition_audio\\\": [],\\n                 \\\"optional\\\": {\\\"Part of Speech\\\": \\\"noun\\\"},\\n                 \\\"source\\\": \\\"words\\\",\\n@@ -187,6 +196,9 @@ def test_json_parser(self):\\n         self.maxDiff = None\\n         self.assertEqual(dictionary.data[0][\\\"word\\\"], \\\"farvel\\\")\\n         self.assertEqual(dictionary.data[3][\\\"word\\\"], \\\"tr√¶\\\")\\n+        self.assertEqual(len(dictionary.data[3][\\\"example_sentence\\\"]), 2)\\n+        self.assertEqual(len(dictionary.data[3][\\\"example_sentence_audio\\\"]), 2)\\n+        self.assertEqual(len(dictionary.data[3][\\\"example_sentence_audio\\\"][0]), 2)\\n         self.assertCountEqual(dictionary.data, self.parsed_data)\\n \\n     def test_basic_tabular_parsers(self):\\n@@ -271,6 +283,9 @@ def _correct_data(self, data):\\n         data[3][\\\"example_sentence_definition\\\"] = self.parsed_data[3][\\n             \\\"example_sentence_definition\\\"\\n         ]\\n+        data[3][\\\"example_sentence_audio\\\"] = self.parsed_data[3][\\n+            \\\"example_sentence_audio\\\"\\n+        ]\\n         return data\\n \\n     def test_unparsable_data(self):\"]", "hints_text": ""}
