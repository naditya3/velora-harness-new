{"instance_id": "1436436551030761", "repo": "mondeja/mdpo", "base_commit": "4bff661182d5e4be1dcec90a6ca05d97060fdeb7", "problem_statement": "Image links not rendered correctly (regression in v0.3.68):\\n## Reproducible example\\r\\n\\r\\n```markdown\\r\\n[![Image title][image-link]][link]\\r\\n\\r\\n[image-link]: https://image.ext\\r\\n[link]: https://link.ext\\r\\n```\\r\\n\\r\\n```po\\r\\n#\\r\\nmsgid \"\"\\r\\nmsgstr \"\"\\r\\n```\\r\\n\\r\\n```markdown\\r\\n$ po2md foo.md -p foo.po\\r\\n![Image title](https://image.ext)[][link]\\r\\n\\r\\n[image-link]: https://image.ext\\r\\n[link]: https://link.ext\\r\\n```\\r\\n\\r\\nRelated #175", "FAIL_TO_PASS": ["test/test_text.py::test_parse_strint_0_inf[-1-inf-None1]", "test/test_text.py::test_parse_strint_0_inf[-1.1-inf-None0]", "test/test_text.py::test_parse_strint_0_inf[-1-inf-None0]", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[code-blocks.md]", "test/test_text.py::test_parse_strint_0_inf[-inf-inf-None]", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[images.md]", "test/test_text.py::test_parse_strint_0_inf[-1.1-inf-None1]", "test/test_md2po/test_extract.py::test_extract_markuptext[images.md]", "test/test_text.py::test_parse_strint_0_inf[1.1-1-None]"], "PASS_TO_PASS": ["test/test_mdpo2html/test_mdpo2html_translate.py::test_translate_markuptext[images.html]", "test/test_md2po/test_extract.py::test_extract_markuptext[ul-with-others.md]", "test/test_md2po/test_extract.py::test_extract_plaintext[paragraphs-with-others.md]", "test/test_md2po/test_extract.py::test_extract_markuptext[ul-nested.md]", "test/test_md2po/test_commands/test_md2po_disable.py::test_disabled_entries", "test/test_md2po/test_commands/test_md2po_disable.py::test_enable_next_line[on-next-line-command_aliases1]", "test/test_command.py::test_normalize_mdpo_command_aliases[command_aliases3-ValueError]", "test/test_md2po/test_commands/test_md2po_translator.py::test_translator_command_paragraph[mdpo-translator-command_aliases0]", "test/test_md2po/test_commands/test_md2po_include.py::test_include_comment[mdpo-include-command_aliases0]", "test/test_md2po/test_extract.py::test_extract_plaintext[ul.md]", "test/test_po.py::test_po_escaped_string[jfsakjbfjksafs-\\\\j]", "test/test_mdpo2html/test_mdpo2html_cli.py::test_stdin", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[paragraphs.md-80]", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[ul.md-80]", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[bold.md]", "test/test_md2po/test_extract.py::test_extract_plaintext[latexmath-display.md]", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[ul.md-10]", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[ol-nested.md]", "test/test_mdpo2html/test_mdpo2html_translate.py::test_translate_merge_adjacent_markups[bold.html]", "test/test_text.py::test_min_not_max_chars_in_a_row[`-hello", "test/test_md2po/test_extract.py::test_extract_markuptext[blockquotes.md]", "test/test_md2po/test_extract.py::test_extract_markuptext[italic-link.md]", "test/test_md2po/test_extract.py::test_extract_plaintext[default-escapes.md]", "test/test_md2po/test_obsoletes.py::test_tcomment_obsolete_msgstr_fallback_without_found_tcomment[]", "test/test_md2po/test_extract.py::test_extract_markuptext[wikilinks.md]", "test/test_io.py::TestToFileContentIfIsFile::test_file", "test/test_io.py::TestToFileContentIfIsFile::test_content", "test/test_mdpo2html/test_commands/test_mdpo2html_include_codeblock.py::test_include_codeblock[mdpo-include-codeblock-command_aliases0]", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[ul.md-0]", "test/test_text.py::test_min_not_max_chars_in_a_row[`-hello-1]", "test/test_md2po/test_obsoletes.py::test_fuzzy_obsolete_msgstr_fallback[Por", "test/test_md2po/test_location.py::test_location_quotes", "test/test_text.py::test_parse_escaped_pair[foo:", "test/test_md2po/test_commands/test_md2po_include.py::test_include_comment_with_extracted_and_context", "test/test_po.py::test_po_escaped_string[`[-\\\\`]", "test/test_mdpo2html/test_commands/test_mdpo2html_context.py::test_context_without_value[contextualization-command_aliases1]", "test/test_md2po/test_obsoletes.py::test_obsolete_msgstr_fallback[]", "test/test_cli.py::test_parse_command_aliases_cli_arguments[foo:bar,baz\\\\\\\\::qux-{\"foo\":", "test/test_md2po/test_extract.py::test_extract_plaintext[images.md]", "test/test_md2po/test_md2po_events.py::test_enter_leave_span_event[False-Hello", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[wikilinks.md]", "test/test_md2po/test_commands/test_md2po_codeblocks.py::test_include_fenced_codeblock", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[ul-nested.md]", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[tasklist-nested.md]", "test/test_md2po/test_extract.py::test_extract_markuptext[default-escapes.md]", "test/test_md2po/test_extract.py::test_extract_markuptext[bold-link.md]", "test/test_text.py::test_parse_escaped_pair[foo:Bar\\\\:-foo-Bar\\\\:-None]", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[tasklist.md-10]", "test/test_command.py::test_normalize_mdpo_command[include-mdpo-include]", "test/test_command.py::test_normalize_mdpo_command_aliases[command_aliases1-expected_result1]", "test/test_mdpo2html/test_mdpo2html_translate.py::test_translate_markuptext[hr.html]", "test/test_mdpo2html/test_commands/test_mdpo2html_disable.py::test_disable_enable[commands0-command_aliases0]", "test/test_md2po/test_extract.py::test_extract_markuptext[links-bold.md]", "test/test_md2po/test_extract.py::test_extract_plaintext[softbreaks.md]", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[tasklist.md-40]", "test/test_io.py::TestToGlobOrContent::test_content", "test/test_po2md/test_po2md_cli.py::test_stdin", "test/test_mdpo2html/test_commands/test_mdpo2html_disable.py::test_enable_next_line[on-next-line-command_aliases1]", "test/test_po2md/test_commands/test_po2md_disable.py::test_enable_next_line[mdpo-enable-next-line-command_aliases0]", "test/test_command.py::test_normalize_mdpo_command_aliases[command_aliases2-expected_result2]", "test/test_md2po/test_extract.py::test_extract_plaintext[strikethrough.md]", "test/test_md2po/test_extract.py::test_extract_plaintext[ul-with-others.md]", "test/test_command.py::test_parse_mdpo_html_command[<!--mdpo-include", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[links.md]", "test/test_text.py::test_parse_escaped_pair[\\\\:foo:bar-:foo-bar-None]", "test/test_md2po/test_md2po_events.py::test_enter_leave_span_event[True-Hello", "test/test_md2po/test_commands/test_md2po_context.py::test_context_without_value[mdpo-context-command_aliases0]", "test/test_md2po/test_commands/test_md2po_include.py::test_include_comment_without_value[this-message-also-command_aliases1]", "test/test_mdpo2html/test_commands/test_mdpo2html_context.py::test_context[mdpo-context-command_aliases0]", "test/test_po2md/test_po2md_disabled_entries.py::test_disabled_entries", "test/test_command.py::test_normalize_mdpo_command[include-codeblock-mdpo-include-codeblock]", "test/test_po2md/test_commands/test_po2md_context.py::test_context[contextualization-command_aliases1]", "test/test_md2po/test_obsoletes.py::test_tcomment_obsolete_msgstr_fallback_with_found_tcomment[Por", "test/test_md2po/test_commands/test_md2po_codeblocks.py::test_disable_codeblocks[mdpo-disable-codeblocks-command_aliases0]", "test/test_md2po/test_location.py::test_location_unordered_lists", "test/test_mdpo2html/test_commands/test_mdpo2html_disable.py::test_disable_enable[commands2-command_aliases2]", "test/test_md2po/test_commands/test_md2po_translator.py::test_translator_command_without_value[mdpo-translator-command_aliases0]", "test/test_po2md/test_commands/test_po2md_disable.py::test_disable_next_line[off-next-line-command_aliases1]", "test/test_po.py::test_po_escaped_string[**-\\\\*]", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[ol.md-40]", "test/test_text.py::test_parse_escaped_pair[:foo\\\\\\\\:Bar:baz\\\\\\\\-:foo:Bar-baz\\\\\\\\-None]", "test/test_md2po/test_commands/test_md2po_disable.py::test_disable_enable_raw_inline", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[paragraphs.md]", "test/test_cli.py::test_parse_command_aliases_cli_arguments[foo:bar-{\"foo\":", "test/test_md2po/test_extract.py::test_extract_plaintext[horizontal-rule.md]", "test/test_mdpo2html/test_mdpo2html_translate.py::test_translate_markuptext[ul-bold.html]", "test/test_mdpo2html/test_mdpo2html_translate.py::test_translate_markuptext[h.html]", "test/test_command.py::test_parse_mdpo_html_command[<!--", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[ol.md]", "test/test_md2po/test_extractor.py::test_md2po_save_without_po_filepath", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[blockquote.md-10]", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[paragraphs.md-0]", "test/test_cli.py::test_parse_command_aliases_cli_arguments[foo:bar,foo:baz-error:", "test/test_md2po/test_extract.py::test_extract_markuptext[headers-with-code.md]", "test/test_md2po/test_obsoletes.py::test_tcomment_obsolete_msgstr_fallback_with_found_tcomment[]", "test/test_command.py::test_get_valid_mdpo_command_names", "test/test_md2po/test_extract.py::test_extract_markuptext[links.md]", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[tasklist.md-0]", "test/test_md2po/test_extract.py::test_extract_plaintext[latexmath.md]", "test/test_md2po/test_extract.py::test_extract_markuptext[bold.md]", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[tasklist.md-inf]", "test/test_md2po/test_md2po_cli.py::test_pipe_redirect_file_stdin", "test/test_md2po/test_extract.py::test_extract_markuptext[strikethrough.md]", "test/test_mdpo2html/test_mdpo2html_translate.py::test_translate_markuptext[ul-bold-code.html]", "test/test_md2po/test_commands/test_md2po_include.py::test_include_comment[this-message-also-command_aliases1]", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[bold-link.md]", "test/test_po2md/test_po2md_translate.py::test_translate_save[blockquotes.md]", "test/test_md2po/test_extractor.py::test_msgstr", "test/test_md2po/test_commands/test_md2po_codeblocks.py::test_disable_codeblocks[off-codeblocks-command_aliases1]", "test/test_mdpo2html/test_commands/test_mdpo2html_context.py::test_context[contextualization-command_aliases1]", "test/test_command.py::test_normalize_mdpo_command_aliases[command_aliases0-expected_result0]", "test/test_command.py::test_normalize_mdpo_command[mdpo-include-mdpo-include]", "test/test_io.py::TestToGlobOrContent::test_glob", "test/test_command.py::test_parse_mdpo_html_command[<!--mdpo-includeHello", "test/test_io.py::TestFilterPaths::test_ignore_files_by_dirpath", "test/test_md2po/test_extract.py::test_extract_markuptext[latexmath.md]", "test/test_md2po/test_extract.py::test_extract_plaintext[wikilinks.md]", "test/test_command.py::test_parse_mdpo_html_command[<!--mdpo_include", "test/test_md2po/test_commands/test_md2po_disable.py::test_enable_next_line[mdpo-enable-next-line-command_aliases0]", "test/test_po2md/test_commands/test_po2md_include_codeblock.py::test_include_fenced_codeblock", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[paragraphs.md-10]", "test/test_text.py::test_parse_escaped_pair[foo:Bar:-foo-Bar:-None]", "test/test_md2po/test_commands/test_md2po_context.py::test_context[mdpo-context-command_aliases0]", "test/test_md2po/test_extract.py::test_extract_plaintext[headers.md]", "test/test_md2po/test_extract.py::test_extract_markuptext[bold-italic.md]", "test/test_md2po/test_md2po_events.py::test_enter_leave_block_event[True]", "test/test_md2po/test_location.py::test_location_headers", "test/test_md2po/test_obsoletes.py::test_obsolete_not_equal_found[mark_not_found_as_obsolete=True]", "test/test_mdpo2html/test_commands/test_mdpo2html_disable.py::test_enable_next_line[mdpo-enable-next-line-command_aliases0]", "test/test_mdpo2html/test_mdpo2html_translate.py::test_translate_markuptext[bold-italic.html]", "test/test_md2po/test_obsoletes.py::test_fuzzy_obsolete_msgstr_fallback[]", "test/test_po2md/test_commands/test_po2md_include_codeblock.py::test_include_indented_codeblock", "test/test_md2po/test_commands/test_md2po_codeblocks.py::test_disable_next_codeblock[off-codeblock-command_aliases1]", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[gh-tables.md]", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[tasklist.md]", "test/test_md2po/test_extract.py::test_extract_plaintext[ol.md]", "test/test_md2po/test_extract.py::test_extract_plaintext[paragraphs.md]", "test/test_md2po/test_location.py::test_location_ordered_lists", "test/test_md2po/test_commands/test_md2po_translator.py::test_translator_command_without_value[hey-translator-command_aliases1]", "test/test_po.py::test_po_escaped_string[\\n-\\\\\\n]", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[tasklist.md-80]", "test/test_md2po/test_extract.py::test_extract_plaintext[gh-tables.md]", "test/test_po2md/test_commands/test_po2md_disable.py::test_disable_enable[commands2-command_aliases2]", "test/test_po2md/test_po2md_pofiles_glob.py::test_multiple_pofiles_glob", "test/test_po2md/test_commands/test_po2md_disable.py::test_disable_enable[commands1-command_aliases1]", "test/test_md2po/test_md2po_events.py::test_enter_block_event[False]", "test/test_md2po/test_location.py::test_location_html", "test/test_md2po/test_commands/test_md2po_translator.py::test_translator_command_paragraph[hey-translator-command_aliases1]", "test/test_md2po/test_md2po_events.py::test_text_event[True]", "test/test_po.py::test_po_escaped_string[\\\\n-\\\\\\\\]", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[ul.md-40]", "test/test_po2md/test_commands/test_po2md_disable.py::test_enable_next_line[on-next-line-command_aliases1]", "test/test_text.py::test_parse_escaped_pair[-None-None-ValueError]", "test/test_md2po/test_extract.py::test_extract_plaintext[bold-code.md]", "test/test_po2md/test_po2md_translated_entries.py::test_translated_entries", "test/test_md2po/test_extract.py::test_extract_markuptext[links-code.md]", "test/test_md2po/test_commands/test_md2po_codeblocks.py::test_include_codeblocks[on-codeblocks-command_aliases1]", "test/test_md2po/test_md2po_events.py::test_text_event[False]", "test/test_md2po/test_extract.py::test_extract_plaintext[bold-italic.md]", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[ol.md-0]", "test/test_mdpo2html/test_commands/test_mdpo2html_context.py::test_context_without_value[mdpo-context-command_aliases0]", "test/test_mdpo2html/test_mdpo2html_translate.py::test_translate_markuptext[paragraphs.html]", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[ul.md]", "test/test_md2po/test_extract.py::test_extract_markuptext[headers-with-bold.md]", "test/test_mdpo2html/test_commands/test_mdpo2html_disable.py::test_disable_enable[commands1-command_aliases1]", "test/test_io.py::TestFilterPaths::test_ignore_directory_by_dirname", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[ul.md-inf]", "test/test_md2po/test_commands/test_md2po_codeblocks.py::test_include_indented_codeblock[mdpo-include-codeblock-command_aliases0]", "test/test_md2po/test_obsoletes.py::test_obsolete_msgstr_fallback[Por", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[links-bold.md]", "test/test_md2po/test_commands/test_md2po_disable.py::test_disable_next_line[off-next-line-command_aliases1]", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[blockquote.md-0]", "test/test_md2po/test_md2po_events.py::test_command_event[True]", "test/test_md2po/test_commands/test_md2po_context.py::test_context_without_value[contextualization-command_aliases1]", "test/test_md2po/test_extract.py::test_extract_markuptext[paragraphs-with-others.md]", "test/test_md2po/test_commands/test_md2po_include.py::test_include_comment_without_value[mdpo-include-command_aliases0]", "test/test_md2po/test_md2po_events.py::test_link_reference_event", "test/test_md2po/test_commands/test_md2po_codeblocks.py::test_include_indented_codeblock[on-codeblock-command_aliases1]", "test/test_md2po/test_location.py::test_location_file_independent", "test/test_md2po/test_extract.py::test_extract_plaintext[links.md]", "test/test_io.py::TestFilterPaths::test_ignore_files_by_filename", "test/test_md2po/test_extract.py::test_extract_markuptext[tasklist.md]", "test/test_md2po/test_extract.py::test_extract_plaintext[bold.md]", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[bold-code.md]", "test/test_md2po/test_obsoletes.py::test_tcomment_obsolete_msgstr_fallback_without_found_tcomment[Por", "test/test_mdpo2html/test_mdpo2html_translate.py::test_translate_markuptext[ul.html]", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[bold-italic.md]", "test/test_command.py::test_normalize_mdpo_command[include_codeblock-None]", "test/test_po2md/test_po2md_events.py::test_msgid_event", "test/test_po2md/test_commands/test_po2md_disable.py::test_disable_enable[commands0-command_aliases0]", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[blockquote.md-80]", "test/test_md2po/test_extract.py::test_extract_markuptext[indented-code-blocks.md]", "test/test_mdpo2html/test_mdpo2html_translate.py::test_translate_markuptext[tables.html]", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[paragraph-code-softbreaks.md]", "test/test_md2po/test_x_headers.py::test_x_headers_included", "test/test_io.py::TestToGlobOrContent::test_bad_glob_characters_range", "test/test_po2md/test_po2md_events.py::test_command_event", "test/test_md2po/test_commands/test_md2po_disable.py::test_disable_enable[commands1-command_aliases1]", "test/test_text.py::test_parse_escaped_pair[:-None-None-ValueError]", "test/test_po2md/test_commands/test_po2md_context.py::test_context_without_value[mdpo-context-command_aliases0]", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[links-italic.md]", "test/test_text.py::test_parse_escaped_pair[foo:bar-foo-bar-None]", "test/test_po2md/test_commands/test_po2md_context.py::test_context_without_value[contextualization-command_aliases1]", "test/test_mdpo2html/test_commands/test_mdpo2html_disable.py::test_disable[off-command_aliases1]", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[paragraphs.md-inf]", "test/test_md2po/test_extractor.py::test_ignore_msgids", "test/test_po.py::test_po_escaped_string[*-\\\\*]", "test/test_md2po/test_commands/test_md2po_disable.py::test_disable_enable[commands0-command_aliases0]", "test/test_md2po/test_commands/test_md2po_context.py::test_context[contextualization-command_aliases1]", "test/test_md2po/test_obsoletes.py::test_obsolete_with_msgctxt_not_matching_msgstr_fallback", "test/test_md2po/test_location.py::test_location_paragraphs", "test/test_md2po/test_extract.py::test_extract_markuptext[latexmath-display.md]", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[paragraphs.md-40]", "test/test_text.py::test_parse_escaped_pair[foo-None-None-ValueError]", "test/test_md2po/test_obsoletes.py::test_obsolete_with_msgctxt_matching_msgstr_fallback", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[blockquotes.md]", "test/test_md2po/test_extract.py::test_extract_markuptext[links-italic.md]", "test/test_md2po/test_md2po_events.py::test_enter_leave_block_event[False]", "test/test_md2po/test_location.py::test_location_tables", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[links-code.md]", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[blockquote.md-inf]", "test/test_text.py::test_parse_escaped_pair[foo\\\\\\\\:Bar:baz\\\\\\\\-foo:Bar-baz\\\\\\\\-None]", "test/test_text.py::test_min_not_max_chars_in_a_row[``-hello", "test/test_po2md/test_commands/test_po2md_context.py::test_context[mdpo-context-command_aliases0]", "test/test_mdpo2html/test_commands/test_mdpo2html_disable.py::test_disable_next_line[off-next-line-command_aliases1]", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[paragraphs-with-others.md]", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[ol.md-10]", "test/test_md2po/test_extractor.py::test_mark_not_found_as_obsolete", "test/test_md2po/test_extract.py::test_extract_plaintext[raw-inline.md]", "test/test_mdpo2html/test_commands/test_mdpo2html_disable.py::test_disabled_entries", "test/test_cli.py::test_parse_command_aliases_cli_arguments[foobar-error:", "test/test_md2po/test_extract.py::test_extract_markuptext[italic-code.md]", "test/test_md2po/test_commands/test_md2po_include.py::test_include_comment_with_extracted", "test/test_md2po/test_extract.py::test_extract_plaintext[indented-code-blocks.md]", "test/test_md2po/test_commands/test_md2po_codeblocks.py::test_disable_next_codeblock[mdpo-disable-codeblock-command_aliases0]", "test/test_po2md/test_commands/test_po2md_disable.py::test_disable_next_line[mdpo-disable-next-line-command_aliases0]", "test/test_command.py::test_normalize_mdpo_command[mdpo-mdpo-include-None]", "test/test_md2po/test_md2po_events.py::test_command_event[False]", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[default-escapes.md]", "test/test_mdpo2html/test_mdpo2html_translate.py::test_translate_markuptext[div.html]", "test/test_md2po/test_commands/test_md2po_disable.py::test_disable_next_line[mdpo-disable-next-line-command_aliases0]", "test/test_po2md/test_po2md_events.py::test_link_reference_footnotes", "test/test_io.py::TestFilterPaths::test_ignore_files_by_filepath", "test/test_md2po/test_extract.py::test_extract_underline[underlines.md]", "test/test_md2po/test_extract.py::test_extract_plaintext[comments.md]", "test/test_md2po/test_extract.py::test_extract_plaintext[ul-nested.md]", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[ol.md-80]", "test/test_md2po/test_md2po_cli.py::test_stdin", "test/test_md2po/test_commands/test_md2po_disable.py::test_disable_enable[commands2-command_aliases2]", "test/test_mdpo2html/test_commands/test_mdpo2html_disable.py::test_disable[mdpo-disable-command_aliases0]", "test/test_mdpo2html/test_mdpo2html_translate.py::test_translate_markuptext[comments.html]", "test/test_md2po/test_commands/test_md2po_codeblocks.py::test_include_codeblocks[mdpo-include-codeblocks-command_aliases0]", "test/test_md2po/test_extract.py::test_extract_plaintext[blockquotes.md]", "test/test_mdpo2html/test_mdpo2html_translate.py::test_translate_markuptext[ul-others.html]", "test/test_md2po/test_location.py::test_location_code_blocks", "test/test_md2po/test_extract.py::test_extract_markuptext[softbreaks.md]", "test/test_md2po/test_extract.py::test_extract_markuptext[ul.md]", "test/test_mdpo2html/test_mdpo2html_translate.py::test_translate_markuptext[links.html]", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[blockquote.md-40]", "test/test_md2po/test_extract.py::test_extract_markuptext[italic.md]", "test/test_md2po/test_extract.py::test_extract_markuptext[bold-code.md]", "test/test_md2po/test_extract.py::test_extract_markuptext[headers-with-italics.md]", "test/test_md2po/test_md2po_events.py::test_msgid_event", "test/test_md2po/test_extractor.py::test_content_extractor", "test/test_md2po/test_md2po_cli.py::test_stdin_subprocess_input", "test/test_md2po/test_md2po_events.py::test_enter_block_event[True]", "test/test_mdpo2html/test_mdpo2html_translate.py::test_translate_markuptext[codehilite.html]", "test/test_mdpo2html/test_mdpo2html_translate.py::test_translate_markuptext[blockquote.html]", "test/test_po2md/test_commands/test_po2md_disable.py::test_disabled_entries", "test/test_mdpo2html/test_commands/test_mdpo2html_disable.py::test_disable_next_line[mdpo-disable-next-line-command_aliases0]", "test/test_mdpo2html/test_mdpo2html_translate.py::test_translate_markuptext[code.html]", "test/test_mdpo2html/test_commands/test_mdpo2html_include_codeblock.py::test_include_codeblock[on-codeblock-command_aliases1]", "test/test_po2md/test_po2md_translate.py::test_translate_markuptext[thematic-breaks.md]", "test/test_md2po/test_extract.py::test_extract_plaintext[italic.md]", "test/test_md2po/test_obsoletes.py::test_obsolete_not_equal_found[mark_not_found_as_obsolete=False]", "test/test_po2md/test_po2md_wrapwidth.py::test_wrapwidth[ol.md-inf]", "test/test_mdpo2html/test_mdpo2html_translate.py::test_translate_markuptext[bold.html]", "test/test_mdpo2html/test_mdpo2html_translate.py::test_translate_markuptext[tasklist.html]", "test/test_md2po/test_extract.py::test_extract_plaintext[headers-with-code.md]", "test/test_text.py::test_parse_escaped_pair[foo\\\\\\\\:Bar:baz-foo:Bar-baz-None]", "test/test_md2po/test_extract.py::test_extract_markuptext[ol-nested.md]"], "language": "python", "test_command": "source /saved/ENV || source /saved/*/ENV && pytest --no-header -rA --tb=no -p no:cacheprovider --continue-on-collection-errors", "test_output_parser": "python/parse_log_pytest_v3", "image_storage_uri": "vmvm-registry.fbinfra.net/repomate_image_activ_pytest/mondeja_mdpo:4bff661182d5e4be1dcec90a6ca05d97060fdeb7", "patch": "[\"diff --git a/.bumpversion.cfg b/.bumpversion.cfg\\nindex 4b4e6969..b41be539 100644\\n--- a/.bumpversion.cfg\\n+++ b/.bumpversion.cfg\\n@@ -1,5 +1,5 @@\\n [bumpversion]\\n-current_version = 0.3.70\\n+current_version = 0.3.71\\n \\n [bumpversion:file:mdpo/__init__.py]\\n \\n\",\"diff --git a/docs/pre-commit-hooks.rst b/docs/pre-commit-hooks.rst\\nindex eeec67d9..0fcf2407 100644\\n--- a/docs/pre-commit-hooks.rst\\n+++ b/docs/pre-commit-hooks.rst\\n@@ -15,7 +15,7 @@ so you don't need to specify them.\\n .. code-block:: yaml\\n \\n    - repo: https://github.com/mondeja/mdpo\\n-     rev: v0.3.70\\n+     rev: v0.3.71\\n      hooks:\\n        - id: md2po\\n          args:\\n@@ -43,7 +43,7 @@ po2md\\n .. code-block:: yaml\\n \\n    - repo: https://github.com/mondeja/mdpo\\n-     rev: v0.3.70\\n+     rev: v0.3.71\\n      hooks:\\n        - id: po2md\\n          args:\\n@@ -56,7 +56,7 @@ po2md\\n .. code-block:: yaml\\n \\n    - repo: https://github.com/mondeja/mdpo\\n-     rev: v0.3.70\\n+     rev: v0.3.71\\n      hooks:\\n        - id: po2md\\n          files: README\\\\.md\\n@@ -75,7 +75,7 @@ md2po2md\\n .. code-block:: yaml\\n \\n    - repo: https://github.com/mondeja/mdpo\\n-     rev: v0.3.70\\n+     rev: v0.3.71\\n      hooks:\\n        - id: md2po2md\\n          args:\\n@@ -88,7 +88,7 @@ md2po2md\\n .. code-block:: yaml\\n \\n    - repo: https://github.com/mondeja/mdpo\\n-     rev: v0.3.70\\n+     rev: v0.3.71\\n      hooks:\\n        - id: md2po2md\\n          files: README\\\\.md\\n\",\"diff --git a/mdpo/__init__.py b/mdpo/__init__.py\\nindex a14bce83..71f3d57a 100644\\n--- a/mdpo/__init__.py\\n+++ b/mdpo/__init__.py\\n@@ -6,7 +6,7 @@\\n from mdpo.po2md import pofile_to_markdown\\n \\n \\n-__version__ = '0.3.70'\\n+__version__ = '0.3.71'\\n __title__ = 'mdpo'\\n __description__ = ('Markdown files translation using PO files.')\\n __all__ = (\\n\",\"diff --git a/mdpo/event.py b/mdpo/event.py\\nindex 7140560b..b22d9d10 100644\\n--- a/mdpo/event.py\\n+++ b/mdpo/event.py\\n@@ -36,7 +36,7 @@ def _block_msg(block, details):\\n     return block.name\\n \\n \\n-def debug_events(program):  # pragma: no cover\\n+def debug_events(program):\\n     \\\"\\\"\\\"Debugging events for interfaces. Displays in STDOUT all event targets.\\n \\n     Args:\\n\",\"diff --git a/mdpo/html.py b/mdpo/html.py\\nindex 5027f2f9..8de609c0 100644\\n--- a/mdpo/html.py\\n+++ b/mdpo/html.py\\n@@ -18,9 +18,9 @@ def html_attrs_tuple_to_string(attrs):\\n     \\\"\\\"\\\"\\n     response = ''\\n     for i, (name, value) in enumerate(attrs):\\n-        response += '%s' % name\\n+        response += name\\n         if value is not None:\\n-            response += '=\\\"%s\\\"' % value\\n+            response += f'=\\\"{value}\\\"'\\n         if i < len(attrs) - 1:\\n             response += ' '\\n     return response\\n\",\"diff --git a/mdpo/io.py b/mdpo/io.py\\nindex 4a2ea5c5..6a90158f 100644\\n--- a/mdpo/io.py\\n+++ b/mdpo/io.py\\n@@ -1,9 +1,13 @@\\n \\\"\\\"\\\"mdpo I/O utilities.\\\"\\\"\\\"\\n \\n+import filecmp\\n import glob\\n-import hashlib\\n import os\\n import re\\n+import tempfile\\n+\\n+\\n+MDPO_FILECMP_TEMPFILE = os.path.join(tempfile.gettempdir(), '__mpdo-filecmp')\\n \\n \\n def filter_paths(filepaths, ignore_paths=[]):\\n@@ -85,18 +89,6 @@ def to_glob_or_content(value):\\n     return (True, parsed)\\n \\n \\n-def filehash(filepath):\\n-    \\\"\\\"\\\"Compute the hash of a file.\\n-\\n-    Args:\\n-        filepath (str): Path to the file.\\n-    \\\"\\\"\\\"\\n-    hasher = hashlib.md5()\\n-    with open(filepath, 'rb') as f:\\n-        hasher.update(f.read())\\n-    return hasher.hexdigest()\\n-\\n-\\n def save_file_checking_file_changed(filepath, content, encoding='utf-8'):\\n     \\\"\\\"\\\"Save a file checking if the content has changed.\\n \\n@@ -112,9 +104,9 @@ def save_file_checking_file_changed(filepath, content, encoding='utf-8'):\\n             f.write(content)\\n         return True\\n \\n-    pre_hash = filehash(filepath)\\n+    with open(MDPO_FILECMP_TEMPFILE, 'w') as temp_f, open(filepath) as f:\\n+        temp_f.write(f.read())\\n     with open(filepath, 'w', encoding=encoding) as f:\\n         f.write(content)\\n-    post_hash = filehash(filepath)\\n \\n-    return pre_hash != post_hash\\n+    return filecmp.cmp(MDPO_FILECMP_TEMPFILE, filepath)\\n\",\"diff --git a/mdpo/md.py b/mdpo/md.py\\nindex 93aede7c..9a3fe5da 100644\\n--- a/mdpo/md.py\\n+++ b/mdpo/md.py\\n@@ -46,9 +46,8 @@ def escape_links_titles(text, link_start_string='[', link_end_string=']'):\\n \\n     for match in re.findall(regex, text):\\n         original_string = match[0] + match[1]\\n-        target_string = match[0] + '\\\"%s\\\"' % (\\n-            match[1][1:-1].replace('\\\"', '\\\\\\\\\\\"')\\n-        )\\n+        escaped_title = match[1][1:-1].replace('\\\"', '\\\\\\\\\\\"')\\n+        target_string = f'{match[0]}\\\"{escaped_title}\\\"'\\n         text = text.replace(original_string, target_string)\\n     return text\\n \\n@@ -418,10 +417,10 @@ def solve_link_reference_targets(translations):\\n         # store in solutions\\n         solutions[new_msgid] = new_msgstr\\n \\n-        # print(\\\"----> new_msgid\\\", new_msgid)\\n-        # print(\\\"----> new_msgstr\\\", new_msgstr)\\n+        # print('----> new_msgid', new_msgid)\\n+        # print('----> new_msgstr', new_msgstr)\\n \\n-    # print(\\\"----> link_references_text_targets\\\", link_references_text_targets)\\n-    # print(\\\"----> msgid_msgstrs_with_links\\\", msgid_msgstrs_with_links)\\n-    # print(\\\"----> solutions\\\", solutions)\\n+    # print('----> link_references_text_targets', link_references_text_targets)\\n+    # print('----> msgid_msgstrs_with_links', msgid_msgstrs_with_links)\\n+    # print('----> solutions', solutions)\\n     return solutions\\n\",\"diff --git a/mdpo/md2po/__init__.py b/mdpo/md2po/__init__.py\\nindex efadba9a..b8031584 100644\\n--- a/mdpo/md2po/__init__.py\\n+++ b/mdpo/md2po/__init__.py\\n@@ -10,7 +10,11 @@\\n     parse_mdpo_html_command,\\n )\\n from mdpo.event import debug_events, raise_skip_event\\n-from mdpo.io import filter_paths, to_glob_or_content\\n+from mdpo.io import (\\n+    filter_paths,\\n+    save_file_checking_file_changed,\\n+    to_glob_or_content,\\n+)\\n from mdpo.md import parse_link_references\\n from mdpo.md4c import (\\n     DEFAULT_MD4C_GENERIC_PARSER_EXTENSIONS,\\n@@ -21,7 +25,6 @@\\n     mark_not_found_entries_as_obsoletes,\\n     po_escaped_string,\\n     remove_not_found_entries,\\n-    save_pofile_checking_file_changed,\\n )\\n from mdpo.text import min_not_max_chars_in_a_row, parse_wrapwidth_argument\\n \\n@@ -172,7 +175,7 @@ def __init__(self, glob_or_content, **kwargs):\\n         self._include_next_codeblock = False\\n         self._disable_next_codeblock = False\\n \\n-        self._saved_files_changed = (  # pragma: no cover\\n+        self._saved_files_changed = (\\n             False if kwargs.get('_check_saved_files_changed') else None\\n         )\\n \\n@@ -781,16 +784,30 @@ def leave_span(self, span, details):\\n                     )\\n                 self._codespan_backticks = None\\n             elif span is md4c.SpanType.IMG:\\n-                self._current_msgid += '![{}]({}'.format(\\n-                    self._current_imgspan['text'],\\n-                    self._current_imgspan['src'],\\n-                )\\n-                if self._current_imgspan['title']:\\n-                    self._current_msgid += ' \\\"%s\\\"' % (\\n-                        self._current_imgspan['title']\\n+                # TODO: refactor with getattr? Currently getting next error\\n+                # getattr(self, target_varname) += '![{}]({}'.format(\\n+                # SyntaxError: cannot assign to function call\\n+\\n+                if not self._inside_aspan:\\n+                    self._current_msgid += '![{}]({}'.format(\\n+                        self._current_imgspan['text'],\\n+                        self._current_imgspan['src'],\\n+                    )\\n+                    title = self._current_imgspan['title']\\n+                    if title:\\n+                        self._current_msgid += f' \\\"{title}\\\"'\\n+                    self._current_msgid += ')'\\n+                    self._current_imgspan = {}\\n+                else:\\n+                    self._current_aspan_text += '![{}]({}'.format(\\n+                        self._current_imgspan['text'],\\n+                        self._current_imgspan['src'],\\n                     )\\n-                self._current_msgid += ')'\\n-                self._current_imgspan = {}\\n+                    title = self._current_imgspan['title']\\n+                    if title:\\n+                        self._current_aspan_text += f' \\\"{title}\\\"'\\n+                    self._current_aspan_text += ')'\\n+                    self._current_imgspan = {}\\n             elif span is md4c.SpanType.U:\\n                 self._inside_uspan = False\\n \\n@@ -968,9 +985,10 @@ def _parse(content):\\n \\n         if save and po_filepath:\\n             if self._saved_files_changed is False:  # pragma: no cover\\n-                self._saved_files_changed = save_pofile_checking_file_changed(\\n-                    self.pofile,\\n+                self._saved_files_changed = save_file_checking_file_changed(\\n                     po_filepath,\\n+                    str(self.pofile),\\n+                    encoding=self.pofile.encoding,\\n                 )\\n             else:\\n                 self.pofile.save(fpath=po_filepath)\\n@@ -1034,8 +1052,8 @@ def markdown_to_pofile(\\n                 for you. It depends on the use you are going to give to\\n                 this library activate this mode (``plaintext=False``) or not.\\n         wrapwidth (int): Wrap width for po file indicated at ``po_filepath``\\n-            parameter. Only useful when the ``-w`` option was passed\\n-            to xgettext.\\n+            parameter. If negative, 0, 'inf' or 'math.inf' the content won't\\n+            be wrapped.\\n         mark_not_found_as_obsolete (bool): The strings extracted from markdown\\n             that will not be found inside the provided pofile will be marked\\n             as obsolete.\\n\",\"diff --git a/mdpo/md2po/__main__.py b/mdpo/md2po/__main__.py\\nindex c5ea89e4..f0453a26 100755\\n--- a/mdpo/md2po/__main__.py\\n+++ b/mdpo/md2po/__main__.py\\n@@ -76,9 +76,8 @@ def build_parser():\\n         '-w', '--wrapwidth', dest='wrapwidth', metavar='N/inf', type=str,\\n         default='78',\\n         help='Wrap width for po file indicated at \\\\'-po/--po-filepath\\\\''\\n-             ' parameter. Only useful when the \\\\'-w\\\\' option was passed to'\\n-             ' xgettext. You can use the values \\\\'0\\\\' and \\\\'inf\\\\' for infinite'\\n-             ' width.',\\n+             ' parameter. If negative, \\\\'0\\\\' or \\\\'inf\\\\', the PO file content'\\n+             ' will not be wrapped.',\\n     )\\n     parser.add_argument(\\n         '-m', '--merge-po-files', '--merge-pofiles',\\n@@ -204,12 +203,10 @@ def run(args=[]):\\n         pofile = md2po.extract(**extract_kwargs)\\n \\n         if not opts.quiet:\\n-            sys.stdout.write(pofile.__unicode__() + '\\\\n')\\n+            sys.stdout.write(f'{pofile}\\\\n')\\n \\n         # pre-commit mode\\n-        if (  # pragma: no cover\\n-            opts.check_saved_files_changed and md2po._saved_files_changed\\n-        ):\\n+        if opts.check_saved_files_changed and md2po._saved_files_changed:\\n             return (pofile, 1)\\n \\n     return (pofile, 0)\\n\",\"diff --git a/mdpo/md2po2md/__init__.py b/mdpo/md2po2md/__init__.py\\nindex b8c1213b..5af777de 100644\\n--- a/mdpo/md2po2md/__init__.py\\n+++ b/mdpo/md2po2md/__init__.py\\n@@ -108,9 +108,9 @@ def markdown_to_pofile_to_markdown(\\n \\n             os.makedirs(os.path.abspath(po_dirpath), exist_ok=True)\\n             if os.path.isdir(po_filepath):\\n-                po_filepath = (\\n-                    po_filepath.rstrip(os.sep) + os.sep +\\n-                    os.path.basename(filepath) + '.po'\\n+                po_filepath = os.path.join(\\n+                    po_filepath.rstrip(os.sep),\\n+                    f'{os.path.basename(filepath)}.po',\\n                 )\\n             if not po_filepath.endswith('.po'):\\n                 po_filepath += '.po'\\n@@ -139,9 +139,7 @@ def markdown_to_pofile_to_markdown(\\n                 po_encoding=po_encoding,\\n                 md_encoding=md_encoding,\\n             )\\n-            if (  # pragma: no cover\\n-                _check_saved_files_changed and _saved_files_changed is False\\n-            ):\\n+            if _check_saved_files_changed and _saved_files_changed is False:\\n                 _saved_files_changed = md2po._saved_files_changed\\n \\n             # po2md\\n@@ -158,9 +156,7 @@ def markdown_to_pofile_to_markdown(\\n                 save=md_filepath,\\n                 md_encoding=md_encoding,\\n             )\\n-            if (  # pragma: no cover\\n-                _check_saved_files_changed and _saved_files_changed is False\\n-            ):\\n+            if _check_saved_files_changed and _saved_files_changed is False:\\n                 _saved_files_changed = po2md._saved_files_changed\\n \\n     return _saved_files_changed\\n\",\"diff --git a/mdpo/md2po2md/__main__.py b/mdpo/md2po2md/__main__.py\\nindex 6619282d..f2538457 100644\\n--- a/mdpo/md2po2md/__main__.py\\n+++ b/mdpo/md2po2md/__main__.py\\n@@ -112,9 +112,7 @@ def run(args=[]):\\n             _check_saved_files_changed=opts.check_saved_files_changed,\\n             **kwargs,\\n         )\\n-        if (  # pragma: no cover\\n-            opts.check_saved_files_changed and _saved_files_changed\\n-        ):\\n+        if opts.check_saved_files_changed and _saved_files_changed:\\n             exitcode = 1\\n     return exitcode\\n \\n\",\"diff --git a/mdpo/mdpo2html/__init__.py b/mdpo/mdpo2html/__init__.py\\nindex 81abbcb7..74acecc9 100644\\n--- a/mdpo/mdpo2html/__init__.py\\n+++ b/mdpo/mdpo2html/__init__.py\\n@@ -123,7 +123,7 @@ def _remove_lastline_from_output_if_empty(self):\\n             self.output = '\\\\n'.join(split_output)[:-1]\\n \\n     def _process_replacer(self):\\n-        # print(\\\"REPLACER:\\\", self.replacer)\\n+        # print('REPLACER:', self.replacer)\\n \\n         template_tags = []\\n         raw_html_template, _current_replacement = ('', '')\\n@@ -143,7 +143,7 @@ def _process_replacer(self):\\n                     raw_html_template += '<{}{}>'.format(\\n                         handled,\\n                         (\\n-                            ' ' + html_attrs_tuple_to_string(attrs)\\n+                            f' {html_attrs_tuple_to_string(attrs)}'\\n                             if attrs else ''\\n                         ),\\n                     )\\n@@ -152,7 +152,7 @@ def _process_replacer(self):\\n                     raw_html_template += '<{}{}>'.format(\\n                         handled,\\n                         (\\n-                            ' ' + html_attrs_tuple_to_string(attrs)\\n+                            f' {html_attrs_tuple_to_string(attrs)}'\\n                             if attrs else ''\\n                         ),\\n                     )\\n@@ -161,25 +161,24 @@ def _process_replacer(self):\\n                     raw_html_template += '<{}{}>'.format(\\n                         handled,\\n                         (\\n-                            ' ' + html_attrs_tuple_to_string(attrs)\\n+                            f' {html_attrs_tuple_to_string(attrs)}'\\n                             if attrs else ''\\n                         ),\\n                     )\\n                 elif handled in self.link_tags:\\n                     title = get_html_attrs_tuple_attr(attrs, 'title')\\n-                    _current_link_target += '(%s' % get_html_attrs_tuple_attr(\\n-                        attrs, 'href',\\n-                    )\\n+                    href = get_html_attrs_tuple_attr(attrs, 'href')\\n+                    _current_link_target += f'({href}'\\n                     if title:\\n-                        _current_link_target += ' \\\"%s\\\"' % title\\n+                        _current_link_target += f' \\\"{title}\\\"'\\n                     _current_link_target += ')'\\n \\n-                    raw_html_template += '<%s' % handled\\n+                    raw_html_template += f'<{handled}'\\n \\n                     # attrs_except_href_title = []\\n                     for attr, value in attrs:\\n                         if attr in ['title', 'href']:\\n-                            raw_html_template += ' %s=\\\"{}\\\"' % attr\\n+                            raw_html_template += f' {attr}=\\\"{{}}\\\"'\\n                         # else:\\n                         #     These attributes are not included in output\\n                         #    attrs_except_href_title.append((attr, value))\\n@@ -191,7 +190,7 @@ def _process_replacer(self):\\n                 else:\\n                     raw_html_template += '<{}{}>'.format(\\n                         handled,\\n-                        ' ' + html_attrs_tuple_to_string(attrs)\\n+                        f' {html_attrs_tuple_to_string(attrs)}'\\n                         if attrs else '',\\n                     )\\n                 _last_start_tag = handled\\n@@ -215,7 +214,7 @@ def _process_replacer(self):\\n                     else:\\n                         _current_replacement += handled\\n             elif handle == 'end':\\n-                raw_html_template += '</%s>' % handled\\n+                raw_html_template += f'</{handled}>'\\n                 if handled in self.code_tags:\\n                     _current_replacement += '`'\\n                 elif handled in self.bold_tags:\\n@@ -226,7 +225,7 @@ def _process_replacer(self):\\n                 if _last_end_tag == 'code':\\n                     _inside_code = False\\n             elif handle == 'comment':\\n-                raw_html_template += '<!--%s-->' % handled\\n+                raw_html_template += f'<!--{handled}-->'\\n             elif handle == 'startend':\\n                 if handled in self.image_tags:\\n                     _current_replacement += '![{}]({}'.format(\\n@@ -235,7 +234,7 @@ def _process_replacer(self):\\n                     )\\n                     title = get_html_attrs_tuple_attr(attrs, 'title')\\n                     if title:\\n-                        _current_replacement += ' \\\"%s\\\"' % title\\n+                        _current_replacement += f' \\\"{title}\\\"'\\n                     _current_replacement += ')'\\n \\n                     raw_html_template += '{}'\\n@@ -243,7 +242,7 @@ def _process_replacer(self):\\n                     raw_html_template += '<{}{}/>'.format(\\n                         handled,\\n                         (\\n-                            (' %s' % html_attrs_tuple_to_string(attrs))\\n+                            f' {html_attrs_tuple_to_string(attrs)}'\\n                             if attrs else ''\\n                         ),\\n                     )\\n@@ -278,9 +277,9 @@ def _process_replacer(self):\\n                         if tag not in template_tags:\\n                             template_tags.append(tag)\\n \\n-        # print(\\\"RAW TEMPLATE:\\\", raw_html_template)\\n-        # print(\\\"TEMPLATE TAGS:\\\", template_tags)\\n-        # print('CURRENT MSGID: \\\\'%s\\\\'' % _current_replacement)\\n+        # print('RAW TEMPLATE:', raw_html_template)\\n+        # print('TEMPLATE TAGS:', template_tags)\\n+        # print(f'CURRENT MSGID: \\\\'{_current_replacement}\\\\'')\\n         # print('MSGSTR:', replacement)\\n \\n         html_before_first_replacement = raw_html_template.split('{')[0]\\n@@ -288,9 +287,9 @@ def _process_replacer(self):\\n         for tags_group in [self.bold_tags, self.italic_tags, self.code_tags]:\\n             for tag in tags_group:\\n                 html_before_first_replacement = \\\\\\n-                    html_before_first_replacement.split('<%s>' % tag)[0]\\n+                    html_before_first_replacement.split(f'<{tag}>')[0]\\n                 html_after_last_replacement = \\\\\\n-                    html_after_last_replacement.split('</%s>' % tag)[-1]\\n+                    html_after_last_replacement.split(f'</{tag}>')[-1]\\n             html_before_first_replacement = \\\\\\n                 html_before_first_replacement.split('<a href=\\\"')[0]\\n \\n@@ -316,27 +315,27 @@ def _process_replacer(self):\\n         self._enable_next_line = False\\n         self._current_msgctxt = None\\n \\n-        # print(\\\"________________________________________________\\\")\\n+        # print('________________________________________________')\\n \\n     def handle_starttag(self, tag, attrs):\\n-        # print(\\\"START TAG: %s | POS: %d:%d\\\" % (tag, *self.getpos()))\\n+        # print('START TAG: %s | POS: %d:%d' % (tag, *self.getpos()))\\n \\n         if tag in self.ignore_grouper_tags:\\n             self.context.append(tag)\\n             self.output += '<{}{}>'.format(\\n-                tag, ' ' + html_attrs_tuple_to_string(attrs) if attrs else '',\\n+                tag, f' {html_attrs_tuple_to_string(attrs)}' if attrs else '',\\n             )\\n         elif self.context and self.context[0] in self.ignore_grouper_tags:\\n             self.output += '<{}{}>'.format(\\n-                tag, ' ' + html_attrs_tuple_to_string(attrs) if attrs else '',\\n+                tag, f' {html_attrs_tuple_to_string(attrs)}' if attrs else '',\\n             )\\n         elif tag == 'ul' and not self.context:\\n             self.output += '<{}{}>'.format(\\n-                tag, ' ' + html_attrs_tuple_to_string(attrs) if attrs else '',\\n+                tag, f' {html_attrs_tuple_to_string(attrs)}' if attrs else '',\\n             )\\n         elif tag in ['blockquote', 'table', 'thead', 'tbody', 'tr']:\\n             self.output += '<{}{}>'.format(\\n-                tag, ' ' + html_attrs_tuple_to_string(attrs) if attrs else '',\\n+                tag, f' {html_attrs_tuple_to_string(attrs)}' if attrs else '',\\n             )\\n         else:\\n             if tag == 'a' and self.real_link_reference_targets is None:\\n@@ -351,26 +350,26 @@ def handle_starttag(self, tag, attrs):\\n             self.context.append(tag)\\n \\n     def handle_endtag(self, tag):\\n-        # print(\\\"END TAG: %s | POS: %d:%d\\\" % (tag, *self.getpos()))\\n+        # print('END TAG: %s | POS: %d:%d' % (tag, *self.getpos()))\\n \\n         if tag in self.ignore_grouper_tags:\\n-            self.output += '</%s>' % tag\\n+            self.output += f'</{tag}>'\\n             if self.context:\\n                 self.context.pop()\\n         elif self.context and self.context[0] in self.ignore_grouper_tags:\\n-            self.output += '</%s>' % tag\\n+            self.output += f'</{tag}>'\\n         elif tag in PROCESS_REPLACER_TAGS:\\n             self.replacer.append(('end', tag, None))\\n             self._process_replacer()\\n         elif tag in ['ul', 'blockquote', 'tr', 'table', 'thead', 'tbody']:\\n-            self.output += '</%s>' % tag\\n+            self.output += f'</{tag}>'\\n         else:\\n             self.replacer.append(('end', tag, None))\\n             if self.context:\\n                 self.context.pop()\\n \\n     def handle_startendtag(self, tag, attrs):\\n-        # print(\\\"STARTEND TAG: %s | POS: %d:%d\\\" % (tag, *self.getpos()))\\n+        # print('STARTEND TAG: %s | POS: %d:%d' % (tag, *self.getpos()))\\n \\n         if not self.replacer:\\n             self.output += self.get_starttag_text()\\n@@ -378,7 +377,7 @@ def handle_startendtag(self, tag, attrs):\\n             self.replacer.append(('startend', tag, attrs))\\n \\n     def handle_data(self, data):\\n-        # print(\\\"     DATA: '%s'\\\" % (data))\\n+        # print(f'     DATA: \\\\'{data}\\\\'')\\n \\n         if data:\\n             if not self.replacer or (\\n@@ -394,7 +393,7 @@ def handle_data(self, data):\\n                 self.replacer.append(('data', data, None))\\n \\n     def handle_comment(self, data):\\n-        # print(\\\"     COMMENT: '%s'\\\" % (data))\\n+        # print(f'     COMMENT: \\\\'{data}\\\\'')\\n \\n         if self.replacer:\\n             self.replacer.append(('comment', data, None))\\n\",\"diff --git a/mdpo/mdpo2html/__main__.py b/mdpo/mdpo2html/__main__.py\\nindex 33bbf3c7..84f57ae5 100644\\n--- a/mdpo/mdpo2html/__main__.py\\n+++ b/mdpo/mdpo2html/__main__.py\\n@@ -103,7 +103,7 @@ def run(args=[]):\\n         )\\n \\n         if not opts.quiet and not opts.save:\\n-            sys.stdout.write(output + '\\\\n')\\n+            sys.stdout.write(f'{output}\\\\n')\\n \\n     return (output, 0)\\n \\n\",\"diff --git a/mdpo/po.py b/mdpo/po.py\\nindex 4780a1fe..11022854 100644\\n--- a/mdpo/po.py\\n+++ b/mdpo/po.py\\n@@ -1,11 +1,10 @@\\n \\\"\\\"\\\"``.po`` files related stuff.\\\"\\\"\\\"\\n \\n import glob\\n-import os\\n \\n import polib\\n \\n-from mdpo.io import filehash, filter_paths\\n+from mdpo.io import filter_paths\\n from mdpo.polib import poentry__cmp__\\n \\n \\n@@ -21,7 +20,7 @@ def po_escaped_string(chars):\\n     Returns:\\n         str: First character of passed string with ``\\\\`` character prepended.\\n     \\\"\\\"\\\"\\n-    return '\\\\\\\\' + chars[0]\\n+    return f'\\\\\\\\{chars[0]}'\\n \\n \\n def find_entry_in_entries(entry, entries, **kwargs):\\n@@ -162,24 +161,3 @@ def paths_or_globs_to_unique_pofiles(pofiles_globs, ignore, po_encoding=None):\\n                 _po_filepaths.append(po_filepath)\\n \\n     return pofiles\\n-\\n-\\n-def save_pofile_checking_file_changed(pofile, po_filepath):\\n-    \\\"\\\"\\\"Save a :py:class:`polib.POFile` checking if the content has changed.\\n-\\n-    Args:\\n-        pofile (:py:class:`polib.POFile`): POFile to save.\\n-        po_filepath (str): Path to the new file to save in.\\n-\\n-    Returns:\\n-        bool: If the PO file content has been changed.\\n-    \\\"\\\"\\\"\\n-    if not os.path.isfile(po_filepath):\\n-        pofile.save(fpath=po_filepath)\\n-        return True\\n-\\n-    pre_hash = filehash(po_filepath)\\n-    pofile.save(fpath=po_filepath)\\n-    post_hash = filehash(po_filepath)\\n-\\n-    return pre_hash != post_hash\\n\",\"diff --git a/mdpo/po2md/__init__.py b/mdpo/po2md/__init__.py\\nindex ba761cf2..16ee9d14 100644\\n--- a/mdpo/po2md/__init__.py\\n+++ b/mdpo/po2md/__init__.py\\n@@ -153,7 +153,7 @@ def __init__(self, pofiles, ignore=[], po_encoding=None, **kwargs):\\n             ) if 'wrapwidth' in kwargs else 80\\n         )\\n \\n-        self._saved_files_changed = (  # pragma: no cover\\n+        self._saved_files_changed = (\\n             False if kwargs.get('_check_saved_files_changed') else None\\n         )\\n \\n@@ -360,8 +360,6 @@ def _save_current_msgid(self):\\n         if self._inside_indented_codeblock:\\n             new_translation = ''\\n             for line in translation.splitlines():\\n-                if not line:\\n-                    continue\\n                 new_translation += f'    {line}\\\\n'\\n             translation = new_translation\\n         else:\\n@@ -421,7 +419,7 @@ def _save_current_line(self):\\n \\n     def enter_block(self, block, details):\\n         # raise 'enter_block' event\\n-        if raise_skip_event(  # pragma: no cover\\n+        if raise_skip_event(\\n             self.events,\\n             'enter_block',\\n             self, block,\\n@@ -459,7 +457,8 @@ def enter_block(self, block, details):\\n                 self._save_current_line()\\n         elif block is md4c.BlockType.H:\\n             self._inside_hblock = True\\n-            self._current_line += '%s ' % ('#' * details['level'])\\n+            hash_signs = '#' * details['level']\\n+            self._current_line += f'{hash_signs} '\\n         elif block is md4c.BlockType.LI:\\n             if self._current_list_type[-1][0] == 'ol':\\n                 # inside OL\\n@@ -480,7 +479,8 @@ def enter_block(self, block, details):\\n                     self._ul_marks[-1],\\n                 )\\n                 if details['is_task']:\\n-                    self._current_line += '[%s] ' % details['task_mark']\\n+                    mark = details['task_mark']\\n+                    self._current_line += f'[{mark}] '\\n                 self._current_list_type[-1][-1].append(details['is_task'])\\n             self._inside_liblock = True\\n             self._inside_liblock_first_p = True\\n@@ -528,7 +528,7 @@ def enter_block(self, block, details):\\n \\n     def leave_block(self, block, details):\\n         # raise 'leave_block' event\\n-        if raise_skip_event(  # pragma: no cover\\n+        if raise_skip_event(\\n             self.events,\\n             'leave_block',\\n             self,\\n@@ -671,7 +671,7 @@ def leave_block(self, block, details):\\n \\n     def enter_span(self, span, details):\\n         # raise 'enter_span' event\\n-        if raise_skip_event(  # pragma: no cover\\n+        if raise_skip_event(\\n             self.events,\\n             'enter_span',\\n             self,\\n@@ -731,7 +731,7 @@ def enter_span(self, span, details):\\n \\n     def leave_span(self, span, details):\\n         # raise 'leave_span' event\\n-        if raise_skip_event(  # pragma: no cover\\n+        if raise_skip_event(\\n             self.events,\\n             'leave_span',\\n             self,\\n@@ -794,20 +794,33 @@ def leave_span(self, span, details):\\n             )\\n             self._codespan_backticks = None\\n         elif span is md4c.SpanType.IMG:\\n-            self._current_msgid += '![{}]({}'.format(\\n-                self._current_imgspan['text'],\\n-                self._current_imgspan['src'],\\n-            )\\n-            if self._current_imgspan['title']:\\n-                self._current_msgid += ' \\\"%s\\\"' % polib.escape(\\n-                    self._current_imgspan['title'],\\n+            # TODO: refactor with getattr? Currently getting next error\\n+            # getattr(self, target_varname) += '![{}]({}'.format(\\n+            # SyntaxError: cannot assign to function call\\n+\\n+            if not self._inside_aspan:\\n+                self._current_msgid += '![{}]({}'.format(\\n+                    self._current_imgspan['text'],\\n+                    self._current_imgspan['src'],\\n+                )\\n+                if self._current_imgspan['title']:\\n+                    title = self._current_imgspan['title']\\n+                    self._current_msgid += f' \\\"{title}\\\"'\\n+                self._current_msgid += ')'\\n+            else:\\n+                self._current_aspan_text += '![{}]({}'.format(\\n+                    self._current_imgspan['text'],\\n+                    self._current_imgspan['src'],\\n                 )\\n-            self._current_msgid += ')'\\n+                if self._current_imgspan['title']:\\n+                    title = self._current_imgspan['title']\\n+                    self._current_aspan_text += f' \\\"{title}\\\"'\\n+                self._current_aspan_text += ')'\\n             self._current_imgspan = {}\\n \\n     def text(self, block, text):\\n         # raise 'text' event\\n-        if raise_skip_event(  # pragma: no cover\\n+        if raise_skip_event(\\n             self.events,\\n             'text',\\n             self,\\n@@ -939,7 +952,7 @@ def translate(\\n         self.output = '\\\\n'.join(self._outputlines)\\n \\n         if save:\\n-            if self._saved_files_changed is False:  # pragma: no cover\\n+            if self._saved_files_changed is False:\\n                 self._saved_files_changed = save_file_checking_file_changed(\\n                     save,\\n                     self.output,\\n\",\"diff --git a/mdpo/po2md/__main__.py b/mdpo/po2md/__main__.py\\nindex 3dd2e4c4..cf0d4de0 100644\\n--- a/mdpo/po2md/__main__.py\\n+++ b/mdpo/po2md/__main__.py\\n@@ -59,8 +59,8 @@ def build_parser():\\n     )\\n     parser.add_argument(\\n         '-w', '--wrapwidth', dest='wrapwidth', default='80', type=str,\\n-        help='Maximum width rendering the Markdown output, when possible. You'\\n-             ' can use the values \\\\'0\\\\' and \\\\'inf\\\\' for infinite width.',\\n+        help='Maximum width rendering the Markdown output, when possible. If'\\n+             ' negative, \\\\'0\\\\' or \\\\'inf\\\\', the content will not be wrapped.',\\n         metavar='N/inf',\\n     )\\n     add_encoding_arguments(parser)\\n@@ -117,12 +117,10 @@ def run(args=[]):\\n         )\\n \\n         if not opts.quiet and not opts.save:\\n-            sys.stdout.write(output + '\\\\n')\\n+            sys.stdout.write(f'{output}\\\\n')\\n \\n         # pre-commit mode\\n-        if (  # pragma: no cover\\n-            opts.check_saved_files_changed and po2md._saved_files_changed\\n-        ):\\n+        if opts.check_saved_files_changed and po2md._saved_files_changed:\\n             return (output, 1)\\n \\n     return (output, 0)\\n\",\"diff --git a/mdpo/text.py b/mdpo/text.py\\nindex 9caf1be3..f8e902ac 100644\\n--- a/mdpo/text.py\\n+++ b/mdpo/text.py\\n@@ -112,13 +112,11 @@ def parse_strint_0_inf(value):\\n     Args:\\n         value (str): Value to parse.\\n     \\\"\\\"\\\"\\n+    num = float(value)\\n     try:\\n-        num = int(value)\\n-    except ValueError:\\n-        if value.lower() == 'inf':\\n-            return math.inf\\n-        raise ValueError(value)\\n-    return num if num else math.inf\\n+        return int(num) if num > 0 else math.inf\\n+    except OverflowError:  # cannot convert float infinity to integer\\n+        return math.inf\\n \\n \\n def parse_wrapwidth_argument(value):\\n@@ -130,7 +128,7 @@ def parse_wrapwidth_argument(value):\\n     try:\\n         value = parse_strint_0_inf(value)\\n     except ValueError as err:\\n-        if os.environ.get('_MDPO_RUNNING'):\\n+        if os.environ.get('_MDPO_RUNNING'):  # executed as CLI\\n             sys.stderr.write(\\n                 f\\\"Invalid value '{err.value}' for -w/--wrapwidth argument.\\\\n\\\",\\n             )\\n@@ -160,7 +158,7 @@ def removeprefix(text, prefix):\\n         return text.removeprefix(prefix)\\n     if text.startswith(prefix):\\n         return text[len(prefix):]\\n-    return text  # pragma: no cover\\n+    return text\\n \\n \\n def removesuffix(text, suffix):\\n@@ -183,4 +181,4 @@ def removesuffix(text, suffix):\\n         return text.removesuffix(suffix)\\n     if suffix and text.endswith(suffix):\\n         return text[:-len(suffix)]\\n-    return text  # pragma: no cover\\n+    return text\\n\",\"diff --git a/setup.cfg b/setup.cfg\\nindex 0973fc23..d07d43ae 100644\\n--- a/setup.cfg\\n+++ b/setup.cfg\\n@@ -1,6 +1,6 @@\\n [metadata]\\n name = mdpo\\n-version = 0.3.70\\n+version = 0.3.71\\n description = Markdown files translation using PO files.\\n long_description = file: README.md\\n long_description_content_type = text/markdown\\n\"]", "test_patch": "", "hints_text": ""}
