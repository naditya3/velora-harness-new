{"instance_id": "666605466452882", "repo": "gazzolalab/pyelastica", "base_commit": "7d85dea97c5785ee8ee7436568d423298cbf1532", "problem_statement": "Typo in `compute_shear_energy` method of Cosserat Rod.:\\nAlthough the code to compute shear energy function is correct, naming of one of the variables is wrong. `shear_internal_torques` is not correct and misleading, we should call this variable as `shear_internal_forces` . \\r\\n\\r\\nhttps://github.com/GazzolaLab/PyElastica/blob/fee87b9da22e310ff925c16fdc839bf8405c51a4/elastica/rod/cosserat_rod.py#L516", "FAIL_TO_PASS": ["tests/test_rod_initialisation.py::test_straight_rod[50]", "tests/test_rod_initialisation.py::test_shear_matrix_for_varying_shear_modulus[5000.0-50]", "tests/test_rod_initialisation.py::test_shear_matrix_for_varying_shear_modulus[50000.0-5]", "tests/test_rod_initialisation.py::test_straight_rod[5]", "tests/test_rod_initialisation.py::test_inertia_shear_bend_matrices_for_varying_radius", "tests/test_rod_initialisation.py::test_shear_matrix_for_varying_shear_modulus[10000.0-50]", "tests/test_rod_initialisation.py::test_shear_matrix_for_varying_shear_modulus[10000.0-10]", "tests/test_rod_initialisation.py::test_shear_matrix_for_varying_shear_modulus[50000.0-50]", "tests/test_rod_initialisation.py::test_shear_matrix_for_varying_shear_modulus[50000.0-10]", "tests/test_rod_initialisation.py::test_shear_matrix_for_varying_shear_modulus[5000.0-10]", "tests/test_rod_initialisation.py::test_shear_matrix_for_varying_shear_modulus[10000.0-5]", "tests/test_rod_initialisation.py::test_shear_matrix_for_varying_shear_modulus[5000.0-5]", "tests/test_rod_initialisation.py::test_straight_rod[20]"], "PASS_TO_PASS": [], "language": "python", "test_command": "source /saved/ENV || source /saved/*/ENV && pytest --no-header -rA --tb=no -p no:cacheprovider --continue-on-collection-errors", "test_output_parser": "python/parse_log_pytest_v3", "image_storage_uri": "vmvm-registry.fbinfra.net/repomate_image_activ_pytest/gazzolalab_pyelastica:7d85dea97c5785ee8ee7436568d423298cbf1532", "patch": "[\"diff --git a/elastica/_elastica_numba.py b/elastica/_elastica_numba.py\\nnew file mode 100644\\nindex 0000000..39b4a6d\\n--- /dev/null\\n+++ b/elastica/_elastica_numba.py\\n@@ -0,0 +1,8 @@\\n+class _elastica_numba:\\n+    \\\"\\\"\\\"The purpose is to throw deprecation error to people previously\\n+    using _elastica_numba module. Please remove this in the future.\\n+    \\\"\\\"\\\"\\n+\\n+    raise ImportError(\\n+        \\\"The module _elastica_numba is moved to main implementation. Please import the modules without _elastica_numba.\\\"\\n+    )\\n\",\"diff --git a/elastica/_elastica_numba/_calculus.py b/elastica/_elastica_numba/_calculus.py\\ndeleted file mode 100644\\nindex 1edc7cf..0000000\\n--- a/elastica/_elastica_numba/_calculus.py\\n+++ /dev/null\\n@@ -1,24 +0,0 @@\\n-import warnings\\n-from elastica._calculus import (\\n-    _trapezoidal,\\n-    _two_point_difference,\\n-    _difference,\\n-    _average,\\n-    _clip_array,\\n-    _isnan_check,\\n-    _get_zero_array,\\n-    _trapezoidal_for_block_structure,\\n-    _two_point_difference_for_block_structure,\\n-)\\n-\\n-warnings.warn(\\n-    \\\"The numba-implementation is included in the default elastica module. Please import without _elastica_numba.\\\",\\n-    DeprecationWarning,\\n-)\\n-\\n-position_difference_kernel = _difference\\n-position_average = _average\\n-quadrature_kernel = _trapezoidal\\n-difference_kernel = _two_point_difference\\n-quadrature_kernel_for_block_structure = _trapezoidal_for_block_structure\\n-difference_kernel_for_block_structure = _two_point_difference_for_block_structure\\n\",\"diff --git a/elastica/_elastica_numba/_external_forces.py b/elastica/_elastica_numba/_external_forces.py\\ndeleted file mode 100644\\nindex 5d53a12..0000000\\n--- a/elastica/_elastica_numba/_external_forces.py\\n+++ /dev/null\\n@@ -1,14 +0,0 @@\\n-import warnings\\n-from elastica.external_forces import (\\n-    NoForces,\\n-    GravityForces,\\n-    EndpointForces,\\n-    UniformTorques,\\n-    UniformForces,\\n-    MuscleTorques,\\n-)\\n-\\n-warnings.warn(\\n-    \\\"The numba-implementation is included in the default elastica module. Please import without _elastica_numba.\\\",\\n-    DeprecationWarning,\\n-)\\n\",\"diff --git a/elastica/_elastica_numba/_interaction.py b/elastica/_elastica_numba/_interaction.py\\ndeleted file mode 100644\\nindex 8865650..0000000\\n--- a/elastica/_elastica_numba/_interaction.py\\n+++ /dev/null\\n@@ -1,17 +0,0 @@\\n-import warnings\\n-from elastica.interaction import (\\n-    AnisotropicFrictionalPlane,\\n-    SlenderBodyTheory,\\n-    # AnisotropicFrictionalPlaneRigidBody,\\n-    # InteractionPlane,\\n-    # InteractionPlaneRigidBody,\\n-    elements_to_nodes_inplace,\\n-    node_to_element_pos_or_vel,\\n-    nodes_to_elements,\\n-    sum_over_elements,\\n-)\\n-\\n-warnings.warn(\\n-    \\\"The numba-implementation is included in the default elastica module. Please import without _elastica_numba.\\\",\\n-    DeprecationWarning,\\n-)\\n\",\"diff --git a/elastica/_elastica_numba/_joint.py b/elastica/_elastica_numba/_joint.py\\ndeleted file mode 100644\\nindex 89a692e..0000000\\n--- a/elastica/_elastica_numba/_joint.py\\n+++ /dev/null\\n@@ -1,14 +0,0 @@\\n-import warnings\\n-\\n-from elastica.joint import (\\n-    FreeJoint,\\n-    HingeJoint,\\n-    FixedJoint,\\n-    ExternalContact,\\n-    SelfContact,\\n-)\\n-\\n-warnings.warn(\\n-    \\\"The numba-implementation is included in the default elastica module. Please import without _elastica_numba.\\\",\\n-    DeprecationWarning,\\n-)\\n\",\"diff --git a/elastica/_elastica_numba/_linalg.py b/elastica/_elastica_numba/_linalg.py\\ndeleted file mode 100644\\nindex 445bba7..0000000\\n--- a/elastica/_elastica_numba/_linalg.py\\n+++ /dev/null\\n@@ -1,20 +0,0 @@\\n-import warnings\\n-from elastica._linalg import (\\n-    levi_civita_tensor,\\n-    _batch_matvec,\\n-    _batch_matmul,\\n-    _batch_cross,\\n-    _batch_vec_oneD_vec_cross,\\n-    _batch_dot,\\n-    _batch_norm,\\n-    _batch_product_i_k_to_ik,\\n-    _batch_product_i_ik_to_k,\\n-    _batch_product_k_ik_to_ik,\\n-    _batch_vector_sum,\\n-    _batch_matrix_transpose,\\n-)\\n-\\n-warnings.warn(\\n-    \\\"The numba-implementation is included in the default elastica module. Please import without _elastica_numba.\\\",\\n-    DeprecationWarning,\\n-)\\n\",\"diff --git a/elastica/_elastica_numba/_rod/__init__.py b/elastica/_elastica_numba/_rod/__init__.py\\ndeleted file mode 100644\\nindex e69de29..0000000\\n--- a/elastica/_elastica_numba/_rod/__init__.py\\n+++ /dev/null\\n\",\"diff --git a/elastica/_elastica_numba/_rod/_cosserat_rod.py b/elastica/_elastica_numba/_rod/_cosserat_rod.py\\ndeleted file mode 100644\\nindex 1aa9d75..0000000\\n--- a/elastica/_elastica_numba/_rod/_cosserat_rod.py\\n+++ /dev/null\\n@@ -1,7 +0,0 @@\\n-import warnings\\n-from elastica.rod.cosserat_rod import CosseratRod\\n-\\n-warnings.warn(\\n-    \\\"The numba-implementation is included in the default elastica module. Please import without _elastica_numba.\\\",\\n-    DeprecationWarning,\\n-)\\n\",\"diff --git a/elastica/_elastica_numba/_rod/_data_structures.py b/elastica/_elastica_numba/_rod/_data_structures.py\\ndeleted file mode 100644\\nindex 0f741c4..0000000\\n--- a/elastica/_elastica_numba/_rod/_data_structures.py\\n+++ /dev/null\\n@@ -1,16 +0,0 @@\\n-import warnings\\n-import numpy as np\\n-from elastica._rotations import _get_rotation_matrix, _rotate\\n-from elastica.rod.data_structures import (\\n-    _RodSymplecticStepperMixin,\\n-    _bootstrap_from_data,\\n-    _State,\\n-    _DerivativeState,\\n-    _KinematicState,\\n-    _DynamicState,\\n-)\\n-\\n-warnings.warn(\\n-    \\\"The numba-implementation is included in the default elastica module. Please import without _elastica_numba.\\\",\\n-    DeprecationWarning,\\n-)\\n\",\"diff --git a/elastica/_elastica_numba/_rotations.py b/elastica/_elastica_numba/_rotations.py\\ndeleted file mode 100644\\nindex f3a0d7b..0000000\\n--- a/elastica/_elastica_numba/_rotations.py\\n+++ /dev/null\\n@@ -1,7 +0,0 @@\\n-import warnings\\n-from elastica._rotations import _get_rotation_matrix, _inv_rotate, _rotate\\n-\\n-warnings.warn(\\n-    \\\"The numba-implementation is included in the default elastica module. Please import without _elastica_numba.\\\",\\n-    DeprecationWarning,\\n-)\\n\",\"diff --git a/elastica/_elastica_numba/_timestepper/__init__.py b/elastica/_elastica_numba/_timestepper/__init__.py\\ndeleted file mode 100644\\nindex 416d02a..0000000\\n--- a/elastica/_elastica_numba/_timestepper/__init__.py\\n+++ /dev/null\\n@@ -1,10 +0,0 @@\\n-__doc__ = \\\"\\\"\\\"Timestepping utilities to be used with Rod and RigidBody classes of Elastica Numba implementation\\\"\\\"\\\"\\n-\\n-import warnings\\n-from elastica.timestepper import extend_stepper_interface, integrate\\n-\\n-\\n-warnings.warn(\\n-    \\\"The numba-implementation is included in the default elastica module. Please import without _elastica_numba.\\\",\\n-    DeprecationWarning,\\n-)\\n\",\"diff --git a/elastica/_elastica_numba/_timestepper/_explicit_steppers.py b/elastica/_elastica_numba/_timestepper/_explicit_steppers.py\\ndeleted file mode 100644\\nindex 560c2bb..0000000\\n--- a/elastica/_elastica_numba/_timestepper/_explicit_steppers.py\\n+++ /dev/null\\n@@ -1,14 +0,0 @@\\n-__doc__ = \\\"\\\"\\\"Explicit timesteppers  and concepts of Elastica Numba implementation\\\"\\\"\\\"\\n-\\n-import warnings\\n-from elastica.timestepper.explicit_steppers import (\\n-    ExplicitStepperTag,\\n-    RungeKutta4,\\n-    EulerForward,\\n-)\\n-\\n-\\n-warnings.warn(\\n-    \\\"The numba-implementation is included in the default elastica module. Please import without _elastica_numba.\\\",\\n-    DeprecationWarning,\\n-)\\n\",\"diff --git a/elastica/_elastica_numba/_timestepper/_symplectic_steppers.py b/elastica/_elastica_numba/_timestepper/_symplectic_steppers.py\\ndeleted file mode 100644\\nindex d6c9c36..0000000\\n--- a/elastica/_elastica_numba/_timestepper/_symplectic_steppers.py\\n+++ /dev/null\\n@@ -1,14 +0,0 @@\\n-__doc__ = \\\"\\\"\\\"Symplectic timesteppers and concepts of Elastica Numba implementation\\\"\\\"\\\"\\n-\\n-import warnings\\n-from elastica.timestepper.symplectic_steppers import (\\n-    SymplecticStepperTag,\\n-    PositionVerlet,\\n-    PEFRL,\\n-)\\n-\\n-\\n-warnings.warn(\\n-    \\\"The numba-implementation is included in the default elastica module. Please import without _elastica_numba.\\\",\\n-    DeprecationWarning,\\n-)\\n\",\"diff --git a/elastica/rod/cosserat_rod.py b/elastica/rod/cosserat_rod.py\\nindex fa0eb12..d74f48e 100644\\n--- a/elastica/rod/cosserat_rod.py\\n+++ b/elastica/rod/cosserat_rod.py\\n@@ -514,11 +514,11 @@ class CosseratRod(RodBase, KnotTheory):\\n         \\\"\\\"\\\"\\n \\n         sigma_diff = self.sigma - self.rest_sigma\\n-        shear_internal_torques = _batch_matvec(self.shear_matrix, sigma_diff)\\n+        shear_internal_forces = _batch_matvec(self.shear_matrix, sigma_diff)\\n \\n         return (\\n             0.5\\n-            * (_batch_dot(sigma_diff, shear_internal_torques) * self.rest_lengths).sum()\\n+            * (_batch_dot(sigma_diff, shear_internal_forces) * self.rest_lengths).sum()\\n         )\\n \\n \\n\",\"diff --git a/elastica/rod/factory_function.py b/elastica/rod/factory_function.py\\nindex 267f7a0..7cf1378 100644\\n--- a/elastica/rod/factory_function.py\\n+++ b/elastica/rod/factory_function.py\\n@@ -145,7 +145,7 @@ def allocate(\\n \\n     # Value taken based on best correlation for Poisson ratio = 0.5, from\\n     # \\\"On Timoshenko's correction for shear in vibrating beams\\\" by Kaneko, 1975\\n-    alpha_c = 0.964\\n+    alpha_c = 27.0 / 28.0\\n     shear_matrix = np.zeros(\\n         (MaxDimension.value(), MaxDimension.value(), n_elements), np.float64\\n     )\\n\",\"diff --git a/elastica/version.py b/elastica/version.py\\nindex ae50f1f..867e4b1 100644\\n--- a/elastica/version.py\\n+++ b/elastica/version.py\\n@@ -1 +1 @@\\n-VERSION = \\\"0.2.3\\\"\\n+VERSION = \\\"0.3.0\\\"\\n\"]", "test_patch": "[\"diff --git a/tests/test_rod_initialisation.py b/tests/test_rod_initialisation.py\\nindex 097b2c0..0ae9d2f 100644\\n--- a/tests/test_rod_initialisation.py\\n+++ b/tests/test_rod_initialisation.py\\n@@ -152,7 +152,7 @@ class MockRodForTest:\\n             density,\\n             nu,\\n             youngs_modulus,\\n-            alpha_c=0.964,\\n+            alpha_c=(27.0 / 28.0),\\n             *args,\\n             **kwargs\\n         )\\n@@ -741,8 +741,8 @@ def test_shear_matrix_for_varying_shear_modulus(n_elems, shear_modulus):\\n     np.fill_diagonal(\\n         correct_shear_matrix[:],\\n         [\\n-            0.964 * shear_modulus * base_area,\\n-            0.964 * shear_modulus * base_area,\\n+            (27.0 / 28.0) * shear_modulus * base_area,\\n+            (27.0 / 28.0) * shear_modulus * base_area,\\n             youngs_modulus * base_area,\\n         ],\\n     )\\n@@ -850,10 +850,10 @@ def test_inertia_shear_bend_matrices_for_varying_radius():\\n \\n     correct_shear_matrix = np.array(\\n         [\\n-            [23296.11783, 23296.11783, 31415.92654],\\n-            [93184.47129, 93184.47129, 125663.7061],\\n-            [209665.06048, 209665.06048, 282743.33882],\\n-            [372737.88191, 372737.88191, 502654.82],\\n+            [23303.02243, 23303.02243, 31415.92654],\\n+            [93212.08972, 93212.08972, 125663.7061],\\n+            [209727.20187, 209727.20187, 282743.33882],\\n+            [372848.35889, 372848.35889, 502654.82],\\n         ]\\n     )\\n \\n@@ -1547,7 +1547,9 @@ def test_straight_rod(n_elems):\\n     inv_mass_second_moment_of_inertia = np.linalg.inv(mass_second_moment_of_inertia)\\n     # Shear/Stretch matrix\\n     shear_matrix = np.zeros((3, 3), np.float64)\\n-    np.fill_diagonal(shear_matrix, [0.964 * G * A0, 0.964 * G * A0, E * A0])\\n+    np.fill_diagonal(\\n+        shear_matrix, [(27.0 / 28.0) * G * A0, (27.0 / 28.0) * G * A0, E * A0]\\n+    )\\n     # Bend/Twist matrix\\n     bend_matrix = np.zeros((3, 3), np.float64)\\n     np.fill_diagonal(bend_matrix, [E * I0_1, E * I0_2, G * I0_3])\"]", "hints_text": ""}
