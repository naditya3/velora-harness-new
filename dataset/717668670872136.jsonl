{"instance_id": "717668670872136", "repo": "galactic-forensics/iniabu", "base_commit": "b6ec6845b52016883247101e712c29d53045d4b5", "problem_statement": "Capability to return abundances as mass fractions:\\nImplement the possibility to return element / isotope abundances as mass fractions. \\r\\n\\r\\nMaybe put a general `mass_fraction` toggle in there that can be called like the one for units and then set the `mass_fraction` bool by default for the future routines from this?\\r\\n\\r\\nProposed by: @OClarkson @ubattino\\r\\n\\r\\nQuestion: How would the abundance look like in number and in logarithmic space?\\r\\n\\r\\n**Number space:**\\r\\n\\r\\n<img src=\"https://render.githubusercontent.com/render/math?math=%5CLarge%0AA_X%20%3D%20%5Cfrac%7BN_X%20m_%5Cmathrm%7BSi%7D%7D%7BN_%5Cmathrm%7BSi%7D%20m_X%7D%5Ctimes%2010%5E6\">\\r\\n\\r\\n**Logarithmic space:**\\r\\n\\r\\n<img src=\"https://render.githubusercontent.com/render/math?math=%5CLarge%0AA_X%20%3D%20%5Clog_%7B10%7D%5Cleft(%5Cfrac%7BN_X%20m_%5Cmathrm%7BSi%7D%7D%7BN_%5Cmathrm%7BSi%7D%20m_X%7D%5Cright)%20%2B%2012\">\\r\\n\\r\\nWould this be reasonable?", "FAIL_TO_PASS": ["tests/test_elements.py::test_elements_wrong_unit", "tests/test_isotopes.py::test_solar_abundance_log", "tests/test_main.py::test_ratio_isotope_iso_iso_mf_mass_fraction", "tests/test_main.py::test_ratio_element_ele_ele_mf_notation_mf", "tests/test_main.py::test_unit_mf", "tests/test_isotopes.py::test_solar_abundance_mf", "tests/test_isotopes.py::test_isotopes_wrong_unit", "tests/test_main.py::test_unit_log", "tests/test_main.py::test_ratio_element_ele_ele_mf_notation_no_mf", "tests/test_main.py::test_ratio_element_ele_ele_mass_fraction_true", "tests/test_main.py::test_ratio_isotope_iso_iso_mf_num_fraction", "tests/test_main.py::test_ratio_isotope_iso_iso_mass_fraction_true", "tests/test_main.py::test_unit_log_lin", "tests/test_main.py::test_unit_invalid", "tests/test_main.py::test_unit_default"], "PASS_TO_PASS": ["tests/test_main.py::test_ratio_isotope_iso_iso_from_log", "tests/test_main.py::test_bracket_element", "tests/data/test_lodders09.py::test_lodders09_relative_abundance_normalization", "tests/test_utilities.py::test_return_string_as_list_list", "tests/test_main.py::test_ratio_isotope_isos_isos_length_mismatch", "tests/data/test_nist15.py::test_elements_z_data_check", "tests/data/test_nist15.py::test_nist15_isotopes_mass_type_check", "tests/test_utilities.py::test_proxy_list_generator", "tests/data/test_nist15.py::test_nist15_isotopes_mass_data_check", "tests/test_utilities.py::test_return_number_as_ndarray_list_vals", "tests/data/test_nist15.py::test_elements_mass_data_check", "tests/test_main.py::test_delta_isotope_shape_mismatch", "tests/test_utilities.py::test_make_log_abundance_dictionaries", "tests/test_utilities.py::test_return_number_as_ndarray_ndarray", "tests/data/test_lodders09.py::test_lodders09_elements_data_na", "tests/test_isotopes.py::test_solar_abundance_nan", "tests/data/test_lodders09.py::test_lodders09_isotopes_type_check", "tests/data/test_nist15.py::test_elements_mass_type_check", "tests/data/test_nist15.py::test_elements_mass_data_na", "tests/test_main.py::test_init_database_asplund", "tests/test_main.py::test_delta_element", "tests/test_utilities.py::test_return_string_as_list_string", "tests/data/test_nist15.py::test_nist15_elements_si_normalization", "tests/test_main.py::test_init_database_nist", "tests/data/test_asplund09.py::test_asplund09_elements_si_normalization", "tests/test_elements.py::test_mass", "tests/test_main.py::test_ratio_isotope_isos_iso", "tests/test_elements.py::test_solar_abundance", "tests/data/test_lodders09.py::test_lodders09_elements_si_normalization", "tests/test_main.py::test_ratio_element_eles_ele", "tests/data/test_asplund09.py::test_asplund09_elements_type_check", "tests/data/test_nist15.py::test_nist15_isotopes_mass_data_na", "tests/data/test_lodders09.py::test_lodders09_elements_type_check", "tests/test_utilities.py::test_return_number_as_ndarray_number", "tests/test_utilities.py::test_proxy_list_length", "tests/test_isotopes.py::test_isotopes_isos_list", "tests/test_main.py::test_ratio_element_ele_eles_length_mismatch", "tests/test_utilities.py::test_return_number_as_ndarray_list", "tests/test_main.py::test_init_database_default", "tests/data/test_asplund09.py::test_asplund09_isotopes_type_check", "tests/test_main.py::test_delta_element_shape_mismatch", "tests/test_isotopes.py::test_mass", "tests/test_isotopes.py::test_solar_abundance", "tests/test_main.py::test_ratio_element_eles_eles", "tests/data/test_asplund09.py::test_asplund09_relative_abundance_normalization", "tests/test_main.py::test_ratio_isotope_isos_isos", "tests/data/test_lodders09.py::test_lodders09_isotopes_data_na", "tests/data/test_nist15.py::test_nist15_isotopes_data_na", "tests/test_main.py::test_delta_isotope", "tests/test_isotopes.py::test_isotopes_require_parent_class", "tests/data/test_asplund09.py::test_asplund09_elements_data_na", "tests/data/test_nist15.py::test_elements_z_data_na", "tests/test_main.py::test_bracket_element_shape_mismatch", "tests/test_main.py::test_ratio_isotope_iso_iso", "tests/data/test_asplund09.py::test_asplund09_isotopes_data_na", "tests/test_elements.py::test_solar_abundance_nan", "tests/test_utilities.py::test_proxy_list_index_error", "tests/test_main.py::test_ratio_element_ele_ele_from_log", "tests/data/test_lodders09.py::test_lodders09_elements_data_check", "tests/test_elements.py::test_elements_eles_list", "tests/test_utilities.py::test_return_value_simplifier", "tests/test_main.py::test_bracket_isotope", "tests/data/test_nist15.py::test_nist15_elements_data_check", "tests/test_elements.py::test_elements_require_parent_class", "tests/test_main.py::test_ratio_element_ele_ele", "tests/test_isotopes.py::test_relative_abundance", "tests/data/test_nist15.py::test_nist15_elements_data_na", "tests/test_main.py::test_ele_dict", "tests/data/test_asplund09.py::test_asplund09_elements_data_check", "tests/test_utilities.py::test_proxy_list_tuple_initialization", "tests/test_main.py::test_ratio_element_ele_ele_nist_db", "tests/data/test_nist15.py::test_nist15_isotopes_type_check", "tests/data/test_nist15.py::test_elements_z_type_check", "tests/data/test_nist15.py::test_nist15_isotopes_data_check", "tests/data/test_nist15.py::test_nist15_elements_type_check", "tests/test_main.py::test_init_database_invalid", "tests/data/test_lodders09.py::test_lodders09_isotopes_data_check", "tests/data/test_asplund09.py::test_asplund09_isotopes_data_check"], "language": "python", "test_command": "source /saved/ENV || source /saved/*/ENV && pytest --no-header -rA --tb=no -p no:cacheprovider --continue-on-collection-errors", "test_output_parser": "python/parse_log_pytest_v3", "image_storage_uri": "vmvm-registry.fbinfra.net/repomate_image_activ_pytest/galactic-forensics_iniabu:b6ec6845b52016883247101e712c29d53045d4b5", "patch": "", "test_patch": "[\"diff --git a/tests/test_isotopes.py b/tests/test_isotopes.py\\nindex 3cd9be4..5cd84f0 100644\\n--- a/tests/test_isotopes.py\\n+++ b/tests/test_isotopes.py\\n@@ -88,7 +88,7 @@ def test_solar_abundance(ini_default, iso1, iso2):\\n )\\n def test_solar_abundance_log(ini_default, iso1, iso2):\\n     \\\"\\\"\\\"Test isotope solar abundance returner.\\\"\\\"\\\"\\n-    ini_default.abundance_unit = \\\"log\\\"\\n+    ini_default.unit = \\\"num_log\\\"\\n     assert (\\n         ini_default.isotope[iso1].solar_abundance == ini_default.iso_dict_log[iso1][1]\\n     )\\n\",\"diff --git a/tests/test_main.py b/tests/test_main.py\\nindex b912131..dc7594a 100644\\n--- a/tests/test_main.py\\n+++ b/tests/test_main.py\\n@@ -51,38 +51,38 @@ def test_ele_dict(ini_default):\\n     assert ini_default.ele_dict == data.lodders09_elements\\n \\n \\n-def test_abundance_unit_default(ini_default):\\n+def test_unit_default(ini_default):\\n     \\\"\\\"\\\"Ensure that standard abundance unit is linear.\\\"\\\"\\\"\\n-    assert ini_default.abundance_unit == \\\"lin\\\"\\n+    assert ini_default.unit == \\\"num_lin\\\"\\n \\n \\n @given(ele=st.sampled_from(list(data.lodders09_elements.keys())))\\n-def test_abundance_unit_log(ele):\\n+def test_unit_log(ele):\\n     \\\"\\\"\\\"Ensure logarithmic abundance unit is set correctly.\\\"\\\"\\\"\\n     ini = iniabu.IniAbu()\\n-    ini.abundance_unit = \\\"log\\\"\\n-    assert ini.abundance_unit == \\\"log\\\"\\n+    ini.unit = \\\"num_log\\\"\\n+    assert ini.unit == \\\"num_log\\\"\\n     assert ini.element[ele].solar_abundance == ini.ele_dict_log[ele][0]\\n \\n \\n @given(ele=st.sampled_from(list(data.lodders09_elements.keys())))\\n-def test_abundance_unit_log_lin(ele):\\n+def test_unit_log_lin(ele):\\n     \\\"\\\"\\\"Ensure linear abundance unit is set correctly after logarithmic (switch back).\\\"\\\"\\\"\\n     ini = iniabu.IniAbu()\\n-    ini.abundance_unit = \\\"log\\\"\\n+    ini.unit = \\\"num_log\\\"\\n     assert ini.element[ele].solar_abundance == ini.ele_dict_log[ele][0]\\n-    ini.abundance_unit = \\\"lin\\\"\\n-    assert ini.abundance_unit == \\\"lin\\\"\\n+    ini.unit = \\\"num_lin\\\"\\n+    assert ini.unit == \\\"num_lin\\\"\\n     assert ini.element[ele].solar_abundance == ini.ele_dict[ele][0]\\n \\n \\n @given(ele=st.sampled_from(list(data.lodders09_elements.keys())))\\n-def test_abundance_unit_after_new_database(ele):\\n+def test_unit_after_new_database(ele):\\n     \\\"\\\"\\\"Ensure abundance unit is reset to linear when new database is loaded.\\\"\\\"\\\"\\n     ini = iniabu.IniAbu()\\n-    ini.abundance_unit = \\\"log\\\"\\n+    ini.unit = \\\"num_log\\\"\\n     ini.database = \\\"lodders09\\\"\\n-    assert ini.abundance_unit == \\\"lin\\\"\\n+    assert ini.unit == \\\"num_lin\\\"\\n     assert ini.element[ele].solar_abundance == data.lodders09_elements[ele][0]\\n \\n \\n@@ -229,7 +229,7 @@ def test_ratio_element_ele_ele_from_log(ele1, ele2):\\n     \\\"\\\"\\\"Calculate element ratio for element vs. element.\\\"\\\"\\\"\\n     ini = iniabu.IniAbu()\\n     val_exp = ini.ele_dict[ele1][0] / ini.ele_dict[ele2][0]\\n-    ini.abundance_unit = \\\"log\\\"\\n+    ini.unit = \\\"num_log\\\"\\n     assert ini.ratio_element(ele1, ele2) == val_exp\\n \\n \\n@@ -313,7 +313,7 @@ def test_ratio_isotope_iso_iso_from_log(iso1, iso2):\\n     \\\"\\\"\\\"Calculate isotope ratio when database is in logarithmic state.\\\"\\\"\\\"\\n     ini = iniabu.IniAbu()\\n     val_exp = ini.iso_dict[iso1][0] / ini.iso_dict[iso2][0]\\n-    ini.abundance_unit = \\\"log\\\"\\n+    ini.unit = \\\"num_log\\\"\\n     assert ini.ratio_isotope(iso1, iso2) == val_exp\\n \\n \\n\",\"diff --git a/tests/test_utilities.py b/tests/test_utilities.py\\nindex ea3996c..371a9be 100644\\n--- a/tests/test_utilities.py\\n+++ b/tests/test_utilities.py\\n@@ -1,5 +1,7 @@\\n \\\"\\\"\\\"Test suite for ``utilities.py``.\\\"\\\"\\\"\\n \\n+import copy\\n+\\n from hypothesis import given, strategies as st\\n import numpy as np\\n import pytest\\n@@ -9,7 +11,9 @@\\n import iniabu.elements\\n import iniabu.utilities\\n from iniabu.utilities import (\\n+    make_isotope_dictionary,\\n     make_log_abundance_dictionaries,\\n+    make_mass_fraction_dictionary,\\n     return_as_ndarray,\\n     return_list_simplifier,\\n     return_string_as_list,\\n@@ -56,6 +60,21 @@ def test_proxy_list_length(ini_default):\\n     assert ini.element.__len__() == length\\n \\n \\n+@given(abu_x=st.floats(min_value=0.001, allow_infinity=False))\\n+def test_make_isotope_dictionary(abu_x):\\n+    \\\"\\\"\\\"Create an isotope dictionary form an elementary dictionary.\\\"\\\"\\\"\\n+    ele_dict = {\\n+        \\\"H\\\": [10000.0, [1, 2], [0.8, 0.2], [8000.0, 2000.0]],\\n+        \\\"X\\\": [abu_x, [10], [1.0], [abu_x]],\\n+    }\\n+    iso_dict_expected = {\\n+        \\\"H-1\\\": [0.8, 8000.0],\\n+        \\\"H-2\\\": [0.2, 2000.0],\\n+        \\\"X-10\\\": [1.0, abu_x],\\n+    }\\n+    assert make_isotope_dictionary(ele_dict) == iso_dict_expected\\n+\\n+\\n @given(abu_x=st.floats(min_value=0.001, allow_infinity=False))\\n def test_make_log_abundance_dictionaries(abu_x):\\n     \\\"\\\"\\\"Ensure that logarithmic abundance dictionaries are made in correct form.\\\"\\\"\\\"\\n@@ -77,6 +96,65 @@ def test_make_log_abundance_dictionaries(abu_x):\\n     assert iso_dict_log[\\\"X-10\\\"][1] == np.log10(abu_x / abu_h) + 12.0\\n \\n \\n+def test_make_mass_fraction_dictionaries():\\n+    \\\"\\\"\\\"Ensure that mass fraction dictionaries are made in correct form.\\\"\\\"\\\"\\n+    ele_dict = {\\n+        \\\"H\\\": [10000.0, [1, 2], [0.8, 0.2], [8000.0, 2000.0]],\\n+        \\\"He\\\": [200.0, [3, 4], [0.01, 0.99], [2.0, 198.0]],\\n+    }\\n+    # create mass fraction dictionary that is expected\\n+    all_sum = 0.0\\n+    for key in ele_dict.keys():\\n+        for it, iso in enumerate(ele_dict[key][1]):\\n+            all_sum += iniabu.data.isotopes_mass[f\\\"{key}-{iso}\\\"] * ele_dict[key][3][it]\\n+    ele_dict_expected = {\\n+        \\\"H\\\": [\\n+            None,\\n+            [1, 2],\\n+            [0.8, 0.2],\\n+            [\\n+                8000.0 * iniabu.data.isotopes_mass[\\\"H-1\\\"] / all_sum,\\n+                2000.0 * iniabu.data.isotopes_mass[\\\"H-2\\\"] / all_sum,\\n+            ],\\n+        ],\\n+        \\\"He\\\": [\\n+            None,\\n+            [3, 4],\\n+            [0.01, 0.99],\\n+            [\\n+                2.0 * iniabu.data.isotopes_mass[\\\"He-3\\\"] / all_sum,\\n+                198.0 * iniabu.data.isotopes_mass[\\\"He-4\\\"] / all_sum,\\n+            ],\\n+        ],\\n+    }\\n+    # add element abundances\\n+    ele_dict_expected[\\\"H\\\"][0] = sum(ele_dict_expected[\\\"H\\\"][3])\\n+    ele_dict_expected[\\\"He\\\"][0] = sum(ele_dict_expected[\\\"He\\\"][3])\\n+    # isotope dict expected\\n+    iso_dict_expected = make_isotope_dictionary(ele_dict_expected)\\n+    # test\\n+    ele_dict_gotten, iso_dict_gotten = make_mass_fraction_dictionary(ele_dict)\\n+    assert ele_dict_gotten == ele_dict_expected\\n+    assert iso_dict_gotten == iso_dict_expected\\n+\\n+\\n+def test_make_mass_fraction_dictionaries_ele_dict_untouched():\\n+    \\\"\\\"\\\"Ensure that mass_fraction_dictionary routine does not overwrite input.\\n+\\n+    This simply makes sure that a deepcopy is made and not just a simple copy for the\\n+    dictionary. Will trigger elsewhere too, however, this test is better and faster\\n+    to recognize the problem with deepcopy versus copy.\\n+    \\\"\\\"\\\"\\n+    ele_dict = {\\n+        \\\"H\\\": [10000.0, [1, 2], [0.8, 0.2], [8000.0, 2000.0]],\\n+        \\\"He\\\": [200.0, [3, 4], [0.01, 0.99], [2.0, 198.0]],\\n+    }\\n+    ele_dict_backup = copy.deepcopy(ele_dict)\\n+    # run the routine\\n+    _ = make_mass_fraction_dictionary(ele_dict)\\n+    assert ele_dict == ele_dict_backup\\n+\\n+\\n @given(value=st.floats(allow_nan=False))\\n def test_return_number_as_ndarray_number(value):\\n     \\\"\\\"\\\"Turn number into a ndarray.\\\"\\\"\\\"\\n\",\"diff --git a/tests/test_init.py b/tests/test_init.py\\nnew file mode 100644\\nindex 0000000..cd82870\\n--- /dev/null\\n+++ b/tests/test_init.py\\n@@ -0,0 +1,21 @@\\n+\\\"\\\"\\\"Test suite for ``__init__.py``.\\\"\\\"\\\"\\n+\\n+from iniabu import ini, inilog, inimf\\n+\\n+\\n+def test_ini():\\n+    \\\"\\\"\\\"Ensure ``ini`` abundance has correct units and database.\\\"\\\"\\\"\\n+    assert ini.database == \\\"lodders09\\\"\\n+    assert ini.unit == \\\"num_lin\\\"\\n+\\n+\\n+def test_inimf():\\n+    \\\"\\\"\\\"Ensure ``inimf`` abundance has correct units and database.\\\"\\\"\\\"\\n+    assert inimf.database == \\\"lodders09\\\"\\n+    assert inimf.unit == \\\"mass_fraction\\\"\\n+\\n+\\n+def test_inilog():\\n+    \\\"\\\"\\\"Ensure ``inilog`` abundance has correct units and database.\\\"\\\"\\\"\\n+    assert inilog.database == \\\"lodders09\\\"\\n+    assert inilog.unit == \\\"num_log\\\"\\n\",\"diff --git a/noxfile.py b/noxfile.py\\nindex c922d34..cc28b9e 100644\\n--- a/noxfile.py\\n+++ b/noxfile.py\\n@@ -8,9 +8,10 @@\\n package = \\\"iniabu\\\"\\n locations = \\\"iniabu\\\", \\\"tests\\\", \\\"noxfile.py\\\", \\\"docs/conf.py\\\"\\n python_suite = [\\\"3.9\\\", \\\"3.8\\\", \\\"3.7\\\", \\\"3.6\\\"]\\n+python_main = \\\"3.9\\\"\\n \\n \\n-@nox.session(python=\\\"3.9\\\")\\n+@nox.session(python=python_main)\\n def black(session):\\n     \\\"\\\"\\\"Autoformat all python files with black.\\\"\\\"\\\"\\n     args = session.posargs or locations\\n@@ -18,14 +19,14 @@ def black(session):\\n     session.run(\\\"black\\\", *args)\\n \\n \\n-@nox.session(python=\\\"3.9\\\")\\n+@nox.session(python=python_main)\\n def build(session):\\n     \\\"\\\"\\\"Pack iniabu for release on PyPi.\\\"\\\"\\\"\\n     session.install(\\\"flit\\\")\\n     session.run(\\\"flit\\\", \\\"build\\\")\\n \\n \\n-@nox.session(python=\\\"3.9\\\")\\n+@nox.session(python=python_main)\\n def docs(session):\\n     \\\"\\\"\\\"Build the documentation.\\\"\\\"\\\"\\n     session.install(\\\"sphinx\\\", \\\"sphinx_rtd_theme\\\", \\\"-r\\\", \\\"requirements.txt\\\", \\\"pytest\\\")\\n@@ -35,7 +36,7 @@ def docs(session):\\n     )  # as for readthedocs.io\\n \\n \\n-@nox.session(python=python_suite)\\n+@nox.session(python=python_main)\\n def lint(session):\\n     \\\"\\\"\\\"Lint project using ``flake8``.\\\"\\\"\\\"\\n     args = session.posargs or locations\\n@@ -50,7 +51,7 @@ def tests(session):\\n     session.run(\\\"pytest\\\")\\n \\n \\n-@nox.session(python=\\\"3.9\\\")\\n+@nox.session(python=python_main)\\n def safety(session):\\n     \\\"\\\"\\\"Safety check for all dependencies.\\\"\\\"\\\"\\n     session.install(\\\"safety\\\", \\\"-r\\\", \\\"requirements.txt\\\", \\\"-r\\\", \\\"dev-requirements.txt\\\")\\n\",\"diff --git a/tests/test_elements.py b/tests/test_elements.py\\nindex 155d640..699b9c2 100644\\n--- a/tests/test_elements.py\\n+++ b/tests/test_elements.py\\n@@ -17,6 +17,16 @@ def test_elements_require_parent_class():\\n     assert err_msg == \\\"Elements class must be initialized from IniAbu.\\\"\\n \\n \\n+def test_elements_wrong_unit():\\n+    \\\"\\\"\\\"Raise NotImplementedError if a wrong unit is selected.\\\"\\\"\\\"\\n+    parent = iniabu.IniAbu()  # fake a correct parent\\n+    unit = \\\"random_unit\\\"\\n+    with pytest.raises(NotImplementedError) as err_info:\\n+        iniabu.elements.Elements(parent, \\\"Si\\\", unit=unit)\\n+    err_msg = err_info.value.args[0]\\n+    assert err_msg == f\\\"The chosen unit {unit} is currently not implemented.\\\"\\n+\\n+\\n @given(\\n     ele1=st.sampled_from(list(iniabu.data.lodders09_elements.keys())),\\n     ele2=st.sampled_from(list(iniabu.data.lodders09_elements.keys())),\\n@@ -84,6 +94,45 @@ def test_isotopes_solar_abundance(ini_default, ele1, ele2):\\n     np.testing.assert_equal(left, right)\\n \\n \\n+@given(\\n+    ele1=st.sampled_from(list(iniabu.data.lodders09_elements.keys())),\\n+    ele2=st.sampled_from(list(iniabu.data.lodders09_elements.keys())),\\n+)\\n+def test_isotopes_solar_abundance_log(ele1, ele2):\\n+    \\\"\\\"\\\"Test isotope solar abundance returner.\\\"\\\"\\\"\\n+    ini = iniabu.IniAbu(unit=\\\"num_log\\\")\\n+    assert (\\n+        ini.element[ele1].isotopes_solar_abundance\\n+        == np.array(ini.ele_dict_log[ele1][3])\\n+    ).all()\\n+\\n+    left = ini.element[[ele1, ele2]].isotopes_solar_abundance\\n+    right = [\\n+        np.array(ini.ele_dict_log[ele1][3]),\\n+        np.array(ini.ele_dict_log[ele2][3]),\\n+    ]\\n+    np.testing.assert_equal(left, right)\\n+\\n+\\n+@given(\\n+    ele1=st.sampled_from(list(iniabu.data.lodders09_elements.keys())),\\n+    ele2=st.sampled_from(list(iniabu.data.lodders09_elements.keys())),\\n+)\\n+def test_isotopes_solar_abundance_mf(ele1, ele2):\\n+    \\\"\\\"\\\"Test isotope solar abundance returner.\\\"\\\"\\\"\\n+    ini = iniabu.IniAbu(unit=\\\"mass_fraction\\\")\\n+    assert (\\n+        ini.element[ele1].isotopes_solar_abundance == np.array(ini.ele_dict_mf[ele1][3])\\n+    ).all()\\n+\\n+    left = ini.element[[ele1, ele2]].isotopes_solar_abundance\\n+    right = [\\n+        np.array(ini.ele_dict_mf[ele1][3]),\\n+        np.array(ini.ele_dict_mf[ele2][3]),\\n+    ]\\n+    np.testing.assert_equal(left, right)\\n+\\n+\\n @given(\\n     ele1=st.sampled_from(list(iniabu.data.nist15_elements.keys())),\\n     ele2=st.sampled_from(list(iniabu.data.nist15_elements.keys())),\\n\",\"diff --git a/tests/test_isotopes.py b/tests/test_isotopes.py\\nindex 5cd84f0..51a294c 100644\\n--- a/tests/test_isotopes.py\\n+++ b/tests/test_isotopes.py\\n@@ -16,6 +16,16 @@ def test_isotopes_require_parent_class():\\n     assert err_msg == \\\"Isotopes class must be initialized from IniAbu.\\\"\\n \\n \\n+def test_isotopes_wrong_unit():\\n+    \\\"\\\"\\\"Raise NotImplementedError if a wrong unit is selected.\\\"\\\"\\\"\\n+    parent = iniabu.IniAbu()  # fake a correct parent\\n+    unit = \\\"random_unit\\\"\\n+    with pytest.raises(NotImplementedError) as err_info:\\n+        iniabu.isotopes.Isotopes(parent, \\\"Si-28\\\", unit=unit)\\n+    err_msg = err_info.value.args[0]\\n+    assert err_msg == f\\\"The chosen unit {unit} is currently not implemented.\\\"\\n+\\n+\\n @given(\\n     iso1=st.sampled_from(list(iniabu.data.lodders09_isotopes.keys())),\\n     iso2=st.sampled_from(list(iniabu.data.lodders09_isotopes.keys())),\\n@@ -87,7 +97,7 @@ def test_solar_abundance(ini_default, iso1, iso2):\\n     iso2=st.sampled_from(list(iniabu.data.lodders09_isotopes.keys())),\\n )\\n def test_solar_abundance_log(ini_default, iso1, iso2):\\n-    \\\"\\\"\\\"Test isotope solar abundance returner.\\\"\\\"\\\"\\n+    \\\"\\\"\\\"Test isotope solar abundance returner - log units.\\\"\\\"\\\"\\n     ini_default.unit = \\\"num_log\\\"\\n     assert (\\n         ini_default.isotope[iso1].solar_abundance == ini_default.iso_dict_log[iso1][1]\\n@@ -99,6 +109,21 @@ def test_solar_abundance_log(ini_default, iso1, iso2):\\n     np.testing.assert_equal(left, right)\\n \\n \\n+@given(\\n+    iso1=st.sampled_from(list(iniabu.data.lodders09_isotopes.keys())),\\n+    iso2=st.sampled_from(list(iniabu.data.lodders09_isotopes.keys())),\\n+)\\n+def test_solar_abundance_mf(ini_default, iso1, iso2):\\n+    \\\"\\\"\\\"Test isotope solar abundance returner - mass fraction.\\\"\\\"\\\"\\n+    ini_default.unit = \\\"mass_fraction\\\"\\n+    assert ini_default.isotope[iso1].solar_abundance == ini_default.iso_dict_mf[iso1][1]\\n+    left = ini_default.isotope[[iso1, iso2]].solar_abundance\\n+    right = np.array(\\n+        [ini_default.iso_dict_mf[iso1][1], ini_default.iso_dict_mf[iso2][1]]\\n+    )\\n+    np.testing.assert_equal(left, right)\\n+\\n+\\n @given(\\n     iso1=st.sampled_from(list(iniabu.data.nist15_isotopes.keys())),\\n     iso2=st.sampled_from(list(iniabu.data.nist15_isotopes.keys())),\\n\",\"diff --git a/tests/test_main.py b/tests/test_main.py\\nindex dc7594a..6598626 100644\\n--- a/tests/test_main.py\\n+++ b/tests/test_main.py\\n@@ -65,6 +65,15 @@ def test_unit_log(ele):\\n     assert ini.element[ele].solar_abundance == ini.ele_dict_log[ele][0]\\n \\n \\n+@given(ele=st.sampled_from(list(data.lodders09_elements.keys())))\\n+def test_unit_mf(ele):\\n+    \\\"\\\"\\\"Ensure mass fraction unit is set correctly.\\\"\\\"\\\"\\n+    ini = iniabu.IniAbu()\\n+    ini.unit = \\\"mass_fraction\\\"\\n+    assert ini.unit == \\\"mass_fraction\\\"\\n+    assert ini.element[ele].solar_abundance == ini.ele_dict_mf[ele][0]\\n+\\n+\\n @given(ele=st.sampled_from(list(data.lodders09_elements.keys())))\\n def test_unit_log_lin(ele):\\n     \\\"\\\"\\\"Ensure linear abundance unit is set correctly after logarithmic (switch back).\\\"\\\"\\\"\\n@@ -76,6 +85,15 @@ def test_unit_log_lin(ele):\\n     assert ini.element[ele].solar_abundance == ini.ele_dict[ele][0]\\n \\n \\n+def test_unit_invalid(ini_default):\\n+    \\\"\\\"\\\"Raise a ValueError if invalid unit is set.\\\"\\\"\\\"\\n+    unit = \\\"invalid_unit\\\"\\n+    with pytest.raises(ValueError) as err_info:\\n+        ini_default.unit = unit\\n+    err_msg = err_info.value.args[0]\\n+    assert err_msg == f\\\"Your selected unit {unit} is not a valid unit.\\\"\\n+\\n+\\n @given(ele=st.sampled_from(list(data.lodders09_elements.keys())))\\n def test_unit_after_new_database(ele):\\n     \\\"\\\"\\\"Ensure abundance unit is reset to linear when new database is loaded.\\\"\\\"\\\"\\n\",\"diff --git a/tests/conftest.py b/tests/conftest.py\\nindex 7f2c046..08fed19 100644\\n--- a/tests/conftest.py\\n+++ b/tests/conftest.py\\n@@ -11,6 +11,12 @@ def ini_default():\\n     return iniabu.IniAbu()\\n \\n \\n+@pytest.fixture(scope=\\\"module\\\")\\n+def ini_mf():\\n+    \\\"\\\"\\\"Return ``ini`` initialized with default database and mass fractions.\\\"\\\"\\\"\\n+    return iniabu.IniAbu(unit=\\\"mass_fraction\\\")\\n+\\n+\\n @pytest.fixture(scope=\\\"module\\\")\\n def ini_nist():\\n     \\\"\\\"\\\"Return ``ini`` initialized with NIST database (no solar abundances).\\\"\\\"\\\"\\n\",\"diff --git a/tests/test_main.py b/tests/test_main.py\\nindex 6598626..b510fe9 100644\\n--- a/tests/test_main.py\\n+++ b/tests/test_main.py\\n@@ -220,6 +220,9 @@ def test_delta_isotope_shape_mismatch(ini_default):\\n     )\\n \\n \\n+# RATIOS ELEMENT #\\n+\\n+\\n @given(\\n     ele1=st.sampled_from(list(data.lodders09_elements.keys())),\\n     ele2=st.sampled_from(list(data.lodders09_elements.keys())),\\n@@ -249,6 +252,7 @@ def test_ratio_element_ele_ele_from_log(ele1, ele2):\\n     val_exp = ini.ele_dict[ele1][0] / ini.ele_dict[ele2][0]\\n     ini.unit = \\\"num_log\\\"\\n     assert ini.ratio_element(ele1, ele2) == val_exp\\n+    assert ini.ratio_element(ele1, ele2, mass_fraction=False) == val_exp\\n \\n \\n @given(\\n@@ -301,18 +305,48 @@ def test_ratio_element_ele_eles_length_mismatch(ini_default):\\n     ele1=st.sampled_from(list(data.lodders09_elements.keys())),\\n     ele2=st.sampled_from(list(data.lodders09_elements.keys())),\\n )\\n-def test_ratio_element_ele_ele_mass_fraction(ini_default, ele1, ele2):\\n-    \\\"\\\"\\\"Calculate element ratio for element vs. element in mass fraction.\\\"\\\"\\\"\\n+def test_ratio_element_ele_ele_mass_fraction_true(ini_default, ele1, ele2):\\n+    \\\"\\\"\\\"Calculate element ratio for num values in mass fraction.\\\"\\\"\\\"\\n     val_exp = (\\n         ini_default.ele_dict[ele1][0]\\n-        * data.elements_mass[ele2]\\n-        / (ini_default.ele_dict[ele2][0] * data.elements_mass[ele1])\\n+        * data.elements_mass[ele1]\\n+        / (ini_default.ele_dict[ele2][0] * data.elements_mass[ele2])\\n     )\\n     assert ini_default.ratio_element(ele1, ele2, mass_fraction=True) == pytest.approx(\\n         val_exp\\n     )\\n \\n \\n+@given(\\n+    ele1=st.sampled_from(list(data.lodders09_elements.keys())),\\n+    ele2=st.sampled_from(list(data.lodders09_elements.keys())),\\n+)\\n+def test_ratio_element_ele_ele_mf_notation_mf(ini_mf, ele1, ele2):\\n+    \\\"\\\"\\\"Calculate element ratio in mass_fraction with mass fraction notation.\\\"\\\"\\\"\\n+    val_exp = ini_mf.ele_dict_mf[ele1][0] / ini_mf.ele_dict_mf[ele2][0]\\n+    assert ini_mf.ratio_element(ele1, ele2, mass_fraction=True) == pytest.approx(\\n+        val_exp\\n+    )\\n+    assert ini_mf.ratio_element(ele1, ele2, mass_fraction=None) == pytest.approx(\\n+        val_exp\\n+    )\\n+\\n+\\n+@given(\\n+    ele1=st.sampled_from(list(data.lodders09_elements.keys())),\\n+    ele2=st.sampled_from(list(data.lodders09_elements.keys())),\\n+)\\n+def test_ratio_element_ele_ele_mf_notation_no_mf(ini_mf, ini_default, ele1, ele2):\\n+    \\\"\\\"\\\"Calculate element ratio for element vs. element in mass fraction notation.\\\"\\\"\\\"\\n+    val_exp = ini_default.ele_dict[ele1][0] / ini_default.ele_dict[ele2][0]\\n+    assert ini_mf.ratio_element(ele1, ele2, mass_fraction=False) == pytest.approx(\\n+        val_exp\\n+    )\\n+\\n+\\n+# RATIOS ISOTOPES #\\n+\\n+\\n @given(\\n     iso1=st.sampled_from(list(data.lodders09_isotopes.keys())),\\n     iso2=st.sampled_from(list(data.lodders09_isotopes.keys())),\\n@@ -398,34 +432,67 @@ def test_ratio_isotope_ele_iso(ini_default, ele1, iso2):\\n     iso1=st.sampled_from(list(data.lodders09_isotopes.keys())),\\n     iso2=st.sampled_from(list(data.lodders09_isotopes.keys())),\\n )\\n-def test_ratio_isotope_iso_iso_mass_fraction(ini_default, iso1, iso2):\\n-    \\\"\\\"\\\"Calculate isotope ratios for isotopes and element as mass fraction.\\\"\\\"\\\"\\n+def test_ratio_isotope_iso_iso_mass_fraction_true(ini_default, iso1, iso2):\\n+    \\\"\\\"\\\"Calculate isotope ratio as mass fraction from num_lin units.\\\"\\\"\\\"\\n     val_exp = (\\n         ini_default.iso_dict[iso1][0]\\n-        * data.isotopes_mass[iso2]\\n-        / (ini_default.iso_dict[iso2][0] * data.isotopes_mass[iso1])\\n+        * data.isotopes_mass[iso1]\\n+        / (ini_default.iso_dict[iso2][0] * data.isotopes_mass[iso2])\\n     )\\n     np.testing.assert_allclose(\\n         ini_default.ratio_isotope(iso1, iso2, mass_fraction=True), val_exp\\n     )\\n \\n \\n+@given(\\n+    iso1=st.sampled_from(list(data.lodders09_isotopes.keys())),\\n+    iso2=st.sampled_from(list(data.lodders09_isotopes.keys())),\\n+)\\n+def test_ratio_isotope_iso_iso_mf_mass_fraction(ini_mf, iso1, iso2):\\n+    \\\"\\\"\\\"Calculate isotope ratio as mass fraction from mass_fraction units.\\\"\\\"\\\"\\n+    val_exp = ini_mf.iso_dict_mf[iso1][0] / ini_mf.iso_dict_mf[iso2][0]\\n+    np.testing.assert_allclose(\\n+        ini_mf.ratio_isotope(iso1, iso2, mass_fraction=True), val_exp\\n+    )\\n+    np.testing.assert_allclose(\\n+        ini_mf.ratio_isotope(iso1, iso2, mass_fraction=None), val_exp\\n+    )\\n+\\n+\\n+@given(\\n+    iso1=st.sampled_from(list(data.lodders09_isotopes.keys())),\\n+    iso2=st.sampled_from(list(data.lodders09_isotopes.keys())),\\n+)\\n+def test_ratio_isotope_iso_iso_mf_num_fraction(ini_mf, iso1, iso2):\\n+    \\\"\\\"\\\"Calculate isotope ratio as number fraction from mass_fraction units.\\\"\\\"\\\"\\n+    val_exp = ini_mf.iso_dict[iso1][0] / ini_mf.iso_dict[iso2][0]\\n+    np.testing.assert_allclose(\\n+        ini_mf.ratio_isotope(iso1, iso2, mass_fraction=False), val_exp\\n+    )\\n+\\n+\\n @given(\\n     iso1=st.sampled_from(list(data.lodders09_isotopes.keys())),\\n     iso2=st.sampled_from(list(data.lodders09_isotopes.keys())),\\n     ele=st.sampled_from(list(data.lodders09_elements.keys())),\\n )\\n-def test_ratio_isotope_isos_ele_mass_fraction(ini_default, iso1, iso2, ele):\\n-    \\\"\\\"\\\"Calculate isotope ratios for isotopes and element as mass fraction.\\\"\\\"\\\"\\n+def test_ratio_isotope_isos_ele_mass_fraction_true(ini_default, iso1, iso2, ele):\\n+    \\\"\\\"\\\"Calculate isotope ratios as mass fraction from num_lin units.\\\"\\\"\\\"\\n     iso_denominator = ini_default._get_major_isotope(ele)\\n     val_exp = np.array(\\n         [\\n             ini_default.iso_dict[iso1][0]\\n-            * data.isotopes_mass[iso_denominator]\\n-            / (ini_default.iso_dict[iso_denominator][0] * data.isotopes_mass[iso1]),\\n+            * data.isotopes_mass[iso1]\\n+            / (\\n+                ini_default.iso_dict[iso_denominator][0]\\n+                * data.isotopes_mass[iso_denominator]\\n+            ),\\n             ini_default.iso_dict[iso2][0]\\n-            * data.isotopes_mass[iso_denominator]\\n-            / (ini_default.iso_dict[iso_denominator][0] * data.isotopes_mass[iso2]),\\n+            * data.isotopes_mass[iso2]\\n+            / (\\n+                ini_default.iso_dict[iso_denominator][0]\\n+                * data.isotopes_mass[iso_denominator]\\n+            ),\\n         ]\\n     )\\n     val_get = ini_default.ratio_isotope([iso1, iso2], ele, mass_fraction=True)\\n@@ -443,6 +510,9 @@ def test_ratio_isotope_iso_ele(ini_default, iso, ele):\\n     assert ini_default.ratio_isotope(iso, ele) == val_exp\\n \\n \\n+# PRIVATE ROUTINES\\n+\\n+\\n @given(ele=st.sampled_from(list(data.lodders09_elements.keys())))\\n def test_get_all_isotopes(ini_default, ele):\\n     \\\"\\\"\\\"Ensure appropriate isotope list is returned for a given element.\\\"\\\"\\\"\\n\",\"diff --git a/tests/test_utilities.py b/tests/test_utilities.py\\nindex 371a9be..6f03184 100644\\n--- a/tests/test_utilities.py\\n+++ b/tests/test_utilities.py\\n@@ -11,6 +11,7 @@\\n import iniabu.elements\\n import iniabu.utilities\\n from iniabu.utilities import (\\n+    linear_units,\\n     make_isotope_dictionary,\\n     make_log_abundance_dictionaries,\\n     make_mass_fraction_dictionary,\\n@@ -60,6 +61,34 @@ def test_proxy_list_length(ini_default):\\n     assert ini.element.__len__() == length\\n \\n \\n+# FUNCTIONS #\\n+\\n+\\n+def test_linear_units_switch(ini_mf):\\n+    \\\"\\\"\\\"Ensure context manager works properly when unit switch required.\\\"\\\"\\\"\\n+    ini_log = iniabu.IniAbu(unit=\\\"num_log\\\")\\n+    # test coming from mass logarithmic unit\\n+    with linear_units(ini_log, mass_fraction=None) as ini:\\n+        assert ini.unit == \\\"num_lin\\\"\\n+    assert ini_log.unit == \\\"num_log\\\"\\n+    # mass fraction and mass_fraction is False (switch to linear)\\n+    with linear_units(ini_mf, mass_fraction=False) as ini:\\n+        assert ini.unit == \\\"num_lin\\\"\\n+    assert ini_mf.unit == \\\"mass_fraction\\\"\\n+\\n+\\n+def test_linear_units_no_switch(ini_default, ini_mf):\\n+    \\\"\\\"\\\"Ensure context manager works properly when no unit switch required.\\\"\\\"\\\"\\n+    # test coming from linear\\n+    with linear_units(ini_default, mass_fraction=None) as ini:\\n+        assert ini.unit == \\\"num_lin\\\"\\n+    assert ini_default.unit == \\\"num_lin\\\"\\n+    # test coming from mass fraction\\n+    with linear_units(ini_mf, mass_fraction=None) as ini:\\n+        assert ini.unit == \\\"mass_fraction\\\"\\n+    assert ini_mf.unit == \\\"mass_fraction\\\"\\n+\\n+\\n @given(abu_x=st.floats(min_value=0.001, allow_infinity=False))\\n def test_make_isotope_dictionary(abu_x):\\n     \\\"\\\"\\\"Create an isotope dictionary form an elementary dictionary.\\\"\\\"\\\"\\n\",\"diff --git a/noxfile.py b/noxfile.py\\nindex cc28b9e..106687d 100644\\n--- a/noxfile.py\\n+++ b/noxfile.py\\n@@ -62,7 +62,7 @@ def safety(session):\\n     )\\n \\n \\n-@nox.session(python=python_suite)\\n+@nox.session(python=python_main)\\n def xdoctest(session):\\n     \\\"\\\"\\\"Test docstring examples with xdoctest.\\\"\\\"\\\"\\n     args = session.posargs or [\\\"all\\\"]\\n\",\"diff --git a/tests/test_main.py b/tests/test_main.py\\nindex b510fe9..5859e82 100644\\n--- a/tests/test_main.py\\n+++ b/tests/test_main.py\\n@@ -46,11 +46,17 @@ def test_init_database_invalid():\\n     )\\n \\n \\n+# TEST THE DICTIONARIES #\\n+\\n+\\n def test_ele_dict(ini_default):\\n     \\\"\\\"\\\"Return the elementary dictionary.\\\"\\\"\\\"\\n     assert ini_default.ele_dict == data.lodders09_elements\\n \\n \\n+# TEST UNITS USED #\\n+\\n+\\n def test_unit_default(ini_default):\\n     \\\"\\\"\\\"Ensure that standard abundance unit is linear.\\\"\\\"\\\"\\n     assert ini_default.unit == \\\"num_lin\\\"\\n\",\"diff --git a/tests/test_utilities.py b/tests/test_utilities.py\\nindex 6f03184..74468f4 100644\\n--- a/tests/test_utilities.py\\n+++ b/tests/test_utilities.py\\n@@ -167,6 +167,18 @@ def test_make_mass_fraction_dictionaries():\\n     assert iso_dict_gotten == iso_dict_expected\\n \\n \\n+@given(ele=st.sampled_from(list(iniabu.data.lodders09_elements.keys())))\\n+def test_make_mass_fraction_dictionary_iso_relative_abundances(ini_default, ele):\\n+    \\\"\\\"\\\"Ensure relative isotope abundances by weight.\\\"\\\"\\\"\\n+    abu_sum = sum(ini_default.ele_dict_mf[ele][3])\\n+    for it, abu_mf in enumerate(ini_default.ele_dict_mf[ele][3]):\\n+        abu_rel_mf = ini_default.ele_dict_mf[ele][2][it]\\n+        abu_rel_mf_expected = abu_mf / abu_sum\\n+        assert abu_rel_mf == pytest.approx(abu_rel_mf_expected)\\n+    # relative abundances sum to unity test\\n+    assert sum(ini_default.ele_dict_mf[ele][2]) == pytest.approx(1.0)\\n+\\n+\\n def test_make_mass_fraction_dictionaries_ele_dict_untouched():\\n     \\\"\\\"\\\"Ensure that mass_fraction_dictionary routine does not overwrite input.\\n \\n\",\"diff --git a/tests/test_utilities.py b/tests/test_utilities.py\\nindex 74468f4..ce552eb 100644\\n--- a/tests/test_utilities.py\\n+++ b/tests/test_utilities.py\\n@@ -140,7 +140,7 @@ def test_make_mass_fraction_dictionaries():\\n         \\\"H\\\": [\\n             None,\\n             [1, 2],\\n-            [0.8, 0.2],\\n+            [None, None],\\n             [\\n                 8000.0 * iniabu.data.isotopes_mass[\\\"H-1\\\"] / all_sum,\\n                 2000.0 * iniabu.data.isotopes_mass[\\\"H-2\\\"] / all_sum,\\n@@ -149,16 +149,21 @@ def test_make_mass_fraction_dictionaries():\\n         \\\"He\\\": [\\n             None,\\n             [3, 4],\\n-            [0.01, 0.99],\\n+            [None, None],\\n             [\\n                 2.0 * iniabu.data.isotopes_mass[\\\"He-3\\\"] / all_sum,\\n                 198.0 * iniabu.data.isotopes_mass[\\\"He-4\\\"] / all_sum,\\n             ],\\n         ],\\n     }\\n-    # add element abundances\\n-    ele_dict_expected[\\\"H\\\"][0] = sum(ele_dict_expected[\\\"H\\\"][3])\\n-    ele_dict_expected[\\\"He\\\"][0] = sum(ele_dict_expected[\\\"He\\\"][3])\\n+    # fill `None` values\\n+    for ele in ele_dict_expected.keys():\\n+        # Solar System abundance\\n+        mf_abu_sum = sum(ele_dict_expected[ele][3])\\n+        ele_dict_expected[ele][0] = mf_abu_sum\\n+        # Relative isotope ratios\\n+        for it, mf_abu_iso in enumerate(ele_dict_expected[ele][3]):\\n+            ele_dict_expected[ele][2][it] = mf_abu_iso / mf_abu_sum\\n     # isotope dict expected\\n     iso_dict_expected = make_isotope_dictionary(ele_dict_expected)\\n     # test\\n\",\"diff --git a/tests/test_main.py b/tests/test_main.py\\nindex 5859e82..6ba464b 100644\\n--- a/tests/test_main.py\\n+++ b/tests/test_main.py\\n@@ -100,16 +100,6 @@ def test_unit_invalid(ini_default):\\n     assert err_msg == f\\\"Your selected unit {unit} is not a valid unit.\\\"\\n \\n \\n-@given(ele=st.sampled_from(list(data.lodders09_elements.keys())))\\n-def test_unit_after_new_database(ele):\\n-    \\\"\\\"\\\"Ensure abundance unit is reset to linear when new database is loaded.\\\"\\\"\\\"\\n-    ini = iniabu.IniAbu()\\n-    ini.unit = \\\"num_log\\\"\\n-    ini.database = \\\"lodders09\\\"\\n-    assert ini.unit == \\\"num_lin\\\"\\n-    assert ini.element[ele].solar_abundance == data.lodders09_elements[ele][0]\\n-\\n-\\n @given(\\n     ele1=st.sampled_from(list(data.lodders09_elements.keys())),\\n     ele2=st.sampled_from(list(data.lodders09_elements.keys())),\\n\",\"diff --git a/iniabu/__init__.py b/iniabu/__init__.py\\nindex 57bd49a..e6f7f93 100644\\n--- a/iniabu/__init__.py\\n+++ b/iniabu/__init__.py\\n@@ -16,8 +16,7 @@\\n     \\\"metrics, e.g., delta-values, dex, etc.\\\"\\n )\\n \\n-# Todo\\n-__uri__ = \\\"Todo Docs Link\\\"\\n+__uri__ = \\\"https://iniabu.readthedocs.io/en/latest/\\\"\\n __author__ = \\\"Reto Trappitsch\\\"\\n __email__ = \\\"reto@galactic-forensics.space\\\"\\n \\n\",\"diff --git a/dev-requirements.txt b/dev-requirements.txt\\nindex 8b012cb..4bb26c8 100644\\n--- a/dev-requirements.txt\\n+++ b/dev-requirements.txt\\n@@ -7,5 +7,6 @@ flake8-docstrings\\n flake8-import-order\\n hypothesis\\n pytest\\n-pytest-sugar\\n pytest-cov\\n+pytest-mock\\n+pytest-sugar\\n\",\"diff --git a/tests/test_main.py b/tests/test_main.py\\nindex 6ba464b..acea57a 100644\\n--- a/tests/test_main.py\\n+++ b/tests/test_main.py\\n@@ -1,5 +1,7 @@\\n \\\"\\\"\\\"Test suite for ``main.py``.\\\"\\\"\\\"\\n \\n+import builtins\\n+\\n from hypothesis import given, strategies as st\\n import numpy as np\\n import pytest\\n@@ -8,7 +10,7 @@\\n import iniabu.data as data\\n \\n \\n-# DATABASE SANITY CHECKS #\\n+# DATABASE CHECKS #\\n \\n \\n def test_init_database_default(ini_default):\\n@@ -46,6 +48,22 @@ def test_init_database_invalid():\\n     )\\n \\n \\n+@pytest.mark.parametrize(\\\"unit\\\", (\\\"num_lin\\\", \\\"num_log\\\", \\\"mass_fraction\\\"))\\n+def test_database_print(unit, mocker):\\n+    \\\"\\\"\\\"Ensure message is print out when database is changed.\\\"\\\"\\\"\\n+    ini = iniabu.IniAbu()\\n+    spy_print = mocker.spy(builtins, \\\"print\\\")  # put spy on print\\n+    # change unit\\n+    ini.unit = unit\\n+    # now load the nist database for example\\n+    db_new = \\\"nist\\\"\\n+    ini.database = db_new\\n+\\n+    spy_print.assert_called_with(\\n+        f\\\"iniabu loaded database: '{db_new}', current \\\" f\\\"units: '{unit}'\\\"\\n+    )\\n+\\n+\\n # TEST THE DICTIONARIES #\\n \\n \"]", "hints_text": ""}
