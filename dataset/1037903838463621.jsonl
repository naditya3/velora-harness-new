{"instance_id": "1037903838463621", "repo": "sphinx-doc/sphinx", "base_commit": "c73628dfcac844f89198ccd805e8e35609b37636", "problem_statement": "DOC: line breaks in long signatures:\\n### Pandas version checks\\n\\n- [X] I have checked that the issue still exists on the latest versions of the docs on `main` [here](https://pandas.pydata.org/docs/dev/)\\n\\n\\n### Location of the documentation\\n\\n[pandas.read_json](https://pandas.pydata.org/docs/reference/api/pandas.read_json.html) for instance\\n\\n### Documentation problem\\n\\nSome of the function/method signatures in the API reference are very hard to read because they have many arguments.\\n\\n### Suggested fix for documentation\\n\\nThe following CSS could be applied on functions or methods with long signatures in order to add line breaks between arguments:\\r\\n```css\\r\\n.long-sig .sig-param:not(.short-sig .sig-param)::before {\\r\\n    content: \"\\a\\20\\20\\20\\20\";\\r\\n    white-space: pre;\\r\\n}\\r\\n\\r\\n/* Newline after the last parameter (so the closing bracket is on a new line) */\\r\\n.long-sig .sig-param:not(.short-sig .sig-param):last-of-type::after {\\r\\n    content: \"\\a\";\\r\\n    white-space: pre;\\r\\n}\\r\\n```\\r\\n\\r\\nOne possible way to apply this only in the right places would be to add a template `function_with_long_sig.rst` like the following:\\r\\n```rst\\r\\n{{ fullname | escape | underline}}\\r\\n\\r\\n.. currentmodule:: {{ module }}\\r\\n\\r\\n.. container:: long-sig\\r\\n\\r\\n    .. auto{{ objtype }}:: {{ objname }}\\r\\n```\\r\\n\\r\\nand below the right `autosummary` directives specify the template where appropriate, with: `:template: autosummary/function_with_long_sig.rst`\\r\\n\\r\\nHere's the before / after:\\r\\n\\r\\n![image](https://user-images.githubusercontent.com/31036680/204390795-9ea52aeb-afc2-4d5d-9384-3a3df85d414c.png)\\r\\n\\r\\n![image](https://user-images.githubusercontent.com/31036680/204393821-9399f21a-f12d-45d9-9831-0d217639c7b7.png)\\r\\n\\r\\n\\r\\nThis all is a matter of style so I don't know if most people would prefer it that way, feel free to share your thoughts. But if it  would actually be a welcome enhancement, I'd be glad to work on a PR.", "FAIL_TO_PASS": ["tests/test_build_html.py::test_html5_output[objects.html-expect128]", "tests/test_domain_cpp.py::test_domain_cpp_build_with_add_function_parentheses_is_True", "tests/test_build_html.py::test_html5_output[otherext.html-expect159]", "tests/test_build_html.py::test_html5_output[markup.html-expect58]", "tests/test_domain_c.py::test_domain_c_build_anon_dup_decl", "tests/test_build_html.py::test_html5_output[markup.html-expect67]", "tests/test_build_html.py::test_docutils_output[footnote.html-expect6]", "tests/test_build_html.py::test_html5_output[markup.html-expect86]", "tests/test_build_html.py::test_option_emphasise_placeholders", "tests/test_domain_js.py::test_jsfunction_signature_with_maximum_signature_line_length_force_single", "tests/test_domain_py.py::test_pyfunction_signature_with_maximum_signature_line_length_equal", "tests/test_domain_cpp.py::test_domain_cpp_build_anon_dup_decl", "tests/test_build_html.py::test_html5_output[markup.html-expect36]", "tests/test_build_html.py::test_html5_output[bom.html-expect150]", "tests/test_build_html.py::test_html5_output[objects.html-expect134]", "tests/test_build_html.py::test_html5_output[markup.html-expect50]", "tests/test_build_html.py::test_html5_output[includes.html-expect23]", "tests/test_build_latex.py::test_writer", "tests/test_build_html.py::test_html5_output[markup.html-expect79]", "tests/test_domain_cpp.py::test_domain_cpp_build_misuse_of_roles", "tests/test_domain_py.py::test_pyfunction_signature_with_maximum_signature_line_length_force_single", "tests/test_build_html.py::test_html5_output[objects.html-expect116]", "tests/test_build_html.py::test_html5_output[markup.html-expect80]", "tests/test_domain_py.py::test_domain_py_python_maximum_signature_line_length_in_text", "tests/test_build_html.py::test_html5_output[objects.html-expect119]", "tests/test_domain_cpp.py::test_cpp_function_signature_with_maximum_signature_line_length_equal", "tests/test_domain_c.py::test_domain_c_parse_cfunction", "tests/test_domain_c.py::test_domain_c_c_maximum_signature_line_length_in_text", "tests/test_build_html.py::test_html5_output[markup.html-expect49]", "tests/test_build_html.py::test_html5_output[extensions.html-expect152]", "tests/test_build.py::test_build_all[dirhtml]", "tests/test_build_html.py::test_html5_output[markup.html-expect44]", "tests/test_build_html.py::test_html5_output[subdir/includes.html-expect9]", "tests/test_build_html.py::test_html5_output[markup.html-expect64]", "tests/test_build_html.py::test_html5_output[markup.html-expect74]", "tests/test_build_html.py::test_html5_output[objects.html-expect104]", "tests/test_build_html.py::test_html5_output[markup.html-expect51]", "tests/test_build_html.py::test_html5_output[autodoc.html-expect25]", "tests/test_build_html.py::test_html5_output[markup.html-expect61]", "tests/test_domain_c.py::test_domain_c_parse_cvar", "tests/test_build_changes.py::test_no_changes", "tests/test_build_html.py::test_html5_output[includes.html-expect17]", "tests/test_build_html.py::test_html5_output[markup.html-expect71]", "tests/test_domain_cpp.py::test_domain_cpp_build_multi_decl_lookup", "tests/test_ext_viewcode.py::test_viewcode_epub_enabled", "tests/test_build_html.py::test_docutils_output[footnote.html-expect8]", "tests/test_domain_py.py::test_python_maximum_signature_line_length_overrides_global", "tests/test_build_html.py::test_html5_output[index.html-expect137]", "tests/test_build_html.py::test_html5_output[objects.html-expect108]", "tests/test_build_html.py::test_html5_output[objects.html-expect112]", "tests/test_build_html.py::test_html5_output[includes.html-expect13]", "tests/test_build_html.py::test_html5_output[markup.html-expect31]", "tests/test_build_html.py::test_html_parallel", "tests/test_build_html.py::test_docutils_output[footnote.html-expect4]", "tests/test_ext_viewcode.py::test_viewcode_epub_default", "tests/test_build_html.py::test_html5_output[subdir/includes.html-expect8]", "tests/test_ext_viewcode.py::test_linkcode", "tests/test_build_html.py::test_html5_output[objects.html-expect117]", "tests/test_build_html.py::test_html5_output[images.html-expect1]", "tests/test_build_html.py::test_html5_output[markup.html-expect85]", "tests/test_domain_cpp.py::test_domain_cpp_parse_mix_decl_duplicate", "tests/test_build_html.py::test_html5_output[subdir/images.html-expect5]", "tests/test_build_html.py::test_html5_output[includes.html-expect15]", "tests/test_domain_c.py::test_domain_c_build_namespace", "tests/test_build_html.py::test_html5_output[includes.html-expect16]", "tests/test_build_html.py::test_docutils_output[footnote.html-expect13]", "tests/test_build_html.py::test_html5_output[genindex.html-expect157]", "tests/test_domain_c.py::test_cfunction_signature_with_maximum_signature_line_length_break", "tests/test_search.py::test_objects_are_escaped", "tests/test_environment.py::test_object_inventory", "tests/test_build_html.py::test_html5_output[subdir/includes.html-expect10]", "tests/test_domain_js.py::test_domain_js_javascript_maximum_signature_line_length_in_text", "tests/test_build_html.py::test_html5_output[markup.html-expect84]", "tests/test_domain_cpp.py::test_domain_cpp_normalize_unspecialized_template_args", "tests/test_build_html.py::test_html5_output[objects.html-expect105]", "tests/test_build.py::test_build_all[text]", "tests/test_build_html.py::test_html5_output[subdir/includes.html-expect11]", "tests/test_build_html.py::test_html5_output[markup.html-expect73]", "tests/test_ext_coverage.py::test_show_missing_items", "tests/test_build_html.py::test_html5_output[markup.html-expect68]", "tests/test_build_html.py::test_html5_output[objects.html-expect100]", "tests/test_build_html.py::test_html5_output[markup.html-expect57]", "tests/test_build_html.py::test_html5_output[markup.html-expect45]", "tests/test_build_html.py::test_html5_output[markup.html-expect83]", "tests/test_build_html.py::test_html5_output[objects.html-expect102]", "tests/test_build_html.py::test_html5_output[markup.html-expect65]", "tests/test_build_html.py::test_html5_output[objects.html-expect90]", "tests/test_build_html.py::test_html5_output[objects.html-expect94]", "tests/test_build.py::test_build_all[singlehtml]", "tests/test_build_html.py::test_html5_output[autodoc.html-expect27]", "tests/test_build_html.py::test_docutils_output[index.html-expect0]", "tests/test_domain_c.py::test_domain_c_parse_noindexentry", "tests/test_build_html.py::test_html5_output[objects.html-expect99]", "tests/test_build_html.py::test_html_download", "tests/test_build_html.py::test_html5_output[markup.html-expect52]", "tests/test_domain_c.py::test_cfunction_signature_with_maximum_signature_line_length_force_single", "tests/test_domain_c.py::test_domain_c_build_field_role", "tests/test_build_html.py::test_html5_output[genindex.html-expect156]", "tests/test_build_html.py::test_html5_output[index.html-expect141]", "tests/test_build_html.py::test_html5_output[markup.html-expect39]", "tests/test_build_html.py::test_docutils_output[index.html-expect1]", "tests/test_build_html.py::test_html5_output[markup.html-expect82]", "tests/test_build_html.py::test_html5_output[includes.html-expect12]", "tests/test_build_html.py::test_html5_output[objects.html-expect96]", "tests/test_build_html.py::test_html5_output[objects.html-expect106]", "tests/test_build_html.py::test_html5_output[objects.html-expect129]", "tests/test_build_html.py::test_html5_output[markup.html-expect33]", "tests/test_build_html.py::test_html5_output[markup.html-expect81]", "tests/test_build_html.py::test_html5_output[objects.html-expect125]", "tests/test_build_html.py::test_html5_output[markup.html-expect75]", "tests/test_build_html.py::test_html5_output[includes.html-expect19]", "tests/test_domain_c.py::test_domain_c_parse_cmember", "tests/test_domain_py.py::test_pyfunction_signature_with_maximum_signature_line_length_break", "tests/test_build_html.py::test_docutils_output[footnote.html-expect2]", "tests/test_domain_c.py::test_domain_c_build_function_param_target", "tests/test_build_html.py::test_html5_output[objects.html-expect122]", "tests/test_build_html.py::test_html5_output[markup.html-expect77]", "tests/test_build_html.py::test_html5_output[markup.html-expect66]", "tests/test_build_html.py::test_html5_output[autodoc.html-expect28]", "tests/test_domain_cpp.py::test_domain_cpp_build_intersphinx", "tests/test_domain_cpp.py::test_domain_cpp_cpp_maximum_signature_line_length_in_html", "tests/test_build_html.py::test_html5_output[includes.html-expect22]", "tests/test_build_html.py::test_html5_output[markup.html-expect46]", "tests/test_build_html.py::test_html5_output[images.html-expect0]", "tests/test_build_html.py::test_html5_output[markup.html-expect60]", "tests/test_build_html.py::test_html5_output[markup.html-expect59]", "tests/test_build_html.py::test_html5_output[autodoc.html-expect26]", "tests/test_build_html.py::test_html5_output[markup.html-expect30]", "tests/test_build_html.py::test_docutils_output[footnote.html-expect7]", "tests/test_build_html.py::test_html5_output[index.html-expect148]", "tests/test_build.py::test_build_all[linkcheck]", "tests/test_build_html.py::test_html5_output[objects.html-expect121]", "tests/test_build_html.py::test_html5_output[markup.html-expect37]", "tests/test_build_html.py::test_html5_output[images.html-expect3]", "tests/test_build_html.py::test_html5_output[markup.html-expect62]", "tests/test_build_html.py::test_html5_output[objects.html-expect113]", "tests/test_domain_cpp.py::test_domain_cpp_parse_noindexentry", "tests/test_build_html.py::test_html5_output[objects.html-expect114]", "tests/test_build_html.py::test_html5_output[markup.html-expect70]", "tests/test_build_html.py::test_html5_output[markup.html-expect63]", "tests/test_domain_js.py::test_javascript_maximum_signature_line_length_overrides_global", "tests/test_build_html.py::test_html5_output[includes.html-expect14]", "tests/test_build_changes.py::test_build", "tests/test_build_html.py::test_html5_output[index.html-expect144]", "tests/test_build_html.py::test_html5_output[objects.html-expect89]", "tests/test_domain_cpp.py::test_cpp_function_signature_with_maximum_signature_line_length_break", "tests/test_build_html.py::test_html5_output[includes.html-expect24]", "tests/test_domain_cpp.py::test_cpp_function_signature_with_maximum_signature_line_length_force_single", "tests/test_build_html.py::test_html5_output[markup.html-expect43]", "tests/test_build_html.py::test_option_reference_with_value", "tests/test_build_html.py::test_html5_output[subdir/images.html-expect6]", "tests/test_build_html.py::test_html5_output[objects.html-expect110]", "tests/test_build_html.py::test_html5_output[genindex.html-expect158]", "tests/test_builder.py::test_incremental_reading", "tests/test_build_html.py::test_html5_output[objects.html-expect91]", "tests/test_build_gettext.py::test_build_gettext", "tests/test_build_html.py::test_docutils_output[footnote.html-expect16]", "tests/test_ext_coverage.py::test_build", "tests/test_build_html.py::test_html5_output[markup.html-expect76]", "tests/test_build_html.py::test_html5_output[objects.html-expect118]", "tests/test_domain_js.py::test_jsfunction_signature_with_maximum_signature_line_length_equal", "tests/test_build_html.py::test_html5_output[markup.html-expect48]", "tests/test_build_html.py::test_html5_output[index.html-expect149]", "tests/test_build_gettext.py::test_build_single_pot", "tests/test_build_html.py::test_html5_output[index.html-expect147]", "tests/test_build_texinfo.py::test_texinfo_samp_with_variable", "tests/test_build_html.py::test_html5_output[objects.html-expect131]", "tests/test_environment.py::test_images", "tests/test_domain_js.py::test_jsfunction_signature_with_maximum_signature_line_length_break", "tests/test_build_html.py::test_html5_output[objects.html-expect88]", "tests/test_build_html.py::test_html5_output[markup.html-expect53]", "tests/test_build_html.py::test_html5_output[objects.html-expect132]", "tests/test_build_html.py::test_html5_output[objects.html-expect127]", "tests/test_build_html.py::test_html5_output[objects.html-expect101]", "tests/test_build_html.py::test_docutils_output[footnote.html-expect11]", "tests/test_build_html.py::test_html5_output[includes.html-expect18]", "tests/test_domain_cpp.py::test_domain_cpp_build_with_add_function_parentheses_is_False", "tests/test_build.py::test_build_all[pseudoxml]", "tests/test_build_html.py::test_html5_output[markup.html-expect34]", "tests/test_build_html.py::test_html5_output[objects.html-expect92]", "tests/test_build_html.py::test_html5_output[index.html-expect145]", "tests/test_domain_py.py::test_pyfunction_signature_with_python_maximum_signature_line_length_force_single", "tests/test_build_latex.py::test_footnote", "tests/test_build_html.py::test_html5_output[subdir/includes.html-expect7]", "tests/test_build_html.py::test_html5_output[extensions.html-expect153]", "tests/test_domain_js.py::test_jsfunction_signature_with_javascript_maximum_signature_line_length_break", "tests/test_domain_py.py::test_pyfunction_signature_with_python_maximum_signature_line_length_break", "tests/test_build_latex.py::test_one_parameter_per_line", "tests/test_build_html.py::test_option_emphasise_placeholders_default", "tests/test_domain_js.py::test_jsfunction_signature_with_javascript_maximum_signature_line_length_equal", "tests/test_build_html.py::test_html5_output[markup.html-expect40]", "tests/test_build_html.py::test_docutils_output[footnote.html-expect9]", "tests/test_domain_js.py::test_domain_js_javascript_maximum_signature_line_length_in_html", "tests/test_build_html.py::test_html5_output[index.html-expect143]", "tests/test_build_html.py::test_html5_output[markup.html-expect32]", "tests/test_domain_c.py::test_domain_c_build_intersphinx", "tests/test_build_html.py::test_html5_output[index.html-expect146]", "tests/test_build_html.py::test_html5_output[objects.html-expect109]", "tests/test_build.py::test_build_all[xml]", "tests/test_build_html.py::test_html5_output[includes.html-expect21]", "tests/test_build_html.py::test_docutils_output[footnote.html-expect5]", "tests/test_build_html.py::test_html5_output[objects.html-expect123]", "tests/test_build_html.py::test_html5_output[genindex.html-expect155]", "tests/test_build_html.py::test_html5_output[markup.html-expect35]", "tests/test_build_html.py::test_html5_output[objects.html-expect126]", "tests/test_domain_py.py::test_pyfunction_signature_with_python_maximum_signature_line_length_equal", "tests/test_build_html.py::test_html5_output[extensions.html-expect151]", "tests/test_domain_py.py::test_domain_py_python_maximum_signature_line_length_in_html", "tests/test_domain_cpp.py::test_domain_cpp_build_semicolon", "tests/test_build_html.py::test_html5_output[index.html-expect138]", "tests/test_build_html.py::test_html5_output[index.html-expect142]", "tests/test_build_html.py::test_docutils_output[footnote.html-expect15]", "tests/test_domain_cpp.py::test_domain_cpp_build_backslash_ok_false", "tests/test_domain_js.py::test_jsfunction_signature_with_javascript_maximum_signature_line_length_force_single", "tests/test_build_html.py::test_html5_output[markup.html-expect42]", "tests/test_domain_cpp.py::test_domain_cpp_build_field_role", "tests/test_build_html.py::test_docutils_output[footnote.html-expect3]", "tests/test_domain_cpp.py::test_domain_cpp_cpp_maximum_signature_line_length_in_text", "tests/test_build_html.py::test_html5_output[objects.html-expect130]", "tests/test_ext_intersphinx.py::test_missing_reference_cppdomain", "tests/test_build_html.py::test_html5_output[markup.html-expect38]", "tests/test_build_html.py::test_html5_output[objects.html-expect93]", "tests/test_build_html.py::test_docutils_output[footnote.html-expect14]", "tests/test_domain_c.py::test_domain_c_build", "tests/test_build_manpage.py::test_all", "tests/test_build_html.py::test_html5_output[objects.html-expect135]", "tests/test_build_html.py::test_html5_output[markup.html-expect47]", "tests/test_build_texinfo.py::test_texinfo_xrefs", "tests/test_domain_c.py::test_domain_c_build_ns_lookup", "tests/test_build_html.py::test_html5_output[index.html-expect136]", "tests/test_build_html.py::test_html5_output[objects.html-expect111]", "tests/test_build_html.py::test_html5_output[markup.html-expect78]", "tests/test_build_html.py::test_html5_output[images.html-expect4]", "tests/test_domain_cpp.py::test_domain_cpp_build_backslash_ok_true", "tests/test_build_html.py::test_html5_output[markup.html-expect54]", "tests/test_build_html.py::test_html5_output[markup.html-expect55]", "tests/test_build_html.py::test_html5_output[objects.html-expect103]", "tests/test_domain_c.py::test_domain_c_build_semicolon", "tests/test_build_html.py::test_html5_output[markup.html-expect69]", "tests/test_build_html.py::test_html5_output[objects.html-expect115]", "tests/test_build_html.py::test_html5_output[objects.html-expect87]", "tests/test_build_html.py::test_html5_output[objects.html-expect98]", "tests/test_build_html.py::test_html5_output[includes.html-expect20]", "tests/test_ext_coverage.py::test_show_missing_items_quiet", "tests/test_build_html.py::test_html5_output[images.html-expect2]", "tests/test_build_html.py::test_html5_output[index.html-expect140]", "tests/test_build_html.py::test_html5_output[objects.html-expect95]", "tests/test_build_html.py::test_html5_output[markup.html-expect41]", "tests/test_build_html.py::test_html5_output[otherext.html-expect160]", "tests/test_build_html.py::test_html5_output[objects.html-expect120]", "tests/test_domain_cpp.py::test_domain_cpp_build_warn_template_param_qualified_name", "tests/test_build_html.py::test_html5_output[objects.html-expect107]", "tests/test_build_html.py::test_html5_output[markup.html-expect56]", "tests/test_build_html.py::test_html5_output[index.html-expect139]", "tests/test_build_html.py::test_html5_output[genindex.html-expect154]", "tests/test_build_html.py::test_html5_output[markup.html-expect72]", "tests/test_build_html.py::test_docutils_output[footnote.html-expect10]", "tests/test_domain_cpp.py::test_domain_cpp_build_xref_consistency", "tests/test_build_html.py::test_html5_output[objects.html-expect124]", "tests/test_build_html.py::test_html5_output[objects.html-expect133]", "tests/test_domain_c.py::test_cfunction_signature_with_maximum_signature_line_length_equal", "tests/test_build_html.py::test_docutils_output[footnote.html-expect12]", "tests/test_domain_c.py::test_domain_c_c_maximum_signature_line_length_in_html", "tests/test_build_html.py::test_html5_output[extapi.html-expect29]", "tests/test_build_html.py::test_html5_output[objects.html-expect97]"], "PASS_TO_PASS": [], "language": "python", "test_command": "source /saved/ENV || source /saved/*/ENV && pytest --no-header -rA --tb=no -p no:cacheprovider --continue-on-collection-errors", "test_output_parser": "python/parse_log_pytest_v3", "image_storage_uri": "vmvm-registry.fbinfra.net/repomate_image_activ_pytest/sphinx-doc_sphinx:c73628dfcac844f89198ccd805e8e35609b37636", "patch": "[\"diff --git a/CHANGES b/CHANGES\\nindex 9ac823c..07bc815 100644\\n--- a/CHANGES\\n+++ b/CHANGES\\n@@ -26,6 +26,13 @@ Features added\\n   generated HTML, using the CRC32 algorithm.\\n * :meth:`~sphinx.application.Sphinx.require_sphinx` now allows the version\\n   requirement to be specified as ``(major, minor)``.\\n+* #11011: Allow configuring a line-length limit for object signatures, via\\n+  :confval:`maximum_signature_line_length` and the domain-specific variants.\\n+  If the length of the signature (in characters) is greater than the configured\\n+  limit, each parameter in the signature will be split to its own logical line.\\n+  This behaviour may also be controlled by options on object description\\n+  directives, for example :rst:dir:`py:function:single-line-parameter-list`.\\n+  Patch by Thomas Louf, Adam Turner, and Jean-Fran√ßois Burnol.\\n \\n Bugs fixed\\n ----------\\n\",\"diff --git a/doc/latex.rst b/doc/latex.rst\\nindex 5044034..a451ae6 100644\\n--- a/doc/latex.rst\\n+++ b/doc/latex.rst\\n@@ -1479,6 +1479,12 @@ Macros\\n   .. versionadded:: 6.2.0\\n      ``\\\\sphinxparam``, ``\\\\sphinxsamedocref``\\n \\n+  .. versionadded:: 7.1.0\\n+     ``\\\\sphinxparamcomma`` which defaults to a comma followed by a space and\\n+     ``\\\\sphinxparamcommaoneperline`` which is used for one-parameter-per-line\\n+     signatures (see :confval:`maximum_signature_line_length`).  It defaults\\n+     to ``\\\\texttt{,}`` to make these end-of-line separators more distinctive.\\n+\\n - More text styling:\\n \\n   .. csv-table::\\n\",\"diff --git a/doc/usage/configuration.rst b/doc/usage/configuration.rst\\nindex 23e9ba7..1fc4c67 100644\\n--- a/doc/usage/configuration.rst\\n+++ b/doc/usage/configuration.rst\\n@@ -675,6 +675,25 @@ General configuration\\n       If the value is a fully-qualified name of a custom Pygments style class,\\n       this is then used as custom style.\\n \\n+.. confval:: maximum_signature_line_length\\n+\\n+   If a signature's length in characters exceeds the number set, each\\n+   parameter within the signature will be displayed on an individual logical\\n+   line.\\n+\\n+   When ``None`` (the default), there is no maximum length and the entire\\n+   signature will be displayed on a single logical line.\\n+\\n+   A 'logical line' is similar to a hard line break---builders or themes may\\n+   choose to 'soft wrap' a single logical line, and this setting does not affect\\n+   that behaviour.\\n+\\n+   Domains may provide options to suppress any hard wrapping on an individual\\n+   object directive, such as seen in the C, C++, and Python domains (e.g.\\n+   :rst:dir:`py:function:single-line-parameter-list`).\\n+\\n+   .. versionadded:: 7.1\\n+\\n .. confval:: add_function_parentheses\\n \\n    A boolean that decides whether parentheses are appended to function and\\n@@ -2912,6 +2931,14 @@ Options for the C domain\\n \\n   .. versionadded:: 4.0.3\\n \\n+.. confval:: c_maximum_signature_line_length\\n+\\n+   If a signature's length in characters exceeds the number set, each\\n+   parameter will be displayed on an individual logical line. This is a\\n+   domain-specific setting, overriding :confval:`maximum_signature_line_length`.\\n+\\n+   .. versionadded:: 7.1\\n+\\n .. _cpp-config:\\n \\n Options for the C++ domain\\n@@ -2942,6 +2969,14 @@ Options for the C++ domain\\n \\n    .. versionadded:: 1.5\\n \\n+.. confval:: cpp_maximum_signature_line_length\\n+\\n+   If a signature's length in characters exceeds the number set, each\\n+   parameter will be displayed on an individual logical line. This is a\\n+   domain-specific setting, overriding :confval:`maximum_signature_line_length`.\\n+\\n+   .. versionadded:: 7.1\\n+\\n Options for the Python domain\\n -----------------------------\\n \\n@@ -2984,6 +3019,25 @@ Options for the Python domain\\n \\n    .. note:: This configuration is still in experimental\\n \\n+.. confval:: python_maximum_signature_line_length\\n+\\n+   If a signature's length in characters exceeds the number set, each\\n+   argument will be displayed on an individual logical line. This is a\\n+   domain-specific setting, overriding :confval:`maximum_signature_line_length`.\\n+\\n+   .. versionadded:: 7.1\\n+\\n+Options for the Javascript domain\\n+---------------------------------\\n+\\n+.. confval:: javascript_maximum_signature_line_length\\n+\\n+   If a signature's length in characters exceeds the number set, each\\n+   parameter will be displayed on an individual logical line. This is a\\n+   domain-specific setting, overriding :confval:`maximum_signature_line_length`.\\n+\\n+   .. versionadded:: 7.1\\n+\\n Example of configuration file\\n -----------------------------\\n \\n\",\"diff --git a/doc/usage/restructuredtext/domains.rst b/doc/usage/restructuredtext/domains.rst\\nindex ac99a28..cbece86 100644\\n--- a/doc/usage/restructuredtext/domains.rst\\n+++ b/doc/usage/restructuredtext/domains.rst\\n@@ -231,6 +231,16 @@ The following directives are provided for module and class contents:\\n       Describe the location where the object is defined.  The default value is\\n       the module specified by :rst:dir:`py:currentmodule`.\\n \\n+   .. rst:directive:option:: single-line-parameter-list\\n+      :type: no value\\n+\\n+      Ensures that the function's arguments will be emitted on a single logical\\n+      line, overriding :confval:`python_maximum_signature_line_length` and\\n+      :confval:`maximum_signature_line_length`.\\n+\\n+      .. versionadded:: 7.1\\n+\\n+\\n .. rst:directive:: .. py:data:: name\\n \\n    Describes global data in a module, including both variables and values used\\n@@ -329,6 +339,15 @@ The following directives are provided for module and class contents:\\n       Describe the location where the object is defined.  The default value is\\n       the module specified by :rst:dir:`py:currentmodule`.\\n \\n+   .. rst:directive:option:: single-line-parameter-list\\n+      :type: no value\\n+\\n+      Ensures that the class constructor's arguments will be emitted on a single\\n+      logical line, overriding :confval:`python_maximum_signature_line_length`\\n+      and :confval:`maximum_signature_line_length`.\\n+\\n+      .. versionadded:: 7.1\\n+\\n .. rst:directive:: .. py:attribute:: name\\n \\n    Describes an object data attribute.  The description should include\\n@@ -441,6 +460,15 @@ The following directives are provided for module and class contents:\\n       Describe the location where the object is defined.  The default value is\\n       the module specified by :rst:dir:`py:currentmodule`.\\n \\n+   .. rst:directive:option:: single-line-parameter-list\\n+      :type: no value\\n+\\n+      Ensures that the method's arguments will be emitted on a single logical\\n+      line, overriding :confval:`python_maximum_signature_line_length` and\\n+      :confval:`maximum_signature_line_length`.\\n+\\n+      .. versionadded:: 7.1\\n+\\n    .. rst:directive:option:: staticmethod\\n       :type: no value\\n \\n@@ -494,6 +522,15 @@ The following directives are provided for module and class contents:\\n    There is no ``py:deco`` role to link to a decorator that is marked up with\\n    this directive; rather, use the :rst:role:`py:func` role.\\n \\n+   .. rst:directive:option:: single-line-parameter-list\\n+      :type: no value\\n+\\n+      Ensures that the decorator's arguments will be emitted on a single logical\\n+      line, overriding :confval:`python_maximum_signature_line_length` and\\n+      :confval:`maximum_signature_line_length`.\\n+\\n+      .. versionadded:: 7.1\\n+\\n .. rst:directive:: .. py:decoratormethod:: name\\n                    .. py:decoratormethod:: name(signature)\\n \\n@@ -763,6 +800,15 @@ The C domain (name **c**) is suited for documentation of C API.\\n       :retval NULL: under some conditions.\\n       :retval NULL: under some other conditions as well.\\n \\n+   .. rst:directive:option:: single-line-parameter-list\\n+      :type: no value\\n+\\n+      Ensures that the function's parameters will be emitted on a single logical\\n+      line, overriding :confval:`c_maximum_signature_line_length` and\\n+      :confval:`maximum_signature_line_length`.\\n+\\n+      .. versionadded:: 7.1\\n+\\n \\n .. rst:directive:: .. c:macro:: name\\n                    .. c:macro:: name(arg list)\\n@@ -776,6 +822,15 @@ The C domain (name **c**) is suited for documentation of C API.\\n    .. versionadded:: 3.0\\n       The function style variant.\\n \\n+   .. rst:directive:option:: single-line-parameter-list\\n+      :type: no value\\n+\\n+      Ensures that the macro's parameters will be emitted on a single logical\\n+      line, overriding :confval:`c_maximum_signature_line_length` and\\n+      :confval:`maximum_signature_line_length`.\\n+\\n+      .. versionadded:: 7.1\\n+\\n .. rst:directive:: .. c:struct:: name\\n \\n    Describes a C struct.\\n@@ -1126,6 +1181,15 @@ visibility statement (``public``, ``private`` or ``protected``).\\n       .. cpp:function:: template<> \\\\\\n                         void print(int i)\\n \\n+   .. rst:directive:option:: single-line-parameter-list\\n+      :type: no value\\n+\\n+      Ensures that the function's parameters will be emitted on a single logical\\n+      line, overriding :confval:`cpp_maximum_signature_line_length` and\\n+      :confval:`maximum_signature_line_length`.\\n+\\n+      .. versionadded:: 7.1\\n+\\n .. rst:directive:: .. cpp:member:: (member) variable declaration\\n                    .. cpp:var:: (member) variable declaration\\n \\n@@ -1908,6 +1972,15 @@ The JavaScript domain (name **js**) provides the following directives:\\n       :throws SomeError: For whatever reason in that case.\\n       :returns: Something.\\n \\n+   .. rst:directive:option:: single-line-parameter-list\\n+      :type: no value\\n+\\n+      Ensures that the function's parameters will be emitted on a single logical\\n+      line, overriding :confval:`javascript_maximum_signature_line_length` and\\n+      :confval:`maximum_signature_line_length`.\\n+\\n+      .. versionadded:: 7.1\\n+\\n .. rst:directive:: .. js:method:: name(signature)\\n \\n    This directive is an alias for :rst:dir:`js:function`, however it describes\\n@@ -1915,6 +1988,15 @@ The JavaScript domain (name **js**) provides the following directives:\\n \\n    .. versionadded:: 1.6\\n \\n+   .. rst:directive:option:: single-line-parameter-list\\n+      :type: no value\\n+\\n+      Ensures that the function's parameters will be emitted on a single logical\\n+      line, overriding :confval:`javascript_maximum_signature_line_length` and\\n+      :confval:`maximum_signature_line_length`.\\n+\\n+      .. versionadded:: 7.1\\n+\\n .. rst:directive:: .. js:class:: name\\n \\n    Describes a constructor that creates an object.  This is basically like a\\n@@ -1933,6 +2015,15 @@ The JavaScript domain (name **js**) provides the following directives:\\n       :param string name: The name of the animal\\n       :param number age: an optional age for the animal\\n \\n+   .. rst:directive:option:: single-line-parameter-list\\n+      :type: no value\\n+\\n+      Ensures that the function's parameters will be emitted on a single logical\\n+      line, overriding :confval:`javascript_maximum_signature_line_length` and\\n+      :confval:`maximum_signature_line_length`.\\n+\\n+      .. versionadded:: 7.1\\n+\\n .. rst:directive:: .. js:data:: name\\n \\n    Describes a global variable or constant.\\n\",\"diff --git a/sphinx/addnodes.py b/sphinx/addnodes.py\\nindex 44655d9..e92d32a 100644\\n--- a/sphinx/addnodes.py\\n+++ b/sphinx/addnodes.py\\n@@ -246,7 +246,12 @@ def astext(self) -> str:\\n \\n \\n class desc_parameterlist(nodes.Part, nodes.Inline, nodes.FixedTextElement):\\n-    \\\"\\\"\\\"Node for a general parameter list.\\\"\\\"\\\"\\n+    \\\"\\\"\\\"Node for a general parameter list.\\n+\\n+    As default the parameter list is written in line with the rest of the signature.\\n+    Set ``multi_line_parameter_list = True`` to describe a multi-line parameter list.\\n+    In that case each parameter will then be written on its own, indented line.\\n+    \\\"\\\"\\\"\\n     child_text_separator = ', '\\n \\n     def astext(self):\\n\",\"diff --git a/sphinx/config.py b/sphinx/config.py\\nindex ad7c3b5..a4e6619 100644\\n--- a/sphinx/config.py\\n+++ b/sphinx/config.py\\n@@ -137,7 +137,7 @@ class Config:\\n         'numfig': (False, 'env', []),\\n         'numfig_secnum_depth': (1, 'env', []),\\n         'numfig_format': ({}, 'env', []),  # will be initialized in init_numfig_format()\\n-\\n+        'maximum_signature_line_length': (None, 'env', {int, None}),\\n         'math_number_all': (False, 'env', []),\\n         'math_eqref_format': (None, 'env', [str]),\\n         'math_numfig': (True, 'env', []),\\n\",\"diff --git a/sphinx/domains/javascript.py b/sphinx/domains/javascript.py\\nindex 093e291..c6baab8 100644\\n--- a/sphinx/domains/javascript.py\\n+++ b/sphinx/domains/javascript.py\\n@@ -43,6 +43,7 @@ class JSObject(ObjectDescription[Tuple[str, str]]):\\n         'noindex': directives.flag,\\n         'noindexentry': directives.flag,\\n         'nocontentsentry': directives.flag,\\n+        'single-line-parameter-list': directives.flag,\\n     }\\n \\n     def get_display_prefix(self) -> list[Node]:\\n@@ -88,6 +89,14 @@ def handle_signature(self, sig: str, signode: desc_signature) -> tuple[str, str]\\n         signode['object'] = prefix\\n         signode['fullname'] = fullname\\n \\n+        max_len = (self.env.config.javascript_maximum_signature_line_length\\n+                   or self.env.config.maximum_signature_line_length\\n+                   or 0)\\n+        multi_line_parameter_list = (\\n+            'single-line-parameter-list' not in self.options\\n+            and (len(sig) > max_len > 0)\\n+        )\\n+\\n         display_prefix = self.get_display_prefix()\\n         if display_prefix:\\n             signode += addnodes.desc_annotation('', '', *display_prefix)\\n@@ -108,7 +117,7 @@ def handle_signature(self, sig: str, signode: desc_signature) -> tuple[str, str]\\n             if not arglist:\\n                 signode += addnodes.desc_parameterlist()\\n             else:\\n-                _pseudo_parse_arglist(signode, arglist)\\n+                _pseudo_parse_arglist(signode, arglist, multi_line_parameter_list)\\n         return fullname, prefix\\n \\n     def _object_hierarchy_parts(self, sig_node: desc_signature) -> tuple[str, ...]:\\n@@ -473,10 +482,12 @@ def get_full_qualified_name(self, node: Element) -> str | None:\\n \\n def setup(app: Sphinx) -> dict[str, Any]:\\n     app.add_domain(JavaScriptDomain)\\n-\\n+    app.add_config_value(\\n+        'javascript_maximum_signature_line_length', None, 'env', types={int, None},\\n+    )\\n     return {\\n         'version': 'builtin',\\n-        'env_version': 2,\\n+        'env_version': 3,\\n         'parallel_read_safe': True,\\n         'parallel_write_safe': True,\\n     }\\n\",\"diff --git a/sphinx/domains/python.py b/sphinx/domains/python.py\\nindex eef78aa..3fda527 100644\\n--- a/sphinx/domains/python.py\\n+++ b/sphinx/domains/python.py\\n@@ -258,10 +258,11 @@ def _unparse_pep_604_annotation(node: ast.Subscript) -> list[Node]:\\n \\n \\n def _parse_arglist(\\n-    arglist: str, env: BuildEnvironment | None = None,\\n+    arglist: str, env: BuildEnvironment | None = None, multi_line_parameter_list: bool = False,\\n ) -> addnodes.desc_parameterlist:\\n     \\\"\\\"\\\"Parse a list of arguments using AST parser\\\"\\\"\\\"\\n     params = addnodes.desc_parameterlist(arglist)\\n+    params['multi_line_parameter_list'] = multi_line_parameter_list\\n     sig = signature_from_str('(%s)' % arglist)\\n     last_kind = None\\n     for param in sig.parameters.values():\\n@@ -309,7 +310,9 @@ def _parse_arglist(\\n     return params\\n \\n \\n-def _pseudo_parse_arglist(signode: desc_signature, arglist: str) -> None:\\n+def _pseudo_parse_arglist(\\n+    signode: desc_signature, arglist: str, multi_line_parameter_list: bool = False,\\n+) -> None:\\n     \\\"\\\"\\\"\\\"Parse\\\" a list of arguments separated by commas.\\n \\n     Arguments can have \\\"optional\\\" annotations given by enclosing them in\\n@@ -317,6 +320,7 @@ def _pseudo_parse_arglist(signode: desc_signature, arglist: str) -> None:\\n     string literal (e.g. default argument value).\\n     \\\"\\\"\\\"\\n     paramlist = addnodes.desc_parameterlist()\\n+    paramlist['multi_line_parameter_list'] = multi_line_parameter_list\\n     stack: list[Element] = [paramlist]\\n     try:\\n         for argument in arglist.split(','):\\n@@ -459,6 +463,7 @@ class PyObject(ObjectDescription[Tuple[str, str]]):\\n         'noindex': directives.flag,\\n         'noindexentry': directives.flag,\\n         'nocontentsentry': directives.flag,\\n+        'single-line-parameter-list': directives.flag,\\n         'module': directives.unchanged,\\n         'canonical': directives.unchanged,\\n         'annotation': directives.unchanged,\\n@@ -541,6 +546,14 @@ def handle_signature(self, sig: str, signode: desc_signature) -> tuple[str, str]\\n         signode['class'] = classname\\n         signode['fullname'] = fullname\\n \\n+        max_len = (self.env.config.python_maximum_signature_line_length\\n+                   or self.env.config.maximum_signature_line_length\\n+                   or 0)\\n+        multi_line_parameter_list = (\\n+            'single-line-parameter-list' not in self.options\\n+            and (len(sig) > max_len > 0)\\n+        )\\n+\\n         sig_prefix = self.get_signature_prefix(sig)\\n         if sig_prefix:\\n             if type(sig_prefix) is str:\\n@@ -559,15 +572,15 @@ def handle_signature(self, sig: str, signode: desc_signature) -> tuple[str, str]\\n         signode += addnodes.desc_name(name, name)\\n         if arglist:\\n             try:\\n-                signode += _parse_arglist(arglist, self.env)\\n+                signode += _parse_arglist(arglist, self.env, multi_line_parameter_list)\\n             except SyntaxError:\\n                 # fallback to parse arglist original parser.\\n                 # it supports to represent optional arguments (ex. \\\"func(foo [, bar])\\\")\\n-                _pseudo_parse_arglist(signode, arglist)\\n+                _pseudo_parse_arglist(signode, arglist, multi_line_parameter_list)\\n             except NotImplementedError as exc:\\n                 logger.warning(\\\"could not parse arglist (%r): %s\\\", arglist, exc,\\n                                location=signode)\\n-                _pseudo_parse_arglist(signode, arglist)\\n+                _pseudo_parse_arglist(signode, arglist, multi_line_parameter_list)\\n         else:\\n             if self.needs_arglist():\\n                 # for callables, add an empty parameter list\\n@@ -1505,13 +1518,15 @@ def setup(app: Sphinx) -> dict[str, Any]:\\n \\n     app.add_domain(PythonDomain)\\n     app.add_config_value('python_use_unqualified_type_names', False, 'env')\\n+    app.add_config_value('python_maximum_signature_line_length', None, 'env',\\n+                         types={int, None})\\n     app.add_config_value('python_display_short_literal_types', False, 'env')\\n     app.connect('object-description-transform', filter_meta_fields)\\n     app.connect('missing-reference', builtin_resolver, priority=900)\\n \\n     return {\\n         'version': 'builtin',\\n-        'env_version': 3,\\n+        'env_version': 4,\\n         'parallel_read_safe': True,\\n         'parallel_write_safe': True,\\n     }\\n\",\"diff --git a/sphinx/texinputs/sphinxlatexobjects.sty b/sphinx/texinputs/sphinxlatexobjects.sty\\nindex b4ff1f9..a2038a9 100644\\n--- a/sphinx/texinputs/sphinxlatexobjects.sty\\n+++ b/sphinx/texinputs/sphinxlatexobjects.sty\\n@@ -146,6 +146,27 @@\\n   \\\\item[{#1\\\\sphinxcode{(}\\\\py@sigparams{#2}{#3}\\\\strut}]\\n   \\\\pysigadjustitemsep\\n }\\n+\\n+\\\\def\\\\sphinxoptionalextraspace{0.5mm}\\n+\\\\newcommand{\\\\pysigwithonelineperarg}[3]{%\\n+  % render each argument on its own line\\n+  \\\\item[#1\\\\sphinxcode{(}\\\\strut]\\n+  \\\\leavevmode\\\\par\\\\nopagebreak\\n+  % this relies on \\\\pysigstartsignatures having set \\\\parskip to zero\\n+  \\\\begingroup\\n+     \\\\let\\\\sphinxparamcomma\\\\sphinxparamcommaoneperline\\n+     \\\\def\\\\sphinxoptionalhook{\\\\ifvmode\\\\else\\\\kern\\\\sphinxoptionalextraspace\\\\relax\\\\fi}%\\n+     % The very first \\\\sphinxparam should not emit a \\\\par hence a complication\\n+     % with a group and global definition here as it may occur in a \\\\sphinxoptional\\n+     \\\\global\\\\let\\\\spx@sphinxparam\\\\sphinxparam\\n+     \\\\gdef\\\\sphinxparam{\\\\gdef\\\\sphinxparam{\\\\par\\\\spx@sphinxparam}\\\\spx@sphinxparam}%\\n+  #2\\\\par\\n+  \\\\endgroup\\n+  \\\\global\\\\let\\\\sphinxparam\\\\spx@sphinxparam\\n+  % fulllineitems sets \\\\labelwidth to be like \\\\leftmargin\\n+  \\\\nopagebreak\\\\noindent\\\\kern-\\\\labelwidth\\\\sphinxcode{)}{#3}\\n+  \\\\pysigadjustitemsep\\n+}\\n \\\\newcommand{\\\\pysigadjustitemsep}{%\\n   % adjust \\\\itemsep to control the separation with the next signature\\n   % sharing common description\\n\",\"diff --git a/sphinx/texinputs/sphinxlatexstyletext.sty b/sphinx/texinputs/sphinxlatexstyletext.sty\\nindex 913bc82..292facc 100644\\n--- a/sphinx/texinputs/sphinxlatexstyletext.sty\\n+++ b/sphinx/texinputs/sphinxlatexstyletext.sty\\n@@ -58,7 +58,8 @@\\n \\\\protected\\\\def\\\\sphinxparam#1{\\\\emph{#1}}\\n % \\\\optional is used for ``[, arg]``, i.e. desc_optional nodes.\\n \\\\long\\\\protected\\\\def\\\\sphinxoptional#1{%\\n-  {\\\\textnormal{\\\\Large[}}{#1}\\\\hspace{0.5mm}{\\\\textnormal{\\\\Large]}}}\\n+  {\\\\sphinxoptionalhook\\\\textnormal{\\\\Large[}}{#1}\\\\hspace{0.5mm}{\\\\textnormal{\\\\Large]}}}\\n+\\\\let\\\\sphinxoptionalhook\\\\empty\\n \\n % additional customizable styling\\n \\\\def\\\\sphinxstyleindexentry   #1{\\\\texttt{#1}}\\n@@ -112,6 +113,11 @@\\n \\n % Special characters\\n %\\n+\\\\def\\\\sphinxparamcomma{, }% by default separate parameters with comma + space\\n+% If the signature is rendered with one line per param, this wil be used\\n+% instead (this \\\\texttt makes the comma slightly more distinctive).\\n+\\\\def\\\\sphinxparamcommaoneperline{\\\\texttt{,}}\\n+%\\n % The \\\\kern\\\\z@ is to prevent en-dash and em-dash TeX ligatures.\\n % A linebreak can occur after the dash in regular text (this is\\n % normal behaviour of \\\"-\\\" in TeX, it is not related to \\\\kern\\\\z@).\\n\",\"diff --git a/sphinx/themes/basic/static/basic.css_t b/sphinx/themes/basic/static/basic.css_t\\nindex 9d5e441..9ae1802 100644\\n--- a/sphinx/themes/basic/static/basic.css_t\\n+++ b/sphinx/themes/basic/static/basic.css_t\\n@@ -670,6 +670,16 @@ dd {\\n     margin-left: 30px;\\n }\\n \\n+.sig dd {\\n+    margin-top: 0px;\\n+    margin-bottom: 0px;\\n+}\\n+\\n+.sig dl {\\n+    margin-top: 0px;\\n+    margin-bottom: 0px;\\n+}\\n+\\n dl > dd:last-child,\\n dl > dd:last-child > :last-child {\\n     margin-bottom: 0;\\n\",\"diff --git a/sphinx/themes/epub/static/epub.css_t b/sphinx/themes/epub/static/epub.css_t\\nindex 767d558..15938cd 100644\\n--- a/sphinx/themes/epub/static/epub.css_t\\n+++ b/sphinx/themes/epub/static/epub.css_t\\n@@ -458,6 +458,11 @@ dl {\\n     margin-bottom: 15px;\\n }\\n \\n+.sig dl {\\n+    margin-top: 0px;\\n+    margin-bottom: 0px;\\n+}\\n+\\n dd p {\\n     margin-top: 0px;\\n }\\n@@ -472,6 +477,11 @@ dd {\\n     margin-left: 30px;\\n }\\n \\n+.sig dd {\\n+    margin-top: 0px;\\n+    margin-bottom: 0px;\\n+}\\n+\\n dt:target, .highlighted {\\n     background-color: #ddd;\\n }\\n\",\"diff --git a/sphinx/writers/html5.py b/sphinx/writers/html5.py\\nindex ab26bab..e7d9322 100644\\n--- a/sphinx/writers/html5.py\\n+++ b/sphinx/writers/html5.py\\n@@ -150,14 +150,26 @@ def depart_desc_returns(self, node: Element) -> None:\\n \\n     def visit_desc_parameterlist(self, node: Element) -> None:\\n         self.body.append('<span class=\\\"sig-paren\\\">(</span>')\\n-        self.first_param = 1\\n+        self.is_first_param = True\\n         self.optional_param_level = 0\\n+        self.params_left_at_level = 0\\n+        self.param_group_index = 0\\n+        # Counts as what we call a parameter group either a required parameter, or a\\n+        # set of contiguous optional ones.\\n+        self.list_is_required_param = [isinstance(c, addnodes.desc_parameter)\\n+                                       for c in node.children]\\n         # How many required parameters are left.\\n-        self.required_params_left = sum([isinstance(c, addnodes.desc_parameter)\\n-                                         for c in node.children])\\n+        self.required_params_left = sum(self.list_is_required_param)\\n         self.param_separator = node.child_text_separator\\n+        self.multi_line_parameter_list = node.get('multi_line_parameter_list', False)\\n+        if self.multi_line_parameter_list:\\n+            self.body.append('\\\\n\\\\n')\\n+            self.body.append(self.starttag(node, 'dl'))\\n+            self.param_separator = self.param_separator.rstrip()\\n \\n     def depart_desc_parameterlist(self, node: Element) -> None:\\n+        if node.get('multi_line_parameter_list'):\\n+            self.body.append('</dl>\\\\n\\\\n')\\n         self.body.append('<span class=\\\"sig-paren\\\">)</span>')\\n \\n     # If required parameters are still to come, then put the comma after\\n@@ -167,28 +179,82 @@ def depart_desc_parameterlist(self, node: Element) -> None:\\n     #     foo([a, ]b, c[, d])\\n     #\\n     def visit_desc_parameter(self, node: Element) -> None:\\n-        if self.first_param:\\n-            self.first_param = 0\\n-        elif not self.required_params_left:\\n+        on_separate_line = self.multi_line_parameter_list\\n+        if on_separate_line and not (self.is_first_param and self.optional_param_level > 0):\\n+            self.body.append(self.starttag(node, 'dd', ''))\\n+        if self.is_first_param:\\n+            self.is_first_param = False\\n+        elif not on_separate_line and not self.required_params_left:\\n             self.body.append(self.param_separator)\\n         if self.optional_param_level == 0:\\n             self.required_params_left -= 1\\n+        else:\\n+            self.params_left_at_level -= 1\\n         if not node.hasattr('noemph'):\\n             self.body.append('<em class=\\\"sig-param\\\">')\\n \\n     def depart_desc_parameter(self, node: Element) -> None:\\n         if not node.hasattr('noemph'):\\n             self.body.append('</em>')\\n-        if self.required_params_left:\\n+        is_required = self.list_is_required_param[self.param_group_index]\\n+        if self.multi_line_parameter_list:\\n+            is_last_group = self.param_group_index + 1 == len(self.list_is_required_param)\\n+            next_is_required = (\\n+                not is_last_group\\n+                and self.list_is_required_param[self.param_group_index + 1]\\n+            )\\n+            opt_param_left_at_level = self.params_left_at_level > 0\\n+            if opt_param_left_at_level or is_required and (is_last_group or next_is_required):\\n+                self.body.append(self.param_separator)\\n+                self.body.append('</dd>\\\\n')\\n+\\n+        elif self.required_params_left:\\n             self.body.append(self.param_separator)\\n \\n+        if is_required:\\n+            self.param_group_index += 1\\n+\\n     def visit_desc_optional(self, node: Element) -> None:\\n+        self.params_left_at_level = sum([isinstance(c, addnodes.desc_parameter)\\n+                                         for c in node.children])\\n         self.optional_param_level += 1\\n-        self.body.append('<span class=\\\"optional\\\">[</span>')\\n+        self.max_optional_param_level = self.optional_param_level\\n+        if self.multi_line_parameter_list:\\n+            # If the first parameter is optional, start a new line and open the bracket.\\n+            if self.is_first_param:\\n+                self.body.append(self.starttag(node, 'dd', ''))\\n+                self.body.append('<span class=\\\"optional\\\">[</span>')\\n+            # Else, if there remains at least one required parameter, append the\\n+            # parameter separator, open a new bracket, and end the line.\\n+            elif self.required_params_left:\\n+                self.body.append(self.param_separator)\\n+                self.body.append('<span class=\\\"optional\\\">[</span>')\\n+                self.body.append('</dd>\\\\n')\\n+            # Else, open a new bracket, append the parameter separator,\\n+            # and end the line.\\n+            else:\\n+                self.body.append('<span class=\\\"optional\\\">[</span>')\\n+                self.body.append(self.param_separator)\\n+                self.body.append('</dd>\\\\n')\\n+        else:\\n+            self.body.append('<span class=\\\"optional\\\">[</span>')\\n \\n     def depart_desc_optional(self, node: Element) -> None:\\n         self.optional_param_level -= 1\\n-        self.body.append('<span class=\\\"optional\\\">]</span>')\\n+        if self.multi_line_parameter_list:\\n+            # If it's the first time we go down one level, add the separator\\n+            # before the bracket.\\n+            if self.optional_param_level == self.max_optional_param_level - 1:\\n+                self.body.append(self.param_separator)\\n+            self.body.append('<span class=\\\"optional\\\">]</span>')\\n+            # End the line if we have just closed the last bracket of this\\n+            # optional parameter group.\\n+            if self.optional_param_level == 0:\\n+                self.body.append('</dd>\\\\n')\\n+        else:\\n+            self.body.append('<span class=\\\"optional\\\">]</span>')\\n+        if self.optional_param_level == 0:\\n+            self.param_group_index += 1\\n \\n     def visit_desc_annotation(self, node: Element) -> None:\\n         self.body.append(self.starttag(node, 'em', '', CLASS='property'))\\n\",\"diff --git a/sphinx/writers/latex.py b/sphinx/writers/latex.py\\nindex e7d31b7..37c73ae 100644\\n--- a/sphinx/writers/latex.py\\n+++ b/sphinx/writers/latex.py\\n@@ -702,7 +702,10 @@ def depart_desc(self, node: Element) -> None:\\n     def _visit_signature_line(self, node: Element) -> None:\\n         for child in node:\\n             if isinstance(child, addnodes.desc_parameterlist):\\n-                self.body.append(CR + r'\\\\pysiglinewithargsret{')\\n+                if child.get('multi_line_parameter_list'):\\n+                    self.body.append(CR + r'\\\\pysigwithonelineperarg{')\\n+                else:\\n+                    self.body.append(CR + r'\\\\pysiglinewithargsret{')\\n                 break\\n         else:\\n             self.body.append(CR + r'\\\\pysigline{')\\n@@ -784,29 +787,82 @@ def depart_desc_returns(self, node: Element) -> None:\\n     def visit_desc_parameterlist(self, node: Element) -> None:\\n         # close name, open parameterlist\\n         self.body.append('}{')\\n-        self.first_param = 1\\n+        self.is_first_param = True\\n+        self.optional_param_level = 0\\n+        self.params_left_at_level = 0\\n+        self.param_group_index = 0\\n+        # Counts as what we call a parameter group either a required parameter, or a\\n+        # set of contiguous optional ones.\\n+        self.list_is_required_param = [isinstance(c, addnodes.desc_parameter)\\n+                                       for c in node.children]\\n+        # How many required parameters are left.\\n+        self.required_params_left = sum(self.list_is_required_param)\\n+        self.param_separator = r'\\\\sphinxparamcomma '\\n+        self.multi_line_parameter_list = node.get('multi_line_parameter_list', False)\\n \\n     def depart_desc_parameterlist(self, node: Element) -> None:\\n         # close parameterlist, open return annotation\\n         self.body.append('}{')\\n \\n     def visit_desc_parameter(self, node: Element) -> None:\\n-        if not self.first_param:\\n-            self.body.append(', ')\\n+        if self.is_first_param:\\n+            self.is_first_param = False\\n+        elif not self.multi_line_parameter_list and not self.required_params_left:\\n+            self.body.append(self.param_separator)\\n+        if self.optional_param_level == 0:\\n+            self.required_params_left -= 1\\n         else:\\n-            self.first_param = 0\\n+            self.params_left_at_level -= 1\\n         if not node.hasattr('noemph'):\\n             self.body.append(r'\\\\sphinxparam{')\\n \\n     def depart_desc_parameter(self, node: Element) -> None:\\n         if not node.hasattr('noemph'):\\n             self.body.append('}')\\n+        is_required = self.list_is_required_param[self.param_group_index]\\n+        if self.multi_line_parameter_list:\\n+            is_last_group = self.param_group_index + 1 == len(self.list_is_required_param)\\n+            next_is_required = (\\n+                not is_last_group\\n+                and self.list_is_required_param[self.param_group_index + 1]\\n+            )\\n+            opt_param_left_at_level = self.params_left_at_level > 0\\n+            if opt_param_left_at_level or is_required and (is_last_group or next_is_required):\\n+                self.body.append(self.param_separator)\\n+\\n+        elif self.required_params_left:\\n+            self.body.append(self.param_separator)\\n+\\n+        if is_required:\\n+            self.param_group_index += 1\\n \\n     def visit_desc_optional(self, node: Element) -> None:\\n-        self.body.append(r'\\\\sphinxoptional{')\\n+        self.params_left_at_level = sum([isinstance(c, addnodes.desc_parameter)\\n+                                         for c in node.children])\\n+        self.optional_param_level += 1\\n+        self.max_optional_param_level = self.optional_param_level\\n+        if self.multi_line_parameter_list:\\n+            if self.is_first_param:\\n+                self.body.append(r'\\\\sphinxoptional{')\\n+            elif self.required_params_left:\\n+                self.body.append(self.param_separator)\\n+                self.body.append(r'\\\\sphinxoptional{')\\n+            else:\\n+                self.body.append(r'\\\\sphinxoptional{')\\n+                self.body.append(self.param_separator)\\n+        else:\\n+            self.body.append(r'\\\\sphinxoptional{')\\n \\n     def depart_desc_optional(self, node: Element) -> None:\\n+        self.optional_param_level -= 1\\n+        if self.multi_line_parameter_list:\\n+            # If it's the first time we go down one level, add the separator before the\\n+            # bracket.\\n+            if self.optional_param_level == self.max_optional_param_level - 1:\\n+                self.body.append(self.param_separator)\\n         self.body.append('}')\\n+        if self.optional_param_level == 0:\\n+            self.param_group_index += 1\\n \\n     def visit_desc_annotation(self, node: Element) -> None:\\n         self.body.append(r'\\\\sphinxbfcode{\\\\sphinxupquote{')\\n\",\"diff --git a/sphinx/writers/text.py b/sphinx/writers/text.py\\nindex 3bce03a..8e3d9df 100644\\n--- a/sphinx/writers/text.py\\n+++ b/sphinx/writers/text.py\\n@@ -594,24 +594,99 @@ def depart_desc_returns(self, node: Element) -> None:\\n \\n     def visit_desc_parameterlist(self, node: Element) -> None:\\n         self.add_text('(')\\n-        self.first_param = 1\\n+        self.is_first_param = True\\n+        self.optional_param_level = 0\\n+        self.params_left_at_level = 0\\n+        self.param_group_index = 0\\n+        # Counts as what we call a parameter group are either a required parameter, or a\\n+        # set of contiguous optional ones.\\n+        self.list_is_required_param = [isinstance(c, addnodes.desc_parameter)\\n+                                       for c in node.children]\\n+        self.required_params_left = sum(self.list_is_required_param)\\n+        self.param_separator = ', '\\n+        self.multi_line_parameter_list = node.get('multi_line_parameter_list', False)\\n+        if self.multi_line_parameter_list:\\n+            self.param_separator = self.param_separator.rstrip()\\n \\n     def depart_desc_parameterlist(self, node: Element) -> None:\\n         self.add_text(')')\\n \\n     def visit_desc_parameter(self, node: Element) -> None:\\n-        if not self.first_param:\\n-            self.add_text(', ')\\n+        on_separate_line = self.multi_line_parameter_list\\n+        if on_separate_line and not (self.is_first_param and self.optional_param_level > 0):\\n+            self.new_state()\\n+        if self.is_first_param:\\n+            self.is_first_param = False\\n+        elif not on_separate_line and not self.required_params_left:\\n+            self.add_text(self.param_separator)\\n+        if self.optional_param_level == 0:\\n+            self.required_params_left -= 1\\n         else:\\n-            self.first_param = 0\\n+            self.params_left_at_level -= 1\\n+\\n         self.add_text(node.astext())\\n+\\n+        is_required = self.list_is_required_param[self.param_group_index]\\n+        if on_separate_line:\\n+            is_last_group = self.param_group_index + 1 == len(self.list_is_required_param)\\n+            next_is_required = (\\n+                not is_last_group\\n+                and self.list_is_required_param[self.param_group_index + 1]\\n+            )\\n+            opt_param_left_at_level = self.params_left_at_level > 0\\n+            if opt_param_left_at_level or is_required and (is_last_group or next_is_required):\\n+                self.add_text(self.param_separator)\\n+                self.end_state(wrap=False, end=None)\\n+\\n+        elif self.required_params_left:\\n+            self.add_text(self.param_separator)\\n+\\n+        if is_required:\\n+            self.param_group_index += 1\\n         raise nodes.SkipNode\\n \\n     def visit_desc_optional(self, node: Element) -> None:\\n-        self.add_text('[')\\n+        self.params_left_at_level = sum([isinstance(c, addnodes.desc_parameter)\\n+                                         for c in node.children])\\n+        self.optional_param_level += 1\\n+        self.max_optional_param_level = self.optional_param_level\\n+        if self.multi_line_parameter_list:\\n+            # If the first parameter is optional, start a new line and open the bracket.\\n+            if self.is_first_param:\\n+                self.new_state()\\n+                self.add_text('[')\\n+            # Else, if there remains at least one required parameter, append the\\n+            # parameter separator, open a new bracket, and end the line.\\n+            elif self.required_params_left:\\n+                self.add_text(self.param_separator)\\n+                self.add_text('[')\\n+                self.end_state(wrap=False, end=None)\\n+            # Else, open a new bracket, append the parameter separator, and end the\\n+            # line.\\n+            else:\\n+                self.add_text('[')\\n+                self.add_text(self.param_separator)\\n+                self.end_state(wrap=False, end=None)\\n+        else:\\n+            self.add_text('[')\\n \\n     def depart_desc_optional(self, node: Element) -> None:\\n-        self.add_text(']')\\n+        self.optional_param_level -= 1\\n+        if self.multi_line_parameter_list:\\n+            # If it's the first time we go down one level, add the separator before the\\n+            # bracket.\\n+            if self.optional_param_level == self.max_optional_param_level - 1:\\n+                self.add_text(self.param_separator)\\n+            self.add_text(']')\\n+            # End the line if we have just closed the last bracket of this group of\\n+            # optional parameters.\\n+            if self.optional_param_level == 0:\\n+                self.end_state(wrap=False, end=None)\\n+\\n+        else:\\n+            self.add_text(']')\\n+        if self.optional_param_level == 0:\\n+            self.param_group_index += 1\\n \\n     def visit_desc_annotation(self, node: Element) -> None:\\n         pass\\n\"]", "test_patch": "", "hints_text": ""}
