{"instance_id": "734775935656414", "repo": "alexhernandezgarcia/gflownet", "base_commit": "030f207be74b0eded7688b6a771c02ee48a2307f", "problem_statement": "The proxy should not be copied into each environment instance:\\nCurrently, the proxy is set as an attribute of the environments and the base environment implements the methods `proxy2reward()` and `reward2proxy()` that determine the conversion between proxy outputs and reward. The environment also implements the methods `reward()` and `reward_batch()`, which call the proxy and the conversion methods. This is probably not ideal for various reasons.\\r\\n\\r\\nI do not see any longer a good reason to keep the proxy and these methods within the environment. It seems possible and a good idea to completely detach the environment and the proxy. Some proxies need information from the environment, which is currently set via the call to `Env.setup_proxy()`, which calls the proxy's `setup()` method. But this could just be done elsewhere.\\r\\n\\r\\nNow, in terms of alternatives, I am not completely settled on what the best option would be. In particular, where should the methods that convert between proxy and reward go? \\r\\n- In the (base) proxy?\\r\\n- In the GFlowNet agent?", "FAIL_TO_PASS": ["tests/gflownet/proxy/test_scrabble_proxy.py::test__scrabble_scorer__returns_expected_scores_input_state2proxy[D", "tests/gflownet/utils/test_batch.py::test__mixed_sampling_multiple_envs_all_as_expected[grid2d-corners]", "tests/gflownet/utils/test_batch.py::test__get_logrewards_multiple_env_returns_expected_non_zero_non_terminating[grid2d-corners]", "tests/gflownet/utils/test_batch.py::test__get_rewards__single_env_returns_expected_non_terminating[grid2d-corners]", "tests/gflownet/utils/test_batch.py::test__get_logrewards_multiple_env_returns_expected_non_zero_non_terminating[tetris6x4-tetris_score_norm]", "tests/gflownet/proxy/test_scrabble_proxy.py::test__scrabble_scorer__returns_expected_scores_input_state2proxy[F", "tests/gflownet/utils/test_batch.py::test__get_logrewards__single_env_returns_expected_non_terminating[grid2d-corners]", "tests/gflownet/proxy/test_scrabble_proxy.py::test__scrabble_scorer__returns_expected_scores_input_list_strings[samples0-scores_expected0]", "tests/gflownet/utils/test_batch.py::test__mixed_sampling_merged_all_as_expected[tetris6x4-tetris_score]", "tests/gflownet/utils/test_batch.py::test__get_rewards_parents_multiple_env_returns_expected_non_terminating[grid2d-corners]", "tests/gflownet/utils/test_batch.py::test__get_logrewards__single_env_returns_expected[tetris6x4-tetris_score]", "tests/gflownet/proxy/test_scrabble_proxy.py::test__scrabble_scorer__returns_expected_scores_input_state2proxy[B", "tests/gflownet/utils/test_batch.py::test__forward_sampling_multiple_envs_all_as_expected[tetris6x4-tetris_score]", "tests/gflownet/utils/test_batch.py::test__get_logrewards__single_env_returns_expected[ctorus2d5l-corners]", "tests/gflownet/utils/test_batch.py::test__get_rewards__single_env_returns_expected[tetris6x4-tetris_score]", "tests/gflownet/utils/test_batch.py::test__get_logrewards__single_env_returns_expected_non_terminating[tetris6x4-tetris_score]", "tests/gflownet/utils/test_batch.py::test__get_logrewards_parents_multiple_env_returns_expected_non_terminating[tetris6x4-tetris_score_norm]", "tests/gflownet/utils/test_batch.py::test__forward_sampling_multiple_envs_all_as_expected[ctorus2d5l-corners]", "tests/gflownet/utils/test_batch.py::test__backward_sampling_multiple_envs_all_as_expected[grid2d-corners]", "tests/gflownet/utils/test_batch.py::test__forward_sampling_multiple_envs_all_as_expected[grid2d-corners]", "tests/gflownet/utils/test_batch.py::test__get_logrewards__single_env_returns_expected_non_terminating[ctorus2d5l-corners]", "tests/gflownet/utils/test_batch.py::test__get_rewards_multiple_env_returns_expected_non_zero_non_terminating[grid2d-corners]", "tests/gflownet/utils/test_batch.py::test__get_rewards_multiple_env_returns_expected_non_zero_non_terminating[tetris6x4-tetris_score_norm]", "tests/gflownet/utils/test_batch.py::test__backward_sampling_multiple_envs_all_as_expected[tetris6x4-tetris_score]", "tests/gflownet/utils/test_batch.py::test__get_logrewards_parents_multiple_env_returns_expected_non_terminating[ctorus2d5l-corners]", "tests/gflownet/utils/test_batch.py::test__mixed_sampling_merged_all_as_expected[grid2d-corners]", "tests/gflownet/utils/test_batch.py::test__get_logrewards_parents_multiple_env_returns_expected_non_terminating[grid2d-corners]", "tests/gflownet/utils/test_batch.py::test__get_rewards__single_env_returns_expected_non_terminating[ctorus2d5l-corners]", "tests/gflownet/proxy/test_scrabble_proxy.py::test__scrabble_scorer__returns_expected_scores_input_state2proxy[C", "tests/gflownet/utils/test_batch.py::test__get_rewards_parents_multiple_env_returns_expected_non_terminating[tetris6x4-tetris_score_norm]", "tests/gflownet/utils/test_batch.py::test__get_rewards__single_env_returns_expected_non_terminating[tetris6x4-tetris_score]", "tests/gflownet/proxy/test_scrabble_proxy.py::test__scrabble_scorer__returns_expected_scores_list_input_list_tokens[samples0-scores_expected0]", "tests/gflownet/utils/test_batch.py::test__get_rewards__single_env_returns_expected[grid2d-corners]", "tests/gflownet/utils/test_batch.py::test__get_rewards__single_env_returns_expected[ctorus2d5l-corners]", "tests/gflownet/utils/test_batch.py::test__get_logrewards__single_env_returns_expected[grid2d-corners]", "tests/gflownet/utils/test_batch.py::test__get_rewards_parents_multiple_env_returns_expected_non_terminating[ctorus2d5l-corners]", "tests/gflownet/utils/test_batch.py::test__mixed_sampling_multiple_envs_all_as_expected[tetris6x4-tetris_score]"], "PASS_TO_PASS": [], "language": "python", "test_command": "source /saved/ENV || source /saved/*/ENV && pytest --no-header -rA --tb=no -p no:cacheprovider --continue-on-collection-errors", "test_output_parser": "python/parse_log_pytest_v3", "image_storage_uri": "vmvm-registry.fbinfra.net/repomate_image_activ_pytest/alexhernandezgarcia_gflownet:030f207be74b0eded7688b6a771c02ee48a2307f", "patch": "", "test_patch": "", "hints_text": ""}
