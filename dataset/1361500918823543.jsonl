{"instance_id": "1361500918823543", "repo": "pyomo/pyomo", "base_commit": "42fa578606e9520f86a2439aad5e96806717469b", "problem_statement": "[PEP] add \"implicit\" sets to the Block as \"anonymous\" components:\\n## Summary\\r\\n\\r\\nHistorically, Set objects implicitly created by a component were added to the same block as the component with hard-coded names derived from the component name.  This PEP proposes we remove that behavior and allow for implicit Sets to be attached to the Block \"anonymously\".\\r\\n\\r\\n### Discussion\\r\\n\\r\\nIt is important that Sets created implicitly during the process of constructing a Component (and attaching it to a Block) are also attached to the same Block.  This ensures that the Sets are properly constructed (especially in the case of AbstractModels), and ensures that `model.clone()` correctly duplicates the Sets.  However, the use of a hard-coded name causes problems when deleting and re-adding components (as the implicit sets are not removed from the Block - see #45).  Further, because this is done when the Component is added to the Block, we cannot disable access to attributes like `Var.domain` for unconstructed Components (because Block._add_implicit_sets() looks for '`domain`' to attach it to the Block).  Finally this convention obscures the model that the user wrote: both by filling it with numerous \"auto\" Sets (e.g., `x_index`, `y_index_0`, `z_domain`), and by reporting the name of the \"auto\" set as the Component index (instead of something more informative like the set expression).\\r\\n\\r\\nThis PEP proposes that we still \"add\" implicit Sets to the Block, but not using an explicit name.  We would add the component using a new `Block.add_anonymous_component()` method.  This would set the Component's `parent_block()` to the Block (so that `block.clone()` works correctly) and would categorize it in the Block's component data structures according to the `ctype` (so, e.g., it would be returned by `component_objects()`), however it would not add the component to the Block's `__dict__`.\\r\\n\\r\\nWe would also transfer the responsibility for constructing implicit components from the Block to the Component that created the implicit components.  Deferring it to the \"originator's\" construction time would allow us to deactivate interfaces like `domain` on abstract components.", "FAIL_TO_PASS": ["pyomo/mpec/tests/test_complementarity.py::CCTests_nl::test_list5", "pyomo/core/tests/unit/test_set.py::TestSet::test_set_skip", "pyomo/core/tests/unit/test_set.py::Test_SetOf_and_RangeSet::test_constructor", "pyomo/mpec/tests/test_complementarity.py::CCTests_standard_form::test_list4", "pyomo/mpec/tests/test_complementarity.py::CCTests_none::test_list2", "pyomo/core/tests/unit/test_connector.py::TestConnector::test_expand_empty_indexed", "pyomo/core/tests/unit/test_numeric_expr.py::TestPrettyPrinter_newStyle::test_large_expression", "pyomo/core/tests/unit/test_set.py::TestSetDifference::test_domain_and_pprint", "pyomo/mpec/tests/test_complementarity.py::CCTests_simple_disjunction::test_list5", "pyomo/core/tests/unit/test_set.py::TestSet::test_domain", "pyomo/core/tests/unit/test_expression.py::TestExpression::test_pprint_oldStyle", "pyomo/mpec/tests/test_complementarity.py::CCTests_none::test_list1", "pyomo/mpec/tests/test_complementarity.py::CCTests_none::test_cov2", "pyomo/mpec/tests/test_complementarity.py::CCTests_simple_disjunction::test_list2", "pyomo/network/tests/test_arc.py::TestArc::test_expand_empty_indexed", "pyomo/core/tests/unit/test_connector.py::TestConnector::test_expand_empty_expression", "pyomo/network/tests/test_arc.py::TestArc::test_expand_implicit_indexed", "pyomo/core/tests/unit/test_connector.py::TestConnector::test_expand_expression", "pyomo/core/tests/unit/test_connector.py::TestConnector::test_expand_empty_scalar", "pyomo/network/tests/test_arc.py::TestArc::test_expand_multiple_indexed", "pyomo/mpec/tests/test_complementarity.py::CCTests_standard_form::test_cov2", "pyomo/core/tests/unit/test_set.py::Test_SetInitializer::test_single_set", "pyomo/core/tests/unit/test_set.py::TestSet::test_no_normalize_index", "pyomo/core/tests/unit/test_connector.py::TestConnector::test_expand_multiple_empty_indexed", "pyomo/core/tests/unit/test_connector.py::TestConnector::test_expand_indexed", "pyomo/mpec/tests/test_complementarity.py::CCTests_simple_nonlinear::test_list2", "pyomo/core/tests/unit/test_set.py::Test_SetInitializer::test_intersect", "pyomo/mpec/tests/test_complementarity.py::CCTests_standard_form::test_t13", "pyomo/mpec/tests/test_complementarity.py::CCTests_none::test_list5", "pyomo/mpec/tests/test_complementarity.py::CCTests_simple_disjunction::test_t13", "pyomo/core/tests/unit/test_set.py::TestSetIntersection::test_domain_and_pprint", "pyomo/core/tests/unit/test_connector.py::TestConnector::test_expand_implicit_indexed", "pyomo/mpec/tests/test_complementarity.py::CCTests_simple_nonlinear::test_t10", "pyomo/core/tests/unit/test_reference.py::TestReference::test_pprint_nested", "pyomo/mpec/tests/test_complementarity.py::CCTests_none::test_list4", "pyomo/mpec/tests/test_complementarity.py::CCTests_standard_form::test_t10", "pyomo/dae/tests/test_diffvar.py::TestDerivativeVar::test_valid", "pyomo/core/tests/unit/test_connector.py::TestConnector::test_expand_scalar", "pyomo/core/tests/unit/test_connector.py::TestConnector::test_expand_single_scalar", "pyomo/core/tests/unit/test_set.py::TestSetProduct::test_ordered_nondim_setproduct", "pyomo/mpec/tests/test_complementarity.py::CCTests_none::test_list3", "pyomo/core/tests/unit/test_set.py::Test_SetInitializer::test_setdefault", "pyomo/core/tests/unit/test_set.py::TestIssues::test_issue_938", "pyomo/network/tests/test_arc.py::TestArc::test_expand_indexed_arc", "pyomo/core/tests/unit/test_reference.py::TestReference::test_reference_indexedcomponent_pprint", "pyomo/core/tests/unit/test_reference.py::TestReference::test_reference_var_pprint", "pyomo/core/tests/unit/test_connector.py::TestConnector::test_varlist_aggregator", "pyomo/mpec/tests/test_complementarity.py::CCTests_simple_disjunction::test_list4", "pyomo/mpec/tests/test_complementarity.py::CCTests_simple_disjunction::test_list3", "pyomo/mpec/tests/test_complementarity.py::CCTests_simple_disjunction::test_cov2", "pyomo/mpec/tests/test_complementarity.py::CCTests_standard_form::test_list1", "pyomo/mpec/tests/test_complementarity.py::CCTests_simple_nonlinear::test_cov2", "pyomo/core/tests/unit/test_set.py::TestSet::test_pprint", "pyomo/mpec/tests/test_complementarity.py::CCTests_simple_nonlinear::test_list5", "pyomo/core/tests/unit/test_set.py::TestSetSymmetricDifference::test_domain_and_pprint", "pyomo/core/tests/unit/test_visitor.py::WalkerTests::test_replacement_walker0", "pyomo/mpec/tests/test_complementarity.py::CCTests_simple_nonlinear::test_t13", "pyomo/core/tests/unit/test_componentuid.py::TestComponentUID::test_generate_cuid_string_map", "pyomo/core/tests/unit/test_set.py::TestSet::test_construction", "pyomo/core/tests/unit/test_set.py::TestSetProduct::test_domain_and_pprint", "pyomo/mpec/tests/test_complementarity.py::CCTests_nl::test_list2", "pyomo/core/tests/unit/test_expression.py::TestExpression::test_pprint_newStyle", "pyomo/core/tests/unit/test_set.py::TestSetProduct::test_no_normalize_index", "pyomo/mpec/tests/test_complementarity.py::CCTests_none::test_t10", "pyomo/mpec/tests/test_complementarity.py::CCTests_standard_form::test_list5", "pyomo/mpec/tests/test_complementarity.py::CCTests_nl::test_list1", "pyomo/core/tests/unit/test_set.py::TestSetUnion::test_domain_and_pprint", "pyomo/core/tests/unit/test_connector.py::TestConnector::test_expand_multiple_indexed", "pyomo/mpec/tests/test_complementarity.py::CCTests_nl::test_list4", "pyomo/core/tests/unit/test_connector.py::TestConnector::test_indexed_connector", "pyomo/mpec/tests/test_complementarity.py::CCTests_simple_nonlinear::test_list3", "pyomo/network/tests/test_arc.py::TestArc::test_expand_indexed", "pyomo/core/tests/unit/test_set.py::Test_SetOperator::test_construct", "pyomo/mpec/tests/test_complementarity.py::CCTests_simple_disjunction::test_t10", "pyomo/core/tests/unit/test_block.py::TestBlock::test_pprint", "pyomo/mpec/tests/test_complementarity.py::CCTests_nl::test_t13", "pyomo/mpec/tests/test_complementarity.py::CCTests_simple_disjunction::test_list1", "pyomo/network/tests/test_arc.py::TestArc::test_expand_multiple_empty_indexed", "pyomo/mpec/tests/test_complementarity.py::CCTests_standard_form::test_list2", "pyomo/mpec/tests/test_complementarity.py::CCTests_nl::test_list3", "pyomo/mpec/tests/test_complementarity.py::CCTests_standard_form::test_list3", "pyomo/core/tests/unit/test_set.py::TestSetProduct::test_ordered_multidim_setproduct", "pyomo/mpec/tests/test_complementarity.py::CCTests_nl::test_cov2", "pyomo/mpec/tests/test_complementarity.py::CCTests_simple_nonlinear::test_list4", "pyomo/core/tests/unit/test_expr_misc.py::Test::test_expr5", "pyomo/mpec/tests/test_complementarity.py::CCTests_none::test_t13", "pyomo/mpec/tests/test_complementarity.py::CCTests_nl::test_t10", "pyomo/mpec/tests/test_complementarity.py::CCTests_simple_nonlinear::test_list1"], "PASS_TO_PASS": [], "language": "python", "test_command": "source /saved/ENV || source /saved/*/ENV && pytest --no-header -rA --tb=no -p no:cacheprovider --continue-on-collection-errors", "test_output_parser": "python/parse_log_pytest_v3", "image_storage_uri": "vmvm-registry.fbinfra.net/repomate_image_activ_pytest/pyomo_pyomo:42fa578606e9520f86a2439aad5e96806717469b", "patch": "", "test_patch": "", "hints_text": ""}
