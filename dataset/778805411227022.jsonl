{"instance_id": "778805411227022", "repo": "cyclonedx/cyclonedx-python-lib", "base_commit": "0f1fd6dfdd41073cbdbb456cf019c7f2ed9e2175", "problem_statement": "[BREAKING] All optional lists become non-optional sets:\\n@madpah a huge change i would suggest is: all optional lists become non-optional sets.\\r\\nbased on https://github.com/CycloneDX/cyclonedx-python-lib/pull/148/files#r798309225\\r\\n\\r\\nthis way a lot of problems would be solved: \\r\\n* no need for implementing `object.add_<list-property>()` all the time\\r\\n* the order of the list-properties would no longer matter - no sorting, no whatsoever\\r\\n* serializers/normalizers would always have a reliable non-optional data type to work with (remeber: an empty `set` is falsy - for easy size-checks)\\r\\n* additionally: use the `set`-literal: instead of writing `set([...])` simply write `{...}` - if this was needed at any place, still\\r\\n\\r\\n_Originally posted by @jkowalleck in https://github.com/CycloneDX/cyclonedx-python-lib/issues/148#issuecomment-1028715688_", "FAIL_TO_PASS": ["test_model_component.TestModelComponent.test_empty_basic_component"], "PASS_TO_PASS": ["test_model_vulnerability.TestModelVulnerability.test_v_source_get_localised_vector_owasp_2", "test_model_issue.TestModelIssueType.test_not_same", "test_model.TestModelXsUri.test_note_with_no_locale", "test_component.TestComponent.test_purl_correct", "test_model_component.TestModelSwid.test_not_same", "test_model_component.TestModelComponent.test_external_references", "test_model_vulnerability.TestModelVulnerability.test_v_source_get_localised_vector_other_2", "test_model_component.TestModelComponent.test_same_2", "test_output_generic.TestOutputGeneric.test_component_no_version_v1_3", "test_component.TestComponent.test_has_component_1", "test_bom.TestBom.test_metadata_component", "test_model_vulnerability.TestModelVulnerability.test_empty_vulnerability", "test_model_component.TestModelPedigree.test_not_same_1", "test_model_component.TestModelComponentEvidence.test_same_1", "test_model_release_note.TestModelReleaseNote.test_complete", "test_model_vulnerability.TestModelVulnerability.test_v_source_get_localised_vector_cvss2_3", "test_e2e_environment.TestE2EEnvironment.test_xml_defaults", "test_model_component.TestModelComponent.test_same_1", "test_model_component.TestModelSwid.test_same_1", "test_model_vulnerability.TestModelVulnerability.test_v_severity_from_cvss_scores_single_low", "test_model_vulnerability.TestModelVulnerability.test_v_source_parse_cvss2_1", "test_model_vulnerability.TestModelVulnerability.test_v_source_parse_owasp_1", "test_model_component.TestModelDiff.test_not_same", "test_model.TestModelXsUri.test_valid_relative_url_unescaped_ascii", "test_model_component.TestModelDiff.test_no_params", "test_model_component.TestModelDiff.test_same", "test_bom.TestBom.test_bom_metadata_tool_this_tool", "test_model.TestModelCopyright.test_same", "test_model_issue.TestModelIssueType.test_same", "test_model.TestModelXsUri.test_invalid_url_bad_escaped_character", "test_model.TestModelXsUri.test_note_with_invalid_locale", "test_model.TestModelXsUri.test_valid_url_with_fragment", "test_output_generic.TestOutputGeneric.test_get_instance_default", "test_model.TestModelXsUri.test_valid_relative_url_with_fragment", "test_output_generic.TestOutputGeneric.test_get_instance_xml", "test_component.TestComponent.test_purl_incorrect_version", "test_model_component.TestModelCommit.test_same", "test_model_component.TestModelComponent.test_empty_basic_component_no_version", "test_model.TestModelCopyright.test_not_same", "test_model.TestModelXsUri.test_valid_mailto", "test_model.TestModelExternalReference.test_external_reference_with_xsuri", "test_model_release_note.TestModelReleaseNote.test_simple", "test_model_component.TestModelPedigree.test_no_params", "test_model.TestModelHashType.test_hash_type_from_composite_str_2", "test_model_issue.TestModelIssueTypeSource.test_no_params", "test_model_component.TestModelPedigree.test_same_1", "test_model_vulnerability.TestModelVulnerability.test_v_severity_from_cvss_scores_single_critical", "test_model_vulnerability.TestModelVulnerability.test_v_severity_from_cvss_scores_single_medium", "test_model.TestModelXsUri.test_valid_relative_url_escaped_ascii", "test_model.TestModelExternalReference.test_not_same", "test_model_component.TestModelComponent.test_component_equal_3", "test_model_service.TestModelService.test_minimal_service", "test_model.TestModelXsUri.test_valid_url", "test_model_component.TestModelComponent.test_component_equal_1", "test_model_vulnerability.TestModelVulnerability.test_v_source_get_localised_vector_owasp_3", "test_component.TestComponent.test_purl_incorrect_name", "test_e2e_environment.TestE2EEnvironment.test_json_defaults", "test_model.TestModelNote.test_note_encoded_text_with_locale", "test_model_component.TestModelCommit.test_not_same", "test_model.TestModelIssueType.test_issue_type", "test_model.TestModelExternalReference.test_same", "test_bom.TestBom.test_empty_bom", "test_model.TestModelNote.test_note_plain_text", "test_component.TestComponent.test_full_purl_spec_no_subpath", "test_model.TestModelHashType.test_hash_type_from_composite_str_1", "test_model_issue.TestModelIssueTypeSource.test_not_same", "test_model.TestModelHashType.test_hash_type_from_unknown", "test_model_vulnerability.TestModelVulnerability.test_v_source_get_localised_vector_owasp_1", "test_model_vulnerability.TestModelVulnerability.test_v_severity_from_cvss_scores_single_none", "test_model_vulnerability.TestModelVulnerability.test_v_severity_from_cvss_scores_multiple_critical", "test_model_component.TestModelComponentEvidence.test_same_2", "test_component.TestComponent.test_from_file_with_path_for_bom", "test_model_component.TestModelPatch.test_not_same_1", "test_model_vulnerability.TestModelVulnerability.test_v_source_get_localised_vector_cvss3_1", "test_model_vulnerability.TestModelVulnerability.test_v_source_parse_cvss3_1", "test_model.TestModelXsUri.test_note_with_valid_locale", "test_component.TestComponent.test_purl_with_qualifiers", "test_model_vulnerability.TestModelVulnerability.test_v_source_get_localised_vector_cvss2_2", "test_model_vulnerability.TestModelVulnerability.test_v_source_get_localised_vector_cvss3_3", "test_model_vulnerability.TestModelVulnerability.test_v_severity_from_cvss_scores_single_high", "test_model_component.TestModelComponentEvidence.test_no_params", "test_model.TestModelIdentifiableAction.test_not_same", "test_model_component.TestModelComponentEvidence.test_not_same_1", "test_model_vulnerability.TestModelVulnerability.test_v_severity_from_cvss_scores_multiple_high", "test_output_generic.TestOutputGeneric.test_get_instance_xml_v1_3", "test_model.TestModelNote.test_note_invalid_locale", "test_model_component.TestModelComponent.test_component_equal_2", "test_model.TestModelXsUri.test_valid_urn", "test_model_component.TestModelPatch.test_same_1", "test_model_issue.TestModelIssueTypeSource.test_same", "test_model_component.TestModelComponent.test_not_same_1", "test_model.TestModelXsUri.test_valid_empty", "test_model_component.TestModelComponent.test_multiple_basic_components", "test_model_service.TestModelService.test_service_with_services", "test_bom.TestBom.test_bom_metadata_tool_multiple_tools", "test_model.TestModelXsUri.test_invalid_url_multiple_fragments", "test_model_component.TestModelCommit.test_no_parameters", "test_model.TestModelIdentifiableAction.test_no_params", "test_model_component.TestModelComponent.test_same_3", "test_model_component.TestModelSwid.test_same_2", "test_model_component.TestModelPatch.test_multiple_times_same", "test_model.TestModelIdentifiableAction.test_same", "test_model_vulnerability.TestModelVulnerability.test_v_source_get_localised_vector_cvss3_2", "test_model_vulnerability.TestModelVulnerability.test_v_source_get_localised_vector_cvss2_1", "test_model_vulnerability.TestModelVulnerability.test_v_source_get_localised_vector_other_1"], "language": "python", "test_command": "source /saved/ENV || source /saved/*/ENV && /usr/bin/python3 /app/repo/unittest_loader_no_traceback.py ./tests", "test_output_parser": "python/parse_log_unittest", "image_storage_uri": "vmvm-registry.fbinfra.net/repomate_image_activ_python_unittest/cyclonedx_cyclonedx-python-lib:0f1fd6dfdd41073cbdbb456cf019c7f2ed9e2175", "patch": "", "test_patch": "[\"diff --git a/tests/data.py b/tests/data.py\\nindex 18bba462..e85b434e 100644\\n--- a/tests/data.py\\n+++ b/tests/data.py\\n@@ -29,7 +29,7 @@\\n from cyclonedx.model.bom import Bom\\n from cyclonedx.model.component import Commit, Component, ComponentEvidence, ComponentType, Copyright, Patch, \\\\\\n     PatchClassification, Pedigree, Swid\\n-from cyclonedx.model.issue import IssueClassification, IssueType\\n+from cyclonedx.model.issue import IssueClassification, IssueType, IssueTypeSource\\n from cyclonedx.model.release_note import ReleaseNotes\\n from cyclonedx.model.service import Service\\n from cyclonedx.model.vulnerability import ImpactAnalysisState, ImpactAnalysisJustification, ImpactAnalysisResponse, \\\\\\n@@ -71,10 +71,10 @@ def get_bom_with_component_setuptools_complete() -> Bom:\\n     component.cpe = 'cpe:2.3:a:python:setuptools:50.3.2:*:*:*:*:*:*:*'\\n     component.swid = get_swid_1()\\n     component.pedigree = get_pedigree_1()\\n-    component.components = [\\n+    component.components.update([\\n         get_component_setuptools_simple(),\\n         get_component_toml_with_hashes_with_references()\\n-    ]\\n+    ])\\n     component.evidence = ComponentEvidence(copyright_=[Copyright(text='Commercial'), Copyright(text='Commercial 2')])\\n     return Bom(components=[component])\\n \\n@@ -130,7 +130,7 @@ def get_bom_with_component_setuptools_with_vulnerability() -> Bom:\\n         ),\\n         affects_targets=[\\n             BomTarget(\\n-                ref=component.purl.to_string() if component.purl else component.to_package_url().to_string(),\\n+                ref=component.purl.to_string() if component.purl else None,\\n                 versions=[BomTargetVersionRange(\\n                     version_range='49.0.0 - 54.0.0', status=ImpactAnalysisAffectedStatus.AFFECTED\\n                 )]\\n@@ -138,7 +138,7 @@ def get_bom_with_component_setuptools_with_vulnerability() -> Bom:\\n         ]\\n     )\\n     component.add_vulnerability(vulnerability=vulnerability)\\n-    bom.add_component(component=component)\\n+    bom.components.add(component)\\n     return bom\\n \\n \\n@@ -286,7 +286,7 @@ def get_component_toml_with_hashes_with_references(bom_ref: Optional[str] = None\\n def get_external_reference_1() -> ExternalReference:\\n     return ExternalReference(\\n         reference_type=ExternalReferenceType.DISTRIBUTION,\\n-        url='https://cyclonedx.org',\\n+        url=XsUri('https://cyclonedx.org'),\\n         comment='No comment',\\n         hashes=[\\n             HashType.from_composite_str(\\n@@ -298,15 +298,15 @@ def get_external_reference_1() -> ExternalReference:\\n def get_external_reference_2() -> ExternalReference:\\n     return ExternalReference(\\n         reference_type=ExternalReferenceType.WEBSITE,\\n-        url='https://cyclonedx.org'\\n+        url=XsUri('https://cyclonedx.org')\\n     )\\n \\n \\n def get_issue_1() -> IssueType:\\n     return IssueType(\\n-        classification=IssueClassification.SECURITY, id='CVE-2021-44228', name='Apache Log3Shell',\\n+        classification=IssueClassification.SECURITY, id_='CVE-2021-44228', name='Apache Log3Shell',\\n         description='Apache Log4j2 2.0-beta9 through 2.12.1 and 2.13.0 through 2.15.0 JNDI features...',\\n-        source_name='NVD', source_url=XsUri('https://nvd.nist.gov/vuln/detail/CVE-2021-44228'),\\n+        source=IssueTypeSource(name='NVD', url=XsUri('https://nvd.nist.gov/vuln/detail/CVE-2021-44228')),\\n         references=[\\n             XsUri('https://logging.apache.org/log4j/2.x/security.html'),\\n             XsUri('https://central.sonatype.org/news/20211213_log4shell_help')\\n@@ -316,9 +316,9 @@ def get_issue_1() -> IssueType:\\n \\n def get_issue_2() -> IssueType:\\n     return IssueType(\\n-        classification=IssueClassification.SECURITY, id='CVE-2021-44229', name='Apache Log4Shell',\\n+        classification=IssueClassification.SECURITY, id_='CVE-2021-44229', name='Apache Log4Shell',\\n         description='Apache Log4j2 2.0-beta9 through 2.12.1 and 2.13.0 through 2.15.0 JNDI features...',\\n-        source_name='NVD', source_url=XsUri('https://nvd.nist.gov/vuln/detail/CVE-2021-44228'),\\n+        source=IssueTypeSource(name='NVD', url=XsUri('https://nvd.nist.gov/vuln/detail/CVE-2021-44228')),\\n         references=[\\n             XsUri('https://logging.apache.org/log4j/2.x/security.html'),\\n             XsUri('https://central.sonatype.org/news/20211213_log4shell_help')\\n@@ -369,7 +369,7 @@ def get_release_notes() -> ReleaseNotes:\\n     ).decode(encoding='UTF-8')\\n \\n     return ReleaseNotes(\\n-        type='major', title=\\\"Release Notes Title\\\",\\n+        type_='major', title=\\\"Release Notes Title\\\",\\n         featured_image=XsUri('https://cyclonedx.org/theme/assets/images/CycloneDX-Twitter-Card.png'),\\n         social_image=XsUri('https://cyclonedx.org/cyclonedx-icon.png'),\\n         description=\\\"This release is a test release\\\", timestamp=MOCK_TIMESTAMP,\\n\",\"diff --git a/tests/test_bom.py b/tests/test_bom.py\\nindex d8d9f1c5..1c1a5b3e 100644\\n--- a/tests/test_bom.py\\n+++ b/tests/test_bom.py\\n@@ -33,7 +33,7 @@ def test_bom_metadata_tool_this_tool(self) -> None:\\n     def test_bom_metadata_tool_multiple_tools(self) -> None:\\n         bom = Bom()\\n         self.assertEqual(len(bom.metadata.tools), 1)\\n-        bom.metadata.add_tool(\\n+        bom.metadata.tools.add(\\n             Tool(vendor='TestVendor', name='TestTool', version='0.0.0')\\n         )\\n         self.assertEqual(len(bom.metadata.tools), 2)\\n@@ -41,8 +41,7 @@ def test_bom_metadata_tool_multiple_tools(self) -> None:\\n     def test_metadata_component(self) -> None:\\n         metadata = Bom().metadata\\n         self.assertTrue(metadata.component is None)\\n-        hextech = Component(name='Hextech', version='1.0.0',\\n-                            component_type=ComponentType.LIBRARY)\\n+        hextech = Component(name='Hextech', version='1.0.0', component_type=ComponentType.LIBRARY)\\n         metadata.component = hextech\\n         self.assertFalse(metadata.component is None)\\n         self.assertEquals(metadata.component, hextech)\\n@@ -51,6 +50,6 @@ def test_empty_bom(self) -> None:\\n         bom = Bom()\\n         self.assertIsNotNone(bom.uuid)\\n         self.assertIsNotNone(bom.metadata)\\n-        self.assertIsNone(bom.components)\\n-        self.assertIsNone(bom.services)\\n-        self.assertIsNone(bom.external_references)\\n+        self.assertFalse(bom.components)\\n+        self.assertFalse(bom.services)\\n+        self.assertFalse(bom.external_references)\\n\",\"diff --git a/tests/test_model_component.py b/tests/test_model_component.py\\nindex 07a111fa..45bc835e 100644\\n--- a/tests/test_model_component.py\\n+++ b/tests/test_model_component.py\\n@@ -295,7 +295,7 @@ def test_multiple_times_same(self) -> None:\\n             )\\n             p2 = Patch(\\n                 type_=PatchClassification.BACKPORT, diff=Diff(url=XsUri('https://cyclonedx.org')),\\n-                resolves=[get_issue_2(), get_issue_1()]\\n+                resolves=[get_issue_2(), get_issue_1(), get_issue_1(), get_issue_1(), get_issue_2()]\\n             )\\n             self.assertEqual(hash(p1), hash(p2))\\n             self.assertNotEqual(id(p1), id(p2))\\n\",\"diff --git a/tests/base.py b/tests/base.py\\nindex a3bd114a..39d146a3 100644\\n--- a/tests/base.py\\n+++ b/tests/base.py\\n@@ -68,8 +68,8 @@ def assertValidAgainstSchema(self, bom_json: str, schema_version: SchemaVersion)\\n \\n     def assertEqualJson(self, a: str, b: str) -> None:\\n         self.assertEqual(\\n-            json.dumps(json.loads(a), sort_keys=True),\\n-            json.dumps(json.loads(b), sort_keys=True)\\n+            json.dumps(sorted(json.loads(a)), sort_keys=True),\\n+            json.dumps(sorted(json.loads(b)), sort_keys=True)\\n         )\\n \\n     def assertEqualJsonBom(self, a: str, b: str) -> None:\\n\",\"diff --git a/poetry.lock b/poetry.lock\\nindex 1920822e..1c44a2d3 100644\\n--- a/poetry.lock\\n+++ b/poetry.lock\\n@@ -393,6 +393,18 @@ six = \\\">=1.9.0,<2\\\"\\n docs = [\\\"proselint (>=0.10.2)\\\", \\\"sphinx (>=3)\\\", \\\"sphinx-argparse (>=0.2.5)\\\", \\\"sphinx-rtd-theme (>=0.4.3)\\\", \\\"towncrier (>=21.3)\\\"]\\n testing = [\\\"coverage (>=4)\\\", \\\"coverage-enable-subprocess (>=1)\\\", \\\"flaky (>=3)\\\", \\\"pytest (>=4)\\\", \\\"pytest-env (>=0.6.2)\\\", \\\"pytest-freezegun (>=0.4.1)\\\", \\\"pytest-mock (>=2)\\\", \\\"pytest-randomly (>=1)\\\", \\\"pytest-timeout (>=1)\\\", \\\"packaging (>=20.0)\\\"]\\n \\n+[[package]]\\n+name = \\\"xmldiff\\\"\\n+version = \\\"2.4\\\"\\n+description = \\\"Creates diffs of XML files\\\"\\n+category = \\\"dev\\\"\\n+optional = false\\n+python-versions = \\\"*\\\"\\n+\\n+[package.dependencies]\\n+lxml = \\\">=3.1.0\\\"\\n+six = \\\"*\\\"\\n+\\n [[package]]\\n name = \\\"zipp\\\"\\n version = \\\"3.6.0\\\"\\n@@ -408,7 +420,7 @@ testing = [\\\"pytest (>=4.6)\\\", \\\"pytest-checkdocs (>=2.4)\\\", \\\"pytest-flake8\\\", \\\"pytes\\n [metadata]\\n lock-version = \\\"1.1\\\"\\n python-versions = \\\"^3.6\\\"\\n-content-hash = \\\"7d2eb65a2400fc39ea675281879e506d7aeb58689dda1f3b389b875040aae9cc\\\"\\n+content-hash = \\\"6a766bb8018a3c7492f24fb8d7567298cd38cad8253ade1a579871066dcbdf60\\\"\\n \\n [metadata.files]\\n attrs = [\\n@@ -710,6 +722,10 @@ virtualenv = [\\n     {file = \\\"virtualenv-20.13.0-py2.py3-none-any.whl\\\", hash = \\\"sha256:339f16c4a86b44240ba7223d0f93a7887c3ca04b5f9c8129da7958447d079b09\\\"},\\n     {file = \\\"virtualenv-20.13.0.tar.gz\\\", hash = \\\"sha256:d8458cf8d59d0ea495ad9b34c2599487f8a7772d796f9910858376d1600dd2dd\\\"},\\n ]\\n+xmldiff = [\\n+    {file = \\\"xmldiff-2.4-py2.py3-none-any.whl\\\", hash = \\\"sha256:213c2f4c39ed71811a9ceeec1c8bdf2e673e5527261ea11708b3acfa6c2bdb00\\\"},\\n+    {file = \\\"xmldiff-2.4.tar.gz\\\", hash = \\\"sha256:05bea20ce1f2c9678683bcce0c3ba9981f87d92b709d190e018bcbf047eccf63\\\"},\\n+]\\n zipp = [\\n     {file = \\\"zipp-3.6.0-py3-none-any.whl\\\", hash = \\\"sha256:9fe5ea21568a0a70e50f273397638d39b03353731e6cbbb3fd8502a33fec40bc\\\"},\\n     {file = \\\"zipp-3.6.0.tar.gz\\\", hash = \\\"sha256:71c644c5369f4a6e07636f0aa966270449561fcea2e3d6747b8d23efaa9d7832\\\"},\\n\",\"diff --git a/tests/base.py b/tests/base.py\\nindex 39d146a3..b2df5ae7 100644\\n--- a/tests/base.py\\n+++ b/tests/base.py\\n@@ -22,13 +22,13 @@\\n import sys\\n import xml.etree.ElementTree\\n from datetime import datetime, timezone\\n-from lxml import etree\\n-from typing import Any\\n from unittest import TestCase\\n from uuid import uuid4\\n-from xml.dom import minidom\\n \\n+from lxml import etree\\n from lxml.etree import DocumentInvalid\\n+from xmldiff import main\\n+from xmldiff.actions import MoveNode\\n \\n from cyclonedx.output import SchemaVersion\\n \\n@@ -121,15 +121,16 @@ def assertValidAgainstSchema(self, bom_xml: str, schema_version: SchemaVersion)\\n                                           f'{bom_xml}')\\n \\n     def assertEqualXml(self, a: str, b: str) -> None:\\n-        da, db = minidom.parseString(a), minidom.parseString(b)\\n-        self.assertTrue(self._is_equal_xml_element(da.documentElement, db.documentElement),\\n-                        'XML Documents are not equal: \\\\n{}\\\\n{}'.format(da.toxml(), db.toxml()))\\n+        diff_results = main.diff_texts(a, b, diff_options={'F': 0.5})\\n+        diff_results = list(filter(lambda o: not isinstance(o, MoveNode), diff_results))\\n+        self.assertEqual(len(diff_results), 0)\\n \\n     def assertEqualXmlBom(self, a: str, b: str, namespace: str) -> None:\\n         \\\"\\\"\\\"\\n         Sanitise some fields such as timestamps which cannot have their values directly compared for equality.\\n         \\\"\\\"\\\"\\n-        ba, bb = xml.etree.ElementTree.fromstring(a), xml.etree.ElementTree.fromstring(b)\\n+        ba = xml.etree.ElementTree.fromstring(a, etree.XMLParser(remove_blank_text=True, remove_comments=True))\\n+        bb = xml.etree.ElementTree.fromstring(b, etree.XMLParser(remove_blank_text=True, remove_comments=True))\\n \\n         # Align serialNumbers\\n         ba.set('serialNumber', single_uuid)\\n@@ -147,42 +148,13 @@ def assertEqualXmlBom(self, a: str, b: str, namespace: str) -> None:\\n \\n         # Align 'this' Tool Version\\n         this_tool = ba.find('.//*/{{{}}}tool[{{{}}}version=\\\"VERSION\\\"]'.format(namespace, namespace))\\n-        if this_tool:\\n+        if this_tool is not None:\\n             this_tool.find('./{{{}}}version'.format(namespace)).text = cyclonedx_lib_version\\n         this_tool = bb.find('.//*/{{{}}}tool[{{{}}}version=\\\"VERSION\\\"]'.format(namespace, namespace))\\n-        if this_tool:\\n+        if this_tool is not None:\\n             this_tool.find('./{{{}}}version'.format(namespace)).text = cyclonedx_lib_version\\n \\n         self.assertEqualXml(\\n             xml.etree.ElementTree.tostring(ba, 'unicode'),\\n             xml.etree.ElementTree.tostring(bb, 'unicode')\\n         )\\n-\\n-    def _is_equal_xml_element(self, a: Any, b: Any) -> bool:\\n-        if a.tagName != b.tagName:\\n-            return False\\n-        if sorted(a.attributes.items()) != sorted(b.attributes.items()):\\n-            return False\\n-\\n-        \\\"\\\"\\\"\\n-        Remove any pure whitespace Dom Text Nodes before we compare\\n-\\n-        See: https://xml-sig.python.narkive.com/8o0UIicu\\n-        \\\"\\\"\\\"\\n-        for n in a.childNodes:\\n-            if n.nodeType == n.TEXT_NODE and n.data.strip() == '':\\n-                a.removeChild(n)\\n-        for n in b.childNodes:\\n-            if n.nodeType == n.TEXT_NODE and n.data.strip() == '':\\n-                b.removeChild(n)\\n-\\n-        if len(a.childNodes) != len(b.childNodes):\\n-            return False\\n-        for ac, bc in zip(a.childNodes, b.childNodes):\\n-            if ac.nodeType != bc.nodeType:\\n-                return False\\n-            if ac.nodeType == ac.TEXT_NODE and ac.data != bc.data:\\n-                return False\\n-            if ac.nodeType == ac.ELEMENT_NODE and not self._is_equal_xml_element(ac, bc):\\n-                return False\\n-        return True\\n\",\"diff --git a/tests/test_bom.py b/tests/test_bom.py\\nindex 1c1a5b3e..a275bba9 100644\\n--- a/tests/test_bom.py\\n+++ b/tests/test_bom.py\\n@@ -16,7 +16,6 @@\\n #\\n # SPDX-License-Identifier: Apache-2.0\\n # Copyright (c) OWASP Foundation. All Rights Reserved.\\n-\\n from unittest import TestCase\\n \\n from cyclonedx.model.bom import Bom, ThisTool, Tool\\n@@ -26,9 +25,9 @@\\n class TestBom(TestCase):\\n \\n     def test_bom_metadata_tool_this_tool(self) -> None:\\n-        self.assertEqual(ThisTool.get_vendor(), 'CycloneDX')\\n-        self.assertEqual(ThisTool.get_name(), 'cyclonedx-python-lib')\\n-        self.assertNotEqual(ThisTool.get_version(), 'UNKNOWN')\\n+        self.assertEqual(ThisTool.vendor, 'CycloneDX')\\n+        self.assertEqual(ThisTool.name, 'cyclonedx-python-lib')\\n+        self.assertNotEqual(ThisTool.version, 'UNKNOWN')\\n \\n     def test_bom_metadata_tool_multiple_tools(self) -> None:\\n         bom = Bom()\\n\",\"diff --git a/tests/test_component.py b/tests/test_component.py\\nindex c5c6056f..3f9b440e 100644\\n--- a/tests/test_component.py\\n+++ b/tests/test_component.py\\n@@ -108,8 +108,7 @@ def test_from_file_with_path_for_bom(self) -> None:\\n \\n     def test_has_component_1(self) -> None:\\n         bom = Bom()\\n-        bom.add_component(component=TestComponent._component)\\n-        bom.add_component(component=TestComponent._component_2)\\n+        bom.components.update([TestComponent._component, TestComponent._component_2])\\n         self.assertEqual(len(bom.components), 2)\\n         self.assertTrue(bom.has_component(component=TestComponent._component_2))\\n         self.assertIsNot(TestComponent._component, TestComponent._component_2)\\n\",\"diff --git a/tests/test_e2e_environment.py b/tests/test_e2e_environment.py\\nindex e850d821..22b6af3d 100644\\n--- a/tests/test_e2e_environment.py\\n+++ b/tests/test_e2e_environment.py\\n@@ -16,7 +16,6 @@\\n #\\n # SPDX-License-Identifier: Apache-2.0\\n # Copyright (c) OWASP Foundation. All Rights Reserved.\\n-\\n import json\\n import pkg_resources\\n from lxml import etree\\n@@ -39,7 +38,7 @@ class TestE2EEnvironment(TestCase):\\n     @classmethod\\n     def setUpClass(cls) -> None:\\n         cls.bom: Bom = Bom()\\n-        cls.bom.add_component(\\n+        cls.bom.components.add(\\n             Component(\\n                 name=OUR_PACKAGE_NAME, author=OUR_PACKAGE_AUTHOR, version=OUR_PACKAGE_VERSION,\\n                 purl=PackageURL(type='pypi', name=OUR_PACKAGE_NAME, version=OUR_PACKAGE_VERSION)\\n\",\"diff --git a/tests/test_model.py b/tests/test_model.py\\nindex eb3f0577..86e75b22 100644\\n--- a/tests/test_model.py\\n+++ b/tests/test_model.py\\n@@ -25,7 +25,7 @@\\n     NoPropertiesProvidedException\\n from cyclonedx.model import Copyright, Encoding, ExternalReference, ExternalReferenceType, HashAlgorithm, HashType, \\\\\\n     IdentifiableAction, Note, NoteText, XsUri\\n-from cyclonedx.model.issue import IssueClassification, IssueType\\n+from cyclonedx.model.issue import IssueClassification, IssueType, IssueTypeSource\\n \\n \\n class TestModelCopyright(TestCase):\\n@@ -45,29 +45,22 @@ def test_not_same(self) -> None:\\n \\n class TestModelExternalReference(TestCase):\\n \\n-    def test_external_reference_with_str(self) -> None:\\n-        e = ExternalReference(reference_type=ExternalReferenceType.VCS, url='https://www.google.com')\\n-        self.assertEqual(e.get_reference_type(), ExternalReferenceType.VCS)\\n-        self.assertEqual(e.get_url(), 'https://www.google.com')\\n-        self.assertEqual(e.get_comment(), '')\\n-        self.assertListEqual(e.get_hashes(), [])\\n-\\n     def test_external_reference_with_xsuri(self) -> None:\\n         e = ExternalReference(reference_type=ExternalReferenceType.VCS, url=XsUri('https://www.google.com'))\\n-        self.assertEqual(e.get_reference_type(), ExternalReferenceType.VCS)\\n-        self.assertEqual(e.get_url(), 'https://www.google.com')\\n-        self.assertEqual(e.get_comment(), '')\\n-        self.assertListEqual(e.get_hashes(), [])\\n+        self.assertEqual(e.type, ExternalReferenceType.VCS)\\n+        self.assertEqual(e.url, XsUri('https://www.google.com'))\\n+        self.assertIsNone(e.comment)\\n+        self.assertSetEqual(e.hashes, set())\\n \\n     def test_same(self) -> None:\\n         ref_1 = ExternalReference(\\n             reference_type=ExternalReferenceType.OTHER,\\n-            url='https://cyclonedx.org',\\n+            url=XsUri('https://cyclonedx.org'),\\n             comment='No comment'\\n         )\\n         ref_2 = ExternalReference(\\n             reference_type=ExternalReferenceType.OTHER,\\n-            url='https://cyclonedx.org',\\n+            url=XsUri('https://cyclonedx.org'),\\n             comment='No comment'\\n         )\\n         self.assertNotEqual(id(ref_1), id(ref_2))\\n@@ -77,12 +70,12 @@ def test_same(self) -> None:\\n     def test_not_same(self) -> None:\\n         ref_1 = ExternalReference(\\n             reference_type=ExternalReferenceType.OTHER,\\n-            url='https://cyclonedx.org',\\n+            url=XsUri('https://cyclonedx.org'),\\n             comment='No comment'\\n         )\\n         ref_2 = ExternalReference(\\n             reference_type=ExternalReferenceType.OTHER,\\n-            url='https://cyclonedx.org/',\\n+            url=XsUri('https://cyclonedx.org/'),\\n             comment='No comment'\\n         )\\n         self.assertNotEqual(id(ref_1), id(ref_2))\\n@@ -94,13 +87,13 @@ class TestModelHashType(TestCase):\\n \\n     def test_hash_type_from_composite_str_1(self) -> None:\\n         h = HashType.from_composite_str('sha256:806143ae5bfb6a3c6e736a764057db0e6a0e05e338b5630894a5f779cabb4f9b')\\n-        self.assertEqual(h.get_algorithm(), HashAlgorithm.SHA_256)\\n-        self.assertEqual(h.get_hash_value(), '806143ae5bfb6a3c6e736a764057db0e6a0e05e338b5630894a5f779cabb4f9b')\\n+        self.assertEqual(h.alg, HashAlgorithm.SHA_256)\\n+        self.assertEqual(h.content, '806143ae5bfb6a3c6e736a764057db0e6a0e05e338b5630894a5f779cabb4f9b')\\n \\n     def test_hash_type_from_composite_str_2(self) -> None:\\n         h = HashType.from_composite_str('md5:dc26cd71b80d6757139f38156a43c545')\\n-        self.assertEqual(h.get_algorithm(), HashAlgorithm.MD5)\\n-        self.assertEqual(h.get_hash_value(), 'dc26cd71b80d6757139f38156a43c545')\\n+        self.assertEqual(h.alg, HashAlgorithm.MD5)\\n+        self.assertEqual(h.content, 'dc26cd71b80d6757139f38156a43c545')\\n \\n     def test_hash_type_from_unknown(self) -> None:\\n         with self.assertRaises(UnknownHashTypeException):\\n@@ -132,7 +125,7 @@ class TestModelIssueType(TestCase):\\n \\n     def test_issue_type(self) -> None:\\n         it = IssueType(\\n-            classification=IssueClassification.SECURITY, id='CVE-2021-44228', name='Apache Log3Shell',\\n+            classification=IssueClassification.SECURITY, id_='CVE-2021-44228', name='Apache Log3Shell',\\n             description='Apache Log4j2 2.0-beta9 through 2.12.1 and 2.13.0 through 2.15.0 JNDI features used in '\\n                         'configuration, log messages, and parameters do not protect against attacker controlled LDAP '\\n                         'and other JNDI related endpoints. An attacker who can control log messages or log message '\\n@@ -141,17 +134,17 @@ def test_issue_type(self) -> None:\\n                         'version 2.16.0, this functionality has been completely removed. Note that this vulnerability '\\n                         'is specific to log4j-core and does not affect log4net, log4cxx, or other Apache Logging '\\n                         'Services projects.',\\n-            source_name='NVD', source_url=XsUri('https://nvd.nist.gov/vuln/detail/CVE-2021-44228'),\\n+            source=IssueTypeSource(name='NVD', url=XsUri('https://nvd.nist.gov/vuln/detail/CVE-2021-44228')),\\n             references=[\\n                 XsUri('https://logging.apache.org/log4j/2.x/security.html'),\\n                 XsUri('https://central.sonatype.org/news/20211213_log4shell_help')\\n             ]\\n         )\\n-        self.assertEqual(it.get_classification(), IssueClassification.SECURITY),\\n-        self.assertEqual(it.get_id(), 'CVE-2021-44228'),\\n-        self.assertEqual(it.get_name(), 'Apache Log3Shell')\\n+        self.assertEqual(it.type, IssueClassification.SECURITY),\\n+        self.assertEqual(it.id, 'CVE-2021-44228'),\\n+        self.assertEqual(it.name, 'Apache Log3Shell')\\n         self.assertEqual(\\n-            it.get_description(),\\n+            it.description,\\n             'Apache Log4j2 2.0-beta9 through 2.12.1 and 2.13.0 through 2.15.0 JNDI features used in '\\n             'configuration, log messages, and parameters do not protect against attacker controlled LDAP '\\n             'and other JNDI related endpoints. An attacker who can control log messages or log message '\\n@@ -161,17 +154,12 @@ def test_issue_type(self) -> None:\\n             'is specific to log4j-core and does not affect log4net, log4cxx, or other Apache Logging '\\n             'Services projects.'\\n         )\\n-        self.assertEqual(it.get_source_name(), 'NVD'),\\n-        self.assertEqual(str(it.get_source_url()), str(XsUri('https://nvd.nist.gov/vuln/detail/CVE-2021-44228')))\\n-        self.assertEqual(str(it.get_source_url()), str('https://nvd.nist.gov/vuln/detail/CVE-2021-44228'))\\n-        self.assertListEqual(list(map(lambda u: str(u), it.get_references())), [\\n-            'https://logging.apache.org/log4j/2.x/security.html',\\n-            'https://central.sonatype.org/news/20211213_log4shell_help'\\n-        ])\\n-        self.assertListEqual(list(map(lambda u: str(u), it.get_references())), [\\n-            'https://logging.apache.org/log4j/2.x/security.html',\\n-            'https://central.sonatype.org/news/20211213_log4shell_help'\\n-        ])\\n+        self.assertEqual(it.source.name, 'NVD'),\\n+        self.assertEqual(it.source.url, XsUri('https://nvd.nist.gov/vuln/detail/CVE-2021-44228'))\\n+        self.assertSetEqual(it.references, {\\n+            XsUri('https://logging.apache.org/log4j/2.x/security.html'),\\n+            XsUri('https://central.sonatype.org/news/20211213_log4shell_help')\\n+        })\\n \\n \\n class TestModelNote(TestCase):\\n\",\"diff --git a/tests/test_model_component.py b/tests/test_model_component.py\\nindex 45bc835e..b1c05927 100644\\n--- a/tests/test_model_component.py\\n+++ b/tests/test_model_component.py\\n@@ -71,12 +71,12 @@ def test_empty_basic_component(self, mock_uuid: Mock) -> None:\\n         self.assertEqual(c.version, '1.2.3')\\n         self.assertIsNone(c.description)\\n         self.assertIsNone(c.scope)\\n-        self.assertListEqual(c.hashes, [])\\n-        self.assertListEqual(c.licenses, [])\\n+        self.assertSetEqual(c.hashes, set())\\n+        self.assertSetEqual(c.licenses, set())\\n         self.assertIsNone(c.copyright)\\n         self.assertIsNone(c.purl)\\n-        self.assertListEqual(c.external_references, [])\\n-        self.assertIsNone(c.properties)\\n+        self.assertSetEqual(c.external_references, set())\\n+        self.assertFalse(c.properties)\\n         self.assertIsNone(c.release_notes)\\n \\n         self.assertEqual(len(c.get_vulnerabilities()), 0)\\n@@ -111,9 +111,9 @@ def test_external_references(self) -> None:\\n         c = Component(\\n             name='test-component', version='1.2.3'\\n         )\\n-        c.add_external_reference(ExternalReference(\\n+        c.external_references.add(ExternalReference(\\n             reference_type=ExternalReferenceType.OTHER,\\n-            url='https://cyclonedx.org',\\n+            url=XsUri('https://cyclonedx.org'),\\n             comment='No comment'\\n         ))\\n         self.assertEqual(c.name, 'test-component')\\n@@ -148,18 +148,18 @@ def test_component_equal_1(self) -> None:\\n         c = Component(\\n             name='test-component', version='1.2.3'\\n         )\\n-        c.add_external_reference(ExternalReference(\\n+        c.external_references.add(ExternalReference(\\n             reference_type=ExternalReferenceType.OTHER,\\n-            url='https://cyclonedx.org',\\n+            url=XsUri('https://cyclonedx.org'),\\n             comment='No comment'\\n         ))\\n \\n         c2 = Component(\\n             name='test-component', version='1.2.3'\\n         )\\n-        c2.add_external_reference(ExternalReference(\\n+        c2.external_references.add(ExternalReference(\\n             reference_type=ExternalReferenceType.OTHER,\\n-            url='https://cyclonedx.org',\\n+            url=XsUri('https://cyclonedx.org'),\\n             comment='No comment'\\n         ))\\n \\n\",\"diff --git a/tests/test_model_release_note.py b/tests/test_model_release_note.py\\nindex a360bd70..b544e58f 100644\\n--- a/tests/test_model_release_note.py\\n+++ b/tests/test_model_release_note.py\\n@@ -26,23 +26,23 @@\\n class TestModelReleaseNote(TestCase):\\n \\n     def test_simple(self) -> None:\\n-        rn = ReleaseNotes(type='major')\\n+        rn = ReleaseNotes(type_='major')\\n         self.assertEqual(rn.type, 'major')\\n         self.assertIsNone(rn.title)\\n         self.assertIsNone(rn.featured_image)\\n         self.assertIsNone(rn.social_image)\\n         self.assertIsNone(rn.description)\\n         self.assertIsNone(rn.timestamp)\\n-        self.assertIsNone(rn.aliases)\\n-        self.assertIsNone(rn.tags)\\n-        self.assertIsNone(rn.resolves)\\n-        self.assertIsNone(rn.notes)\\n-        self.assertIsNone(rn.properties)\\n+        self.assertFalse(rn.aliases)\\n+        self.assertFalse(rn.tags)\\n+        self.assertFalse(rn.resolves)\\n+        self.assertFalse(rn.notes)\\n+        self.assertFalse(rn.properties)\\n \\n     def test_complete(self) -> None:\\n         timestamp: datetime.datetime = datetime.datetime.utcnow()\\n         rn = ReleaseNotes(\\n-            type='major', title=\\\"Release Notes Title\\\",\\n+            type_='major', title=\\\"Release Notes Title\\\",\\n             featured_image=XsUri('https://cyclonedx.org/theme/assets/images/CycloneDX-Twitter-Card.png'),\\n             social_image=XsUri('https://cyclonedx.org/cyclonedx-icon.png'),\\n             description=\\\"This release is a test release\\\", timestamp=timestamp,\\n@@ -53,8 +53,8 @@ def test_complete(self) -> None:\\n             resolves=[],\\n             notes=[]\\n         )\\n-        rn.add_alias(alias=\\\"Release Alpha\\\")\\n-        rn.add_tag(tag='testing')\\n+        rn.aliases.add(\\\"Release Alpha\\\")\\n+        rn.tags.add('testing')\\n \\n         self.assertEqual(rn.type, 'major')\\n         self.assertEqual(rn.title, 'Release Notes Title')\\n@@ -64,8 +64,8 @@ def test_complete(self) -> None:\\n         )\\n         self.assertEqual(str(rn.social_image), 'https://cyclonedx.org/cyclonedx-icon.png')\\n         self.assertEqual(rn.description, 'This release is a test release')\\n-        self.assertListEqual(rn.aliases, [\\\"First Test Release\\\", \\\"Release Alpha\\\"])\\n-        self.assertListEqual(rn.tags, ['test', 'alpha', 'testing'])\\n-        self.assertIsNone(rn.resolves)\\n-        self.assertIsNone(rn.notes)\\n-        self.assertIsNone(rn.properties)\\n+        self.assertSetEqual(rn.aliases, {\\\"Release Alpha\\\", \\\"First Test Release\\\"})\\n+        self.assertSetEqual(rn.tags, {'test', 'testing', 'alpha'})\\n+        self.assertSetEqual(rn.resolves, set())\\n+        self.assertFalse(rn.notes)\\n+        self.assertSetEqual(rn.properties, set())\\n\",\"diff --git a/tests/test_model_service.py b/tests/test_model_service.py\\nindex da414ebf..70b1df53 100644\\n--- a/tests/test_model_service.py\\n+++ b/tests/test_model_service.py\\n@@ -34,15 +34,15 @@ def test_minimal_service(self, mock_uuid: Mock) -> None:\\n         self.assertIsNone(s.group)\\n         self.assertIsNone(s.version)\\n         self.assertIsNone(s.description)\\n-        self.assertIsNone(s.endpoints)\\n+        self.assertFalse(s.endpoints)\\n         self.assertIsNone(s.authenticated)\\n         self.assertIsNone(s.x_trust_boundary)\\n-        self.assertIsNone(s.data)\\n-        self.assertListEqual(s.licenses, [])\\n-        self.assertListEqual(s.external_references, [])\\n-        self.assertIsNone(s.services)\\n-        self.assertIsNone(s.release_notes)\\n-        self.assertIsNone(s.properties)\\n+        self.assertFalse(s.data)\\n+        self.assertFalse(s.licenses)\\n+        self.assertFalse(s.external_references)\\n+        self.assertFalse(s.services)\\n+        self.assertFalse(s.release_notes)\\n+        self.assertFalse(s.properties)\\n \\n     @patch('cyclonedx.model.service.uuid4', return_value='859ff614-35a7-4d37-803b-d89130cb2577')\\n     def test_service_with_services(self, mock_uuid: Mock) -> None:\\n@@ -58,14 +58,14 @@ def test_service_with_services(self, mock_uuid: Mock) -> None:\\n         self.assertIsNone(parent_service.group)\\n         self.assertIsNone(parent_service.version)\\n         self.assertIsNone(parent_service.description)\\n-        self.assertIsNone(parent_service.endpoints)\\n+        self.assertFalse(parent_service.endpoints)\\n         self.assertIsNone(parent_service.authenticated)\\n         self.assertIsNone(parent_service.x_trust_boundary)\\n-        self.assertIsNone(parent_service.data)\\n-        self.assertListEqual(parent_service.licenses, [])\\n-        self.assertListEqual(parent_service.external_references, [])\\n+        self.assertFalse(parent_service.data)\\n+        self.assertFalse(parent_service.licenses)\\n+        self.assertFalse(parent_service.external_references)\\n         self.assertIsNotNone(parent_service.services)\\n         self.assertEqual(len(parent_service.services), 2)\\n         self.assertIsNone(parent_service.release_notes)\\n-        self.assertIsNone(parent_service.properties)\\n+        self.assertFalse(parent_service.properties)\\n         self.assertTrue(parent_service.has_service(service=Service(name='child-service-1')))\\n\",\"diff --git a/tests/test_model_vulnerability.py b/tests/test_model_vulnerability.py\\nindex 361b9f1d..450793cf 100644\\n--- a/tests/test_model_vulnerability.py\\n+++ b/tests/test_model_vulnerability.py\\n@@ -16,7 +16,6 @@\\n #\\n # SPDX-License-Identifier: Apache-2.0\\n # Copyright (c) OWASP Foundation. All Rights Reserved.\\n-\\n import unittest\\n from unittest import TestCase\\n from unittest.mock import Mock, patch\\n@@ -30,17 +29,17 @@ class TestModelVulnerability(TestCase):\\n     @unittest.skip('Deprecated in Schema Version 1.4')\\n     def test_v_rating_scores_empty(self) -> None:\\n         vr = VulnerabilityRating()\\n-        self.assertFalse(vr.has_score())\\n+        self.assertFalse(vr.score)\\n \\n     @unittest.skip('Deprecated in Schema Version 1.4')\\n     def test_v_rating_scores_base_only(self) -> None:\\n         vr = VulnerabilityRating(score_base=1.0)\\n-        self.assertTrue(vr.has_score())\\n+        self.assertTrue(vr.score)\\n \\n     @unittest.skip('Deprecated in Schema Version 1.4')\\n     def test_v_rating_scores_all(self) -> None:\\n         vr = VulnerabilityRating(score_base=1.0, score_impact=3.5, score_exploitability=5.6)\\n-        self.assertTrue(vr.has_score())\\n+        self.assertTrue(vr.score)\\n \\n     def test_v_severity_from_cvss_scores_single_critical(self) -> None:\\n         self.assertEqual(\\n@@ -178,17 +177,17 @@ def test_empty_vulnerability(self, mock_uuid: Mock) -> None:\\n         self.assertEqual(v.bom_ref, '0afa65bc-4acd-428b-9e17-8e97b1969745')\\n         self.assertIsNone(v.id)\\n         self.assertIsNone(v.source)\\n-        self.assertListEqual(v.references, [])\\n-        self.assertListEqual(v.ratings, [])\\n-        self.assertListEqual(v.cwes, [])\\n+        self.assertFalse(v.references)\\n+        self.assertFalse(v.ratings)\\n+        self.assertFalse(v.cwes)\\n         self.assertIsNone(v.description)\\n         self.assertIsNone(v.detail)\\n         self.assertIsNone(v.recommendation)\\n-        self.assertListEqual(v.advisories, [])\\n+        self.assertFalse(v.advisories)\\n         self.assertIsNone(v.created)\\n         self.assertIsNone(v.published)\\n         self.assertIsNone(v.updated)\\n         self.assertIsNone(v.credits)\\n-        self.assertListEqual(v.tools, [])\\n+        self.assertFalse(v.tools)\\n         self.assertIsNone(v.analysis)\\n-        self.assertListEqual(v.affects, [])\\n+        self.assertFalse(v.affects)\\n\",\"diff --git a/tests/test_output_generic.py b/tests/test_output_generic.py\\nindex 22c4896c..5d8d9441 100644\\n--- a/tests/test_output_generic.py\\n+++ b/tests/test_output_generic.py\\n@@ -30,7 +30,7 @@ class TestOutputGeneric(TestCase):\\n     @classmethod\\n     def setUpClass(cls) -> None:\\n         cls._bom = Bom()\\n-        cls._bom.add_component(Component(name='setuptools'))\\n+        cls._bom.components.add(Component(name='setuptools'))\\n \\n     def test_get_instance_default(self) -> None:\\n         i = get_instance(bom=TestOutputGeneric._bom)\\n\",\"diff --git a/tox.ini b/tox.ini\\nindex c902de7d..4b9eb4d1 100644\\n--- a/tox.ini\\n+++ b/tox.ini\\n@@ -26,7 +26,7 @@ commands_pre =\\n     lowest: poetry run pip install -U -r requirements.lowest.txt\\n     poetry run pip freeze\\n commands =\\n-    poetry run coverage run --source=cyclonedx -m unittest discover -s tests -v\\n+    PYTHONHASHSEED=0 poetry run coverage run --source=cyclonedx -m unittest discover -s tests -v\\n \\n [testenv:mypy{,-locked,-lowest}]\\n commands =\\n\",\"diff --git a/tox.ini b/tox.ini\\nindex 4b9eb4d1..d14cb059 100644\\n--- a/tox.ini\\n+++ b/tox.ini\\n@@ -26,7 +26,9 @@ commands_pre =\\n     lowest: poetry run pip install -U -r requirements.lowest.txt\\n     poetry run pip freeze\\n commands =\\n-    PYTHONHASHSEED=0 poetry run coverage run --source=cyclonedx -m unittest discover -s tests -v\\n+    poetry run coverage run --source=cyclonedx -m unittest discover -s tests -v\\n+setenv =\\n+    PYTHONHASHSEED = 0\\n \\n [testenv:mypy{,-locked,-lowest}]\\n commands =\\n\",\"diff --git a/tests/test_bom.py b/tests/test_bom.py\\nindex a275bba9..aedc4ddd 100644\\n--- a/tests/test_bom.py\\n+++ b/tests/test_bom.py\\n@@ -20,6 +20,7 @@\\n \\n from cyclonedx.model.bom import Bom, ThisTool, Tool\\n from cyclonedx.model.component import Component, ComponentType\\n+from data import get_bom_with_component_setuptools_with_vulnerability\\n \\n \\n class TestBom(TestCase):\\n@@ -52,3 +53,7 @@ def test_empty_bom(self) -> None:\\n         self.assertFalse(bom.components)\\n         self.assertFalse(bom.services)\\n         self.assertFalse(bom.external_references)\\n+\\n+    def test_bom_with_vulnerabilities(self) -> None:\\n+        bom = get_bom_with_component_setuptools_with_vulnerability()\\n+        self.assertTrue(bom.has_vulnerabilities())\\n\",\"diff --git a/tests/test_model_service.py b/tests/test_model_service.py\\nindex 70b1df53..12f589cf 100644\\n--- a/tests/test_model_service.py\\n+++ b/tests/test_model_service.py\\n@@ -68,4 +68,4 @@ def test_service_with_services(self, mock_uuid: Mock) -> None:\\n         self.assertEqual(len(parent_service.services), 2)\\n         self.assertIsNone(parent_service.release_notes)\\n         self.assertFalse(parent_service.properties)\\n-        self.assertTrue(parent_service.has_service(service=Service(name='child-service-1')))\\n+        self.assertTrue(Service(name='child-service-1') in parent_service.services)\"]", "hints_text": ""}
