{"instance_id": "24378122975105454", "repo": "xnuinside/simple-ddl-parser", "base_commit": "1c292ef370a18e0ab761dc0bf0adc370dfb4e885", "problem_statement": "Snowflake Table DDL support of WITH MASKING POLICY column definition:\\n**Is your feature request related to a problem? Please describe.**\\r\\nI would like to improve the CREATE TABLE statement of Snowflake ddl to support the Column WITH MASKING POLICY.\\r\\n\\r\\n**Describe the solution you'd like**\\r\\nCREATE OR REPLACE TABLE schemaName.TableAddresses (\\r\\n\\tAddressID NUMBER(38,0) NOT NULL,\\r\\n\\tAddress1 VARCHAR(100) **WITH MASKING POLICY** DBName.MASKING_POLICY_LIBRARY.MASK_STRING **WITH TAG** (DBName.MASKING_POLICY_LIBRARY.PROJECT_POLICY_MASK='mask_object')\\r\\n);\\r\\nSupported by DDLParser.run() functions\\r\\n\\r\\n**Describe alternatives you've considered**\\r\\nadd MASKING POLICY and TAG members same as Comment, Nullable or Default properties\\r\\n\\r\\nhttps://docs.snowflake.com/en/sql-reference/sql/create-table\\r\\n", "FAIL_TO_PASS": ["tests/dialects/test_snowflake.py::test_table_with_tag", "tests/dialects/test_snowflake.py::test_table_with_retention", "tests/dialects/test_snowflake.py::test_table_with_change_tracking", "tests/dialects/test_snowflake.py::test_table_with_mask"], "PASS_TO_PASS": ["tests/test_after_columns_statements.py::test_partition_by_without_parths", "tests/test_simple_ddl_parser.py::test_run_postgres_first_query", "tests/test_simple_ddl_parser.py::test_create_or_replace", "tests/test_alter_statements.py::test_alter_foreiggn_with_constraint", "tests/dialects/test_mssql_specific.py::test_mssql_foreign_ref_in_column", "tests/test_simple_ddl_parser.py::test_ddl_properties", "tests/dialects/test_bigquery.py::test_bigquery_options_string", "tests/dialects/test_bigquery.py::test_long_string_in_option", "tests/test_custom_types_and_domains.py::test_as_table", "tests/dialects/test_mssql_specific.py::test_primary_key_clustered", "tests/test_sequences.py::test_add_support_no_value", "tests/test_comments.py::test_inline_comment", "tests/test_checks.py::test_checks_with_in_works", "tests/dialects/test_hql_output_mode.py::test_simple_serde", "tests/dialects/test_mssql_specific.py::test_with_on_table_level", "tests/dialects/test_hql_output_mode.py::test_location_showed", "tests/dialects/test_spark_sql.py::test_partition_by", "tests/dialects/test_bigquery.py::test_multiple_options", "tests/test_custom_types_and_domains.py::test_custom_enum_wihtout_schema", "tests/test_indexes.py::test_indexes_in_table", "tests/dialects/test_mssql_specific.py::test_with_on", "tests/test_simple_ddl_parser.py::test_schema_with_project_name", "tests/test_simple_ddl_parser.py::test_default_and_primary_inline", "tests/test_simple_ddl_parser.py::test_autoincrement", "tests/test_after_columns_statements.py::test_stored_as_parsed_but_not_showed", "tests/test_read_from_file.py::test_parse_from_file_one_table", "tests/test_simple_ddl_parser.py::test_do_not_fail_on_brackets_in_default", "tests/test_simple_ddl_parser.py::test_increment_column", "tests/dialects/test_hql_output_mode.py::test_output_input_format", "tests/dialects/test_redshift_dialect.py::test_like_in_parath", "tests/test_after_columns_statements.py::test_partitioned_by_hql", "tests/test_sequences.py::test_only_sequence", "tests/dialects/test_bigquery.py::test_table_name_with_project_id", "tests/test_references.py::test_foreigen_keys", "tests/test_after_columns_statements.py::test_map_keys_terminated_not_showed", "tests/dialects/test_redshift_dialect.py::test_interleaved_sortkey_also_ok", "tests/dialects/test_hql_output_mode.py::test_table_properties", "tests/dialects/test_bigquery.py::test_bigquery[test_two_options_values]", "tests/dialects/test_mssql_specific.py::test_output_separated_by_go_and_textimage", "tests/dialects/test_bigquery.py::test_bigquery[test_simple_struct]", "tests/dialects/test_mssql_specific.py::test_constraint_unique", "tests/non_statement_tests/test_common.py::test_flag_normalize_names", "tests/dialects/test_bigquery.py::test_project_id_in_alter_and_references", "tests/non_statement_tests/test_common.py::test_silent_false_flag", "tests/test_simple_ddl_parser.py::test_group_by_type_output", "tests/test_simple_ddl_parser.py::test_generated_always_with_concat", "tests/dialects/test_oracle.py::test_organization_index", "tests/test_simple_ddl_parser.py::test_added_create_tablespace", "tests/test_simple_ddl_parser.py::test_replace_with_id", "tests/test_sequences.py::test_sequence_with_by", "tests/test_simple_ddl_parser.py::test_column_names_with_names_like_tokens_works_well", "tests/dialects/test_oracle.py::test_encrypt", "tests/non_statement_tests/test_common.py::test_parsing_go_and_use_correctly", "tests/dialects/test_mssql_specific.py::test_mysql_constraint_pk", "tests/test_references.py::test_references", "tests/dialects/test_hql_output_mode.py::test_hql_create_remote_schema", "tests/dialects/test_mysql.py::test_on_update_with_fcall", "tests/dialects/test_bigquery.py::test_cluster_by_without_brackets", "tests/test_ddl_settings.py::test_parse_validly_tables_after_set", "tests/test_simple_ddl_parser.py::test_check_in_column", "tests/dialects/test_hql_output_mode.py::test_with_serde_properties", "tests/dialects/test_bigquery.py::test_two_options_in_create_table", "tests/dialects/test_mssql_specific.py::test_two_unique_constructs", "tests/test_simple_ddl_parser.py::test_non_int_type_paramteter", "tests/test_alter_statements.py::test_alter_check_with_constraint", "tests/test_ddl_settings.py::test_set_lower_parsed", "tests/dialects/test_hql_output_mode.py::test_special_characters_in_comment", "tests/dialects/test_snowflake.py::test_comment_on_create_schema", "tests/test_simple_ddl_parser.py::test_tablespaces_temporary", "tests/dialects/test_redshift_dialect.py::test_distyle", "tests/dialects/test_snowflake.py::test_clone_table", "tests/test_simple_ddl_parser.py::test_defaults_with_comments", "tests/test_simple_ddl_parser.py::test_parser_multiple_tables", "tests/test_simple_ddl_parser.py::test_generated_always", "tests/dialects/test_mssql_specific.py::test_constraint_unique_none", "tests/test_alter_statements.py::test_alter_using", "tests/test_simple_ddl_parser.py::test_method_in_check", "tests/dialects/test_oracle.py::test_star_in_columns_siize", "tests/test_indexes.py::test_clustered_index", "tests/test_simple_ddl_parser.py::test_quotes", "tests/test_ddl_settings.py::test_sets_with_dot_and_comma", "tests/test_sequences.py::test_sequence_and_table", "tests/test_references.py::test_deferrable_initially_not", "tests/dialects/test_redshift_dialect.py::test_base_encode", "tests/test_simple_ddl_parser.py::test_output_without_separator_in_statements", "tests/test_simple_ddl_parser.py::test_schema", "tests/non_statement_tests/test_args.py::test_json_dump_arg", "tests/test_read_from_file.py::test_parse_from_file_two_statements", "tests/dialects/test_bigquery.py::test_multiple_options_statements", "tests/dialects/test_ibm_db2.py::test_organize_by_row", "tests/dialects/test_hql_output_mode.py::test_clustered_by_multiple_columns", "tests/non_statement_tests/test_common.py::test_no_unexpected_logs", "tests/dialects/test_mssql_specific.py::test_with_on_with_properties", "tests/dialects/test_hql_output_mode.py::test_comment_and_lines", "tests/dialects/test_bigquery.py::test_bigquery[test_schema_options]", "tests/test_alter_statements.py::test_alter_table_if_exists", "tests/test_after_columns_statements.py::test_tablespace_statement", "tests/test_references.py::test_references_on", "tests/test_simple_ddl_parser.py::test_run_query_caps_in_columns", "tests/dialects/test_hql_output_mode.py::test_remote_database", "tests/dialects/test_mssql_specific.py::test_period_for_system_time", "tests/test_simple_ddl_parser.py::test_inserts_skipped_validly", "tests/test_after_columns_statements.py::test_partitioned_by_postgresql", "tests/test_simple_ddl_parser.py::test_table_name_reserved_word_after_dot", "tests/dialects/test_snowflake.py::test_schema_parsed_normally", "tests/dialects/test_hql_output_mode.py::test_stored_as_hql_showed", "tests/test_alter_statements.py::test_alter_check", "tests/test_simple_ddl_parser.py::test_tabs_not_fails_ddl", "tests/test_alter_statements.py::test_alter_table_only", "tests/test_simple_ddl_parser.py::test_like_statement", "tests/test_after_columns_statements.py::test_fields_terminated_by_not_showed", "tests/test_checks.py::test_in_clause_in_check", "tests/dialects/test_mssql_specific.py::test_alter_unique", "tests/test_simple_ddl_parser.py::test_unique_statement_in_columns", "tests/test_simple_ddl_parser.py::test_collate", "tests/dialects/test_mssql_specific.py::test_on_primary_on_table_level", "tests/test_comments.py::test_mysql_comments_support", "tests/dialects/test_mssql_specific.py::test_max_supported_as_column_size", "tests/dialects/test_mssql_specific.py::test_constraint_primary_key", "tests/test_simple_ddl_parser.py::test_default_expression", "tests/test_simple_ddl_parser.py::test_check_that_all_columns_parsed_correctly", "tests/dialects/test_hql_output_mode.py::test_multiple_serde_options", "tests/test_alter_statements.py::test_combo_with_alter_and_table_constraints", "tests/test_simple_ddl_parser.py::test_check_with_constraint", "tests/test_simple_ddl_parser.py::test_schema_with_authorisation", "tests/dialects/test_spark_sql.py::test_spark_sql_partitioned_by_function", "tests/dialects/test_hql_output_mode.py::test_skewed_by", "tests/test_alter_statements.py::test_alter_foreign_with_multiple_ids", "tests/test_alter_statements.py::test_several_alter_fk_for_same_table", "tests/dialects/test_hql_output_mode.py::test_partitioned_by_multiple_columns", "tests/dialects/test_mssql_specific.py::test_constraint_with_with", "tests/dialects/test_hql_output_mode.py::test_comment_without_null_statement", "tests/test_custom_types_and_domains.py::test_custom_enum", "tests/dialects/test_mssql_specific.py::test_int_identity_type", "tests/test_create_database.py::test_parse_properties_in_create_db", "tests/dialects/test_snowflake.py::test_clone_schema", "tests/test_simple_ddl_parser.py::test_create_empty_table", "tests/dialects/test_mysql.py::test_default_charset", "tests/dialects/test_hql_output_mode.py::test_partitioned_by_hql_output_mode_hql", "tests/test_custom_types_and_domains.py::test_create_type_as_object", "tests/dialects/test_mysql.py::test_simple_on_update", "tests/dialects/test_hql_output_mode.py::test_clustered", "tests/dialects/test_oracle.py::test_oracle_sizes", "tests/dialects/test_redshift_dialect.py::test_create_temp_table", "tests/test_simple_ddl_parser.py::test_enum_in_lowercase", "tests/dialects/test_ibm_db2.py::test_in_tablespace", "tests/test_simple_ddl_parser.py::test_floats", "tests/test_simple_ddl_parser.py::test_default_null", "tests/test_custom_types_and_domains.py::test_create_type_with_input_properties", "tests/dialects/test_psql.py::test_inherits", "tests/dialects/test_bigquery.py::test_options_in_column", "tests/test_simple_ddl_parser.py::test_arrays", "tests/dialects/test_hql_output_mode.py::test_map_keys_terminated_by_hql", "tests/dialects/test_spark_sql.py::test_spark_sql_using", "tests/test_comments.py::test_block_comments", "tests/test_simple_ddl_parser.py::test_escaping_symbols_normal_str", "tests/test_simple_ddl_parser.py::test_unique_statement_separate_line", "tests/dialects/test_mssql_specific.py::test_next_value_for", "tests/dialects/test_redshift_dialect.py::test_encode_for_full_table", "tests/non_statement_tests/test_common.py::test_flag_normalize_names_mixed_usage", "tests/test_references.py::test_references_with_schema", "tests/test_alter_statements.py::test_alter_check_combine_all_variants", "tests/dialects/test_hql_output_mode.py::test_fields_terminated_by_hql", "tests/dialects/test_oracle.py::test_oracle_output_mode", "tests/dialects/test_hql_output_mode.py::test_complex_structure_test_hql", "tests/test_alter_statements.py::test_alter_without_constraint_and_constraint_in_table", "tests/dialects/test_bigquery.py::test_option_in_create_table", "tests/dialects/test_bigquery.py::test_bigquery[test_dataset_in_output]", "tests/dialects/test_snowflake.py::test_enforced", "tests/test_after_columns_statements.py::test_tablespace_with_properties", "tests/test_simple_ddl_parser.py::test_create_database", "tests/test_after_columns_statements.py::test_row_format_is_not_showed", "tests/dialects/test_hql_output_mode.py::test_into_buckets", "tests/test_alter_statements.py::test_alter_table_initial_support", "tests/dialects/test_snowflake.py::test_table_comment_parsed_validly", "tests/test_simple_ddl_parser.py::test_comments_in_columns", "tests/test_simple_ddl_parser.py::test_tablespace_small_big", "tests/dialects/test_oracle.py::test_storage", "tests/dialects/test_hql_output_mode.py::test_hql_row_format", "tests/test_simple_ddl_parser.py::test_lines_starts_with_statement_keys", "tests/test_indexes.py::test_indexes_in_table_wint_no_schema", "tests/test_references.py::test_ref_in_alter", "tests/dialects/test_mysql.py::test_identity_with_properties", "tests/dialects/test_ibm_db2.py::test_index_in", "tests/test_after_columns_statements.py::test_collection_items_terminated_by_not_showed", "tests/dialects/test_hql_output_mode.py::test_location_with_table_properties_in_like", "tests/test_simple_ddl_parser.py::test_fix_multiline_comments_not_joined_with_table", "tests/test_simple_ddl_parser.py::test_escaping_symbols_raw_string", "tests/dialects/test_mssql_specific.py::test_foreign_keys", "tests/dialects/test_bigquery.py::test_ars_in_arrays_in_option", "tests/dialects/test_hql_output_mode.py::test_collection_items_terminated_by_hql", "tests/test_simple_ddl_parser.py::test_domains", "tests/test_simple_ddl_parser.py::test_add_timezone", "tests/dialects/test_redshift_dialect.py::test_distkey_sortkey", "tests/test_references.py::test_defferable_initially", "tests/dialects/test_mssql_specific.py::test_defaults_in_alter", "tests/dialects/test_snowflake.py::test_clone_db", "tests/dialects/test_snowflake.py::test_cluster_by", "tests/test_indexes.py::test_several_indexes_types", "tests/test_comments.py::test_two_defices_in_string_work_ok", "tests/test_create_database.py::test_create_database_database", "tests/dialects/test_hql_output_mode.py::test_allow_use_tags_in_column_names", "tests/test_alter_statements.py::test_alter_table_primary_key", "tests/test_simple_ddl_parser.py::test_parse_table_name_table", "tests/dialects/test_oracle.py::test_partition_by"], "language": "python", "test_command": "source /saved/ENV || source /saved/*/ENV && pytest --no-header -rA --tb=no -p no:cacheprovider --continue-on-collection-errors", "test_output_parser": "python/parse_log_pytest_v3", "image_storage_uri": "vmvm-registry.fbinfra.net/repomate_image_activ_pytest/xnuinside_simple-ddl-parser:1c292ef370a18e0ab761dc0bf0adc370dfb4e885", "patch": "", "test_patch": "", "hints_text": ""}
