{"instance_id": "1933347334076601", "repo": "pypa/setuptools", "base_commit": "8032430d75cdfad9f9826d302d90cd7b23dea3ca", "problem_statement": "Build RPM for setuptools fails:\\nOriginally reported by: **toidi (Bitbucket: [toidi](http://bitbucket.org/toidi), GitHub: [toidi](http://github.com/toidi))**\\n\\n---\\n\\nEnd of `python setup.py bdist_rpm` command\\n\\n```\\nRPM build errors:\\n    Two files on one line: /usr/lib/python2.6/site-packages/setuptools/script\\n    File must begin with \"/\": template.py\\n    Two files on one line: /usr/lib/python2.6/site-packages/setuptools/script\\n    File must begin with \"/\": template\\n    Two files on one line: /usr/lib/python2.6/site-packages/setuptools/script\\n    File must begin with \"/\": (dev).py\\n    Two files on one line: /usr/lib/python2.6/site-packages/setuptools/script\\n    File must begin with \"/\": template.pyc\\n    Two files on one line: /usr/lib/python2.6/site-packages/setuptools/script\\n    File must begin with \"/\": template.pyo\\n    Two files on one line: /usr/lib/python2.6/site-packages/setuptools/script\\n    File must begin with \"/\": template\\n    Two files on one line: /usr/lib/python2.6/site-packages/setuptools/script\\n    File must begin with \"/\": (dev).pyc\\n    Two files on one line: /usr/lib/python2.6/site-packages/setuptools/script\\n    File must begin with \"/\": template\\n    Two files on one line: /usr/lib/python2.6/site-packages/setuptools/script\\n    File must begin with \"/\": (dev).pyo\\nerror: command 'rpmbuild' failed with exit status 1\\n```\\n\\nIt cannot handle files with space in file names.\\n- setuptools/script template (dev).py\\n- setuptools/script template.py\\n\\n---\\n- Bitbucket: https://bitbucket.org/pypa/setuptools/issue/178\\n\\nget_python_inc returns wrong include directory for bundled Pythons:\\nMy group maintains a project which bundles Python and so we compile packages with our bundled Python and not the system Python on our machines to ensure a stable environment for users. After #173, `sysconfig.get_python_inc()` always returns the Python headers in `/Library/Frameworks` instead of the header directory relative to our bundled Python. ", "FAIL_TO_PASS": ["setuptools/tests/test_build_meta.py::TestBuildMetaBackend::test_prepare_metadata_for_build_wheel[build_backend5]", "setuptools/tests/test_config_discovery.py::TestDiscoverPackagesAndPyModules::test_py_modules_when_wheel_dir_is_cwd", "setuptools/tests/test_build_meta.py::TestBuildMetaLegacyBackend::test_dont_install_setup_requires", "setuptools/tests/test_build_meta.py::TestBuildMetaBackend::test_prepare_metadata_inplace[build_backend0]"], "PASS_TO_PASS": [], "language": "python", "test_command": "source /saved/ENV || source /saved/*/ENV && tox -- --no-header -rA --tb=no -p no:cacheprovider --continue-on-collection-errors", "test_output_parser": "python/parse_log_pytest_v3", "image_storage_uri": "vmvm-registry.fbinfra.net/repomate_image_activ_pytest/pypa_setuptools:8032430d75cdfad9f9826d302d90cd7b23dea3ca", "patch": "[\"diff --git a/changelog.d/3809.change.rst b/changelog.d/3809.change.rst\\nnew file mode 100644\\nindex 0000000..ac38871\\n--- /dev/null\\n+++ b/changelog.d/3809.change.rst\\n@@ -0,0 +1 @@\\n+Merge with distutils@8c3c3d29, including fix for ``sysconfig.get_python_inc()`` (pypa/distutils#178), fix for segfault on MinGW (pypa/distutils#196), and better ``has_function`` support (pypa/distutils#195).\\n\",\"diff --git a/setuptools/_distutils/_collections.py b/setuptools/_distutils/_collections.py\\nindex 0255661..5ad21cc 100644\\n--- a/setuptools/_distutils/_collections.py\\n+++ b/setuptools/_distutils/_collections.py\\n@@ -185,7 +185,7 @@ class RangeMap(dict):\\n         return (sorted_keys[RangeMap.first_item], sorted_keys[RangeMap.last_item])\\n \\n     # some special values for the RangeMap\\n-    undefined_value = type(str('RangeValueUndefined'), (), {})()\\n+    undefined_value = type('RangeValueUndefined', (), {})()\\n \\n     class Item(int):\\n         \\\"RangeMap Item\\\"\\n\",\"diff --git a/setuptools/_distutils/_msvccompiler.py b/setuptools/_distutils/_msvccompiler.py\\nindex 8b4023c..4f081c7 100644\\n--- a/setuptools/_distutils/_msvccompiler.py\\n+++ b/setuptools/_distutils/_msvccompiler.py\\n@@ -339,7 +339,6 @@ class MSVCCompiler(CCompiler):\\n         extra_postargs=None,\\n         depends=None,\\n     ):\\n-\\n         if not self.initialized:\\n             self.initialize()\\n         compile_info = self._setup_compile(\\n@@ -413,8 +412,7 @@ class MSVCCompiler(CCompiler):\\n             args = [self.cc] + compile_opts + pp_opts\\n             if add_cpp_opts:\\n                 args.append('/EHsc')\\n-            args.append(input_opt)\\n-            args.append(\\\"/Fo\\\" + obj)\\n+            args.extend((input_opt, \\\"/Fo\\\" + obj))\\n             args.extend(extra_postargs)\\n \\n             try:\\n@@ -427,7 +425,6 @@ class MSVCCompiler(CCompiler):\\n     def create_static_lib(\\n         self, objects, output_libname, output_dir=None, debug=0, target_lang=None\\n     ):\\n-\\n         if not self.initialized:\\n             self.initialize()\\n         objects, output_dir = self._fix_object_args(objects, output_dir)\\n@@ -461,7 +458,6 @@ class MSVCCompiler(CCompiler):\\n         build_temp=None,\\n         target_lang=None,\\n     ):\\n-\\n         if not self.initialized:\\n             self.initialize()\\n         objects, output_dir = self._fix_object_args(objects, output_dir)\\n\",\"diff --git a/setuptools/_distutils/bcppcompiler.py b/setuptools/_distutils/bcppcompiler.py\\nindex 5d6b865..ba45ea2 100644\\n--- a/setuptools/_distutils/bcppcompiler.py\\n+++ b/setuptools/_distutils/bcppcompiler.py\\n@@ -64,7 +64,6 @@ class BCPPCompiler(CCompiler):\\n     exe_extension = '.exe'\\n \\n     def __init__(self, verbose=0, dry_run=0, force=0):\\n-\\n         super().__init__(verbose, dry_run, force)\\n \\n         # These executables are assumed to all be in the path.\\n@@ -98,7 +97,6 @@ class BCPPCompiler(CCompiler):\\n         extra_postargs=None,\\n         depends=None,\\n     ):\\n-\\n         macros, objects, extra_postargs, pp_opts, build = self._setup_compile(\\n             output_dir, macros, include_dirs, sources, depends, extra_postargs\\n         )\\n@@ -167,7 +165,6 @@ class BCPPCompiler(CCompiler):\\n     def create_static_lib(\\n         self, objects, output_libname, output_dir=None, debug=0, target_lang=None\\n     ):\\n-\\n         (objects, output_dir) = self._fix_object_args(objects, output_dir)\\n         output_filename = self.library_filename(output_libname, output_dir=output_dir)\\n \\n@@ -200,7 +197,6 @@ class BCPPCompiler(CCompiler):\\n         build_temp=None,\\n         target_lang=None,\\n     ):\\n-\\n         # XXX this ignores 'build_temp'!  should follow the lead of\\n         # msvccompiler.py\\n \\n@@ -219,7 +215,6 @@ class BCPPCompiler(CCompiler):\\n             output_filename = os.path.join(output_dir, output_filename)\\n \\n         if self._need_link(objects, output_filename):\\n-\\n             # Figure out linker args based on type of target.\\n             if target_desc == CCompiler.EXECUTABLE:\\n                 startup_obj = 'c0w32'\\n@@ -294,8 +289,7 @@ class BCPPCompiler(CCompiler):\\n                     ld_args.append(libfile)\\n \\n             # some default libraries\\n-            ld_args.append('import32')\\n-            ld_args.append('cw32mt')\\n+            ld_args.extend(('import32', 'cw32mt'))\\n \\n             # def file for export symbols\\n             ld_args.extend([',', def_file])\\n@@ -381,7 +375,6 @@ class BCPPCompiler(CCompiler):\\n         extra_preargs=None,\\n         extra_postargs=None,\\n     ):\\n-\\n         (_, macros, include_dirs) = self._fix_compile_args(None, macros, include_dirs)\\n         pp_opts = gen_preprocess_options(macros, include_dirs)\\n         pp_args = ['cpp32.exe'] + pp_opts\\n\",\"diff --git a/setuptools/_distutils/cmd.py b/setuptools/_distutils/cmd.py\\nindex 918db85..3860c3f 100644\\n--- a/setuptools/_distutils/cmd.py\\n+++ b/setuptools/_distutils/cmd.py\\n@@ -160,7 +160,7 @@ class Command:\\n             header = \\\"command options for '%s':\\\" % self.get_command_name()\\n         self.announce(indent + header, level=logging.INFO)\\n         indent = indent + \\\"  \\\"\\n-        for (option, _, _) in self.user_options:\\n+        for option, _, _ in self.user_options:\\n             option = option.translate(longopt_xlate)\\n             if option[-1] == \\\"=\\\":\\n                 option = option[:-1]\\n@@ -291,7 +291,7 @@ class Command:\\n         # Option_pairs: list of (src_option, dst_option) tuples\\n         src_cmd_obj = self.distribution.get_command_obj(src_cmd)\\n         src_cmd_obj.ensure_finalized()\\n-        for (src_option, dst_option) in option_pairs:\\n+        for src_option, dst_option in option_pairs:\\n             if getattr(self, dst_option) is None:\\n                 setattr(self, dst_option, getattr(src_cmd_obj, src_option))\\n \\n@@ -325,7 +325,7 @@ class Command:\\n         run for the current distribution.  Return a list of command names.\\n         \\\"\\\"\\\"\\n         commands = []\\n-        for (cmd_name, method) in self.sub_commands:\\n+        for cmd_name, method in self.sub_commands:\\n             if method is None or method(self):\\n                 commands.append(cmd_name)\\n         return commands\\n\",\"diff --git a/setuptools/_distutils/command/bdist.py b/setuptools/_distutils/command/bdist.py\\nindex bf0baab..6329039 100644\\n--- a/setuptools/_distutils/command/bdist.py\\n+++ b/setuptools/_distutils/command/bdist.py\\n@@ -33,7 +33,6 @@ class ListCompat(dict):\\n \\n \\n class bdist(Command):\\n-\\n     description = \\\"create a built (binary) distribution\\\"\\n \\n     user_options = [\\n\",\"diff --git a/setuptools/_distutils/command/bdist_dumb.py b/setuptools/_distutils/command/bdist_dumb.py\\nindex 071da77..01dd790 100644\\n--- a/setuptools/_distutils/command/bdist_dumb.py\\n+++ b/setuptools/_distutils/command/bdist_dumb.py\\n@@ -14,7 +14,6 @@ from distutils._log import log\\n \\n \\n class bdist_dumb(Command):\\n-\\n     description = \\\"create a \\\\\\\"dumb\\\\\\\" built distribution\\\"\\n \\n     user_options = [\\n\",\"diff --git a/setuptools/_distutils/command/bdist_rpm.py b/setuptools/_distutils/command/bdist_rpm.py\\nindex 340527b..3ed608b 100644\\n--- a/setuptools/_distutils/command/bdist_rpm.py\\n+++ b/setuptools/_distutils/command/bdist_rpm.py\\n@@ -21,7 +21,6 @@ from distutils._log import log\\n \\n \\n class bdist_rpm(Command):\\n-\\n     description = \\\"create an RPM distribution\\\"\\n \\n     user_options = [\\n@@ -554,7 +553,7 @@ class bdist_rpm(Command):\\n             ('postun', 'post_uninstall', None),\\n         ]\\n \\n-        for (rpm_opt, attr, default) in script_options:\\n+        for rpm_opt, attr, default in script_options:\\n             # Insert contents of file referred to, if no file is referred to\\n             # use 'default' as contents of script\\n             val = getattr(self, attr)\\n\",\"diff --git a/setuptools/_distutils/command/build.py b/setuptools/_distutils/command/build.py\\nindex c3ab410..cc9b367 100644\\n--- a/setuptools/_distutils/command/build.py\\n+++ b/setuptools/_distutils/command/build.py\\n@@ -16,7 +16,6 @@ def show_compilers():\\n \\n \\n class build(Command):\\n-\\n     description = \\\"build everything needed to install\\\"\\n \\n     user_options = [\\n\",\"diff --git a/setuptools/_distutils/command/build_clib.py b/setuptools/_distutils/command/build_clib.py\\nindex f90c566..b3f679b 100644\\n--- a/setuptools/_distutils/command/build_clib.py\\n+++ b/setuptools/_distutils/command/build_clib.py\\n@@ -28,7 +28,6 @@ def show_compilers():\\n \\n \\n class build_clib(Command):\\n-\\n     description = \\\"build C/C++ libraries used by Python extensions\\\"\\n \\n     user_options = [\\n@@ -103,7 +102,7 @@ class build_clib(Command):\\n             self.compiler.set_include_dirs(self.include_dirs)\\n         if self.define is not None:\\n             # 'define' option is a list of (name,value) tuples\\n-            for (name, value) in self.define:\\n+            for name, value in self.define:\\n                 self.compiler.define_macro(name, value)\\n         if self.undef is not None:\\n             for macro in self.undef:\\n@@ -155,14 +154,14 @@ class build_clib(Command):\\n             return None\\n \\n         lib_names = []\\n-        for (lib_name, build_info) in self.libraries:\\n+        for lib_name, build_info in self.libraries:\\n             lib_names.append(lib_name)\\n         return lib_names\\n \\n     def get_source_files(self):\\n         self.check_library_list(self.libraries)\\n         filenames = []\\n-        for (lib_name, build_info) in self.libraries:\\n+        for lib_name, build_info in self.libraries:\\n             sources = build_info.get('sources')\\n             if sources is None or not isinstance(sources, (list, tuple)):\\n                 raise DistutilsSetupError(\\n@@ -175,7 +174,7 @@ class build_clib(Command):\\n         return filenames\\n \\n     def build_libraries(self, libraries):\\n-        for (lib_name, build_info) in libraries:\\n+        for lib_name, build_info in libraries:\\n             sources = build_info.get('sources')\\n             if sources is None or not isinstance(sources, (list, tuple)):\\n                 raise DistutilsSetupError(\\n\",\"diff --git a/setuptools/_distutils/command/build_ext.py b/setuptools/_distutils/command/build_ext.py\\nindex f4c0ecc..fbeec34 100644\\n--- a/setuptools/_distutils/command/build_ext.py\\n+++ b/setuptools/_distutils/command/build_ext.py\\n@@ -39,7 +39,6 @@ def show_compilers():\\n \\n \\n class build_ext(Command):\\n-\\n     description = \\\"build C/C++ extensions (compile/link to build directory)\\\"\\n \\n     # XXX thoughts on how to deal with complex command-line options like\\n@@ -328,7 +327,7 @@ class build_ext(Command):\\n             self.compiler.set_include_dirs(self.include_dirs)\\n         if self.define is not None:\\n             # 'define' option is a list of (name,value) tuples\\n-            for (name, value) in self.define:\\n+            for name, value in self.define:\\n                 self.compiler.define_macro(name, value)\\n         if self.undef is not None:\\n             for macro in self.undef:\\n@@ -721,7 +720,7 @@ class build_ext(Command):\\n         name = ext.name.split('.')[-1]\\n         try:\\n             # Unicode module name support as defined in PEP-489\\n-            # https://www.python.org/dev/peps/pep-0489/#export-hook-name\\n+            # https://peps.python.org/pep-0489/#export-hook-name\\n             name.encode('ascii')\\n         except UnicodeEncodeError:\\n             suffix = 'U_' + name.encode('punycode').replace(b'-', b'_').decode('ascii')\\n\",\"diff --git a/setuptools/_distutils/command/build_py.py b/setuptools/_distutils/command/build_py.py\\nindex 9f78324..d9df959 100644\\n--- a/setuptools/_distutils/command/build_py.py\\n+++ b/setuptools/_distutils/command/build_py.py\\n@@ -14,7 +14,6 @@ from distutils._log import log\\n \\n \\n class build_py(Command):\\n-\\n     description = \\\"\\\\\\\"build\\\\\\\" pure Python modules (copy to build directory)\\\"\\n \\n     user_options = [\\n@@ -310,7 +309,7 @@ class build_py(Command):\\n     def get_outputs(self, include_bytecode=1):\\n         modules = self.find_all_modules()\\n         outputs = []\\n-        for (package, module, module_file) in modules:\\n+        for package, module, module_file in modules:\\n             package = package.split('.')\\n             filename = self.get_module_outfile(self.build_lib, package, module)\\n             outputs.append(filename)\\n@@ -352,7 +351,7 @@ class build_py(Command):\\n \\n     def build_modules(self):\\n         modules = self.find_modules()\\n-        for (package, module, module_file) in modules:\\n+        for package, module, module_file in modules:\\n             # Now \\\"build\\\" the module -- ie. copy the source file to\\n             # self.build_lib (the build directory for Python source).\\n             # (Actually, it gets copied to the directory for this package\\n@@ -375,7 +374,7 @@ class build_py(Command):\\n \\n             # Now loop over the modules we found, \\\"building\\\" each one (just\\n             # copy it to self.build_lib).\\n-            for (package_, module, module_file) in modules:\\n+            for package_, module, module_file in modules:\\n                 assert package == package_\\n                 self.build_module(module, module_file, package)\\n \\n\",\"diff --git a/setuptools/_distutils/command/build_scripts.py b/setuptools/_distutils/command/build_scripts.py\\nindex 87174f6..ce222f1 100644\\n--- a/setuptools/_distutils/command/build_scripts.py\\n+++ b/setuptools/_distutils/command/build_scripts.py\\n@@ -22,7 +22,6 @@ first_line_re = shebang_pattern\\n \\n \\n class build_scripts(Command):\\n-\\n     description = \\\"\\\\\\\"build\\\\\\\" scripts (copy and fixup #! line)\\\"\\n \\n     user_options = [\\n\",\"diff --git a/setuptools/_distutils/command/clean.py b/setuptools/_distutils/command/clean.py\\nindex d6eb3eb..9413f7c 100644\\n--- a/setuptools/_distutils/command/clean.py\\n+++ b/setuptools/_distutils/command/clean.py\\n@@ -11,7 +11,6 @@ from distutils._log import log\\n \\n \\n class clean(Command):\\n-\\n     description = \\\"clean up temporary files from 'build' command\\\"\\n     user_options = [\\n         ('build-base=', 'b', \\\"base build directory (default: 'build.build-base')\\\"),\\n\",\"diff --git a/setuptools/_distutils/command/config.py b/setuptools/_distutils/command/config.py\\nindex 8bf0e48..494d97d 100644\\n--- a/setuptools/_distutils/command/config.py\\n+++ b/setuptools/_distutils/command/config.py\\n@@ -21,7 +21,6 @@ LANG_EXT = {\\\"c\\\": \\\".c\\\", \\\"c++\\\": \\\".cxx\\\"}\\n \\n \\n class config(Command):\\n-\\n     description = \\\"prepare to build\\\"\\n \\n     user_options = [\\n\",\"diff --git a/setuptools/_distutils/command/install.py b/setuptools/_distutils/command/install.py\\nindex 08d2f88..a7ac4e6 100644\\n--- a/setuptools/_distutils/command/install.py\\n+++ b/setuptools/_distutils/command/install.py\\n@@ -180,7 +180,6 @@ def _pypy_hack(name):\\n \\n \\n class install(Command):\\n-\\n     description = \\\"install everything from build directory\\\"\\n \\n     user_options = [\\n@@ -609,7 +608,7 @@ class install(Command):\\n         for attr in attrs:\\n             val = getattr(self, attr)\\n             if val is not None:\\n-                if os.name == 'posix' or os.name == 'nt':\\n+                if os.name in ('posix', 'nt'):\\n                     val = os.path.expanduser(val)\\n                 val = subst_vars(val, self.config_vars)\\n                 setattr(self, attr, val)\\n\",\"diff --git a/setuptools/_distutils/command/install_data.py b/setuptools/_distutils/command/install_data.py\\nindex d92ed87..7ba35ee 100644\\n--- a/setuptools/_distutils/command/install_data.py\\n+++ b/setuptools/_distutils/command/install_data.py\\n@@ -11,7 +11,6 @@ from ..util import change_root, convert_path\\n \\n \\n class install_data(Command):\\n-\\n     description = \\\"install data files\\\"\\n \\n     user_options = [\\n\",\"diff --git a/setuptools/_distutils/command/install_headers.py b/setuptools/_distutils/command/install_headers.py\\nindex 1cdee82..085272c 100644\\n--- a/setuptools/_distutils/command/install_headers.py\\n+++ b/setuptools/_distutils/command/install_headers.py\\n@@ -8,7 +8,6 @@ from ..core import Command\\n \\n # XXX force is never used\\n class install_headers(Command):\\n-\\n     description = \\\"install C/C++ header files\\\"\\n \\n     user_options = [\\n\",\"diff --git a/setuptools/_distutils/command/install_lib.py b/setuptools/_distutils/command/install_lib.py\\nindex 840d340..be4c243 100644\\n--- a/setuptools/_distutils/command/install_lib.py\\n+++ b/setuptools/_distutils/command/install_lib.py\\n@@ -16,7 +16,6 @@ PYTHON_SOURCE_EXTENSION = \\\".py\\\"\\n \\n \\n class install_lib(Command):\\n-\\n     description = \\\"install all Python modules (extensions and pure Python)\\\"\\n \\n     # The byte-compilation options are a tad confusing.  Here are the\\n\",\"diff --git a/setuptools/_distutils/command/install_scripts.py b/setuptools/_distutils/command/install_scripts.py\\nindex ec6ec5a..20f07aa 100644\\n--- a/setuptools/_distutils/command/install_scripts.py\\n+++ b/setuptools/_distutils/command/install_scripts.py\\n@@ -12,7 +12,6 @@ from stat import ST_MODE\\n \\n \\n class install_scripts(Command):\\n-\\n     description = \\\"install scripts (Python or otherwise)\\\"\\n \\n     user_options = [\\n\",\"diff --git a/setuptools/_distutils/command/register.py b/setuptools/_distutils/command/register.py\\nindex 55c1045..c19aabb 100644\\n--- a/setuptools/_distutils/command/register.py\\n+++ b/setuptools/_distutils/command/register.py\\n@@ -17,7 +17,6 @@ from distutils._log import log\\n \\n \\n class register(PyPIRCCommand):\\n-\\n     description = \\\"register the distribution with the Python package index\\\"\\n     user_options = PyPIRCCommand.user_options + [\\n         ('list-classifiers', None, 'list the valid Trove classifiers'),\\n\",\"diff --git a/setuptools/_distutils/command/upload.py b/setuptools/_distutils/command/upload.py\\nindex 16e15d8..caf15f0 100644\\n--- a/setuptools/_distutils/command/upload.py\\n+++ b/setuptools/_distutils/command/upload.py\\n@@ -27,7 +27,6 @@ _FILE_CONTENT_DIGESTS = {\\n \\n \\n class upload(PyPIRCCommand):\\n-\\n     description = \\\"upload binary package to PyPI\\\"\\n \\n     user_options = PyPIRCCommand.user_options + [\\n\",\"diff --git a/setuptools/_distutils/core.py b/setuptools/_distutils/core.py\\nindex 34cafbc..05d2971 100644\\n--- a/setuptools/_distutils/core.py\\n+++ b/setuptools/_distutils/core.py\\n@@ -132,7 +132,7 @@ def setup(**attrs):  # noqa: C901\\n     # our Distribution (see below).\\n     klass = attrs.get('distclass')\\n     if klass:\\n-        del attrs['distclass']\\n+        attrs.pop('distclass')\\n     else:\\n         klass = Distribution\\n \\n\",\"diff --git a/setuptools/_distutils/cygwinccompiler.py b/setuptools/_distutils/cygwinccompiler.py\\nindex f15b8ee..47efa37 100644\\n--- a/setuptools/_distutils/cygwinccompiler.py\\n+++ b/setuptools/_distutils/cygwinccompiler.py\\n@@ -43,7 +43,7 @@ _msvcr_lookup = RangeMap.left(\\n         # VS2013 / MSVC 12.0\\n         1800: ['msvcr120'],\\n         # VS2015 / MSVC 14.0\\n-        1900: ['ucrt', 'vcruntime140'],\\n+        1900: ['vcruntime140'],\\n         2000: RangeMap.undefined_value,\\n     },\\n )\\n@@ -84,7 +84,6 @@ class CygwinCCompiler(UnixCCompiler):\\n     exe_extension = \\\".exe\\\"\\n \\n     def __init__(self, verbose=0, dry_run=0, force=0):\\n-\\n         super().__init__(verbose, dry_run, force)\\n \\n         status, details = check_config_h()\\n@@ -118,7 +117,7 @@ class CygwinCCompiler(UnixCCompiler):\\n \\n     @property\\n     def gcc_version(self):\\n-        # Older numpy dependend on this existing to check for ancient\\n+        # Older numpy depended on this existing to check for ancient\\n         # gcc versions. This doesn't make much sense with clang etc so\\n         # just hardcode to something recent.\\n         # https://github.com/numpy/numpy/pull/20333\\n@@ -133,7 +132,7 @@ class CygwinCCompiler(UnixCCompiler):\\n \\n     def _compile(self, obj, src, ext, cc_args, extra_postargs, pp_opts):\\n         \\\"\\\"\\\"Compiles the source by spawning GCC and windres if needed.\\\"\\\"\\\"\\n-        if ext == '.rc' or ext == '.res':\\n+        if ext in ('.rc', '.res'):\\n             # gcc needs '.res' and '.rc' compiled to object files !!!\\n             try:\\n                 self.spawn([\\\"windres\\\", \\\"-i\\\", src, \\\"-o\\\", obj])\\n@@ -269,7 +268,6 @@ class Mingw32CCompiler(CygwinCCompiler):\\n     compiler_type = 'mingw32'\\n \\n     def __init__(self, verbose=0, dry_run=0, force=0):\\n-\\n         super().__init__(verbose, dry_run, force)\\n \\n         shared_option = \\\"-shared\\\"\\n\",\"diff --git a/setuptools/_distutils/dir_util.py b/setuptools/_distutils/dir_util.py\\nindex 80f7764..23dc339 100644\\n--- a/setuptools/_distutils/dir_util.py\\n+++ b/setuptools/_distutils/dir_util.py\\n@@ -227,7 +227,7 @@ def remove_tree(directory, verbose=1, dry_run=0):\\n             # remove dir from cache if it's already there\\n             abspath = os.path.abspath(cmd[1])\\n             if abspath in _path_created:\\n-                del _path_created[abspath]\\n+                _path_created.pop(abspath)\\n         except OSError as exc:\\n             log.warning(\\\"error removing %s: %s\\\", directory, exc)\\n \\n\",\"diff --git a/setuptools/_distutils/dist.py b/setuptools/_distutils/dist.py\\nindex d7458a0..7c0f0e5 100644\\n--- a/setuptools/_distutils/dist.py\\n+++ b/setuptools/_distutils/dist.py\\n@@ -237,9 +237,9 @@ Common commands: (see '--help-commands' for more)\\n             options = attrs.get('options')\\n             if options is not None:\\n                 del attrs['options']\\n-                for (command, cmd_options) in options.items():\\n+                for command, cmd_options in options.items():\\n                     opt_dict = self.get_option_dict(command)\\n-                    for (opt, val) in cmd_options.items():\\n+                    for opt, val in cmd_options.items():\\n                         opt_dict[opt] = (\\\"setup script\\\", val)\\n \\n             if 'licence' in attrs:\\n@@ -253,7 +253,7 @@ Common commands: (see '--help-commands' for more)\\n \\n             # Now work on the rest of the attributes.  Any attribute that's\\n             # not already defined is invalid!\\n-            for (key, val) in attrs.items():\\n+            for key, val in attrs.items():\\n                 if hasattr(self.metadata, \\\"set_\\\" + key):\\n                     getattr(self.metadata, \\\"set_\\\" + key)(val)\\n                 elif hasattr(self.metadata, key):\\n@@ -414,7 +414,7 @@ Common commands: (see '--help-commands' for more)\\n         # to set Distribution options.\\n \\n         if 'global' in self.command_options:\\n-            for (opt, (src, val)) in self.command_options['global'].items():\\n+            for opt, (src, val) in self.command_options['global'].items():\\n                 alias = self.negative_opt.get(opt)\\n                 try:\\n                     if alias:\\n@@ -585,7 +585,7 @@ Common commands: (see '--help-commands' for more)\\n             cmd_class.help_options, list\\n         ):\\n             help_option_found = 0\\n-            for (help_option, short, desc, func) in cmd_class.help_options:\\n+            for help_option, short, desc, func in cmd_class.help_options:\\n                 if hasattr(opts, parser.get_attr_name(help_option)):\\n                     help_option_found = 1\\n                     if callable(func):\\n@@ -603,7 +603,7 @@ Common commands: (see '--help-commands' for more)\\n         # Put the options from the command-line into their official\\n         # holding pen, the 'command_options' dictionary.\\n         opt_dict = self.get_option_dict(command)\\n-        for (name, value) in vars(opts).items():\\n+        for name, value in vars(opts).items():\\n             opt_dict[name] = (\\\"command line\\\", value)\\n \\n         return args\\n@@ -696,11 +696,11 @@ Common commands: (see '--help-commands' for more)\\n         for option in self.display_options:\\n             is_display_option[option[0]] = 1\\n \\n-        for (opt, val) in option_order:\\n+        for opt, val in option_order:\\n             if val and is_display_option.get(opt):\\n                 opt = translate_longopt(opt)\\n                 value = getattr(self.metadata, \\\"get_\\\" + opt)()\\n-                if opt in ['keywords', 'platforms']:\\n+                if opt in ('keywords', 'platforms'):\\n                     print(','.join(value))\\n                 elif opt in ('classifiers', 'provides', 'requires', 'obsoletes'):\\n                     print('\\\\n'.join(value))\\n@@ -887,7 +887,7 @@ Common commands: (see '--help-commands' for more)\\n \\n         if DEBUG:\\n             self.announce(\\\"  setting options for '%s' command:\\\" % command_name)\\n-        for (option, (source, value)) in option_dict.items():\\n+        for option, (source, value) in option_dict.items():\\n             if DEBUG:\\n                 self.announce(\\\"    {} = {} (from {})\\\".format(option, value, source))\\n             try:\\n\",\"diff --git a/setuptools/_distutils/fancy_getopt.py b/setuptools/_distutils/fancy_getopt.py\\nindex 6abb884..3b887dc 100644\\n--- a/setuptools/_distutils/fancy_getopt.py\\n+++ b/setuptools/_distutils/fancy_getopt.py\\n@@ -113,7 +113,7 @@ class FancyGetopt:\\n \\n     def _check_alias_dict(self, aliases, what):\\n         assert isinstance(aliases, dict)\\n-        for (alias, opt) in aliases.items():\\n+        for alias, opt in aliases.items():\\n             if alias not in self.option_index:\\n                 raise DistutilsGetoptError(\\n                     (\\\"invalid %s '%s': \\\" \\\"option '%s' not defined\\\")\\n\",\"diff --git a/setuptools/_distutils/file_util.py b/setuptools/_distutils/file_util.py\\nindex 1b7cd53..7c69906 100644\\n--- a/setuptools/_distutils/file_util.py\\n+++ b/setuptools/_distutils/file_util.py\\n@@ -176,7 +176,6 @@ def copy_file(  # noqa: C901\\n \\n # XXX I suspect this is Unix-specific -- need porting help!\\n def move_file(src, dst, verbose=1, dry_run=0):  # noqa: C901\\n-\\n     \\\"\\\"\\\"Move a file 'src' to 'dst'.  If 'dst' is a directory, the file will\\n     be moved into it with the same name; otherwise, 'src' is just renamed\\n     to 'dst'.  Return the new full name of the file.\\n\",\"diff --git a/setuptools/_distutils/msvc9compiler.py b/setuptools/_distutils/msvc9compiler.py\\nindex a4714a5..f9f9f2d 100644\\n--- a/setuptools/_distutils/msvc9compiler.py\\n+++ b/setuptools/_distutils/msvc9compiler.py\\n@@ -391,7 +391,7 @@ class MSVCCompiler(CCompiler):\\n             # to cross compile, you use 'x86_amd64'.\\n             # On AMD64, 'vcvars32.bat amd64' is a native build env; to cross\\n             # compile use 'x86' (ie, it runs the x86 compiler directly)\\n-            if plat_name == get_platform() or plat_name == 'win32':\\n+            if plat_name in (get_platform(), 'win32'):\\n                 # native build or cross-compile to win32\\n                 plat_spec = PLAT_TO_VCVARS[plat_name]\\n             else:\\n@@ -499,7 +499,6 @@ class MSVCCompiler(CCompiler):\\n         extra_postargs=None,\\n         depends=None,\\n     ):\\n-\\n         if not self.initialized:\\n             self.initialize()\\n         compile_info = self._setup_compile(\\n@@ -586,7 +585,6 @@ class MSVCCompiler(CCompiler):\\n     def create_static_lib(\\n         self, objects, output_libname, output_dir=None, debug=0, target_lang=None\\n     ):\\n-\\n         if not self.initialized:\\n             self.initialize()\\n         (objects, output_dir) = self._fix_object_args(objects, output_dir)\\n@@ -619,7 +617,6 @@ class MSVCCompiler(CCompiler):\\n         build_temp=None,\\n         target_lang=None,\\n     ):\\n-\\n         if not self.initialized:\\n             self.initialize()\\n         (objects, output_dir) = self._fix_object_args(objects, output_dir)\\n\",\"diff --git a/setuptools/_distutils/msvccompiler.py b/setuptools/_distutils/msvccompiler.py\\nindex 59ebe99..c3823e2 100644\\n--- a/setuptools/_distutils/msvccompiler.py\\n+++ b/setuptools/_distutils/msvccompiler.py\\n@@ -389,7 +389,6 @@ class MSVCCompiler(CCompiler):\\n         extra_postargs=None,\\n         depends=None,\\n     ):\\n-\\n         if not self.initialized:\\n             self.initialize()\\n         compile_info = self._setup_compile(\\n@@ -476,7 +475,6 @@ class MSVCCompiler(CCompiler):\\n     def create_static_lib(\\n         self, objects, output_libname, output_dir=None, debug=0, target_lang=None\\n     ):\\n-\\n         if not self.initialized:\\n             self.initialize()\\n         (objects, output_dir) = self._fix_object_args(objects, output_dir)\\n@@ -509,7 +507,6 @@ class MSVCCompiler(CCompiler):\\n         build_temp=None,\\n         target_lang=None,\\n     ):\\n-\\n         if not self.initialized:\\n             self.initialize()\\n         (objects, output_dir) = self._fix_object_args(objects, output_dir)\\n\",\"diff --git a/setuptools/_distutils/sysconfig.py b/setuptools/_distutils/sysconfig.py\\nindex 0ec6936..a40a723 100644\\n--- a/setuptools/_distutils/sysconfig.py\\n+++ b/setuptools/_distutils/sysconfig.py\\n@@ -130,12 +130,20 @@ def get_python_inc(plat_specific=0, prefix=None):\\n     return getter(resolved_prefix, prefix, plat_specific)\\n \\n \\n+@pass_none\\n+def _extant(path):\\n+    \\\"\\\"\\\"\\n+    Replace path with None if it doesn't exist.\\n+    \\\"\\\"\\\"\\n+    return path if os.path.exists(path) else None\\n+\\n+\\n def _get_python_inc_posix(prefix, spec_prefix, plat_specific):\\n     if IS_PYPY and sys.version_info < (3, 8):\\n         return os.path.join(prefix, 'include')\\n     return (\\n         _get_python_inc_posix_python(plat_specific)\\n-        or _get_python_inc_from_config(plat_specific, spec_prefix)\\n+        or _extant(_get_python_inc_from_config(plat_specific, spec_prefix))\\n         or _get_python_inc_posix_prefix(prefix)\\n     )\\n \\n@@ -474,7 +482,6 @@ def parse_makefile(fn, g=None):  # noqa: C901\\n                         del notdone[name]\\n \\n                         if name.startswith('PY_') and name[3:] in renamed_variables:\\n-\\n                             name = name[3:]\\n                             if name not in done:\\n                                 done[name] = value\\n\",\"diff --git a/setuptools/_distutils/text_file.py b/setuptools/_distutils/text_file.py\\nindex 7274d4b..36f947e 100644\\n--- a/setuptools/_distutils/text_file.py\\n+++ b/setuptools/_distutils/text_file.py\\n@@ -180,7 +180,6 @@ class TextFile:\\n                 line = None\\n \\n             if self.strip_comments and line:\\n-\\n                 # Look for the first \\\"#\\\" in the line.  If none, never\\n                 # mind.  If we find one and it's the first character, or\\n                 # is not preceded by \\\"\\\\\\\", then it starts a comment --\\n@@ -255,7 +254,7 @@ class TextFile:\\n \\n             # blank line (whether we rstrip'ed or not)? skip to next line\\n             # if appropriate\\n-            if (line == '' or line == '\\\\n') and self.skip_blanks:\\n+            if line in ('', '\\\\n') and self.skip_blanks:\\n                 continue\\n \\n             if self.join_lines:\\n\",\"diff --git a/setuptools/_distutils/unixccompiler.py b/setuptools/_distutils/unixccompiler.py\\nindex 4bf2e6a..6ca2332 100644\\n--- a/setuptools/_distutils/unixccompiler.py\\n+++ b/setuptools/_distutils/unixccompiler.py\\n@@ -103,7 +103,6 @@ def _linker_params(linker_cmd, compiler_cmd):\\n \\n \\n class UnixCCompiler(CCompiler):\\n-\\n     compiler_type = 'unix'\\n \\n     # These are used by CCompiler in two places: the constructor sets\\n\",\"diff --git a/setuptools/_distutils/util.py b/setuptools/_distutils/util.py\\nindex 8668b43..7ef4717 100644\\n--- a/setuptools/_distutils/util.py\\n+++ b/setuptools/_distutils/util.py\\n@@ -228,7 +228,7 @@ def _subst_compat(s):\\n         import warnings\\n \\n         warnings.warn(\\n-            \\\"shell/Perl-style substitions are deprecated\\\",\\n+            \\\"shell/Perl-style substitutions are deprecated\\\",\\n             DeprecationWarning,\\n         )\\n     return repl\\n\",\"diff --git a/setuptools/_distutils/version.py b/setuptools/_distutils/version.py\\nindex e29e265..74c40d7 100644\\n--- a/setuptools/_distutils/version.py\\n+++ b/setuptools/_distutils/version.py\\n@@ -169,7 +169,6 @@ class StrictVersion(Version):\\n             self.prerelease = None\\n \\n     def __str__(self):\\n-\\n         if self.version[2] == 0:\\n             vstring = '.'.join(map(str, self.version[0:2]))\\n         else:\"]", "test_patch": "[\"diff --git a/setuptools/_distutils/ccompiler.py b/setuptools/_distutils/ccompiler.py\\nindex 6463531..f4a8a89 100644\\n--- a/setuptools/_distutils/ccompiler.py\\n+++ b/setuptools/_distutils/ccompiler.py\\n@@ -6,6 +6,7 @@ for the Distutils compiler abstraction model.\\\"\\\"\\\"\\n import sys\\n import os\\n import re\\n+import warnings\\n \\n from .errors import (\\n     CompileError,\\n@@ -388,7 +389,7 @@ class CCompiler:\\n             raise TypeError(\\\"'macros' (if supplied) must be a list of tuples\\\")\\n \\n         if include_dirs is None:\\n-            include_dirs = self.include_dirs\\n+            include_dirs = list(self.include_dirs)\\n         elif isinstance(include_dirs, (list, tuple)):\\n             include_dirs = list(include_dirs) + (self.include_dirs or [])\\n         else:\\n@@ -824,9 +825,19 @@ class CCompiler:\\n         libraries=None,\\n         library_dirs=None,\\n     ):\\n-        \\\"\\\"\\\"Return a boolean indicating whether funcname is supported on\\n-        the current platform.  The optional arguments can be used to\\n-        augment the compilation environment.\\n+        \\\"\\\"\\\"Return a boolean indicating whether funcname is provided as\\n+        a symbol on the current platform.  The optional arguments can\\n+        be used to augment the compilation environment.\\n+\\n+        The libraries argument is a list of flags to be passed to the\\n+        linker to make additional symbol definitions available for\\n+        linking.\\n+\\n+        The includes and include_dirs arguments are deprecated.\\n+        Usually, supplying include files with function declarations\\n+        will cause function detection to fail even in cases where the\\n+        symbol is available for linking.\\n+\\n         \\\"\\\"\\\"\\n         # this can't be included at module scope because it tries to\\n         # import math which might not be available at that point - maybe\\n@@ -835,8 +846,12 @@ class CCompiler:\\n \\n         if includes is None:\\n             includes = []\\n+        else:\\n+            warnings.warn(\\\"includes is deprecated\\\", DeprecationWarning)\\n         if include_dirs is None:\\n             include_dirs = []\\n+        else:\\n+            warnings.warn(\\\"include_dirs is deprecated\\\", DeprecationWarning)\\n         if libraries is None:\\n             libraries = []\\n         if library_dirs is None:\\n@@ -845,7 +860,24 @@ class CCompiler:\\n         f = os.fdopen(fd, \\\"w\\\")\\n         try:\\n             for incl in includes:\\n-                f.write(\\\"\\\"\\\"#include \\\"%s\\\"\\\\n\\\"\\\"\\\" % incl)\\n+                f.write(\\\"\\\"\\\"#include %s\\\\n\\\"\\\"\\\" % incl)\\n+            if not includes:\\n+                # Use \\\"char func(void);\\\" as the prototype to follow\\n+                # what autoconf does.  This prototype does not match\\n+                # any well-known function the compiler might recognize\\n+                # as a builtin, so this ends up as a true link test.\\n+                # Without a fake prototype, the test would need to\\n+                # know the exact argument types, and the has_function\\n+                # interface does not provide that level of information.\\n+                f.write(\\n+                    \\\"\\\"\\\"\\\\\\n+#ifdef __cplusplus\\n+extern \\\"C\\\"\\n+#endif\\n+char %s(void);\\n+\\\"\\\"\\\"\\n+                    % funcname\\n+                )\\n             f.write(\\n                 \\\"\\\"\\\"\\\\\\n int main (int argc, char **argv) {\\n@@ -871,7 +903,9 @@ int main (int argc, char **argv) {\\n         except (LinkError, TypeError):\\n             return False\\n         else:\\n-            os.remove(os.path.join(self.output_dir or '', \\\"a.out\\\"))\\n+            os.remove(\\n+                self.executable_filename(\\\"a.out\\\", output_dir=self.output_dir or '')\\n+            )\\n         finally:\\n             for fn in objects:\\n                 os.remove(fn)\\n\",\"diff --git a/setuptools/_distutils/command/sdist.py b/setuptools/_distutils/command/sdist.py\\nindex 5cfd4c1..ac48972 100644\\n--- a/setuptools/_distutils/command/sdist.py\\n+++ b/setuptools/_distutils/command/sdist.py\\n@@ -33,7 +33,6 @@ def show_formats():\\n \\n \\n class sdist(Command):\\n-\\n     description = \\\"create a source distribution (tarball, zip file, etc.)\\\"\\n \\n     def checking_metadata(self):\\n@@ -235,7 +234,7 @@ class sdist(Command):\\n         \\\"\\\"\\\"Add all the default files to self.filelist:\\n           - README or README.txt\\n           - setup.py\\n-          - test/test*.py\\n+          - tests/test*.py and test/test*.py\\n           - all pure Python modules mentioned in setup script\\n           - all files pointed by package_data (build_py)\\n           - all files defined in data_files.\\n@@ -293,7 +292,7 @@ class sdist(Command):\\n                     self.warn(\\\"standard file '%s' not found\\\" % fn)\\n \\n     def _add_defaults_optional(self):\\n-        optional = ['test/test*.py', 'setup.cfg']\\n+        optional = ['tests/test*.py', 'test/test*.py', 'setup.cfg']\\n         for pattern in optional:\\n             files = filter(os.path.isfile, glob(pattern))\\n             self.filelist.extend(files)\\n\",\"diff --git a/setuptools/_distutils/tests/test_archive_util.py b/setuptools/_distutils/tests/test_archive_util.py\\nindex 7778c3a..89c415d 100644\\n--- a/setuptools/_distutils/tests/test_archive_util.py\\n+++ b/setuptools/_distutils/tests/test_archive_util.py\\n@@ -289,7 +289,7 @@ class ArchiveUtilTestCase(support.TempdirManager):\\n                 pass\\n             assert os.getcwd() == current_dir\\n         finally:\\n-            del ARCHIVE_FORMATS['xxx']\\n+            ARCHIVE_FORMATS.pop('xxx')\\n \\n     def test_make_archive_tar(self):\\n         base_dir = self._create_files()\\n\",\"diff --git a/setuptools/_distutils/tests/test_bdist_dumb.py b/setuptools/_distutils/tests/test_bdist_dumb.py\\nindex b9bec05..6fb50c4 100644\\n--- a/setuptools/_distutils/tests/test_bdist_dumb.py\\n+++ b/setuptools/_distutils/tests/test_bdist_dumb.py\\n@@ -29,7 +29,6 @@ class TestBuildDumb(\\n ):\\n     @pytest.mark.usefixtures('needs_zlib')\\n     def test_simple_built(self):\\n-\\n         # let's create a simple package\\n         tmp_dir = self.mkdtemp()\\n         pkg_dir = os.path.join(tmp_dir, 'foo')\\n\",\"diff --git a/setuptools/_distutils/tests/test_build_clib.py b/setuptools/_distutils/tests/test_build_clib.py\\nindex 709d0b7..b5a392a 100644\\n--- a/setuptools/_distutils/tests/test_build_clib.py\\n+++ b/setuptools/_distutils/tests/test_build_clib.py\\n@@ -71,7 +71,6 @@ class TestBuildCLib(support.TempdirManager):\\n         assert cmd.get_source_files() == ['a', 'b', 'c', 'd']\\n \\n     def test_build_libraries(self):\\n-\\n         pkg_dir, dist = self.create_dist()\\n         cmd = build_clib(dist)\\n \\n\",\"diff --git a/setuptools/_distutils/tests/test_build_ext.py b/setuptools/_distutils/tests/test_build_ext.py\\nindex f505848..cb61ad7 100644\\n--- a/setuptools/_distutils/tests/test_build_ext.py\\n+++ b/setuptools/_distutils/tests/test_build_ext.py\\n@@ -158,7 +158,7 @@ class TestBuildExt(TempdirManager):\\n         cmd = self.build_ext(dist)\\n \\n         # making sure the user option is there\\n-        options = [name for name, short, lable in cmd.user_options]\\n+        options = [name for name, short, label in cmd.user_options]\\n         assert 'user' in options\\n \\n         # setting a value\\n@@ -180,7 +180,6 @@ class TestBuildExt(TempdirManager):\\n         assert incl in cmd.include_dirs\\n \\n     def test_optional_extension(self):\\n-\\n         # this extension will fail, but let's ignore this failure\\n         # with the optional argument.\\n         modules = [Extension('foo', ['xxx'], optional=False)]\\n\",\"diff --git a/setuptools/_distutils/tests/test_ccompiler.py b/setuptools/_distutils/tests/test_ccompiler.py\\nindex da1879f..88497d2 100644\\n--- a/setuptools/_distutils/tests/test_ccompiler.py\\n+++ b/setuptools/_distutils/tests/test_ccompiler.py\\n@@ -53,3 +53,40 @@ def test_set_include_dirs(c_file):\\n     # do it again, setting include dirs after any initialization\\n     compiler.set_include_dirs([python])\\n     compiler.compile(_make_strs([c_file]))\\n+\\n+\\n+def test_has_function_prototype():\\n+    # Issue https://github.com/pypa/setuptools/issues/3648\\n+    # Test prototype-generating behavior.\\n+\\n+    compiler = ccompiler.new_compiler()\\n+\\n+    # Every C implementation should have these.\\n+    assert compiler.has_function('abort')\\n+    assert compiler.has_function('exit')\\n+    with pytest.deprecated_call(match='includes is deprecated'):\\n+        # abort() is a valid expression with the <stdlib.h> prototype.\\n+        assert compiler.has_function('abort', includes=['<stdlib.h>'])\\n+    with pytest.deprecated_call(match='includes is deprecated'):\\n+        # But exit() is not valid with the actual prototype in scope.\\n+        assert not compiler.has_function('exit', includes=['<stdlib.h>'])\\n+    # And setuptools_does_not_exist is not declared or defined at all.\\n+    assert not compiler.has_function('setuptools_does_not_exist')\\n+    with pytest.deprecated_call(match='includes is deprecated'):\\n+        assert not compiler.has_function(\\n+            'setuptools_does_not_exist', includes=['<stdio.h>']\\n+        )\\n+\\n+\\n+def test_include_dirs_after_multiple_compile_calls(c_file):\\n+    \\\"\\\"\\\"\\n+    Calling compile multiple times should not change the include dirs\\n+    (regression test for setuptools issue #3591).\\n+    \\\"\\\"\\\"\\n+    compiler = ccompiler.new_compiler()\\n+    python = sysconfig.get_paths()['include']\\n+    compiler.set_include_dirs([python])\\n+    compiler.compile(_make_strs([c_file]))\\n+    assert compiler.include_dirs == [python]\\n+    compiler.compile(_make_strs([c_file]))\\n+    assert compiler.include_dirs == [python]\\n\",\"diff --git a/setuptools/_distutils/tests/test_check.py b/setuptools/_distutils/tests/test_check.py\\nindex 5465406..6d240b8 100644\\n--- a/setuptools/_distutils/tests/test_check.py\\n+++ b/setuptools/_distutils/tests/test_check.py\\n@@ -152,8 +152,7 @@ class TestCheck(support.TempdirManager):\\n         pytest.importorskip('docutils')\\n         # Don't fail if there is a `code` or `code-block` directive\\n \\n-        example_rst_docs = []\\n-        example_rst_docs.append(\\n+        example_rst_docs = [\\n             textwrap.dedent(\\n                 \\\"\\\"\\\"\\\\\\n             Here's some code:\\n@@ -163,9 +162,7 @@ class TestCheck(support.TempdirManager):\\n                 def foo():\\n                     pass\\n             \\\"\\\"\\\"\\n-            )\\n-        )\\n-        example_rst_docs.append(\\n+            ),\\n             textwrap.dedent(\\n                 \\\"\\\"\\\"\\\\\\n             Here's some code:\\n@@ -175,8 +172,8 @@ class TestCheck(support.TempdirManager):\\n                 def foo():\\n                     pass\\n             \\\"\\\"\\\"\\n-            )\\n-        )\\n+            ),\\n+        ]\\n \\n         for rest_with_code in example_rst_docs:\\n             pkg_info, dist = self.create_dist(long_description=rest_with_code)\\n\",\"diff --git a/setuptools/_distutils/tests/test_cmd.py b/setuptools/_distutils/tests/test_cmd.py\\nindex 3aac448..cc740d1 100644\\n--- a/setuptools/_distutils/tests/test_cmd.py\\n+++ b/setuptools/_distutils/tests/test_cmd.py\\n@@ -58,7 +58,6 @@ class TestCommand:\\n         cmd.make_file(infiles='in', outfile='out', func='func', args=())\\n \\n     def test_dump_options(self, cmd):\\n-\\n         msgs = []\\n \\n         def _announce(msg, level):\\n\",\"diff --git a/setuptools/_distutils/tests/test_cygwinccompiler.py b/setuptools/_distutils/tests/test_cygwinccompiler.py\\nindex ef01ae2..6fb449a 100644\\n--- a/setuptools/_distutils/tests/test_cygwinccompiler.py\\n+++ b/setuptools/_distutils/tests/test_cygwinccompiler.py\\n@@ -47,7 +47,6 @@ class TestCygwinCCompiler(support.TempdirManager):\\n         assert compiler.runtime_library_dir_option('/foo') == []\\n \\n     def test_check_config_h(self):\\n-\\n         # check_config_h looks for \\\"GCC\\\" in sys.version first\\n         # returns CONFIG_H_OK if found\\n         sys.version = (\\n@@ -72,7 +71,6 @@ class TestCygwinCCompiler(support.TempdirManager):\\n         assert check_config_h()[0] == CONFIG_H_OK\\n \\n     def test_get_msvcr(self):\\n-\\n         # none\\n         sys.version = (\\n             '2.6.1 (r261:67515, Dec  6 2008, 16:42:21) '\\n@@ -108,7 +106,7 @@ class TestCygwinCCompiler(support.TempdirManager):\\n             '3.10.0 (tags/v3.10.0:b494f59, Oct  4 2021, 18:46:30) '\\n             '[MSC v.1929 32 bit (Intel)]'\\n         )\\n-        assert get_msvcr() == ['ucrt', 'vcruntime140']\\n+        assert get_msvcr() == ['vcruntime140']\\n \\n         # unknown\\n         sys.version = (\\n\",\"diff --git a/setuptools/_distutils/tests/test_dep_util.py b/setuptools/_distutils/tests/test_dep_util.py\\nindex 2dcce1d..e5dcad9 100644\\n--- a/setuptools/_distutils/tests/test_dep_util.py\\n+++ b/setuptools/_distutils/tests/test_dep_util.py\\n@@ -9,7 +9,6 @@ import pytest\\n \\n class TestDepUtil(support.TempdirManager):\\n     def test_newer(self):\\n-\\n         tmpdir = self.mkdtemp()\\n         new_file = os.path.join(tmpdir, 'new')\\n         old_file = os.path.abspath(__file__)\\n\",\"diff --git a/setuptools/_distutils/tests/test_dir_util.py b/setuptools/_distutils/tests/test_dir_util.py\\nindex 0c6db4a..72aca4e 100644\\n--- a/setuptools/_distutils/tests/test_dir_util.py\\n+++ b/setuptools/_distutils/tests/test_dir_util.py\\n@@ -51,7 +51,6 @@ class TestDirUtil(support.TempdirManager):\\n         assert stat.S_IMODE(os.stat(self.target2).st_mode) == 0o555 & ~umask\\n \\n     def test_create_tree_verbosity(self, caplog):\\n-\\n         create_tree(self.root_target, ['one', 'two', 'three'], verbose=0)\\n         assert caplog.messages == []\\n         remove_tree(self.root_target, verbose=0)\\n@@ -63,7 +62,6 @@ class TestDirUtil(support.TempdirManager):\\n         remove_tree(self.root_target, verbose=0)\\n \\n     def test_copy_tree_verbosity(self, caplog):\\n-\\n         mkpath(self.target, verbose=0)\\n \\n         copy_tree(self.target, self.target2, verbose=0)\\n\",\"diff --git a/setuptools/_distutils/tests/test_dist.py b/setuptools/_distutils/tests/test_dist.py\\nindex b5e81d0..30a6f9f 100644\\n--- a/setuptools/_distutils/tests/test_dist.py\\n+++ b/setuptools/_distutils/tests/test_dist.py\\n@@ -142,7 +142,7 @@ class TestDistributionBehavior(support.TempdirManager):\\n             result_dict.keys()\\n         )\\n \\n-        for (key, value) in d.command_options.get('install').items():\\n+        for key, value in d.command_options.get('install').items():\\n             assert value == result_dict[key]\\n \\n         # Test case: In a Virtual Environment\\n\",\"diff --git a/setuptools/_distutils/tests/test_install.py b/setuptools/_distutils/tests/test_install.py\\nindex 102218b..3f525db 100644\\n--- a/setuptools/_distutils/tests/test_install.py\\n+++ b/setuptools/_distutils/tests/test_install.py\\n@@ -100,7 +100,7 @@ class TestInstall(\\n         cmd = install(dist)\\n \\n         # making sure the user option is there\\n-        options = [name for name, short, lable in cmd.user_options]\\n+        options = [name for name, short, label in cmd.user_options]\\n         assert 'user' in options\\n \\n         # setting a value\\n\",\"diff --git a/setuptools/_distutils/tests/test_register.py b/setuptools/_distutils/tests/test_register.py\\nindex a10393b..34e5932 100644\\n--- a/setuptools/_distutils/tests/test_register.py\\n+++ b/setuptools/_distutils/tests/test_register.py\\n@@ -158,7 +158,6 @@ class TestRegister(BasePyPIRCCommandTestCase):\\n         assert b'xxx' in self.conn.reqs[1].data\\n \\n     def test_password_not_in_file(self):\\n-\\n         self.write_file(self.rc, PYPIRC_NOPASSWORD)\\n         cmd = self._get_cmd()\\n         cmd._set_config()\\n\",\"diff --git a/setuptools/_distutils/tests/test_sdist.py b/setuptools/_distutils/tests/test_sdist.py\\nindex 9750472..fdb768e 100644\\n--- a/setuptools/_distutils/tests/test_sdist.py\\n+++ b/setuptools/_distutils/tests/test_sdist.py\\n@@ -162,7 +162,6 @@ class TestSDist(BasePyPIRCCommandTestCase):\\n \\n     @pytest.mark.usefixtures('needs_zlib')\\n     def test_add_defaults(self):\\n-\\n         # http://bugs.python.org/issue2279\\n \\n         # add_default should also include\\n\",\"diff --git a/setuptools/_distutils/tests/test_sysconfig.py b/setuptools/_distutils/tests/test_sysconfig.py\\nindex 66f92c2..bfeaf9a 100644\\n--- a/setuptools/_distutils/tests/test_sysconfig.py\\n+++ b/setuptools/_distutils/tests/test_sysconfig.py\\n@@ -297,3 +297,22 @@ class TestSysconfig:\\n             cmd, env={**os.environ, \\\"PYTHONPATH\\\": distutils_path}\\n         )\\n         assert out == \\\"True\\\"\\n+\\n+    def test_get_python_inc_missing_config_dir(self, monkeypatch):\\n+        \\\"\\\"\\\"\\n+        In portable Python installations, the sysconfig will be broken,\\n+        pointing to the directories where the installation was built and\\n+        not where it currently is. In this case, ensure that the missing\\n+        directory isn't used for get_python_inc.\\n+\\n+        See pypa/distutils#178.\\n+        \\\"\\\"\\\"\\n+\\n+        def override(name):\\n+            if name == 'INCLUDEPY':\\n+                return '/does-not-exist'\\n+            return sysconfig.get_config_var(name)\\n+\\n+        monkeypatch.setattr(sysconfig, 'get_config_var', override)\\n+\\n+        assert os.path.exists(sysconfig.get_python_inc())\\n\",\"diff --git a/setuptools/_distutils/tests/test_unixccompiler.py b/setuptools/_distutils/tests/test_unixccompiler.py\\nindex 3978c23..a018442 100644\\n--- a/setuptools/_distutils/tests/test_unixccompiler.py\\n+++ b/setuptools/_distutils/tests/test_unixccompiler.py\\n@@ -303,4 +303,4 @@ class TestUnixCCompiler(support.TempdirManager):\\n         # FileNotFoundError: [Errno 2] No such file or directory: 'a.out'\\n         self.cc.output_dir = 'scratch'\\n         os.chdir(self.mkdtemp())\\n-        self.cc.has_function('abort', includes=['stdlib.h'])\\n+        self.cc.has_function('abort')\\n\",\"diff --git a/setuptools/_distutils/tests/test_upload.py b/setuptools/_distutils/tests/test_upload.py\\nindex 9685c06..af113b8 100644\\n--- a/setuptools/_distutils/tests/test_upload.py\\n+++ b/setuptools/_distutils/tests/test_upload.py\\n@@ -77,7 +77,6 @@ class TestUpload(BasePyPIRCCommandTestCase):\\n         return self.last_open\\n \\n     def test_finalize_options(self):\\n-\\n         # new format\\n         self.write_file(self.rc, PYPIRC)\\n         dist = Distribution()\\n\"]", "hints_text": ""}
