{"instance_id": "716243164488095", "repo": "lf1-io/padl", "base_commit": "be0ce5a988bd5ea65986e85f474a602b9f7f84a8", "problem_statement": "Support for old variables:\\n## ğŸ›°ï¸ Feature\\r\\n\\r\\nIn `aleph` we had variables which could be specified at load time, and which were not saved with the model (because that didn't necessarily always make sense.\\r\\n\\r\\nAt load time we had `load(path, some_variable_to_be_changed=<value>)`. This makes sense for many training scenarios. ", "FAIL_TO_PASS": ["tests/unittests/test_transforms.py::TestParam::test_no_default", "tests/unittests/dumptools/test_sourceget.py::TestReplace::test_a1", "tests/unittests/dumptools/test_sourceget.py::TestReplace::test_b", "tests/unittests/dumptools/test_sourceget.py::TestReplace::test_a", "tests/unittests/test_transforms.py::TestParam::test_wrong_param", "tests/unittests/test_transforms.py::TestParam::test_param_works"], "PASS_TO_PASS": ["tests/unittests/dumptools/test_inspector.py::TestGetSurroundingBlock::test_hanging_arguments_5", "tests/unittests/test_transforms.py::TestRollout::test_eval_apply", "tests/unittests/dumptools/test_inspector.py::TestCallerInfo::test_double_nested", "tests/unittests/test_thingfinder.py::test__get_call_assignments_a", "tests/unittests/test_transforms.py::TestClassInstance::test_infer_apply", "tests/unittests/test_transforms.py::TestClassInstance::test_pd_parameters", "tests/unittests/test_util_transforms.py::TestTry::test_stages_1", "tests/unittests/test_transforms.py::TestMap::test_pd_preprocess", "tests/unittests/dumptools/test_serialize.py::test_save_by_value", "tests/unittests/test_transforms.py::TestAssertNoDoubleBatch::test_no_double", "tests/unittests/test_dump.py::test_pipeline_dump_a", "tests/unittests/test_transforms.py::TestModel::test_pd_preprocess", "tests/unittests/test_dump.py::test_dotimport", "tests/unittests/test_transforms.py::TestRollout::test_pprintt", "tests/unittests/test_wrap.py::test_function_a", "tests/unittests/test_dump.py::test_setcomp_a", "tests/unittests/test_transforms.py::TestCompose::test_all_transforms_1", "tests/unittests/dumptools/test_inspector.py::TestGetSurroundingBlock::test_hanging_arguments_4", "tests/unittests/test_transforms.py::TestCompose::test_save_and_load", "tests/unittests/test_transforms.py::TestFunctionTransform::test_infer_apply", "tests/unittests/dumptools/test_inspector.py::TestGetSurroundingBlock::test_hanging_arguments_2", "tests/unittests/test_transforms.py::TestRollout::test_save_and_load", "tests/unittests/dumptools/test_inspector.py::TestGetStatement::test_simple_1", "tests/unittests/test_transforms.py::TestFunctionTransform::test_pd_forward", "tests/unittests/test_dump.py::TestOtherModule::test_import_wrapped", "tests/unittests/dumptools/test_var2mod.py::TestFindGlobals::test_find_in_assignment", "tests/unittests/test_transforms.py::TestNamedTupleOutput::test_call", "tests/unittests/test_dump.py::TestOtherModule::test_import_makefunction_squared", "tests/unittests/test_transforms.py::TestRollout::test_pd_postprocess", "tests/unittests/test_thingfinder.py::test__get_call_assignments_e", "tests/unittests/test_transforms.py::test_name", "tests/unittests/test_transforms.py::TestTransformDeviceCheck::test_device_check", "tests/unittests/test_transforms.py::TestTorchModuleTransformWithJit::test_eval_apply", "tests/unittests/test_transforms.py::TestTorchModuleTransformWithJit::test_pd_layers", "tests/unittests/dumptools/test_inspector.py::TestGetStatement::test_simple_2", "tests/unittests/test_wrap.py::test_class_a", "tests/unittests/test_transforms.py::TestCompose::test_unbatchify_position", "tests/unittests/test_transforms.py::TestClassTransform::test_stored_arguments", "tests/unittests/test_util_transforms.py::TestTry::test_no_multistage_try", "tests/unittests/test_transforms.py::TestModel::test_pd_splits_compose_with_group", "tests/unittests/test_transforms.py::TestAssertNoDoubleBatch::test_double_1", "tests/unittests/test_transforms.py::TestNamedTupleOutput::test_train_apply", "tests/unittests/test_dump.py::TestOtherModule::test_import_pipeline", "tests/unittests/test_transforms.py::TestFunctionTransform::test_pd_to", "tests/unittests/test_util_transforms.py::TestIfInMode::test_train_apply", "tests/unittests/test_transforms.py::TestTrace::test_pd_trace", "tests/unittests/test_transforms.py::TestCompose::test_all_transforms_2", "tests/unittests/test_thingfinder.py::test__get_call_assignments_c", "tests/unittests/test_transforms.py::TestClassTransform::test_save_and_load", "tests/unittests/test_transforms.py::TestClassInstance::test_print", "tests/unittests/test_dump.py::TestOtherModule::test_full_makeclasstransform_with_constants", "tests/unittests/test_transforms.py::TestModel::test_eval_apply", "tests/unittests/test_transforms.py::TestModel::test_pd_splits_compose", "tests/unittests/test_transforms.py::TestCompose::test_train_apply", "tests/unittests/test_transforms.py::TestCompose::test_pd_forward", "tests/unittests/test_thingfinder.py::test__get_call_assignments_b", "tests/unittests/test_transforms.py::TestMap::test_pprintt", "tests/unittests/test_transforms.py::test_identity_compose_saves", "tests/unittests/test_dump.py::test_lambda_b", "tests/unittests/test_transforms.py::TestClassInstance::test_long_list", "tests/unittests/dumptools/test_inspector.py::TestGetStatement::test_multiline_5", "tests/unittests/test_transforms.py::TestRollout::test_identity_split", "tests/unittests/dumptools/test_sourceget.py::TestCut::test_single_line", "tests/unittests/test_transforms.py::TestMap::test_infer_apply", "tests/unittests/test_transforms.py::TestClassInstance::test_train_apply", "tests/unittests/test_dump.py::test_dictcomp_a", "tests/unittests/test_transforms.py::TestMap::test_pd_postprocess", "tests/unittests/test_transforms.py::TestCompose::test_pprintt", "tests/unittests/test_dump.py::TestOtherModule::test_full_pipeline", "tests/unittests/test_transforms.py::TestCompose::test_getitem", "tests/unittests/test_transforms.py::TestRollout::test_pd_preprocess", "tests/unittests/dumptools/test_var2mod.py::TestFindGlobals::test_complex_statement_1", "tests/unittests/test_transforms.py::TestAssertNoDoubleBatch::test_double_3", "tests/unittests/dumptools/test_inspector.py::TestCallerInfo::test_nested", "tests/unittests/dumptools/test_symfinder.py::test_annassign", "tests/unittests/test_dump.py::test_lambda_a", "tests/unittests/test_transforms.py::TestTorchModuleTransformWithJit::test_type", "tests/unittests/test_transforms.py::TestClassInstance::test_save_and_load", "tests/unittests/test_dump.py::test_nested_dump_c", "tests/unittests/dumptools/test_inspector.py::TestGetStatement::test_multiline_3", "tests/unittests/test_dump.py::test_with_raises", "tests/unittests/test_transforms.py::TestModel::test_pd_splits_rollout", "tests/unittests/test_transforms.py::TestClassInstance::test_eval_apply", "tests/unittests/test_transforms.py::TestComposeWithComments::test_function_1", "tests/unittests/test_util_transforms.py::TestIfInMode::test_infer_apply", "tests/unittests/test_transforms.py::TestAssertNoDoubleBatch::test_double_4", "tests/unittests/test_transforms.py::TestClassInstance::test_pd_layers", "tests/unittests/test_transforms.py::TestCompose::test_infer_apply", "tests/unittests/test_transforms.py::TestCompose::test_associative", "tests/unittests/test_wrap.py::test_function_b", "tests/unittests/test_transforms.py::TestFunctionTransform::test_all_transforms", "tests/unittests/test_transforms.py::TestParallel::test_pd_forward", "tests/unittests/test_util_transforms.py::TestTry::test_infer_apply", "tests/unittests/test_transforms.py::TestFunctionTransform::test_save_and_load", "tests/unittests/test_dump.py::TestOtherModule::test_full_object", "tests/unittests/test_wrap.py::test_raise", "tests/unittests/test_transforms.py::TestMap::test_train_apply", "tests/unittests/test_transforms.py::TestClassTransform::test_infer_apply", "tests/unittests/dumptools/test_var2mod.py::TestFindGlobals::test_find_same_name", "tests/unittests/dumptools/test_inspector.py::TestCallerInfo::test_toplevel", "tests/unittests/test_transforms.py::TestPADLCallTransform::test_pprintt", "tests/unittests/test_transforms.py::TestFunctionTransform::test_pd_postprocess", "tests/unittests/test_transforms.py::TestAssertNoDoubleBatch::test_double_2", "tests/unittests/test_dump.py::test_dump_a", "tests/unittests/test_transforms.py::TestTorchModuleTransformWithJit::test_pd_parameters", "tests/unittests/test_transforms.py::TestModel::test_pd_forward", "tests/unittests/test_transforms.py::TestComposeWithComments::test_identity", "tests/unittests/test_dump.py::TestOtherModule::test_import_makelambda", "tests/unittests/test_utils.py::test_same", "tests/unittests/test_dump.py::test_recursive", "tests/unittests/test_dump.py::TestOtherModule::test_import_function", "tests/unittests/test_thingfinder.py::test__get_call_signature_a", "tests/unittests/test_transforms.py::TestMap::test_save_and_load", "tests/unittests/test_dump.py::test_dumping_indexset", "tests/unittests/test_dump.py::TestOtherModule::test_full_makeclass", "tests/unittests/test_transforms.py::TestClassInstance::test_wrap", "tests/unittests/test_dump.py::test_if_train", "tests/unittests/test_transforms.py::TestParallel::test_pd_preprocess", "tests/unittests/test_transforms.py::TestPADLCallTransform::test_save_load", "tests/unittests/test_transforms.py::TestModel::test_pprintt", "tests/unittests/test_transforms.py::TestParallel::test_eval_apply", "tests/unittests/test_dump.py::test_pipeline_dump_c", "tests/unittests/test_transforms.py::TestNamedTupleOutput::test_infer_apply", "tests/unittests/test_transforms.py::TestCompose::test_eval_apply", "tests/unittests/test_dump.py::test_nested_dump_a", "tests/unittests/test_transforms.py::TestRollout::test_pd_forward", "tests/unittests/dumptools/test_var2mod.py::TestFindGlobals::test_dots", "tests/unittests/test_transforms.py::TestModel::test_train_apply", "tests/unittests/test_dump.py::test_grouped_dump_a", "tests/unittests/test_dump.py::test_listcomp_b", "tests/unittests/test_transforms.py::TestRollout::test_output", "tests/unittests/test_dump.py::test_dump_b", "tests/unittests/test_dump.py::test_multiline_init", "tests/unittests/test_thingfinder.py::test__get_call_assignments_d", "tests/unittests/test_transforms.py::TestFunctionTransform::test_pd_preprocess", "tests/unittests/test_util_transforms.py::TestTry::test_no_multistage_else", "tests/unittests/test_transforms.py::TestTorchModuleTransformWithJit::test_methods", "tests/unittests/test_wrap.py::TestModuleWrap::test_save_load", "tests/unittests/dumptools/test_inspector.py::TestGetStatement::test_multiline_1", "tests/unittests/test_dump.py::TestOtherModule::test_import_object", "tests/unittests/test_transforms.py::TestComposeWithComments::test_lambda_1", "tests/unittests/test_transforms.py::TestMap::test_eval_apply", "tests/unittests/test_dump.py::test_nested_dump_d", "tests/unittests/test_transforms.py::TestComposeWithComments::test_function_2", "tests/unittests/test_dump.py::TestOtherModule::test_full_makefunction", "tests/unittests/test_transforms.py::TestModel::test_pd_splits_parallel", "tests/unittests/test_transforms.py::TestParallel::test_pd_postprocess", "tests/unittests/test_transforms.py::TestFunctionTransform::test_eval_apply", "tests/unittests/test_util_transforms.py::TestIfInMode::test_save_and_load", "tests/unittests/test_dump.py::test_dump_hanging_indent", "tests/unittests/test_transforms.py::TestRollout::test_infer_apply", "tests/unittests/dumptools/test_var2mod.py::TestFindGlobals::test_attribute", "tests/unittests/dumptools/test_inspector.py::TestGetStatement::test_multiline_4", "tests/unittests/test_transforms.py::TestParallel::test_pprintt", "tests/unittests/test_dump.py::TestOtherModule::test_import_class", "tests/unittests/test_dump.py::test_listcomp_a", "tests/unittests/test_util_transforms.py::TestTry::test_train_apply", "tests/unittests/test_transforms.py::TestModel::test_infer_apply", "tests/unittests/test_transforms.py::test_isinstance_of_namedtuple", "tests/unittests/test_util_transforms.py::TestIfInMode::test_eval_apply", "tests/unittests/test_transforms.py::TestTorchModuleTransform::test_pd_parameters", "tests/unittests/test_transforms.py::TestTorchModuleTransform::test_output", "tests/unittests/test_transforms.py::TestParallel::test_save_and_load", "tests/unittests/test_thingfinder.py::test__get_call_signature_b", "tests/unittests/test_dump.py::TestOtherModule::test_full_class", "tests/unittests/dumptools/test_inspector.py::TestGetStatement::test_multiline_2", "tests/unittests/test_transforms.py::TestTorchModuleTransform::test_device", "tests/unittests/test_transforms.py::TestTorchModuleTransform::test_infer_apply", "tests/unittests/test_dump.py::TestOtherModule::test_full_makeclasstransform", "tests/unittests/test_transforms.py::TestTorchModuleTransformWithJit::test_device", "tests/unittests/test_util_transforms.py::TestTry::test_save_and_load", "tests/unittests/test_dump.py::TestOtherModule::test_full_function", "tests/unittests/test_transforms.py::TestCompose::test_pd_postprocess", "tests/unittests/test_transforms.py::TestTorchModuleTransformWithJit::test_save_and_load", "tests/unittests/test_transforms.py::TestModel::test_save_and_load", "tests/unittests/test_transforms.py::TestTorchModuleTransformWithJit::test_infer_apply", "tests/unittests/test_transforms.py::TestMap::test_pd_forward", "tests/unittests/dumptools/test_inspector.py::TestGetSurroundingBlock::test_hanging_arguments_3", "tests/unittests/test_transforms.py::TestPADLCallTransform::test_infer_apply", "tests/unittests/test_transforms.py::TestCompose::test_pd_preprocess", "tests/unittests/test_transforms.py::TestModel::test_pd_postprocess", "tests/unittests/test_transforms.py::TestParallel::test_output", "tests/unittests/test_dump.py::TestOtherModule::test_import_makeclass_squared", "tests/unittests/test_util_transforms.py::TestTry::test_no_multistage_catch", "tests/unittests/test_transforms.py::TestParallel::test_infer_apply", "tests/unittests/test_transforms.py::TestCompose::test_output", "tests/unittests/dumptools/test_inspector.py::TestGetStatement::test_function", "tests/unittests/test_transforms.py::TestTorchModuleTransformWithJit::test_output", "tests/unittests/test_transforms.py::TestComposeWithComments::test_lambda_2", "tests/unittests/test_dump.py::test_dump_class_a", "tests/unittests/test_transforms.py::TestTorchModuleTransform::test_pd_layers", "tests/unittests/dumptools/test_inspector.py::TestGetSurroundingBlock::test_hanging_arguments_1", "tests/unittests/test_thingfinder.py::test__get_call_assignments_f", "tests/unittests/test_dump.py::test_pipeline_dump_b", "tests/unittests/test_transforms.py::TestTorchModuleTransform::test_save_and_load", "tests/unittests/test_util_transforms.py::TestTry::test_eval_apply", "tests/unittests/test_packagefinder.py::test_getpackages", "tests/unittests/test_transforms.py::TestNamedTupleOutput::test_eval_apply", "tests/unittests/test_dump.py::test_dumping_selfassign"], "language": "python", "test_command": "source /saved/ENV || source /saved/*/ENV && pytest --no-header -rA --tb=no -p no:cacheprovider --continue-on-collection-errors", "test_output_parser": "python/parse_log_pytest_v3", "image_storage_uri": "vmvm-registry.fbinfra.net/repomate_image_activ_pytest/lf1-io_padl:be0ce5a988bd5ea65986e85f474a602b9f7f84a8", "patch": "", "test_patch": "[\"diff --git a/tests/material/relative_import.py b/tests/material/relative_import.py\\nnew file mode 100644\\nindex 00000000..13fcb370\\n--- /dev/null\\n+++ b/tests/material/relative_import.py\\n@@ -0,0 +1,2 @@\\n+from . import transforms_in_module as tim\\n+from .transforms_in_module import function\\n\",\"diff --git a/tests/unittests/dumptools/test_sourceget.py b/tests/unittests/dumptools/test_sourceget.py\\nindex eb0da4e1..7cb378bb 100644\\n--- a/tests/unittests/dumptools/test_sourceget.py\\n+++ b/tests/unittests/dumptools/test_sourceget.py\\n@@ -36,13 +36,13 @@\\n \\n class TestReplace:\\n     def test_a(self):\\n-        assert sourceget._replace(a, 'here', 2, 2, 2, 5) == a_r\\n+        assert sourceget.replace(a, 'here', 2, 2, 2, 5) == a_r\\n \\n     def test_a1(self):\\n-        assert sourceget._replace(a, 'he\\\\nre', 2, 2, 2, 8) == a_r1\\n+        assert sourceget.replace(a, 'he\\\\nre', 2, 2, 2, 8) == a_r1\\n \\n     def test_b(self):\\n-        assert sourceget._replace(b, 'here', 0, 0, 4, 6) == b_r\\n+        assert sourceget.replace(b, 'here', 0, 0, 4, 6) == b_r\\n \\n \\n class TestCut:\\n\",\"diff --git a/tests/unittests/test_transforms.py b/tests/unittests/test_transforms.py\\nindex ad01b24e..a74ee50c 100644\\n--- a/tests/unittests/test_transforms.py\\n+++ b/tests/unittests/test_transforms.py\\n@@ -1073,3 +1073,25 @@ def test_pd_trace(self):\\n def test_identity_compose_saves(tmp_path):\\n     t = padl.identity >> padl.identity\\n     t.pd_save(tmp_path / 'test')\\n+\\n+\\n+class TestParam:\\n+    def test_param_works(self, tmp_path):\\n+        x = padl.param(1, 'x')\\n+        t = SimpleClassTransform(x)\\n+        assert t(1) == 2\\n+        t.pd_save(tmp_path / 'test.padl')\\n+        t_1 = padl.load(tmp_path / 'test.padl')\\n+        assert t_1(1) == 2\\n+        t_2 = padl.load(tmp_path / 'test.padl', x=2)\\n+        assert t_2(1) == 3\\n+\\n+    def test_no_default(self, tmp_path):\\n+        x = padl.param(1, 'x', use_default=False)\\n+        t = SimpleClassTransform(x)\\n+        assert t(1) == 2\\n+        t.pd_save(tmp_path / 'test.padl')\\n+        with pytest.raises(ValueError):\\n+            padl.load(tmp_path / 'test.padl')\\n+        t_2 = padl.load(tmp_path / 'test.padl', x=2)\\n+        assert t_2(1) == 3\\n\",\"diff --git a/tests/unittests/test_transforms.py b/tests/unittests/test_transforms.py\\nindex a74ee50c..b28c56a1 100644\\n--- a/tests/unittests/test_transforms.py\\n+++ b/tests/unittests/test_transforms.py\\n@@ -1095,3 +1095,13 @@ def test_no_default(self, tmp_path):\\n             padl.load(tmp_path / 'test.padl')\\n         t_2 = padl.load(tmp_path / 'test.padl', x=2)\\n         assert t_2(1) == 3\\n+\\n+    def test_wrong_param(self, tmp_path):\\n+        x = padl.param(1, 'x')\\n+        t = SimpleClassTransform(x)\\n+        assert t(1) == 2\\n+        t.pd_save(tmp_path / 'test.padl')\\n+        with pytest.raises(ValueError):\\n+            padl.load(tmp_path / 'test.padl', y=1)\\n+        t_2 = padl.load(tmp_path / 'test.padl', x=2)\\n+        assert t_2(1) == 3\"]", "hints_text": ""}
