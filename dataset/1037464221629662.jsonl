{"instance_id": "1037464221629662", "repo": "tauffer-consulting/default_domino_pieces", "base_commit": "7f23a94b7e5b8d48e783b74add9f05772ea131cf", "problem_statement": "[piece] ToStringTypePiece:\\nA Piece that will make it easy to change type of data to string\\r\\n\\r\\nInput:\\r\\n- source_arg: any type, always from_upstream\\r\\n\\r\\nOutput:\\r\\n- output_string: str", "FAIL_TO_PASS": ["pieces/GetItemFromArrayPiece/test_getitemfromarray.py::test_getitemfromarray_random", "pieces/ToStringPiece/test_stringpiece.py::test_stringpiece_datetime", "pieces/ToStringPiece/test_stringpiece.py::test_stringpiece_time", "pieces/ToStringPiece/test_stringpiece.py::test_stringpiece_dict", "pieces/ToStringPiece/test_stringpiece.py::test_stringpiece_date", "pieces/GetItemFromArrayPiece/test_getitemfromarray.py::test_getitemfromarray_last", "pieces/ToStringPiece/test_stringpiece.py::test_stringpiece_list", "pieces/ToStringPiece/test_stringpiece.py::test_stringpiece_float", "pieces/ToStringPiece/test_stringpiece.py::test_stringpiece_bool", "pieces/GetItemFromArrayPiece/test_getitemfromarray.py::test_getitemfromarray_another", "pieces/ToStringPiece/test_stringpiece.py::test_stringpiece_int", "pieces/GetItemFromArrayPiece/test_getitemfromarray.py::test_getitemfromarray_first"], "PASS_TO_PASS": ["pieces/SimpleLogPiece/test_simple_log_piece.py::test_simple_log_piece", "pieces/ApiFetchPiece/test_api_fetch_piece.py::test_api_fetch_piece", "pieces/DataConversionPiece/test_data_conversion_piece.py::test_data_conversion_piece", "pieces/GetDateTimePiece/test_get_datetime_piece.py::test_get_datetime_piece", "pieces/SleepPiece/test_sleep_piece.py::test_sleep_piece"], "language": "python", "test_command": "source /saved/ENV || source /saved/*/ENV && pytest --no-header -rA --tb=no -p no:cacheprovider --continue-on-collection-errors", "test_output_parser": "python/parse_log_pytest_v3", "image_storage_uri": "vmvm-registry.fbinfra.net/repomate_image_activ_pytest/tauffer-consulting_default_domino_pieces:7f23a94b7e5b8d48e783b74add9f05772ea131cf", "patch": "[\"diff --git a/config.toml b/config.toml\\nindex a87027d..b4400dd 100644\\n--- a/config.toml\\n+++ b/config.toml\\n@@ -1,12 +1,7 @@\\n [repository]\\n-# The name of the github organization / person owner, e.g. tauffer-consulting.\\n-# Must be in lower-case letters\\n REGISTRY_NAME = \\\"tauffer-consulting\\\"\\n \\n-# The name of this Pieces repository\\n REPOSITORY_NAME = \\\"default_domino_pieces\\\"\\n REPOSITORY_LABEL = \\\"Default Pieces Repository\\\"\\n \\n-# The version of this Pieces release\\n-# Attention: changing this will create a new release   \\n-VERSION = \\\"0.5.0\\\" \\n+VERSION = \\\"0.6.0\\\"\\n\",\"diff --git a/dependencies/requirements_0.txt b/dependencies/requirements_0.txt\\nindex 206f526..6f1b5c8 100644\\n--- a/dependencies/requirements_0.txt\\n+++ b/dependencies/requirements_0.txt\\n@@ -1,3 +1,4 @@\\n pytz==2023.3\\n pandas==2.1.2\\n-Pillow==10.1.0\\n\\\\ No newline at end of file\\n+Pillow==10.1.0\\n+beautifulsoup4==4.12.2\\n\\\\ No newline at end of file\\n\",\"diff --git a/pieces/ApiFetchPiece/models.py b/pieces/ApiFetchPiece/models.py\\nindex e15dc9c..36e1db4 100644\\n--- a/pieces/ApiFetchPiece/models.py\\n+++ b/pieces/ApiFetchPiece/models.py\\n@@ -1,7 +1,6 @@\\n from pydantic import BaseModel, Field\\n \\n \\n-\\n class InputModel(BaseModel):\\n     api_url: str = Field(\\n         description='Input data to be converted. Can be a file path or data as string.'\\n@@ -11,4 +10,4 @@ class InputModel(BaseModel):\\n class OutputModel(BaseModel):\\n     base64_bytes_data: str = Field(\\n         description='Output data as base64 encoded string.'\\n-    )\\n\\\\ No newline at end of file\\n+    )\\n\",\"diff --git a/pieces/CustomPythonPiece/models.py b/pieces/CustomPythonPiece/models.py\\nindex 186b74d..031e8e2 100644\\n--- a/pieces/CustomPythonPiece/models.py\\n+++ b/pieces/CustomPythonPiece/models.py\\n@@ -1,6 +1,7 @@\\n from pydantic import BaseModel, Field\\n from domino.models import OutputModifierModel, OutputModifierItemType\\n from typing import List, Union\\n+from datetime import date as dt_date, datetime as dt_datetime, time as dt_time\\n \\n \\n class InputKwargsModel(BaseModel):\\n@@ -11,7 +12,7 @@ class InputKwargsModel(BaseModel):\\n             \\\"from_upstream\\\": \\\"never\\\"\\n         }\\n     )\\n-    kwarg_value: Union[str, list, int, float, bool, dict] = Field(\\n+    kwarg_value: Union[str, list, int, float, bool, dict, dt_date, dt_time, dt_datetime] = Field(\\n         default=None,\\n         description='Argument value.',\\n         json_schema_extra={\\n@@ -24,7 +25,6 @@ class InputModel(BaseModel):\\n     \\\"\\\"\\\"\\n     CustomPythonPiece Input Model\\n     \\\"\\\"\\\"\\n-    \\n     input_args: List[InputKwargsModel] = Field(\\n         default=[\\n             InputKwargsModel(kwarg_value=\\\"\\\", kwarg_name=\\\"kwarg_2\\\"),\\n@@ -45,7 +45,7 @@ def custom_function(kwarg_1, kwarg_2):\\n     # Return the output of the function as an object,\\n     # Matching the Output Args defined in the Form below\\n     return {\\n-        \\\"output_1\\\": \\\"this is a string\\\", \\n+        \\\"output_1\\\": \\\"this is a string\\\",\\n         \\\"output_2\\\": 420\\n     }\\n \\\"\\\"\\\",\\n\",\"diff --git a/pieces/DataConversionPiece/models.py b/pieces/DataConversionPiece/models.py\\nindex a549ab3..42eee07 100644\\n--- a/pieces/DataConversionPiece/models.py\\n+++ b/pieces/DataConversionPiece/models.py\\n@@ -1,7 +1,5 @@\\n-from pydantic import BaseModel, Field, field_validator\\n+from pydantic import BaseModel, Field\\n from enum import Enum\\n-from typing import Optional\\n-\\n \\n \\n class DataFormatOption(str, Enum):\\n@@ -24,8 +22,7 @@ class InputModel(BaseModel):\\n     )\\n \\n \\n-\\n class OutputModel(BaseModel):\\n     output_file_path: str = Field(\\n         description='Path to the converted file.'\\n-    )\\n\\\\ No newline at end of file\\n+    )\\n\",\"diff --git a/pieces/GetDateTimePiece/__init__.py b/pieces/GetDateTimePiece/__init__.py\\ndeleted file mode 100644\\nindex e69de29..0000000\\n--- a/pieces/GetDateTimePiece/__init__.py\\n+++ /dev/null\\n\",\"diff --git a/pieces/GetDateTimePiece/models.py b/pieces/GetDateTimePiece/models.py\\nindex 16855f9..b2b2859 100644\\n--- a/pieces/GetDateTimePiece/models.py\\n+++ b/pieces/GetDateTimePiece/models.py\\n@@ -29,7 +29,7 @@ class TZOptions(str, Enum):\\n     utc_plus_11 = '(UTC+11) - Pacific/Pohnpei'\\n     utc_plus_12 = '(UTC+12) - Pacific/Chatham'\\n     utc_plus_13 = '(UTC+13) - Pacific/Tongatapu'\\n-    utc_plus_14 = '(UTC+14) - Pacific/Kiritimati' \\n+    utc_plus_14 = '(UTC+14) - Pacific/Kiritimati'\\n \\n \\n class InputModel(BaseModel):\\n@@ -58,4 +58,4 @@ class OutputModel(BaseModel):\\n     )\\n     datetime: dt_datetime = Field(\\n         description='Datetime of the timestamp, in ISO format.'\\n-    )\\n\\\\ No newline at end of file\\n+    )\\n\",\"diff --git a/pieces/GetItemFromArrayPiece/metadata.json b/pieces/GetItemFromArrayPiece/metadata.json\\nnew file mode 100644\\nindex 0000000..58f0b82\\n--- /dev/null\\n+++ b/pieces/GetItemFromArrayPiece/metadata.json\\n@@ -0,0 +1,17 @@\\n+{\\n+    \\\"name\\\": \\\"GetItemFromArrayPiece\\\",\\n+    \\\"description\\\": \\\"Get one item from an array\\\",\\n+    \\\"dependency\\\": {\\n+        \\\"requirements_file\\\": \\\"requirements_0.txt\\\"\\n+    },\\n+    \\\"tags\\\": [\\n+        \\\"default\\\"\\n+    ],\\n+    \\\"style\\\": {\\n+        \\\"node_label\\\": \\\"Get Item From Array Piece\\\",\\n+        \\\"node_style\\\": {\\n+            \\\"backgroundColor\\\": \\\"#b3cde8\\\"\\n+        },\\n+        \\\"icon_class_name\\\": \\\"fluent:tray-item-remove-24-filled\\\"\\n+    }\\n+}\\n\\\\ No newline at end of file\\n\",\"diff --git a/pieces/GetItemFromArrayPiece/models.py b/pieces/GetItemFromArrayPiece/models.py\\nnew file mode 100644\\nindex 0000000..534b71a\\n--- /dev/null\\n+++ b/pieces/GetItemFromArrayPiece/models.py\\n@@ -0,0 +1,41 @@\\n+from pydantic import BaseModel, Field\\n+from typing import Union\\n+from datetime import date as dt_date, datetime as dt_datetime, time as dt_time\\n+from enum import Enum\\n+\\n+\\n+class IndexType(str, Enum):\\n+    first = 'first'\\n+    last = 'last'\\n+    random = 'random'\\n+    another = 'another'\\n+\\n+\\n+class InputModel(BaseModel):\\n+    \\\"\\\"\\\"\\n+    GetItemFromArrayPiece Input Model\\n+    \\\"\\\"\\\"\\n+    input_array: list = Field(\\n+        description='Input array to get item from.',\\n+        json_schema_extra={\\n+            \\\"from_upstream\\\": \\\"always\\\"\\n+        }\\n+    )\\n+    index: IndexType = Field(\\n+        default=IndexType.first,\\n+        description='Index of item to get from input array.'\\n+    )\\n+    another_index: int = Field(\\n+        default=1,\\n+        ge=1,\\n+        description='Index number of item to get from input array.'\\n+    )\\n+\\n+\\n+class OutputModel(BaseModel):\\n+    \\\"\\\"\\\"\\n+    GetItemFromArrayPiece Output Model\\n+    \\\"\\\"\\\"\\n+    output_value: Union[str, list, int, float, bool, dict, dt_date, dt_time, dt_datetime] = Field(\\n+        description='Item from input array at specified index.'\\n+    )\\n\",\"diff --git a/pieces/GetItemFromArrayPiece/piece.py b/pieces/GetItemFromArrayPiece/piece.py\\nnew file mode 100644\\nindex 0000000..5cff3cc\\n--- /dev/null\\n+++ b/pieces/GetItemFromArrayPiece/piece.py\\n@@ -0,0 +1,28 @@\\n+from domino.base_piece import BasePiece\\n+from .models import InputModel, OutputModel\\n+import random\\n+\\n+\\n+class GetItemFromArrayPiece(BasePiece):\\n+\\n+    def piece_function(self, input_data: InputModel):\\n+\\n+        input_array = input_data.input_array\\n+        index = input_data.index\\n+        if index == 'first':\\n+            output_value = input_array[0]\\n+        elif index == 'last':\\n+            output_value = input_array[-1]\\n+        elif index == 'random':\\n+            output_value = input_array[random.randint(0, len(input_array) - 1)]\\n+        elif index == 'another':\\n+            if input_data.another_index > len(input_array):\\n+                raise ValueError(f\\\"Index {input_data.another_index} is out of range for input array of length {len(input_array)}\\\")\\n+            output_value = input_array[input_data.another_index]\\n+\\n+        self.logger.info(f\\\"Output value: {output_value}\\\")\\n+\\n+        # Return output\\n+        return OutputModel(\\n+            output_value=output_value\\n+        )\\n\",\"diff --git a/pieces/PageScrapperPiece/metadata.json b/pieces/PageScrapperPiece/metadata.json\\nnew file mode 100644\\nindex 0000000..cd5b6c4\\n--- /dev/null\\n+++ b/pieces/PageScrapperPiece/metadata.json\\n@@ -0,0 +1,17 @@\\n+{\\n+    \\\"name\\\": \\\"PageScrapperPiece\\\",\\n+    \\\"description\\\": \\\"Scrapes text from a web page, given a URL and a list of HTML tags.\\\",\\n+    \\\"dependency\\\": {\\n+        \\\"requirements_file\\\": \\\"requirements_0.txt\\\"\\n+    },\\n+    \\\"tags\\\": [\\n+        \\\"Default\\\"\\n+    ],\\n+    \\\"style\\\": {\\n+        \\\"node_label\\\": \\\"Page Scrapper Piece\\\",\\n+        \\\"node_style\\\": {\\n+            \\\"backgroundColor\\\": \\\"#b3cde8\\\"\\n+        },\\n+        \\\"icon_class_name\\\": \\\"lucide:text-selection\\\"\\n+    }\\n+}\\n\\\\ No newline at end of file\\n\",\"diff --git a/pieces/PageScrapperPiece/models.py b/pieces/PageScrapperPiece/models.py\\nnew file mode 100644\\nindex 0000000..f169810\\n--- /dev/null\\n+++ b/pieces/PageScrapperPiece/models.py\\n@@ -0,0 +1,36 @@\\n+from pydantic import BaseModel, Field\\n+from typing import List\\n+\\n+\\n+class ItemType(BaseModel):\\n+    tag: str = Field(\\n+        default=\\\"p\\\",\\n+        description='HTML tag name.',\\n+    )\\n+    class_name: str = Field(\\n+        default=\\\"\\\",\\n+        description='HTML tag class name.',\\n+    )\\n+\\n+\\n+class InputModel(BaseModel):\\n+    \\\"\\\"\\\"\\n+    PageScrapperPiece Input Model\\n+    \\\"\\\"\\\"\\n+    url: str = Field(\\n+        default=\\\"\\\",\\n+        description='URL to retrieve content from.'\\n+    )\\n+    search_items: List[ItemType] = Field(\\n+        default=[ItemType()],\\n+        description='List of HTML tags and class names to search for.'\\n+    )\\n+\\n+\\n+class OutputModel(BaseModel):\\n+    \\\"\\\"\\\"\\n+    PageScrapperPiece Output Model\\n+    \\\"\\\"\\\"\\n+    scrapped_text: str = Field(\\n+        description='Scrapped text from the URL.'\\n+    )\\n\",\"diff --git a/pieces/PageScrapperPiece/piece.py b/pieces/PageScrapperPiece/piece.py\\nnew file mode 100644\\nindex 0000000..e54adf3\\n--- /dev/null\\n+++ b/pieces/PageScrapperPiece/piece.py\\n@@ -0,0 +1,71 @@\\n+from domino.base_piece import BasePiece\\n+from .models import InputModel, OutputModel\\n+import requests\\n+from bs4 import BeautifulSoup\\n+import re\\n+from html import unescape\\n+\\n+\\n+def clean_text(text):\\n+    # Replace HTML entities with their corresponding characters, e.g., '&amp;' becomes '&'\\n+    text = unescape(text)\\n+    # Remove HTML tags\\n+    text = re.sub(r'<[^>]+>', '', text)\\n+    # Replace sequences of whitespace characters with a single space\\n+    text = re.sub(r'\\\\s+', ' ', text)\\n+    # Remove leading and trailing whitespace\\n+    text = text.strip()\\n+    # Remove other unwanted characters\\n+    text = text.replace(u'\\\\xa0', ' ').replace('\\\\r', '').replace('\\\\n', '').replace('\\\\t', '').replace('\\\\u200b', '')\\n+    return text\\n+\\n+\\n+def extract_content_with_known_tags_classes(url, search_items):\\n+    response = requests.get(url)\\n+    if response.status_code == 200:\\n+        soup = BeautifulSoup(response.text, 'html.parser')\\n+        content = []\\n+        for item in search_items:\\n+            if item.class_name:\\n+                elements = soup.find_all(item.tag, class_=item.class_name)\\n+            else:\\n+                elements = soup.find_all(item.tag)\\n+            for element in elements:\\n+                content.append(element.get_text(separator=' ', strip=True))\\n+        return clean_text(' '.join(content))\\n+    else:\\n+        return \\\"\\\"\\n+\\n+\\n+class PageScrapperPiece(BasePiece):\\n+\\n+    def piece_function(self, input_data: InputModel):\\n+\\n+        url = input_data.url\\n+        search_items = input_data.search_items\\n+\\n+        self.logger.info(\\\"Starting page scrapper...\\\")\\n+        self.logger.info(f\\\"URL: {url}\\\")\\n+        self.logger.info(f\\\"Search items: {search_items}\\\")\\n+\\n+        content = extract_content_with_known_tags_classes(url, search_items)\\n+\\n+        self.logger.info(f\\\"Scrapped text: {content}\\\")\\n+\\n+        # Return output\\n+        return OutputModel(\\n+            scrapped_text=content,\\n+        )\\n+\\n+    def format_display_result(self, input_data: InputModel, content: str):\\n+        md_text = f\\\"**url:** {input_data.url}\\\\n\\\"\\n+        for item in input_data.search_items:\\n+            md_text += f\\\"**tag:** {item['tag']} \\\\t**class_name:** {item['class_name']}\\\\n\\\"\\n+        md_text += f\\\"**scrapped text:**\\\\n{content}\\\\n\\\"\\n+        file_path = f\\\"{self.results_path}/display_result.md\\\"\\n+        with open(file_path, \\\"w\\\") as f:\\n+            f.write(md_text)\\n+        self.display_result = {\\n+            \\\"file_type\\\": \\\"md\\\",\\n+            \\\"file_path\\\": file_path\\n+        }\\n\",\"diff --git a/pieces/SaveImagePiece/models.py b/pieces/SaveImagePiece/models.py\\nindex e575e34..7b278f5 100644\\n--- a/pieces/SaveImagePiece/models.py\\n+++ b/pieces/SaveImagePiece/models.py\\n@@ -1,7 +1,6 @@\\n from pydantic import BaseModel, Field\\n \\n \\n-\\n class InputModel(BaseModel):\\n     base64_data: str = Field(\\n         description='Input data to be saved as image.'\\n@@ -11,4 +10,4 @@ class InputModel(BaseModel):\\n class OutputModel(BaseModel):\\n     output_image_path: str = Field(\\n         description='Output file path of the saved image.'\\n-    )\\n\\\\ No newline at end of file\\n+    )\\n\",\"diff --git a/pieces/SimpleLogPiece/__init__.py b/pieces/SimpleLogPiece/__init__.py\\ndeleted file mode 100644\\nindex e69de29..0000000\\n--- a/pieces/SimpleLogPiece/__init__.py\\n+++ /dev/null\\n\",\"diff --git a/pieces/SimpleLogPiece/models.py b/pieces/SimpleLogPiece/models.py\\nindex 4467edb..3105c7b 100644\\n--- a/pieces/SimpleLogPiece/models.py\\n+++ b/pieces/SimpleLogPiece/models.py\\n@@ -9,6 +9,7 @@ class InputEnum(str, Enum):\\n     option2 = \\\"option2\\\"\\n     option3 = \\\"option3\\\"\\n \\n+\\n class InputModel(BaseModel):\\n     \\\"\\\"\\\"\\n     SimpleLogPiece Input Model\\n@@ -101,4 +102,3 @@ class OutputModel(BaseModel):\\n             'widget': \\\"codeeditor\\\",\\n         }\\n     )\\n-\\n\",\"diff --git a/pieces/SleepPiece/models.py b/pieces/SleepPiece/models.py\\nindex f1934fd..58ea9ee 100644\\n--- a/pieces/SleepPiece/models.py\\n+++ b/pieces/SleepPiece/models.py\\n@@ -8,8 +8,7 @@ class InputModel(BaseModel):\\n \\n     sleep_time: float = Field(\\n         default=1,\\n-        required=True,\\n-        description=\\\"Number of seconds to sleep\\\"\\n+        description=\\\"Number of seconds to sleep\\\",\\n     )\\n \\n \\n@@ -18,6 +17,5 @@ class OutputModel(BaseModel):\\n     Sleep Piece Output Model\\n     \\\"\\\"\\\"\\n     message: str = Field(\\n-        default=\\\"\\\",\\n         description=\\\"Sleep piece executed\\\"\\n-    )\\n\\\\ No newline at end of file\\n+    )\\n\",\"diff --git a/pieces/SleepPiece/piece.py b/pieces/SleepPiece/piece.py\\nindex 3d83d2a..247ad34 100644\\n--- a/pieces/SleepPiece/piece.py\\n+++ b/pieces/SleepPiece/piece.py\\n@@ -15,4 +15,4 @@ class SleepPiece(BasePiece):\\n         # Return output\\n         return OutputModel(\\n             message=message,\\n-        )\\n\\\\ No newline at end of file\\n+        )\\n\",\"diff --git a/pieces/ToStringPiece/metadata.json b/pieces/ToStringPiece/metadata.json\\nnew file mode 100644\\nindex 0000000..07b0e50\\n--- /dev/null\\n+++ b/pieces/ToStringPiece/metadata.json\\n@@ -0,0 +1,17 @@\\n+{\\n+    \\\"name\\\": \\\"ToStringPiece\\\",\\n+    \\\"description\\\": \\\"A Piece that transforms any input to string.\\\",\\n+    \\\"dependency\\\": {\\n+        \\\"requirements_file\\\": \\\"requirements_0.txt\\\"\\n+    },\\n+    \\\"tags\\\": [\\n+        \\\"Default\\\"\\n+    ],\\n+    \\\"style\\\": {\\n+        \\\"node_label\\\": \\\"To String Piece\\\",\\n+        \\\"node_style\\\": {\\n+            \\\"backgroundColor\\\": \\\"#b3cde8\\\"\\n+        },\\n+        \\\"icon_class_name\\\": \\\"solar:text-bold\\\"\\n+    }\\n+}\\n\\\\ No newline at end of file\\n\",\"diff --git a/pieces/ToStringPiece/models.py b/pieces/ToStringPiece/models.py\\nnew file mode 100644\\nindex 0000000..3692413\\n--- /dev/null\\n+++ b/pieces/ToStringPiece/models.py\\n@@ -0,0 +1,24 @@\\n+from pydantic import BaseModel, Field\\n+from typing import Union\\n+from datetime import date as dt_date, datetime as dt_datetime, time as dt_time\\n+\\n+\\n+class InputModel(BaseModel):\\n+    \\\"\\\"\\\"\\n+    ToStringPiece Input Model\\n+    \\\"\\\"\\\"\\n+    input_value: Union[str, list, int, float, bool, dict, dt_date, dt_time, dt_datetime] = Field(\\n+        description='Input value to be turned into string.',\\n+        json_schema_extra={\\n+            \\\"from_upstream\\\": \\\"always\\\"\\n+        }\\n+    )\\n+\\n+\\n+class OutputModel(BaseModel):\\n+    \\\"\\\"\\\"\\n+    ToStringPiece Output Model\\n+    \\\"\\\"\\\"\\n+    output_value: str = Field(\\n+        description='Input value as a string.'\\n+    )\\n\",\"diff --git a/pieces/ToStringPiece/piece.py b/pieces/ToStringPiece/piece.py\\nnew file mode 100644\\nindex 0000000..79c968b\\n--- /dev/null\\n+++ b/pieces/ToStringPiece/piece.py\\n@@ -0,0 +1,15 @@\\n+from domino.base_piece import BasePiece\\n+from .models import InputModel, OutputModel\\n+\\n+\\n+class ToStringPiece(BasePiece):\\n+\\n+    def piece_function(self, input_data: InputModel):\\n+\\n+        string_value = str(input_data.input_value)\\n+        self.logger.info(f\\\"Input value as string: {string_value}\\\")\\n+\\n+        # Return output\\n+        return OutputModel(\\n+            output_value=string_value,\\n+        )\\n\"]", "test_patch": "[\"diff --git a/.github/workflows/tests-dev.yml b/.github/workflows/tests-dev.yml\\nnew file mode 100644\\nindex 0000000..5f3c9a3\\n--- /dev/null\\n+++ b/.github/workflows/tests-dev.yml\\n@@ -0,0 +1,47 @@\\n+name: Run tests on dev branch\\n+\\n+on:\\n+  push:\\n+    branches:\\n+      - dev\\n+\\n+jobs:\\n+  run-tests-dev:\\n+    runs-on: ubuntu-latest\\n+    steps:\\n+      - name: Checkout\\n+        uses: actions/checkout@v3\\n+        with:\\n+          persist-credentials: false # otherwise, the token used is the GITHUB_TOKEN, instead of your personal access token.\\n+          fetch-depth: 0 # otherwise, there would be errors pushing refs to the destination repository.\\n+\\n+      - name: Set up Python 3.10\\n+        uses: actions/setup-python@v3\\n+        with:\\n+          python-version: \\\"3.10\\\"\\n+\\n+      - name: Pip install packages\\n+        run: |\\n+          python -m pip install -U pip\\n+          pip install --no-cache-dir domino-py[cli]\\n+\\n+      - name: Login to GitHub Container Registry\\n+        uses: docker/login-action@v2\\n+        with:\\n+          registry: ghcr.io\\n+          username: ${{ github.actor }}\\n+          password: ${{ secrets.GITHUB_TOKEN }}\\n+\\n+      - name: pip list\\n+        run: pip list | grep domino\\n+\\n+      - name: Run organize and build images\\n+        run: |\\n+          domino piece organize --build-images --source-url=https://github.com/${{github.repository}}\\n+\\n+      - name: Install Tests Dependencies\\n+        run: pip install -r requirements-tests.txt\\n+\\n+      - name: Run tests over built images\\n+        run: |\\n+          pytest\\n\",\"diff --git a/pieces/GetDateTimePiece/test_get_datetime_piece.py b/pieces/GetDateTimePiece/test_get_datetime_piece.py\\nindex 7d9f2db..6767309 100644\\n--- a/pieces/GetDateTimePiece/test_get_datetime_piece.py\\n+++ b/pieces/GetDateTimePiece/test_get_datetime_piece.py\\n@@ -1,5 +1,23 @@\\n from domino.testing import piece_dry_run\\n from datetime import datetime\\n+import re\\n+from datetime import datetime\\n+\\n+\\n+def validate_iso_format(s):\\n+    # Regular expressions for ISO date, time, and datetime formats\\n+    date_regex = r'^\\\\d{4}-\\\\d{2}-\\\\d{2}$'\\n+    time_regex = r'^\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?$'\\n+    datetime_regex = r'^\\\\d{4}-\\\\d{2}-\\\\d{2}T\\\\d{2}:\\\\d{2}:\\\\d{2}(\\\\.\\\\d+)?(Z|[+-]\\\\d{2}:\\\\d{2})?$'\\n+\\n+    if re.match(date_regex, s):\\n+        return True\\n+    elif re.match(time_regex, s):\\n+        return True\\n+    elif re.match(datetime_regex, s):\\n+        return True\\n+    else:\\n+        return False\\n \\n \\n def test_get_datetime_piece():\\n@@ -18,9 +36,10 @@ def test_get_datetime_piece():\\n     assert 'time' in piece_output\\n     assert 'datetime' in piece_output\\n \\n-    assert piece_output['date'] == datetime.now().date().isoformat()\\n+    assert validate_iso_format(piece_output['date'])\\n+    assert validate_iso_format(piece_output['time'])\\n+    assert validate_iso_format(piece_output['datetime'])\\n+\\n     dt = datetime.fromisoformat(piece_output['datetime'])\\n     timezone = dt.tzinfo\\n-    assert str(timezone) in ['UTC-03:00', 'UTC-04:00'] # Using list because of DST \\n-\\n-    \\n\\\\ No newline at end of file\\n+    assert str(timezone) in ['UTC-03:00', 'UTC-04:00']  # Using list because of DST\\n\",\"diff --git a/pieces/GetItemFromArrayPiece/test_getitemfromarray.py b/pieces/GetItemFromArrayPiece/test_getitemfromarray.py\\nnew file mode 100644\\nindex 0000000..e3d093b\\n--- /dev/null\\n+++ b/pieces/GetItemFromArrayPiece/test_getitemfromarray.py\\n@@ -0,0 +1,50 @@\\n+from domino.testing import piece_dry_run\\n+\\n+\\n+def test_getitemfromarray_first():\\n+    input_data = dict(\\n+        input_array=[1, 2, 3, 4, 5],\\n+        index=\\\"first\\\"\\n+    )\\n+    piece_output = piece_dry_run(\\n+        piece_name=\\\"GetItemFromArrayPiece\\\",\\n+        input_data=input_data\\n+    )\\n+    assert 1 == piece_output.get(\\\"output_value\\\", None)\\n+\\n+\\n+def test_getitemfromarray_last():\\n+    input_data = dict(\\n+        input_array=[1, 2, 3, 4, 5],\\n+        index=\\\"last\\\"\\n+    )\\n+    piece_output = piece_dry_run(\\n+        piece_name=\\\"GetItemFromArrayPiece\\\",\\n+        input_data=input_data\\n+    )\\n+    assert 5 == piece_output.get(\\\"output_value\\\", None)\\n+\\n+\\n+def test_getitemfromarray_random():\\n+    input_data = dict(\\n+        input_array=[1, 2, 3, 4, 5],\\n+        index=\\\"random\\\"\\n+    )\\n+    piece_output = piece_dry_run(\\n+        piece_name=\\\"GetItemFromArrayPiece\\\",\\n+        input_data=input_data\\n+    )\\n+    assert piece_output.get(\\\"output_value\\\", None) in [1, 2, 3, 4, 5]\\n+\\n+\\n+def test_getitemfromarray_another():\\n+    input_data = dict(\\n+        input_array=[1, 2, 3, 4, 5],\\n+        index=\\\"another\\\",\\n+        another_index=3\\n+    )\\n+    piece_output = piece_dry_run(\\n+        piece_name=\\\"GetItemFromArrayPiece\\\",\\n+        input_data=input_data\\n+    )\\n+    assert 4 == piece_output.get(\\\"output_value\\\", None)\\n\",\"diff --git a/pieces/PageScrapperPiece/test_pagescrapper.py b/pieces/PageScrapperPiece/test_pagescrapper.py\\nnew file mode 100644\\nindex 0000000..20738b1\\n--- /dev/null\\n+++ b/pieces/PageScrapperPiece/test_pagescrapper.py\\n@@ -0,0 +1,23 @@\\n+from domino.testing import piece_dry_run\\n+\\n+\\n+def test_pagescrapper():\\n+    input_data = dict(\\n+        url=\\\"https://en.wikipedia.org/wiki/Mr._Tambourine_Man\\\",\\n+        search_items=[\\n+            dict(\\n+                tag=\\\"article\\\",\\n+                class_name=\\\"\\\",\\n+            ),\\n+            dict(\\n+                tag=\\\"main\\\",\\n+                class_name=\\\"\\\",\\n+            ),\\n+        ]\\n+    )\\n+    piece_output = piece_dry_run(\\n+        piece_name=\\\"PageScrapperPiece\\\",\\n+        input_data=input_data\\n+    )\\n+    assert \\\"tambourine\\\" in piece_output[\\\"scrapped_text\\\"].lower(), \\\"PageScrapperPiece failed to scrap the page\\\"\\n+    assert \\\"dylan\\\" in piece_output[\\\"scrapped_text\\\"].lower(), \\\"PageScrapperPiece failed to scrap the page\\\"\\n\",\"diff --git a/pieces/ToStringPiece/test_stringpiece.py b/pieces/ToStringPiece/test_stringpiece.py\\nnew file mode 100644\\nindex 0000000..56382c0\\n--- /dev/null\\n+++ b/pieces/ToStringPiece/test_stringpiece.py\\n@@ -0,0 +1,93 @@\\n+from domino.testing import piece_dry_run\\n+from datetime import datetime\\n+\\n+\\n+def test_stringpiece_int():\\n+    input_data = dict(\\n+        input_value=10\\n+    )\\n+    piece_output = piece_dry_run(\\n+        piece_name=\\\"ToStringPiece\\\",\\n+        input_data=input_data\\n+    )\\n+    assert str(10) == piece_output.get(\\\"output_value\\\", None)\\n+\\n+\\n+def test_stringpiece_float():\\n+    input_data = dict(\\n+        input_value=10.5\\n+    )\\n+    piece_output = piece_dry_run(\\n+        piece_name=\\\"ToStringPiece\\\",\\n+        input_data=input_data\\n+    )\\n+    assert str(10.5) == piece_output.get(\\\"output_value\\\", None)\\n+\\n+\\n+def test_stringpiece_bool():\\n+    input_data = dict(\\n+        input_value=True\\n+    )\\n+    piece_output = piece_dry_run(\\n+        piece_name=\\\"ToStringPiece\\\",\\n+        input_data=input_data\\n+    )\\n+    assert str(True) == piece_output.get(\\\"output_value\\\", None)\\n+\\n+\\n+def test_stringpiece_list():\\n+    input_data = dict(\\n+        input_value=[1, 2, 3]\\n+    )\\n+    piece_output = piece_dry_run(\\n+        piece_name=\\\"ToStringPiece\\\",\\n+        input_data=input_data\\n+    )\\n+    assert str([1, 2, 3]) == piece_output.get(\\\"output_value\\\", None)\\n+\\n+\\n+def test_stringpiece_dict():\\n+    input_data = dict(\\n+        input_value={\\\"a\\\": 1, \\\"b\\\": 2}\\n+    )\\n+    piece_output = piece_dry_run(\\n+        piece_name=\\\"ToStringPiece\\\",\\n+        input_data=input_data\\n+    )\\n+    assert str({\\\"a\\\": 1, \\\"b\\\": 2}) == piece_output.get(\\\"output_value\\\", None)\\n+\\n+\\n+def test_stringpiece_datetime():\\n+    now = datetime.now().isoformat()\\n+    input_data = dict(\\n+        input_value=now,\\n+    )\\n+    piece_output = piece_dry_run(\\n+        piece_name=\\\"ToStringPiece\\\",\\n+        input_data=input_data\\n+    )\\n+    assert str(now) == piece_output.get(\\\"output_value\\\", None)\\n+\\n+\\n+def test_stringpiece_date():\\n+    now = datetime.now().date().isoformat()\\n+    input_data = dict(\\n+        input_value=now,\\n+    )\\n+    piece_output = piece_dry_run(\\n+        piece_name=\\\"ToStringPiece\\\",\\n+        input_data=input_data\\n+    )\\n+    assert str(now) == piece_output.get(\\\"output_value\\\", None)\\n+\\n+\\n+def test_stringpiece_time():\\n+    now = datetime.now().time().isoformat()\\n+    input_data = dict(\\n+        input_value=now,\\n+    )\\n+    piece_output = piece_dry_run(\\n+        piece_name=\\\"ToStringPiece\\\",\\n+        input_data=input_data\\n+    )\\n+    assert str(now) == piece_output.get(\\\"output_value\\\", None)\"]", "hints_text": ""}
