{"id": 38, "timestamp": "2026-01-22T11:19:44.557991", "source": "agent", "message": "Command `pytest /workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258/tests/test_optimizer.py` executed with exit code 1.", "cause": 37, "observation": "run", "tool_call_metadata": {"function_name": "execute_bash", "tool_call_id": "call_AJix2DeXuibsVbHQ24kECQze", "model_response": {"id": "chatcmpl-D0n0wOTIelzmw3lIvJclVCTDluQZn", "created": 1769080782, "model": "gpt-4o-2024-08-06", "object": "chat.completion", "system_fingerprint": "fp_a0e9480a2f", "choices": [{"finish_reason": "tool_calls", "index": 0, "message": {"content": null, "role": "assistant", "tool_calls": [{"function": {"arguments": "{\"command\":\"pytest /workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258/tests/test_optimizer.py\",\"security_risk\":\"MEDIUM\"}", "name": "execute_bash"}, "id": "call_AJix2DeXuibsVbHQ24kECQze", "type": "function"}], "function_call": null, "annotations": []}, "provider_specific_fields": {}}], "usage": {"completion_tokens": 50, "prompt_tokens": 17189, "total_tokens": 17239, "completion_tokens_details": {"accepted_prediction_tokens": 0, "audio_tokens": 0, "reasoning_tokens": 0, "rejected_prediction_tokens": 0, "text_tokens": null}, "prompt_tokens_details": {"audio_tokens": 0, "cached_tokens": 16640, "text_tokens": null, "image_tokens": null}}, "service_tier": "default"}, "total_calls_in_response": 1}, "content": "========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================= test session starts ==========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================\nplatform linux -- Python 3.12.12, pytest-9.0.2, pluggy-1.6.0\nrootdir: /workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258\nplugins: anyio-4.12.1\ncollected 18 items\n\n../../workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258/tests/test_optimizer.py ..................                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          [100%]\n\n=============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================== FAILURES ===============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================\n_________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________ TestOptimizer.test_simplify [date '1998-12-01' - interval '90' day] __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________\n\nself = <tests.test_optimizer.TestOptimizer testMethod=test_simplify>, file = 'simplify', func = <function simplify at 0x711b8eed7ce0>, pretty = False, kwargs = {}, sql = \"date '1998-12-01' - interval '90' day\", expected = \"CAST('1998-09-02' AS DATE)\"\n\n    def check_file(self, file, func, pretty=False, **kwargs):\n        for sql, expected in load_sql_fixture_pairs(f\"optimizer/{file}.sql\"):\n            with self.subTest(sql):\n>               self.assertEqual(\n                    func(parse_one(sql), **kwargs).sql(pretty=pretty),\n                    expected,\n                )\nE               AssertionError: \"CAST('1998-12-01' AS DATE) - INTERVAL '90' day\" != \"CAST('1998-09-02' AS DATE)\"\nE               - CAST('1998-12-01' AS DATE) - INTERVAL '90' day\nE               + CAST('1998-09-02' AS DATE)\n\n/workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258/tests/test_optimizer.py:32: AssertionError\n_________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________ TestOptimizer.test_simplify [date '1998-12-01' + interval '1' week] __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________\n\nself = <tests.test_optimizer.TestOptimizer testMethod=test_simplify>, file = 'simplify', func = <function simplify at 0x711b8eed7ce0>, pretty = False, kwargs = {}, sql = \"date '1998-12-01' + interval '1' week\", expected = \"CAST('1998-12-08' AS DATE)\"\n\n    def check_file(self, file, func, pretty=False, **kwargs):\n        for sql, expected in load_sql_fixture_pairs(f\"optimizer/{file}.sql\"):\n            with self.subTest(sql):\n>               self.assertEqual(\n                    func(parse_one(sql), **kwargs).sql(pretty=pretty),\n                    expected,\n                )\nE               AssertionError: \"CAST('1998-12-01' AS DATE) + INTERVAL '1' week\" != \"CAST('1998-12-08' AS DATE)\"\nE               - CAST('1998-12-01' AS DATE) + INTERVAL '1' week\nE               + CAST('1998-12-08' AS DATE)\n\n/workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258/tests/test_optimizer.py:32: AssertionError\n_________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________ TestOptimizer.test_simplify [interval '1' year + date '1998-01-01'] __________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________\n\nself = <tests.test_optimizer.TestOptimizer testMethod=test_simplify>, file = 'simplify', func = <function simplify at 0x711b8eed7ce0>, pretty = False, kwargs = {}, sql = \"interval '1' year + date '1998-01-01'\", expected = \"CAST('1999-01-01' AS DATE)\"\n\n    def check_file(self, file, func, pretty=False, **kwargs):\n        for sql, expected in load_sql_fixture_pairs(f\"optimizer/{file}.sql\"):\n            with self.subTest(sql):\n>               self.assertEqual(\n                    func(parse_one(sql), **kwargs).sql(pretty=pretty),\n                    expected,\n                )\nE               AssertionError: \"INTERVAL '1' year + CAST('1998-01-01' AS DATE)\" != \"CAST('1999-01-01' AS DATE)\"\nE               - INTERVAL '1' year + CAST('1998-01-01' AS DATE)\nE               + CAST('1999-01-01' AS DATE)\n\n/workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258/tests/test_optimizer.py:32: AssertionError\n___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________ TestOptimizer.test_simplify [interval '1' year + date '1998-01-01' + 3 * 7 * 4] ____________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________\n\nself = <tests.test_optimizer.TestOptimizer testMethod=test_simplify>, file = 'simplify', func = <function simplify at 0x711b8eed7ce0>, pretty = False, kwargs = {}, sql = \"interval '1' year + date '1998-01-01' + 3 * 7 * 4\", expected = \"CAST('1999-01-01' AS DATE) + 84\"\n\n    def check_file(self, file, func, pretty=False, **kwargs):\n        for sql, expected in load_sql_fixture_pairs(f\"optimizer/{file}.sql\"):\n            with self.subTest(sql):\n>               self.assertEqual(\n                    func(parse_one(sql), **kwargs).sql(pretty=pretty),\n                    expected,\n                )\nE               AssertionError: \"INTERVAL '1' year + CAST('1998-01-01' AS DATE) + 84\" != \"CAST('1999-01-01' AS DATE) + 84\"\nE               - INTERVAL '1' year + CAST('1998-01-01' AS DATE) + 84\nE               + CAST('1999-01-01' AS DATE) + 84\n\n/workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258/tests/test_optimizer.py:32: AssertionError\n__________________________________________________________________________________________________________________________________________________________________________ TestOptimizer.test_tpch [select\n        l_returnflag,\n        l_linestatus,\n        sum(l_quantity) as sum_qty,\n        sum(l_extendedprice) as sum_base_price,\n        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,\n        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,\n        avg(l_quantity) as avg_qty,\n        avg(l_extendedprice) as avg_price,\n        avg(l_discount) as avg_disc,\n        count(*) as count_order\nfrom\n        lineitem\nwhere\n        CAST(l_shipdate AS DATE) <= date '1998-12-01' - interval '90' day\ngroup by\n        l_returnflag,\n        l_linestatus\norder by\n        l_returnflag,\n        l_linestatus] __________________________________________________________________________________________________________________________________________________________________________\n\nself = <tests.test_optimizer.TestOptimizer testMethod=test_tpch>, file = 'tpc-h/tpc-h', func = <function optimize at 0x711b8eed7560>, pretty = True, kwargs = {'schema': {'customer': {'c_acctbal': 'float64', 'c_address': 'string', 'c_comment': 'string', 'c_custkey': 'uint64', ...4'}, 'orders': {'o_clerk': 'string', 'o_comment': 'string', 'o_custkey': 'uint64', 'o_orderdate': 'date32', ...}, ...}}, sql = \"select\\n        l_returnflag,\\n        l_linestatus,\\n        sum(l_quantity) as sum_qty,\\n        sum(l_extendedpric...'90' day\\ngroup by\\n        l_returnflag,\\n        l_linestatus\\norder by\\n        l_returnflag,\\n        l_linestatus\", expected = 'SELECT\\n  \"lineitem\".\"l_returnflag\" AS \"l_returnflag\",\\n  \"lineitem\".\"l_linestatus\" AS \"l_linestatus\",\\n  SUM(\"lineit...tem\".\"l_returnflag\",\\n  \"lineitem\".\"l_linestatus\"\\nORDER BY\\n  \"lineitem\".\"l_returnflag\",\\n  \"lineitem\".\"l_linestatus\"'\n\n    def check_file(self, file, func, pretty=False, **kwargs):\n        for sql, expected in load_sql_fixture_pairs(f\"optimizer/{file}.sql\"):\n            with self.subTest(sql):\n>               self.assertEqual(\n                    func(parse_one(sql), **kwargs).sql(pretty=pretty),\n                    expected,\n                )\nE               AssertionError: 'SELE[708 chars]1998-12-01\\' AS DATE) - INTERVAL \\'90\\' day\\nG[131 chars]tus\"' != 'SELE[708 chars]1998-09-02\\' AS DATE)\\nGROUP BY\\n  \"lineitem\".[109 chars]tus\"'\nE                 SELECT\nE                   \"lineitem\".\"l_returnflag\" AS \"l_returnflag\",\nE                   \"lineitem\".\"l_linestatus\" AS \"l_linestatus\",\nE                   SUM(\"lineitem\".\"l_quantity\") AS \"sum_qty\",\nE                   SUM(\"lineitem\".\"l_extendedprice\") AS \"sum_base_price\",\nE                   SUM(\"lineitem\".\"l_extendedprice\" * (\nE                       1 - \"lineitem\".\"l_discount\"\nE                   )) AS \"sum_disc_price\",\nE                   SUM(\"lineitem\".\"l_extendedprice\" * (\nE                       1 - \"lineitem\".\"l_discount\"\nE                     ) * (\nE                       1 + \"lineitem\".\"l_tax\"\nE                   )) AS \"sum_charge\",\nE                   AVG(\"lineitem\".\"l_quantity\") AS \"avg_qty\",\nE                   AVG(\"lineitem\".\"l_extendedprice\") AS \"avg_price\",\nE                   AVG(\"lineitem\".\"l_discount\") AS \"avg_disc\",\nE                   COUNT(*) AS \"count_order\"\nE                 FROM \"lineitem\" AS \"lineitem\"\nE                 WHERE\nE               -   CAST(\"lineitem\".\"l_shipdate\" AS DATE) <= CAST('1998-12-01' AS DATE) - INTERVAL '90' day\nE               ?                                                       ^^  ^          --------------------\nE               +   CAST(\"lineitem\".\"l_shipdate\" AS DATE) <= CAST('1998-09-02' AS DATE)\nE               ?                                                       ^^  ^\nE                 GROUP BY\nE                   \"lineitem\".\"l_returnflag\",\nE                   \"lineitem\".\"l_linestatus\"\nE                 ORDER BY\nE                   \"lineitem\".\"l_returnflag\",\nE                   \"lineitem\".\"l_linestatus\"\n\n/workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258/tests/test_optimizer.py:32: AssertionError\n_______________________________\n[... Observation truncated due to length ...]\nm\".[1072 chars]ame\"'\nE                 SELECT\nE                   \"supplier\".\"s_name\" AS \"s_name\",\nE                   \"supplier\".\"s_address\" AS \"s_address\"\nE                 FROM (\nE                   SELECT\nE                     \"supplier\".\"s_suppkey\" AS \"s_suppkey\",\nE                     \"supplier\".\"s_name\" AS \"s_name\",\nE                     \"supplier\".\"s_address\" AS \"s_address\",\nE                     \"supplier\".\"s_nationkey\" AS \"s_nationkey\"\nE                   FROM \"supplier\" AS \"supplier\"\nE                 ) AS \"supplier\"\nE                 LEFT JOIN (\nE                   SELECT\nE                     \"partsupp\".\"ps_suppkey\" AS \"ps_suppkey\"\nE                   FROM \"partsupp\" AS \"partsupp\"\nE                   LEFT JOIN (\nE                     SELECT\nE                       0.5 * SUM(\"lineitem\".\"l_quantity\") AS \"_col_0\",\nE                       \"lineitem\".\"l_partkey\" AS \"_u_1\",\nE                       \"lineitem\".\"l_suppkey\" AS \"_u_2\"\nE                     FROM \"lineitem\" AS \"lineitem\"\nE                     WHERE\nE               -       \"lineitem\".\"l_shipdate\" < CAST('1994-01-01' AS DATE) + INTERVAL '1' year\nE               ?                                          ^                --------------------\nE               +       \"lineitem\".\"l_shipdate\" < CAST('1995-01-01' AS DATE)\nE               ?                                          ^\nE                       AND \"lineitem\".\"l_shipdate\" >= CAST('1994-01-01' AS DATE)\nE                     GROUP BY\nE                       \"lineitem\".\"l_partkey\",\nE                       \"lineitem\".\"l_suppkey\"\nE                   ) AS \"_u_0\"\nE                     ON \"_u_0\".\"_u_1\" = \"partsupp\".\"ps_partkey\"\nE                     AND \"_u_0\".\"_u_2\" = \"partsupp\".\"ps_suppkey\"\nE                   LEFT JOIN (\nE                     SELECT\nE                       \"part\".\"p_partkey\" AS \"p_partkey\"\nE                     FROM \"part\" AS \"part\"\nE                     WHERE\nE                       \"part\".\"p_name\" LIKE 'forest%'\nE                     GROUP BY\nE                       \"part\".\"p_partkey\"\nE                   ) AS \"_u_3\"\nE                     ON \"partsupp\".\"ps_partkey\" = \"_u_3\".\"p_partkey\"\nE                   WHERE\nE                     \"partsupp\".\"ps_availqty\" > \"_u_0\".\"_col_0\"\nE                     AND NOT \"_u_0\".\"_u_1\" IS NULL\nE                     AND NOT \"_u_0\".\"_u_2\" IS NULL\nE                     AND NOT \"_u_3\".\"p_partkey\" IS NULL\nE                   GROUP BY\nE                     \"partsupp\".\"ps_suppkey\"\nE                 ) AS \"_u_4\"\nE                   ON \"supplier\".\"s_suppkey\" = \"_u_4\".\"ps_suppkey\"\nE                 JOIN (\nE                   SELECT\nE                     \"nation\".\"n_nationkey\" AS \"n_nationkey\",\nE                     \"nation\".\"n_name\" AS \"n_name\"\nE                   FROM \"nation\" AS \"nation\"\nE                   WHERE\nE                     \"nation\".\"n_name\" = 'CANADA'\nE                 ) AS \"nation\"\nE                   ON \"supplier\".\"s_nationkey\" = \"nation\".\"n_nationkey\"\nE                 WHERE\nE                   NOT \"_u_4\".\"ps_suppkey\" IS NULL\nE                 ORDER BY\nE                   \"supplier\".\"s_name\"\n\n/workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258/tests/test_optimizer.py:32: AssertionError\n======================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================= short test summary info ========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================\nSUBFAILED[date '1998-12-01' - interval '90' day] ../../workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258/tests/test_optimizer.py::TestOptimizer::test_simplify - AssertionError: \"CAST('1998-12-01' AS DATE) - INTERVAL '90' day\" != \"CAST('1998-09-02' AS DATE)\"\nSUBFAILED[date '1998-12-01' + interval '1' week] ../../workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258/tests/test_optimizer.py::TestOptimizer::test_simplify - AssertionError: \"CAST('1998-12-01' AS DATE) + INTERVAL '1' week\" != \"CAST('1998-12-08' AS DATE)\"\nSUBFAILED[interval '1' year + date '1998-01-01'] ../../workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258/tests/test_optimizer.py::TestOptimizer::test_simplify - AssertionError: \"INTERVAL '1' year + CAST('1998-01-01' AS DATE)\" != \"CAST('1999-01-01' AS DATE)\"\nSUBFAILED[interval '1' year + date '1998-01-01' + 3 * 7 * 4] ../../workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258/tests/test_optimizer.py::TestOptimizer::test_simplify - AssertionError: \"INTERVAL '1' year + CAST('1998-01-01' AS DATE) + 84\" != \"CAST('1999-01-01' AS DATE) + 84\"\nSUBFAILED[select\n        l_returnflag,\n        l_linestatus,\n        sum(l_quantity) as sum_qty,\n        sum(l_extendedprice) as sum_base_price,\n        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,\n        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,\n        avg(l_quantity) as avg_qty,\n        avg(l_extendedprice) as avg_price,\n        avg(l_discount) as avg_disc,\n        count(*) as count_order\nfrom\n        lineitem\nwhere\n        CAST(l_shipdate AS DATE) <= date '1998-12-01' - interval '90' day\ngroup by\n        l_returnflag,\n        l_linestatus\norder by\n        l_returnflag,\n        l_linestatus] ../../workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258/tests/test_optimizer.py::TestOptimizer::test_tpch - AssertionError: 'SELE[708 chars]1998-12-01\\' AS DATE) - INTERVAL \\'90\\' day\\nG[131 chars]tus\"' != 'SELE[708 chars]1998-09-02\\' AS DATE)\\nGROUP BY\\n  \"lineitem\".[109 chars]tus\"'\nSUBFAILED[select\n        o_orderpriority,\n        count(*) as order_count\nfrom\n        orders\nwhere\n        o_orderdate >= date '1993-07-01'\n        and o_orderdate < date '1993-07-01' + interval '3' month\n        and exists (\n                select\n                        *\n                from\n                        lineitem\n                where\n                        l_orderkey = o_orderkey\n                        and l_commitdate < l_receiptdate\n        )\ngroup by\n        o_orderpriority\norder by\n        o_orderpriority] ../../workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258/tests/test_optimizer.py::TestOptimizer::test_tpch - AssertionError: 'SELE[427 chars]1993-07-01\\' AS DATE) + INTERVAL \\'3\\' month\\n[175 chars]ity\"' != 'SELE[427 chars]1993-10-01\\' AS DATE)\\n  AND \"orders\".\"o_order[152 chars]ity\"'\nSUBFAILED[select\n        n_name,\n        sum(l_extendedprice * (1 - l_discount)) as revenue\nfrom\n        customer,\n        orders,\n        lineitem,\n        supplier,\n        nation,\n        region\nwhere\n        c_custkey = o_custkey\n        and l_orderkey = o_orderkey\n        and l_suppkey = s_suppkey\n        and c_nationkey = s_nationkey\n        and s_nationkey = n_nationkey\n        and n_regionkey = r_regionkey\n        and r_name = 'ASIA'\n        and o_orderdate >= date '1994-01-01'\n        and o_orderdate < date '1994-01-01' + interval '1' year\ngroup by\n        n_name\norder by\n        revenue desc] ../../workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258/tests/test_optimizer.py::TestOptimizer::test_tpch - AssertionError: 'SELE[512 chars]\\'1994-01-01\\' AS DATE) + INTERVAL \\'1\\' year\\[1262 chars]DESC' != 'SELE[512 chars]\\'1995-01-01\\' AS DATE)\\n    AND \"orders\".\"o_o[1240 chars]DESC'\nSUBFAILED[select\n        sum(l_extendedprice * l_discount) as revenue\nfrom\n        lineitem\nwhere\n        l_shipdate >= date '1994-01-01'\n        and l_shipdate < date '1994-01-01' + interval '1' year\n        and l_discount between 0.06 - 0.01 and 0.06 + 0.01\n        and l_quantity < 24] ../../workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258/tests/test_optimizer.py::TestOptimizer::test_tpch - AssertionError: 'SELE[240 chars]\\'1994-01-01\\' AS DATE) + INTERVAL \\'1\\' year\\[58 chars]ATE)' != 'SELE[240 chars]\\'1995-01-01\\' AS DATE)\\n  AND \"lineitem\".\"l_s[36 chars]ATE)'\nSUBFAILED[select\n        c_custkey,\n        c_name,\n        sum(l_extendedprice * (1 - l_discount)) as revenue,\n        c_acctbal,\n        n_name,\n        c_address,\n        c_phone,\n        c_comment\nfrom\n        customer,\n        orders,\n        lineitem,\n        nation\nwhere\n        c_custkey = o_custkey\n        and l_orderkey = o_orderkey\n        and o_orderdate >= date '1993-10-01'\n        and o_orderdate < date '1993-10-01' + interval '3' month\n        and l_returnflag = 'R'\n        and c_nationkey = n_nationkey\ngroup by\n        c_custkey,\n        c_name,\n        c_acctbal,\n        c_phone,\n        n_name,\n        c_address,\n        c_comment\norder by\n        revenue desc\nlimit\n        20] ../../workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258/tests/test_optimizer.py::TestOptimizer::test_tpch - AssertionError: 'SELE[964 chars]\\'1993-10-01\\' AS DATE) + INTERVAL \\'3\\' month[919 chars]T 20' != 'SELE[964 chars]\\'1994-01-01\\' AS DATE)\\n    AND \"orders\".\"o_o[896 chars]T 20'\nSUBFAILED[select\n        l_shipmode,\n        sum(case\n                when o_orderpriority = '1-URGENT'\n                        or o_orderpriority = '2-HIGH'\n                        then 1\n                else 0\n        end) as high_line_count,\n        sum(case\n                when o_orderpriority <> '1-URGENT'\n                        and o_orderpriority <> '2-HIGH'\n                        then 1\n                else 0\n        end) as low_line_count\nfrom\n        orders,\n        lineitem\nwhere\n        o_orderkey = l_orderkey\n        and l_shipmode in ('MAIL', 'SHIP')\n        and l_commitdate < l_receiptdate\n        and l_shipdate < l_commitdate\n        and l_receiptdate >= date '1994-01-01'\n        and l_receiptdate < date '1994-01-01' + interval '1' year\ngroup by\n        l_shipmode\norder by\n        l_shipmode] ../../workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258/tests/test_optimizer.py::TestOptimizer::test_tpch - AssertionError: 'SELE[961 chars]\\'1994-01-01\\' AS DATE) + INTERVAL \\'1\\' year\\[326 chars]ode\"' != 'SELE[961 chars]\\'1995-01-01\\' AS DATE)\\n    AND \"lineitem\".\"l[304 chars]ode\"'\nSUBFAILED[select\n        100.00 * sum(case\n                when p_type like 'PROMO%'\n                        then l_extendedprice * (1 - l_discount)\n                else 0\n        end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue\nfrom\n        lineitem,\n        part\nwhere\n        l_partkey = p_partkey\n        and l_shipdate >= date '1995-09-01'\n        and l_shipdate < date '1995-09-01' + interval '1' month] ../../workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258/tests/test_optimizer.py::TestOptimizer::test_tpch - AssertionError: 'SELE[573 chars]1995-09-01\\' AS DATE) + INTERVAL \\'1\\' month\\n[255 chars]key\"' != 'SELE[573 chars]1995-10-01\\' AS DATE)\\n    AND \"lineitem\".\"l_s[232 chars]key\"'\nSUBFAILED[with revenue (supplier_no, total_revenue) as (\n        select\n                l_suppkey,\n                sum(l_extendedprice * (1 - l_discount))\n        from\n                lineitem\n        where\n                l_shipdate >= date '1996-01-01'\n                and l_shipdate < date '1996-01-01' + interval '3' month\n        group by\n                l_suppkey)\nselect\n        s_suppkey,\n        s_name,\n        s_address,\n        s_phone,\n        total_revenue\nfrom\n        supplier,\n        revenue\nwhere\n        s_suppkey = supplier_no\n        and total_revenue = (\n                select\n                        max(total_revenue)\n                from\n                        revenue\n        )\norder by\n        s_suppkey] ../../workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258/tests/test_optimizer.py::TestOptimizer::test_tpch - AssertionError: 'WITH[259 chars]996-01-01\\' AS DATE) + INTERVAL \\'3\\' month\\n [779 chars]key\"' != 'WITH[259 chars]996-04-01\\' AS DATE)\\n    AND \"lineitem\".\"l_sh[756 chars]key\"'\nSUBFAILED[select\n        s_name,\n        s_address\nfrom\n        supplier,\n        nation\nwhere\n        s_suppkey in (\n                select\n                        ps_suppkey\n                from\n                        partsupp\n                where\n                        ps_partkey in (\n                                select\n                                        p_partkey\n                                from\n                                        part\n                                where\n                                        p_name like 'forest%'\n                        )\n                        and ps_availqty > (\n                                select\n                                        0.5 * sum(l_quantity)\n                                from\n                                        lineitem\n                                where\n                                        l_partkey = ps_partkey\n                                        and l_suppkey = ps_suppkey\n                                        and l_shipdate >= date '1994-01-01'\n                                        and l_shipdate < date '1994-01-01' + interval '1' year\n                        )\n        )\n        and s_nationkey = n_nationkey\n        and n_name = 'CANADA'\norder by\n        s_name] ../../workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258/tests/test_optimizer.py::TestOptimizer::test_tpch - AssertionError: 'SELE[669 chars]\\'1994-01-01\\' AS DATE) + INTERVAL \\'1\\' year\\[1094 chars]ame\"' != 'SELE[669 chars]\\'1995-01-01\\' AS DATE)\\n      AND \"lineitem\".[1072 chars]ame\"'\n==================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================== 13 failed, 18 passed in 0.43s =====================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================", "extras": {"command": "pytest /workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258/tests/test_optimizer.py", "metadata": {"exit_code": 1, "pid": -1, "username": "root", "hostname": "55b831a6f996", "working_dir": "/workspace/tobymao__sqlglot__tobymao__sqlglot-e604fe6d8258", "py_interpreter_path": "/openhands/micromamba/envs/openhands/bin/python", "prefix": "", "suffix": "\n[The command completed with exit code 1.]"}, "hidden": false}, "success": false}