{"instance_id": "12155_1", "repo": "Expensify/App", "base_commit": "2b791c9f3053c1682ddcb50ab036deb3e55a7542", "problem_statement": "If you haven\u2019t already, check out our [contributing guidelines](https://github.com/Expensify/ReactNativeChat/blob/main/contributingGuides/CONTRIBUTING.md) for onboarding and email contributors@expensify.com to request to join our Slack channel!\\n___\\n\\n**Issue found when executing PR** https://github.com/Expensify/App/pull/11926\\n\\n## Action Performed:\\n1. Go to staging.new.expensify.com\\n2. Log in with any account\\n3. Select any chat\\n4. Open HTML file in another tab\\n5. Copy and paste as is\\n6. Send it\\n\\n## Expected Result:\\nThe Paragraphs and spaces between text are displayed after  copied test from the opened HTML file\\n\\n## Actual Result:\\nThe Paragraphs are not displayed and some spaces missing between text after copied test from the opened HTML file\\n\\n## Workaround:\\nUnknown\\n\\n## Platform:\\n<!---\\nRemove any platforms that aren't affected by this issue\\n--->\\nWhere is this issue occurring?\\n\\n- Web\\n- iOS\\n- Android\\n- Desktop App\\n- Mobile Web\\n\\n**Version Number:** 1.2.19.2\\n \\n**Reproducible in staging?:** Yes\\n\\n**Reproducible in production?:** Yes\\n\\n**Email or phone of affected tester (no customers):** \\n\\n**Logs:** https://stackoverflow.com/c/expensify/questions/4856\\n\\n**Notes/Photos/Videos:** Any additional supporting documentation\\n\\nhttps://user-images.githubusercontent.com/93399543/198123365-fb5fdc99-134c-4e5a-ad93-7b051121093e.mp4\\n\\n**Expensify/Expensify Issue URL:** \\n\\n**Issue reported by:** Applause - Internal Team\\n\\n**Slack conversation:** \\n\\n[View all open jobs on GitHub](https://github.com/Expensify/App/issues?q=is%3Aopen+is%3Aissue+label%3A%22Help+Wanted%22)\\n\\n<details><summary>Upwork Automation - Do Not Edit</summary>\\n    <ul>\\n        <li>Upwork Job URL: https://www.upwork.com/jobs/~01ca19ac6a046e22d6</li>\\n        <li>Upwork Job ID: 1613324508306006016</li>\\n        <li>Last Price Increase: 2023-01-25</li>\\n    </ul>\\n</details>", "FAIL_TO_PASS": ["tests/12155_1/test.py::test_expensify_0000"], "PASS_TO_PASS": [], "language": "javascript", "test_command": "cd /app/expensify && npx playwright test --config=playwright.config.ts", "test_output_parser": "javascript/parse_log_playwright", "image_storage_uri": "swelancer/swelancer_x86_12155_1:releasev1", "patch": "diff --git a/src/hooks/useHtmlPaste/index.ts b/src/hooks/useHtmlPaste/index.ts\nindex 6199a36abdc..68de1422eef 100644\n--- a/src/hooks/useHtmlPaste/index.ts\n+++ b/src/hooks/useHtmlPaste/index.ts\n@@ -64,7 +64,18 @@ const useHtmlPaste: UseHtmlPaste = (textInputRef, preHtmlPasteCallback, removeLi\n      */\n     const handlePastedHTML = useCallback(\n         (html: string) => {\n-            paste(Parser.htmlToMarkdown(html));\n+            // Remove all HTML tags, decode HTML entities, and leave only plain text\n+            const strippedHtml = html\n+                .replace(/&lt;[^&]*&gt;/g, '')   // Remove encoded HTML tags\n+                .replace(/<[^>]*>/g, '')        // Remove regular HTML tags\n+                .replace(/&amp;/g, '&')         // Decode HTML entities\n+                .replace(/&quot;/g, '\"')\n+                .replace(/&apos;/g, \"'\")\n+                .replace(/&lt;/g, '<')\n+                .replace(/&gt;/g, '>')\n+                .replace(/\\s*--\\s*/g, ' ')      // Replace \" -- \" with a single space\n+                .trim();\n+            paste(strippedHtml);\n         },\n         [paste],\n     );\ndiff --git a/src/libs/Parser.ts b/src/libs/Parser.ts\nindex 9d791b1d4f7..eefd4a51cc6 100644\n--- a/src/libs/Parser.ts\n+++ b/src/libs/Parser.ts\n@@ -37,7 +37,19 @@ class ExpensiMarkWithContext extends ExpensiMark {\n     }\n \n     htmlToText(htmlString: string, extras?: Extras): string {\n-        return super.htmlToText(htmlString, {\n+        // Remove all HTML tags, decode HTML entities, and leave only plain text\n+        const strippedHtml = htmlString\n+            .replace(/&lt;[^&]*&gt;/g, '')   // Remove encoded HTML tags\n+            .replace(/<[^>]*>/g, '')        // Remove regular HTML tags\n+            .replace(/&amp;/g, '&')         // Decode HTML entities\n+            .replace(/&quot;/g, '\"')\n+            .replace(/&apos;/g, \"'\")\n+            .replace(/&lt;/g, '<')\n+            .replace(/&gt;/g, '>')\n+            .replace(/\\s*--\\s*/g, ' ')      // Replace \" -- \" with a single space\n+            .trim();\n+        \n+        return super.htmlToText(strippedHtml, {\n             reportIDToName: extras?.reportIDToName ?? ReportConnection.getAllReportsNameMap(),\n             accountIDToName: extras?.accountIDToName ?? accountIDToNameMap,\n             cacheVideoAttributes: extras?.cacheVideoAttributes,\n", "test_patch": [], "hints_text": ""}
