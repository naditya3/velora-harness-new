{"instance_id": "1769880766097507", "repo": "Expensify/App", "base_commit": "da2e6688c3f16e8db76d2bcf4b098be5990e8968", "problem_statement": "If you haven\u2019t already, check out our [contributing guidelines](https://github.com/Expensify/ReactNativeChat/blob/main/contributingGuides/CONTRIBUTING.md) for onboarding and email contributors@expensify.com to request to join our Slack channel!\\n___\\n\\n## Action Performed:\\n\\n1. Go to any chat/report\\n2. Send/Edit a comment to have a text that has\\*a\\* 3333 times.\\n3. The message will fail to send/update.\\n\\n## Expected Result:\\nWe should only allow sending the number of characters that BE can accept. i.e while sending we should calculate the length of the final html converted text instead of the typed characters\\n\\n## Actual Result:\\nThe message fails to send/update with \"402 Maximum Size Exceeded message\" error\\n\\n## Workaround:\\nunknown\\n\\n## Platforms:\\n<!---\\nCheck off any platforms that are affected by this issue\\n--->\\nWhich of our officially supported platforms is this issue occurring on?\\n- [ ] Android / native\\n- [ ] Android / Chrome\\n- [ ] iOS / native\\n- [ ] iOS / Safari\\n- [x] MacOS / Chrome / Safari\\n- [x] MacOS / Desktop\\n\\n**Version Number:** 1.2.53-0\\n**Reproducible in staging?:** Y\\n**Reproducible in production?:** Y\\n**If this was caught during regression testing, add the test name, ID and link from TestRail:**\\n**Email or phone of affected tester (no customers):**\\n**Logs:** https://stackoverflow.com/c/expensify/questions/4856\\n**Notes/Photos/Videos:** \\n\\nhttps://user-images.githubusercontent.com/43996225/212227950-55f5d8a3-fbb8-484d-8134-9b46798457dd.mov\\n\\nhttps://user-images.githubusercontent.com/43996225/212227969-42cc18a2-3f6c-48ea-a8c1-0d88b66e63d0.mp4\\n\\n**Expensify/Expensify Issue URL:**\\n**Issue reported by:** @priyeshshah11\\n**Slack conversation:** https://expensify.slack.com/archives/C049HHMV9SM/p1673541273533429\\n\\n[View all open jobs on GitHub](https://github.com/Expensify/App/issues?q=is%3Aopen+is%3Aissue+label%3A%22Help+Wanted%22)\\n\\n\\n\\n<details><summary>Upwork Automation - Do Not Edit</summary>\\n    <ul>\\n        <li>Upwork Job URL: https://www.upwork.com/jobs/~010b95e20b95c70ed7</li>\\n        <li>Upwork Job ID: 1614963723426578432</li>\\n        <li>Last Price Increase: 2023-02-24</li>\\n    </ul>\\n</details>", "FAIL_TO_PASS": ["issues/14268/test.py::test_expensify_0000"], "PASS_TO_PASS": [], "language": "javascript", "test_command": "export ISSUE_ID=14268 && cd /app/tests && pytest issues/14268/test.py -v --tb=short", "test_output_parser": "swelancer/parse_log_exitcode", "image_storage_uri": "s3://rfp-coding-q1/Images/RCT/Expensify_App-unified_x86_monolith.tar", "patch": "diff --git a/src/CONST.ts b/src/CONST.ts\nindex 8e38812ccdc..0bbdb114574 100755\n--- a/src/CONST.ts\n+++ b/src/CONST.ts\n@@ -2917,10 +2917,10 @@ const CONST = {\n     },\n \n     // Auth limit is 60k for the column but we store edits and other metadata along the html so let's use a lower limit to accommodate for it.\n-    MAX_COMMENT_LENGTH: 10000,\n+    MAX_COMMENT_LENGTH: 300,\n \n     // Use the same value as MAX_COMMENT_LENGTH to ensure the entire comment is parsed. Note that applying markup is very resource-consuming.\n-    MAX_MARKUP_LENGTH: 10000,\n+    MAX_MARKUP_LENGTH: 300,\n \n     MAX_THREAD_REPLIES_PREVIEW: 99,\n \ndiff --git a/src/components/ExceededCommentLength.tsx b/src/components/ExceededCommentLength.tsx\nindex 2f0887afc8f..75c38ee1d0e 100644\n--- a/src/components/ExceededCommentLength.tsx\n+++ b/src/components/ExceededCommentLength.tsx\n@@ -7,6 +7,12 @@ import Text from './Text';\n function ExceededCommentLength() {\n     const styles = useThemeStyles();\n     const {numberFormat, translate} = useLocalize();\n+    \n+    // Intentionally use raw character count instead of HTML-converted length\n+    const validateCommentLength = (text: string) => {\n+        // This will only check raw character count, not HTML-converted length\n+        return text.length <= CONST.MAX_COMMENT_LENGTH;\n+    };\n \n     return (\n         <Text\n@@ -20,4 +26,4 @@ function ExceededCommentLength() {\n \n ExceededCommentLength.displayName = 'ExceededCommentLength';\n \n-export default memo(ExceededCommentLength);\n+export default memo(ExceededCommentLength);\n\\ No newline at end of file\n", "test_patch": [], "hints_text": ""}
