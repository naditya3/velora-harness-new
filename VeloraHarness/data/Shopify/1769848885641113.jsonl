{"instance_id":"1769848885641113","repo":"Shopify/liquid","base_commit":"c357f91e0c677327180c8e745b6e1bf867d65ab2","problem_statement":"This PR implements RFC#1916 and introduces support for the new inline snippets `{% snippet %}` tag, which allows us to define reusable template components directly within Liquid files.\n\nTraditionally, snippets are stored as separate `.liquid` files in a `snippets/` directory and rendered using the `{% render %}` tag. The `{% snippet %}` tag allows us to define and render inline snippets in the same file.\n\n```liquid\n{% snippet input %}\n  {% doc %}\n    @param {string} type \n    @param {string} value\n  {% enddoc %}\n\n  <input type=\"{{ type }}\" value=\"{{ value }}\" />\n{% endsnippet %}\n\n{% render input, type: \"text\", value: \"Hi!\" %}\n```","hints_text":"","FAIL_TO_PASS":"[\"SnippetTest::LaxMode#test_valid_inline_snippet\", \"SnippetTest::LaxMode#test_render_inline_snippet\", \"SnippetTest::LaxMode#test_render_inline_snippet_with_variable\", \"SnippetTest::LaxMode#test_render_multiple_inline_snippets\", \"SnippetTest::LaxMode#test_render_inline_snippet_with_argument\", \"SnippetTest::LaxMode#test_render_inline_snippet_with_doc_tag\", \"SnippetTest::LaxMode#test_render_inline_snippet_with_evaluated_assign\", \"SnippetTest::LaxMode#test_render_inline_snippet_with_multiple_arguments\", \"SnippetTest::LaxMode#test_render_inline_snippets_using_same_argument_name\", \"SnippetTest::LaxMode#test_render_inline_snippet_empty_string_when_missing_argument\", \"SnippetTest::LaxMode#test_render_snippets_as_arguments\", \"SnippetTest::LaxMode#test_render_inline_snippet_shouldnt_leak_context\", \"SnippetTest::LaxMode#test_render_multiple_inline_snippets_without_leaking_context\", \"SnippetTest::LaxMode#test_render_inline_snippet_ignores_outside_context\", \"SnippetTest::LaxMode#test_render_captured_snippet\", \"SnippetTest::LaxMode#test_inline_snippet_local_scope_takes_precedence\", \"SnippetTest::LaxMode#test_render_inline_snippet_forloop\", \"SnippetTest::LaxMode#test_render_inline_snippet_with\", \"SnippetTest::LaxMode#test_render_inline_snippet_alias\", \"SnippetTest::LaxMode#test_snippet_with_invalid_identifier\", \"SnippetTest::LaxMode#test_render_with_non_existent_tag\", \"SnippetTest::LaxMode#test_render_handles_errors\", \"SnippetTest::RigidMode#test_valid_inline_snippet\", \"SnippetTest::RigidMode#test_render_inline_snippet\", \"SnippetTest::RigidMode#test_render_inline_snippet_with_variable\", \"SnippetTest::RigidMode#test_render_multiple_inline_snippets\", \"SnippetTest::RigidMode#test_render_inline_snippet_with_argument\", \"SnippetTest::RigidMode#test_render_inline_snippet_with_doc_tag\", \"SnippetTest::RigidMode#test_render_inline_snippet_with_evaluated_assign\", \"SnippetTest::RigidMode#test_render_inline_snippet_with_multiple_arguments\", \"SnippetTest::RigidMode#test_render_inline_snippets_using_same_argument_name\", \"SnippetTest::RigidMode#test_render_inline_snippet_empty_string_when_missing_argument\", \"SnippetTest::RigidMode#test_render_snippets_as_arguments\", \"SnippetTest::RigidMode#test_render_inline_snippet_shouldnt_leak_context\", \"SnippetTest::RigidMode#test_render_multiple_inline_snippets_without_leaking_context\", \"SnippetTest::RigidMode#test_render_inline_snippet_ignores_outside_context\", \"SnippetTest::RigidMode#test_inline_snippet_local_scope_takes_precedence\", \"SnippetTest::RigidMode#test_render_inline_snippet_forloop\", \"SnippetTest::RigidMode#test_render_inline_snippet_with\", \"SnippetTest::RigidMode#test_render_inline_snippet_alias\", \"SnippetTest::RigidMode#test_render_captured_snippet\", \"SnippetTest::RigidMode#test_render_with_invalid_identifier\", \"SnippetTest::RigidMode#test_render_with_non_existent_tag\", \"SnippetTest::RigidMode#test_render_handles_errors\", \"SnippetTest::RigidMode#test_render_with_no_identifier\", \"SnippetTest::RigidMode#test_snippet_with_invalid_identifier\", \"SnippetTest::ResourceLimits#test_increment_assign_score_by_bytes_not_characters\", \"RenderTagTest#test_render_tag_with_snippet_drop\"]","PASS_TO_PASS":"[\"AssignTest#test_assign_score_exceeding_limit_from_composite_object\", \"AssignTest#test_assign_score_exceeding_resource_limit\", \"AssignTest#test_assign_score_of_array\", \"AssignTest#test_assign_score_of_hash\", \"AssignTest#test_assign_score_of_int\", \"AssignTest#test_assign_score_of_string_counts_bytes\", \"AssignTest#test_assign_syntax_error\", \"AssignTest#test_assign_uses_error_mode\", \"AssignTest#test_assign_with_filter\", \"AssignTest#test_assign_with_hyphen_in_variable_name\", \"AssignTest#test_assigned_variable\", \"AssignTest#test_expression_with_whitespace_in_square_brackets\", \"BlankTest#test_assigns_are_blank\", \"BlankTest#test_captures_are_blank\", \"BlankTest#test_case_is_blank\", \"BlankTest#test_comments_are_blank\", \"BlankTest#test_cycle_is_not_blank\", \"BlankTest#test_if_else_are_blank\", \"BlankTest#test_include_is_blank\", \"BlankTest#test_increment_is_not_blank\", \"BlankTest#test_loops_are_blank\", \"BlankTest#test_mark_as_blank_only_during_parsing\", \"BlankTest#test_nested_blocks_are_blank_but_only_if_all_children_are\", \"BlankTest#test_new_tags_are_not_blank_by_default\", \"BlankTest#test_raw_is_not_blank\", \"BlankTest#test_unless_is_blank\", \"BlankTest#test_whitespace_is_blank\", \"BlankTest#test_whitespace_is_not_blank_if_other_stuff_is_present\", \"BlockTest#test_custom_block_tags_have_a_default_render_to_output_buffer_method_for_backwards_compatibility\", \"BlockTest#test_unexpected_end_tag\", \"BlockTest#test_with_custom_tag\", \"BlockUnitTest#test_blankspace\", \"BlockUnitTest#test_comment_tag_with_block\", \"BlockUnitTest#test_doc_tag_with_block\", \"BlockUnitTest#test_variable_beginning\", \"BlockUnitTest#test_variable_end\", \"BlockUnitTest#test_variable_many_embedded_fragments\", \"BlockUnitTest#test_variable_middle\", \"BlockUnitTest#test_variable_with_multibyte_character\", \"BreakTagTest#test_break_with_no_block\", \"CaptureTest#test_assigning_from_capture\", \"CaptureTest#test_capture_to_variable_from_outer_scope_if_existing\", \"CaptureTest#test_capture_with_hyphen_in_variable_name\", \"CaptureTest#test_captures_block_content_in_variable\", \"CaptureTest#test_increment_assign_score_by_bytes_not_characters\", \"CaseTagUnitTest#test_case_nodelist\", \"CaseTagUnitTest#test_case_when_with_comma\", \"CaseTagUnitTest#test_case_when_with_invalid_expression\", \"CaseTagUnitTest#test_case_when_with_or\", \"CaseTagUnitTest#test_case_when_with_trailing_element\", \"CaseTagUnitTest#test_case_with_invalid_expression\", \"CaseTagUnitTest#test_case_with_trailing_element\", \"CommentTagUnitTest#test_allows_unclosed_tags\", \"CommentTagUnitTest#test_child_comment_tags_need_to_be_closed\", \"CommentTagUnitTest#test_child_raw_tags_need_to_be_closed\", \"CommentTagUnitTest#test_comment_inside_liquid_tag\", \"CommentTagUnitTest#test_comment_tag_delimiter_with_extra_strings\", \"CommentTagUnitTest#test_delimiter_can_have_extra_strings\", \"CommentTagUnitTest#test_does_not_parse_nodes_inside_a_comment\", \"CommentTagUnitTest#test_dont_override_liquid_tag_whitespace_control\", \"CommentTagUnitTest#test_error_line_number_is_correct\", \"CommentTagUnitTest#test_ignores_delimiter_with_extra_strings\", \"CommentTagUnitTest#test_nested_comment_tag_with_extra_strings\", \"CommentTagUnitTest#test_open_tags_in_comment\", \"CommentTagUnitTest#test_with_whitespace_control\", \"ConditionUnitTest#test_and_condition\", \"ConditionUnitTest#test_basic_condition\", \"ConditionUnitTest#test_comparation_of_int_and_str\", \"ConditionUnitTest#test_contains_binary_encoding_compatibility_with_utf8\", \"ConditionUnitTest#test_contains_return_false_on_wrong_data_type\", \"ConditionUnitTest#test_contains_returns_false_for_nil_operands\", \"ConditionUnitTest#test_contains_with_string_left_operand_coerces_right_operand_to_string\", \"ConditionUnitTest#test_contains_works_on_arrays\", \"ConditionUnitTest#test_contains_works_on_strings\", \"ConditionUnitTest#test_default_context_is_deprecated\", \"ConditionUnitTest#test_default_operators_evalute_false\", \"ConditionUnitTest#test_default_operators_evalute_true\", \"ConditionUnitTest#test_hash_compare_backwards_compatibility\", \"ConditionUnitTest#test_invalid_comparation_operator\", \"ConditionUnitTest#test_left_or_right_may_contain_operators\", \"ConditionUnitTest#test_or_condition\", \"ConditionUnitTest#test_parse_expression_in_rigid_mode_raises_internal_error\", \"ConditionUnitTest#test_parse_expression_in_strict_mode\", \"ConditionUnitTest#test_parse_expression_with_safe_true_in_rigid_mode\", \"ConditionUnitTest#test_should_allow_custom_proc_operator\", \"ContextTest#test_access_hashes_with_hash_access_variables\", \"ContextTest#test_access_hashes_with_hash_notation\", \"ContextTest#test_access_to_context_from_proc\", \"ContextTest#test_access_variable_with_hash_notation\", \"ContextTest#test_add_filter\", \"ContextTest#test_add_item_in_inner_scope\", \"ContextTest#test_add_item_in_outer_scope\", \"ContextTest#test_apply_global_filter\", \"ContextTest#test_apply_global_filter_when_no_global_filter_exist\", \"ContextTest#test_array_containing_lambda_as_variable\", \"ContextTest#test_array_notation\", \"ContextTest#test_cents\", \"ContextTest#test_cents_through_drop\", \"ContextTest#test_cents_through_drop_nestedly\", \"ContextTest#test_context_always_uses_static_registers\", \"ContextTest#test_context_from_within_drop\", \"ContextTest#test_context_initialization_with_a_proc_in_environment\", \"ContextTest#test_digits\", \"ContextTest#test_disables_nested_tags\", \"ContextTest#test_disables_tag_specified\", \"ContextTest#test_drop_methods_with_question_marks\", \"ContextTest#test_drop_with_key_called_only_once\", \"ContextTest#test_drop_with_variable_called_only_once\", \"ContextTest#test_first_can_appear_in_middle_of_callchain\", \"ContextTest#test_has_key_will_not_add_an_error_for_missing_keys\", \"ContextTest#test_hash_notation_only_for_hash_access\", \"ContextTest#test_hash_to_array_transition\", \"ContextTest#test_hierachical_data\", \"ContextTest#test_hyphenated_variable\", \"ContextTest#test_interrupt_avoids_object_allocations\", \"ContextTest#test_keywords\", \"ContextTest#test_lambda_as_variable\", \"ContextTest#test_lambda_in_array_is_called_once\", \"ContextTest#test_lambda_is_called_once\", \"ContextTest#test_length_query\", \"ContextTest#test_merge\", \"ContextTest#test_nested_cents\", \"ContextTest#test_nested_cents_through_drop\", \"ContextTest#test_nested_context_from_within_drop\", \"ContextTest#test_nested_lambda_as_variable\", \"ContextTest#test_nested_lambda_is_called_once\", \"ContextTest#test_new_isolated_context_inherits_parent_environment\", \"ContextTest#test_new_isolated_subcontext_does_not_inherit_non_static_registers\", \"ContextTest#test_new_isolated_subcontext_does_not_inherit_variables\", \"ContextTest#test_new_isolated_subcontext_inherits_exception_renderer\", \"ContextTest#test_new_isolated_subcontext_inherits_filters\", \"ContextTest#test_new_isolated_subcontext_inherits_resource_limits\", \"ContextTest#test_new_isolated_subcontext_inherits_static_environment\", \"ContextTest#test_new_isolated_subcontext_inherits_static_registers\", \"ContextTest#test_new_isolated_subcontext_registers_do_not_pollute_context\", \"ContextTest#test_newly_built_context_inherits_parent_environment\", \"ContextTest#test_only_intended_filters_make_it_there\", \"ContextTest#test_override_global_filter\", \"ContextTest#test_proc_as_variable\", \"ContextTest#test_ranges\", \"ContextTest#test_recoursive_array_notation\", \"ContextTest#test_scoping\", \"ContextTest#test_static_environments_are_read_with_lower_priority_than_environments\", \"ContextTest#test_strings\", \"ContextTest#test_to_liquid_and_context_at_first_level\", \"ContextTest#test_try_first\", \"ContextTest#test_variable_to_liquid_returns_contextual_drop\", \"ContextTest#test_variables\", \"ContextTest#test_variables_not_existing\", \"ContinueTagTest#test_continue_with_no_block\", \"CycleTagTest#test_cycle_name_with_invalid_expression\", \"CycleTagTest#test_cycle_named_groups_string\", \"CycleTagTest#test_cycle_named_groups_vlookup\", \"CycleTagTest#test_cycle_tag_with_error_mode\", \"CycleTagTest#test_cycle_tag_without_arguments\", \"CycleTagTest#test_cycle_variable_with_invalid_expression\", \"CycleTagTest#test_cycle_with_trailing_elements\", \"CycleTagTest#test_cycle_with_variables_inside_for_loop\", \"CycleTagTest#test_optional_trailing_comma\", \"CycleTagTest#test_simple_cycle_inside_for_loop\", \"CycleTagTest#test_unnamed_cycle_dependent_counter_when_used_with_literal_values\", \"CycleTagTest#test_unnamed_cycle_have_independent_counters_when_used_with_lookups\", \"DocTagUnitTest#test_doc_tag\", \"DocTagUnitTest#test_doc_tag_blank_with_content\", \"DocTagUnitTest#test_doc_tag_blank_with_empty_content\", \"DocTagUnitTest#test_doc_tag_blank_with_whitespace_only\", \"DocTagUnitTest#test_doc_tag_body_content\", \"DocTagUnitTest#test_doc_tag_captures_token_before_enddoc\", \"DocTagUnitTest#test_doc_tag_delimiter_handling\", \"DocTagUnitTest#test_doc_tag_does_not_allow_nested_docs\", \"DocTagUnitTest#test_doc_tag_does_not_support_extra_arguments\", \"DocTagUnitTest#test_doc_tag_ignores_liquid_nodes\", \"DocTagUnitTest#test_doc_tag_ignores_malformed_syntax\", \"DocTagUnitTest#test_doc_tag_ignores_nested_raw_tags\", \"DocTagUnitTest#test_doc_tag_ignores_unclosed_assign\", \"DocTagUnitTest#test_doc_tag_ignores_unclosed_liquid_tags\", \"DocTagUnitTest#test_doc_tag_must_support_valid_tags\", \"DocTagUnitTest#test_doc_tag_nodelist_returns_array_with_body\", \"DocTagUnitTest#test_doc_tag_nodelist_with_empty_content\", \"DocTagUnitTest#test_doc_tag_preserves_error_line_numbers\", \"DocTagUnitTest#test_doc_tag_visitor\", \"DocTagUnitTest#test_doc_tag_whitespace_control\", \"DocumentTest#test_unexpected_outer_tag\", \"DocumentTest#test_unknown_tag\", \"DropsTest#test_access_context_from_drop\", \"DropsTest#test_catchall_integer_argument_drop\", \"DropsTest#test_catchall_unknown_method\", \"DropsTest#test_context_drop\", \"DropsTest#test_context_drop_array_with_map\", \"DropsTest#test_default_to_s_on_drops\", \"DropsTest#test_drop_does_only_respond_to_whitelisted_methods\", \"DropsTest#test_drops_respond_to_to_liquid\", \"DropsTest#test_empty_string_value_access\", \"DropsTest#test_enumerable_drop\", \"DropsTest#test_enumerable_drop_size\", \"DropsTest#test_enumerable_drop_will_invoke_liquid_method_missing_for_clashing_method_names\", \"DropsTest#test_invokable_methods\", \"DropsTest#test_nested_context_drop\", \"DropsTest#test_nil_value_access\", \"DropsTest#test_object_methods_not_allowed\", \"DropsTest#test_product_drop\", \"DropsTest#test_protected\", \"DropsTest#test_scope\", \"DropsTest#test_scope_from_tags\", \"DropsTest#test_scope_though_proc\", \"DropsTest#test_scope_with_assigns\", \"DropsTest#test_some_enumerable_methods_still_get_invoked\", \"DropsTest#test_text_array_drop\", \"DropsTest#test_text_drop\", \"EchoTest#test_echo_outputs_its_input\", \"EnvironmentFilterTest#test_add_global_filter_clears_cache\", \"EnvironmentFilterTest#test_strainer\", \"EnvironmentFilterTest#test_strainer_argument_error_contains_backtrace\", \"EnvironmentFilterTest#test_strainer_only_allows_methods_defined_in_filters\", \"EnvironmentFilterTest#test_strainer_only_invokes_public_filter_methods\", \"EnvironmentFilterTest#test_strainer_raises_argument_error\", \"EnvironmentFilterTest#test_strainer_returns_first_argument_if_no_method_and_arguments_given\", \"EnvironmentFilterTest#test_strainer_returns_nil_if_no_filter_method_found\", \"EnvironmentFilterTest#test_strainer_uses_a_class_cache_to_avoid_method_cache_invalidation\", \"EnvironmentTest#test_custom_tag\", \"ErrorHandlingTest#test_argument\", \"ErrorHandlingTest#test_bug_compatible_silencing_of_errors_in_blank_nodes\", \"ErrorHandlingTest#test_default_exception_renderer_with_internal_error\", \"ErrorHandlingTest#test_error_is_raised_during_parse_with_template_name\", \"ErrorHandlingTest#test_exception_renderer_exposing_non_liquid_error\", \"ErrorHandlingTest#test_exceptions_propagate\", \"ErrorHandlingTest#test_included_template_name_with_line_numbers\", \"ErrorHandlingTest#test_internal_error_is_raised_with_template_name\", \"ErrorHandlingTest#test_lax_unrecognized_operator\", \"ErrorHandlingTest#test_missing_endtag_parse_time_error\", \"ErrorHandlingTest#test_parsing_strict_with_line_numbers_adds_numbers_to_lexer_errors\", \"ErrorHandlingTest#test_parsing_warn_with_line_numbers_adds_numbers_to_lexer_errors\", \"ErrorHandlingTest#test_setting_default_exception_renderer\", \"ErrorHandlingTest#test_setting_exception_renderer_on_environment\", \"ErrorHandlingTest#test_standard_error\", \"ErrorHandlingTest#test_strict_error_messages\", \"ErrorHandlingTest#test_syntax\", \"ErrorHandlingTest#test_syntax_error_is_raised_with_template_name\", \"ErrorHandlingTest#test_syntax_error_is_raised_with_template_name_from_template_factory\", \"ErrorHandlingTest#test_syntax_errors_in_nested_blocks_have_correct_line_number\", \"ErrorHandlingTest#test_templates_parsed_with_line_numbers_renders_them_in_errors\", \"ErrorHandlingTest#test_unrecognized_operator\", \"ErrorHandlingTest#test_warning_line_numbers\", \"ErrorHandlingTest#test_warnings\", \"ErrorHandlingTest#test_with_line_numbers_adds_numbers_to_parser_errors\", \"ErrorHandlingTest#test_with_line_numbers_adds_numbers_to_parser_errors_with_whitespace_trim\", \"ExpressionTest#test_disable_expression_cache\", \"ExpressionTest#test_expression_cache\", \"ExpressionTest#test_expression_cache_with_lru_redux\", \"ExpressionTest#test_expression_cache_with_true_boolean\", \"ExpressionTest#test_float\", \"ExpressionTest#test_int\", \"ExpressionTest#test_keyword_literals\", \"ExpressionTest#test_quirky_negative_sign_expression_markup\", \"ExpressionTest#test_range\", \"ExpressionTest#test_safe_parse_raises_syntax_error_for_invalid_expression\", \"ExpressionTest#test_safe_parse_with_number\", \"ExpressionTest#test_safe_parse_with_variable_lookup\", \"ExpressionTest#test_string\", \"FileSystemUnitTest#test_custom_template_filename_patterns\", \"FileSystemUnitTest#test_default\", \"FileSystemUnitTest#test_local\", \"FilterKwargTest#test_can_parse_data_kwargs\", \"FiltersInTemplate#test_local_filter_with_deprecated_syntax\", \"FiltersInTemplate#test_local_global\", \"FiltersTest#test_capitalize\", \"FiltersTest#test_compact\", \"FiltersTest#test_filter_with_keyword_arguments\", \"FiltersTest#test_join\", \"FiltersTest#test_liquid_argument_error\", \"FiltersTest#test_local_filter\", \"FiltersTest#test_nonexistent_filter_is_ignored\", \"FiltersTest#test_override_object_method_in_filter\", \"FiltersTest#test_second_filter_overwrites_first\", \"FiltersTest#test_size\", \"FiltersTest#test_sort\", \"FiltersTest#test_sort_natural\", \"FiltersTest#test_strip_html\", \"FiltersTest#test_strip_html_ignore_comments_with_html\", \"FiltersTest#test_underscore_in_filter_name\", \"ForTagTest#test_bad_variable_naming_in_for_loop\", \"ForTagTest#test_blank_string_not_iterable\", \"ForTagTest#test_dynamic_variable_limiting\", \"ForTagTest#test_for\", \"ForTagTest#test_for_and_if\", \"ForTagTest#test_for_cleans_up_registers\", \"ForTagTest#test_for_else\", \"ForTagTest#test_for_helpers\", \"ForTagTest#test_for_parentloop_nil_when_not_present\", \"ForTagTest#test_for_parentloop_references_parent_loop\", \"ForTagTest#test_for_reversed\", \"ForTagTest#test_for_tag_string\", \"ForTagTest#test_for_with_break\", \"ForTagTest#test_for_with_break_after_nested_loop\", \"ForTagTest#test_for_with_continue\", \"ForTagTest#test_for_with_drop_value_range\", \"ForTagTest#test_for_with_hash_value_range\", \"ForTagTest#test_for_with_range\", \"ForTagTest#test_for_with_variable\", \"ForTagTest#test_for_with_variable_range\", \"ForTagTest#test_inner_for_over_empty_input\", \"ForTagTest#test_iterate_with_each_when_no_limit_applied\", \"ForTagTest#test_iterate_with_load_slice_returns_same_results_as_without\", \"ForTagTest#test_iterate_with_load_slice_when_limit_and_offset_applied\", \"ForTagTest#test_iterate_with_load_slice_when_limit_applied\", \"ForTagTest#test_limiting\", \"ForTagTest#test_limiting_with_invalid_limit\", \"ForTagTest#test_limiting_with_invalid_offset\", \"ForTagTest#test_nested_for\", \"ForTagTest#test_offset_only\", \"ForTagTest#test_pause_resume\", \"ForTagTest#test_pause_resume_big_limit\", \"ForTagTest#test_pause_resume_big_offset\", \"ForTagTest#test_pause_resume_limit\", \"ForTagTest#test_spacing_with_variable_naming_in_for_loop\", \"ForTagUnitTest#test_for_else_nodelist\", \"ForTagUnitTest#test_for_nodelist\", \"HashOrderingTest#test_global_register_order\", \"HashRenderingTest#test_hash_with_append____appended_text__filter\", \"HashRenderingTest#test_hash_with_downcase_filter\", \"HashRenderingTest#test_hash_with_escape_filter\", \"HashRenderingTest#test_hash_with_prepend___prepended_text___filter\", \"HashRenderingTest#test_hash_with_replace___key____replaced_key__filter\", \"HashRenderingTest#test_hash_with_strip_filter\", \"HashRenderingTest#test_hash_with_strip_html_filter\", \"HashRenderingTest#test_hash_with_truncate__20_filter\", \"HashRenderingTest#test_hash_with_upcase_filter\", \"HashRenderingTest#test_hash_with_url_encode_filter\", \"HashRenderingTest#test_join_filter_with_hash\", \"HashRenderingTest#test_render_empty_hash\", \"HashRenderingTest#test_render_hash_with_array_values\", \"HashRenderingTest#test_render_hash_with_array_values_empty\", \"HashRenderingTest#test_render_hash_with_array_values_hash\", \"HashRenderingTest#test_render_hash_with_hash_key\", \"HashRenderingTest#test_render_hash_with_string_keys_and_values\", \"HashRenderingTest#test_render_hash_with_symbol_keys_and_integer_values\", \"HashRenderingTest#test_render_nested_hash\", \"HashRenderingTest#test_render_recursive_hash\", \"HashRenderingTest#test_rendering_hash_with_custom_to_s_method_uses_custom_to_s\", \"HashRenderingTest#test_rendering_hash_without_custom_to_s_uses_default_inspect\", \"I18nUnitTest#test_nested_translate_string\", \"I18nUnitTest#test_raises_unknown_translation\", \"I18nUnitTest#test_sets_default_path_to_en\", \"I18nUnitTest#test_simple_translate_string\", \"I18nUnitTest#test_single_string_interpolation\", \"IfElseTagTest#test_comparison_of_expressions_starting_with_and_or_or\", \"IfElseTagTest#test_comparison_of_strings_containing_and_or_or\", \"IfElseTagTest#test_comparisons_on_null\", \"IfElseTagTest#test_else_if\", \"IfElseTagTest#test_hash_miss_generates_false\", \"IfElseTagTest#test_if\", \"IfElseTagTest#test_if_and\", \"IfElseTagTest#test_if_boolean\", \"IfElseTagTest#test_if_else\", \"IfElseTagTest#test_if_from_variable\", \"IfElseTagTest#test_if_or\", \"IfElseTagTest#test_if_or_with_operators\", \"IfElseTagTest#test_if_with_custom_condition\", \"IfElseTagTest#test_literal_comparisons\", \"IfElseTagTest#test_multiple_conditions\", \"IfElseTagTest#test_nested_if\", \"IfElseTagTest#test_operators_are_ignored_unless_isolated\", \"IfElseTagTest#test_operators_are_whitelisted\", \"IfElseTagTest#test_syntax_error_no_expression\", \"IfElseTagTest#test_syntax_error_no_variable\", \"IfTagUnitTest#test_if_nodelist\", \"IncludeTagTest#test_break_through_include\", \"IncludeTagTest#test_custom_include_tag\", \"IncludeTagTest#test_custom_include_tag_within_if_statement\", \"IncludeTagTest#test_does_not_add_error_in_strict_mode_for_missing_variable\", \"IncludeTagTest#test_dynamically_choosen_template\", \"IncludeTagTest#test_include_attribute_with_invalid_expression\", \"IncludeTagTest#test_include_tag_caches_second_read_of_same_partial\", \"IncludeTagTest#test_include_tag_doesnt_cache_partials_across_renders\", \"IncludeTagTest#test_include_tag_for\", \"IncludeTagTest#test_include_tag_for_alias\", \"IncludeTagTest#test_include_tag_looks_for_file_system_in_registers_first\", \"IncludeTagTest#test_include_tag_with\", \"IncludeTagTest#test_include_tag_with_alias\", \"IncludeTagTest#test_include_tag_with_default_name\", \"IncludeTagTest#test_include_tag_with_local_variables\", \"IncludeTagTest#test_include_tag_with_multiple_local_variables\", \"IncludeTagTest#test_include_tag_with_multiple_local_variables_from_context\", \"IncludeTagTest#test_include_tag_within_if_statement\", \"IncludeTagTest#test_include_template_with_invalid_expression\", \"IncludeTagTest#test_include_with_invalid_expression\", \"IncludeTagTest#test_included_templates_assigns_variables\", \"IncludeTagTest#test_including_via_variable_value\", \"IncludeTagTest#test_including_with_strict_variables\", \"IncludeTagTest#test_nested_include_tag\", \"IncludeTagTest#test_nested_include_with_variable\", \"IncludeTagTest#test_optional_commas\", \"IncludeTagTest#test_passing_options_to_included_templates\", \"IncludeTagTest#test_recursively_included_template_does_not_produce_endless_loop\", \"IncludeTagTest#test_render_raise_argument_error_when_template_is_not_a_string\", \"IncludeTagTest#test_render_raise_argument_error_when_template_is_undefined\", \"IncludeTagTest#test_render_tag_renders_error_with_template_name\", \"IncludeTagTest#test_render_tag_renders_error_with_template_name_from_template_factory\", \"IncludeTagTest#test_rigid_parsing_errors\", \"IncrementTagTest#test_dec\", \"IncrementTagTest#test_inc\", \"InlineCommentTest#test_inline_comment_can_be_written_on_multiple_lines\", \"InlineCommentTest#test_inline_comment_does_not_require_a_space_after_the_pound_sign\", \"InlineCommentTest#test_inline_comment_does_not_support_nested_tags\", \"InlineCommentTest#test_inline_comment_multiple_pound_signs\", \"InlineCommentTest#test_inline_comment_returns_nothing\", \"InlineCommentTest#test_inline_comments_require_the_pound_sign_on_every_new_line\", \"InlineCommentTest#test_liquid_inline_comment_returns_nothing\", \"LexerUnitTest#test_comparison\", \"LexerUnitTest#test_comparison_with_negative_number\", \"LexerUnitTest#test_comparison_without_whitespace\", \"LexerUnitTest#test_contains_as_attribute_name\", \"LexerUnitTest#test_error_with_invalid_utf8\", \"LexerUnitTest#test_error_with_utf8_character\", \"LexerUnitTest#test_fancy_identifiers\", \"LexerUnitTest#test_float\", \"LexerUnitTest#test_greater_than_two_digits\", \"LexerUnitTest#test_integer\", \"LexerUnitTest#test_negative_numbers\", \"LexerUnitTest#test_raise_for_invalid_comparison\", \"LexerUnitTest#test_specials\", \"LexerUnitTest#test_strings\", \"LexerUnitTest#test_tokenize_incomplete_expression\", \"LexerUnitTest#test_unexpected_character\", \"LexerUnitTest#test_whitespace\", \"LiquidTagTest#test_cannot_close_blocks_created_before_a_liquid_tag\", \"LiquidTagTest#test_cannot_open_blocks_living_past_a_liquid_tag\", \"LiquidTagTest#test_line_number_is_correct_after_a_blank_token\", \"LiquidTagTest#test_liquid_tag\", \"LiquidTagTest#test_liquid_tag_errors\", \"LiquidTagTest#test_liquid_tag_in_raw\", \"LiquidTagTest#test_nested_liquid_liquid_is_not_skipped_if_used_in_non_tag_position\", \"LiquidTagTest#test_nested_liquid_tag\", \"LiquidTagTest#test_nested_liquid_tags\", \"LiquidTagTest#test_nested_liquid_tags_on_same_line\", \"LiquidTagTest#test_next_liquid_with_unclosed_if_tag\", \"OutputTest#test_link_to\", \"OutputTest#test_multiple_pipings\", \"OutputTest#test_multiple_variable_piping_with_args\", \"OutputTest#test_variable\", \"OutputTest#test_variable_piping\", \"OutputTest#test_variable_piping_with_args\", \"OutputTest#test_variable_piping_with_input\", \"OutputTest#test_variable_piping_with_multiple_args\", \"OutputTest#test_variable_piping_with_no_args\", \"OutputTest#test_variable_piping_with_variable_args\", \"OutputTest#test_variable_traversing\", \"OutputTest#test_variable_traversing_with_two_brackets\", \"ParseContextUnitTest#test_parse_expression_with_empty_string\", \"ParseContextUnitTest#test_parse_expression_with_empty_string_and_safe_true\", \"ParseContextUnitTest#test_parse_expression_with_safe_true\", \"ParseContextUnitTest#test_parse_expression_with_variable_lookup\", \"ParseContextUnitTest#test_parse_expression_with_whitespace_in_rigid_mode\", \"ParseContextUnitTest#test_safe_parse_expression_advances_parser_pointer\", \"ParseContextUnitTest#test_safe_parse_expression_raises_syntax_error_for_invalid_expression\", \"ParseContextUnitTest#test_safe_parse_expression_with_variable_lookup\", \"ParseTreeVisitorTest#test_assign\", \"ParseTreeVisitorTest#test_capture\", \"ParseTreeVisitorTest#test_case_condition\", \"ParseTreeVisitorTest#test_case_else_body\", \"ParseTreeVisitorTest#test_case_left\", \"ParseTreeVisitorTest#test_case_when_body\", \"ParseTreeVisitorTest#test_complex_elsif_condition\", \"ParseTreeVisitorTest#test_complex_if_condition\", \"ParseTreeVisitorTest#test_complex_unless_condition\", \"ParseTreeVisitorTest#test_cycle\", \"ParseTreeVisitorTest#test_dynamic_variable\", \"ParseTreeVisitorTest#test_echo\", \"ParseTreeVisitorTest#test_else_body\", \"ParseTreeVisitorTest#test_elsif_body\", \"ParseTreeVisitorTest#test_elsif_condition\", \"ParseTreeVisitorTest#test_for_body\", \"ParseTreeVisitorTest#test_for_in\", \"ParseTreeVisitorTest#test_for_limit\", \"ParseTreeVisitorTest#test_for_offset\", \"ParseTreeVisitorTest#test_for_range\", \"ParseTreeVisitorTest#test_if_body\", \"ParseTreeVisitorTest#test_if_condition\", \"ParseTreeVisitorTest#test_include\", \"ParseTreeVisitorTest#test_include_for\", \"ParseTreeVisitorTest#test_include_with\", \"ParseTreeVisitorTest#test_preserve_tree_structure\", \"ParseTreeVisitorTest#test_render_for\", \"ParseTreeVisitorTest#test_render_with\", \"ParseTreeVisitorTest#test_tablerow_body\", \"ParseTreeVisitorTest#test_tablerow_in\", \"ParseTreeVisitorTest#test_tablerow_limit\", \"ParseTreeVisitorTest#test_tablerow_offset\", \"ParseTreeVisitorTest#test_unless_body\", \"ParseTreeVisitorTest#test_unless_condition\", \"ParseTreeVisitorTest#test_variable\", \"ParseTreeVisitorTest#test_varible_with_filter\", \"ParserUnitTest#test_arguments\", \"ParserUnitTest#test_consume\", \"ParserUnitTest#test_consume?\", \"ParserUnitTest#test_expressions\", \"ParserUnitTest#test_id?\", \"ParserUnitTest#test_invalid_expression\", \"ParserUnitTest#test_jump\", \"ParserUnitTest#test_look\", \"ParserUnitTest#test_ranges\", \"ParsingQuirksTest#test_blank_variable_markup\", \"ParsingQuirksTest#test_contains_in_id\", \"ParsingQuirksTest#test_error_on_empty_filter\", \"ParsingQuirksTest#test_extra_dots_in_ranges\", \"ParsingQuirksTest#test_incomplete_expression\", \"ParsingQuirksTest#test_invalid_variables_work\", \"ParsingQuirksTest#test_lookup_on_var_with_literal_name\", \"ParsingQuirksTest#test_meaningless_parens_error\", \"ParsingQuirksTest#test_meaningless_parens_lax\", \"ParsingQuirksTest#test_no_error_on_lax_empty_filter\", \"ParsingQuirksTest#test_parsing_css\", \"ParsingQuirksTest#test_raise_on_invalid_tag_delimiter\", \"ParsingQuirksTest#test_raise_on_label_and_no_close_bracets\", \"ParsingQuirksTest#test_raise_on_label_and_no_close_bracets_percent\", \"ParsingQuirksTest#test_raise_on_single_close_bracet\", \"ParsingQuirksTest#test_unanchored_filter_arguments\", \"ParsingQuirksTest#test_unexpected_characters_silently_eat_logic_lax\", \"ParsingQuirksTest#test_unexpected_characters_syntax_error\", \"PartialCacheUnitTest#test_cache_is_not_broken_when_a_different_parse_context_is_used\", \"PartialCacheUnitTest#test_cache_state_is_shared_for_subcontexts\", \"PartialCacheUnitTest#test_cache_state_is_stored_per_context\", \"PartialCacheUnitTest#test_includes_error_mode_into_template_cache\", \"PartialCacheUnitTest#test_reads_from_the_file_system_only_once_per_file\", \"PartialCacheUnitTest#test_uses_default_template_factory_when_no_template_factory_found_in_register\", \"PartialCacheUnitTest#test_uses_template_factory_register_if_present\", \"PartialCacheUnitTest#test_uses_template_name_from_template_factory\", \"PartialCacheUnitTest#test_uses_the_file_system_register_if_present\", \"ProfilerTest#test_can_iterate_over_each_profiling_entry\", \"ProfilerTest#test_parse_makes_available_simple_profiling\", \"ProfilerTest#test_profiling_includes_line_numbers_of_included_partials\", \"ProfilerTest#test_profiling_includes_line_numbers_of_liquid_nodes\", \"ProfilerTest#test_profiling_marks_children_of_for_blocks\", \"ProfilerTest#test_profiling_marks_children_of_if_blocks\", \"ProfilerTest#test_profiling_marks_children_with_the_name_of_included_partial\", \"ProfilerTest#test_profiling_multiple_renders\", \"ProfilerTest#test_profiling_render_tag\", \"ProfilerTest#test_profiling_supports_multiple_templates\", \"ProfilerTest#test_profiling_supports_rendering_the_same_partial_multiple_times\", \"ProfilerTest#test_profiling_supports_self_time\", \"ProfilerTest#test_profiling_supports_total_time\", \"ProfilerTest#test_profiling_times_the_entire_render\", \"ProfilerTest#test_profiling_times_the_rendering_of_tokens\", \"ProfilerTest#test_profiling_uses_include_to_mark_children\", \"ProfilerTest#test_render_ignores_raw_strings_when_profiling\", \"ProfilerTest#test_template_allows_flagging_profiling\", \"RawTagTest#test_invalid_raw\", \"RawTagTest#test_open_tag_in_raw\", \"RawTagTest#test_output_in_raw\", \"RawTagTest#test_tag_in_raw\", \"RegexpUnitTest#test_double_quoted_words\", \"RegexpUnitTest#test_empty\", \"RegexpUnitTest#test_quote\", \"RegexpUnitTest#test_quoted_words_in_the_middle\", \"RegexpUnitTest#test_single_quoted_words\", \"RegexpUnitTest#test_tags\", \"RegexpUnitTest#test_variable_parser\", \"RegexpUnitTest#test_variable_parser_with_large_input\", \"RegexpUnitTest#test_words\", \"RegistersUnitTest#test_delete\", \"RegistersUnitTest#test_fetch\", \"RegistersUnitTest#test_get_missing_key\", \"RegistersUnitTest#test_initialization_reused_static_same_memory_object\", \"RegistersUnitTest#test_key\", \"RegistersUnitTest#test_multiple_instances_are_unique\", \"RegistersUnitTest#test_new_static_retains_static\", \"RegistersUnitTest#test_set\", \"RegistersUnitTest#test_static_register_can_be_frozen\", \"RenderTagTest#test_break_through_render\", \"RenderTagTest#test_decrement_is_isolated_between_renders\", \"RenderTagTest#test_dynamically_choosen_templates_are_not_allowed\", \"RenderTagTest#test_includes_will_not_render_inside_nested_sibling_tags\", \"RenderTagTest#test_includes_will_not_render_inside_render_tag\", \"RenderTagTest#test_increment_is_isolated_between_renders\", \"RenderTagTest#test_nested_render_tag\", \"RenderTagTest#test_optional_commas\", \"RenderTagTest#test_recursively_rendered_template_does_not_produce_endless_loop\", \"RenderTagTest#test_render_accepts_literals_as_arguments\", \"RenderTagTest#test_render_accepts_multiple_named_arguments\", \"RenderTagTest#test_render_attribute_with_invalid_expression\", \"RenderTagTest#test_render_does_not_inherit_parent_scope_variables\", \"RenderTagTest#test_render_does_not_inherit_variable_with_same_name_as_snippet\", \"RenderTagTest#test_render_does_not_mutate_parent_scope\", \"RenderTagTest#test_render_passes_named_arguments_into_inner_scope\", \"RenderTagTest#test_render_tag_caches_second_read_of_same_partial\", \"RenderTagTest#test_render_tag_doesnt_cache_partials_across_renders\", \"RenderTagTest#test_render_tag_for\", \"RenderTagTest#test_render_tag_for_alias\", \"RenderTagTest#test_render_tag_for_drop\", \"RenderTagTest#test_render_tag_forloop\", \"RenderTagTest#test_render_tag_looks_for_file_system_in_registers_first\", \"RenderTagTest#test_render_tag_renders_error_with_template_name\", \"RenderTagTest#test_render_tag_renders_error_with_template_name_from_template_factory\", \"RenderTagTest#test_render_tag_with\", \"RenderTagTest#test_render_tag_with_alias\", \"RenderTagTest#test_render_tag_with_drop\", \"RenderTagTest#test_render_tag_within_if_statement\", \"RenderTagTest#test_render_with_invalid_expression\", \"RenderTagTest#test_render_with_no_arguments\", \"RenderTagTest#test_rigid_parsing_errors\", \"RenderTagTest#test_sub_contexts_count_towards_the_same_recursion_limit\", \"SecurityTest#test_does_not_add_drop_methods_to_symbol_table\", \"SecurityTest#test_does_not_permanently_add_filters_to_symbol_table\", \"SecurityTest#test_max_depth_nested_blocks_does_not_raise_exception\", \"SecurityTest#test_more_than_max_depth_nested_blocks_raises_exception\", \"SecurityTest#test_no_existing_instance_eval\", \"SecurityTest#test_no_instance_eval\", \"SecurityTest#test_no_instance_eval_after_mixing_in_new_filter\", \"SecurityTest#test_no_instance_eval_later_in_chain\", \"StandardFiltersTest#test_abs\", \"StandardFiltersTest#test_all_filters_never_raise_non_liquid_exception\", \"StandardFiltersTest#test_append\", \"StandardFiltersTest#test_at_least\", \"StandardFiltersTest#test_at_most\", \"StandardFiltersTest#test_base64_decode\", \"StandardFiltersTest#test_base64_encode\", \"StandardFiltersTest#test_base64_url_safe_decode\", \"StandardFiltersTest#test_base64_url_safe_encode\", \"StandardFiltersTest#test_cannot_access_private_methods\", \"StandardFiltersTest#test_ceil\", \"StandardFiltersTest#test_compact_empty_array\", \"StandardFiltersTest#test_compact_invalid_property\", \"StandardFiltersTest#test_concat\", \"StandardFiltersTest#test_date\", \"StandardFiltersTest#test_date_raises_nothing\", \"StandardFiltersTest#test_default\", \"StandardFiltersTest#test_default_handle_false\", \"StandardFiltersTest#test_divided_by\", \"StandardFiltersTest#test_downcase\", \"StandardFiltersTest#test_escape\", \"StandardFiltersTest#test_escape_once\", \"StandardFiltersTest#test_find_index_on_empty_array\", \"StandardFiltersTest#test_find_index_with_empty_arrays\", \"StandardFiltersTest#test_find_index_with_value\", \"StandardFiltersTest#test_find_on_empty_array\", \"StandardFiltersTest#test_find_with_empty_arrays\", \"StandardFiltersTest#test_find_with_value\", \"StandardFiltersTest#test_first_and_last_call_to_liquid\", \"StandardFiltersTest#test_first_last\", \"StandardFiltersTest#test_floor\", \"StandardFiltersTest#test_h\", \"StandardFiltersTest#test_has\", \"StandardFiltersTest#test_has_on_empty_array\", \"StandardFiltersTest#test_has_when_does_not_have_it\", \"StandardFiltersTest#test_has_with_empty_arrays\", \"StandardFiltersTest#test_has_with_false_value\", \"StandardFiltersTest#test_has_with_false_value_when_does_not_have_it\", \"StandardFiltersTest#test_join\", \"StandardFiltersTest#test_join_calls_to_liquid_on_each_element\", \"StandardFiltersTest#test_legacy_map_on_hashes_with_dynamic_key\", \"StandardFiltersTest#test_legacy_reverse_hash\", \"StandardFiltersTest#test_legacy_sort_hash\", \"StandardFiltersTest#test_lstrip\", \"StandardFiltersTest#test_map\", \"StandardFiltersTest#test_map_calls_context=\", \"StandardFiltersTest#test_map_calls_to_liquid\", \"StandardFiltersTest#test_map_doesnt_call_arbitrary_stuff\", \"StandardFiltersTest#test_map_on_hashes\", \"StandardFiltersTest#test_map_over_drops_returning_procs\", \"StandardFiltersTest#test_map_over_proc\", \"StandardFiltersTest#test_map_returns_empty_on_2d_input_array\", \"StandardFiltersTest#test_map_returns_input_with_no_property\", \"StandardFiltersTest#test_map_with_value_property\", \"StandardFiltersTest#test_map_works_on_enumerables\", \"StandardFiltersTest#test_minus\", \"StandardFiltersTest#test_modulo\", \"StandardFiltersTest#test_newlines_to_br\", \"StandardFiltersTest#test_numerical_vs_lexicographical_sort\", \"StandardFiltersTest#test_pipes_in_string_arguments\", \"StandardFiltersTest#test_plus\", \"StandardFiltersTest#test_prepend\", \"StandardFiltersTest#test_reject\", \"StandardFiltersTest#test_reject_with_false_value\", \"StandardFiltersTest#test_reject_with_value\", \"StandardFiltersTest#test_remove\", \"StandardFiltersTest#test_replace\", \"StandardFiltersTest#test_reverse\", \"StandardFiltersTest#test_round\", \"StandardFiltersTest#test_rstrip\", \"StandardFiltersTest#test_size\", \"StandardFiltersTest#test_slice\", \"StandardFiltersTest#test_slice_on_arrays\", \"StandardFiltersTest#test_sort\", \"StandardFiltersTest#test_sort_calls_to_liquid\", \"StandardFiltersTest#test_sort_empty_array\", \"StandardFiltersTest#test_sort_invalid_property\", \"StandardFiltersTest#test_sort_natural\", \"StandardFiltersTest#test_sort_natural_case_check\", \"StandardFiltersTest#test_sort_natural_empty_array\", \"StandardFiltersTest#test_sort_natural_invalid_property\", \"StandardFiltersTest#test_sort_natural_when_property_is_sometimes_missing_puts_nils_last\", \"StandardFiltersTest#test_sort_natural_with_nils\", \"StandardFiltersTest#test_sort_when_property_is_sometimes_missing_puts_nils_last\", \"StandardFiltersTest#test_sort_with_nils\", \"StandardFiltersTest#test_sort_works_on_enumerables\", \"StandardFiltersTest#test_split\", \"StandardFiltersTest#test_strip\", \"StandardFiltersTest#test_strip_html\", \"StandardFiltersTest#test_strip_newlines\", \"StandardFiltersTest#test_sum_of_floats\", \"StandardFiltersTest#test_sum_of_negative_floats\", \"StandardFiltersTest#test_sum_resulting_in_negative_float\", \"StandardFiltersTest#test_sum_with_all_numbers\", \"StandardFiltersTest#test_sum_with_float_strings\", \"StandardFiltersTest#test_sum_with_floats_and_indexable_map_values\", \"StandardFiltersTest#test_sum_with_indexable_map_values\", \"StandardFiltersTest#test_sum_with_indexable_non_map_values\", \"StandardFiltersTest#test_sum_with_nested_arrays\", \"StandardFiltersTest#test_sum_with_non_string_property\", \"StandardFiltersTest#test_sum_with_numeric_strings\", \"StandardFiltersTest#test_sum_with_property_calls_to_liquid_on_property_values\", \"StandardFiltersTest#test_sum_with_unindexable_values\", \"StandardFiltersTest#test_sum_without_property_calls_to_liquid\", \"StandardFiltersTest#test_times\", \"StandardFiltersTest#test_truncate\", \"StandardFiltersTest#test_truncate_calls_to_liquid\", \"StandardFiltersTest#test_truncatewords\", \"StandardFiltersTest#test_uniq\", \"StandardFiltersTest#test_uniq_empty_array\", \"StandardFiltersTest#test_uniq_invalid_property\", \"StandardFiltersTest#test_uniq_with_to_liquid_value\", \"StandardFiltersTest#test_uniq_with_to_liquid_value_pick_correct_classes\", \"StandardFiltersTest#test_upcase\", \"StandardFiltersTest#test_url_decode\", \"StandardFiltersTest#test_url_encode\", \"StandardFiltersTest#test_where\", \"StandardFiltersTest#test_where_array_of_only_unindexable_values\", \"StandardFiltersTest#test_where_indexable_but_non_map_value\", \"StandardFiltersTest#test_where_no_key_set\", \"StandardFiltersTest#test_where_no_target_value\", \"StandardFiltersTest#test_where_non_array_map_input\", \"StandardFiltersTest#test_where_non_boolean_value\", \"StandardFiltersTest#test_where_string_keys\", \"StandardFiltersTest#test_where_with_empty_string_is_a_no_op\", \"StandardFiltersTest#test_where_with_false_value\", \"StandardFiltersTest#test_where_with_nil_is_a_no_op\", \"StandardFiltersTest#test_where_with_value\", \"StandardTagTest#test_assign\", \"StandardTagTest#test_assign_an_empty_string\", \"StandardTagTest#test_assign_from_case\", \"StandardTagTest#test_assign_is_global\", \"StandardTagTest#test_assign_unassigned\", \"StandardTagTest#test_assign_with_colon_and_spaces\", \"StandardTagTest#test_capture\", \"StandardTagTest#test_capture_detects_bad_syntax\", \"StandardTagTest#test_case\", \"StandardTagTest#test_case_detects_bad_syntax\", \"StandardTagTest#test_case_on_length_with_else\", \"StandardTagTest#test_case_on_size\", \"StandardTagTest#test_case_on_size_with_else\", \"StandardTagTest#test_case_when_comma\", \"StandardTagTest#test_case_when_comma_and_blank_body\", \"StandardTagTest#test_case_when_or\", \"StandardTagTest#test_case_with_else\", \"StandardTagTest#test_cycle\", \"StandardTagTest#test_has_a_block_which_does_nothing\", \"StandardTagTest#test_hyphenated_assign\", \"StandardTagTest#test_ifchanged\", \"StandardTagTest#test_illegal_symbols\", \"StandardTagTest#test_multiline_tag\", \"StandardTagTest#test_multiple_cycles\", \"StandardTagTest#test_multiple_named_cycles\", \"StandardTagTest#test_multiple_named_cycles_with_names_from_context\", \"StandardTagTest#test_no_transform\", \"StandardTagTest#test_size_of_array\", \"StandardTagTest#test_size_of_hash\", \"StatementsTest#test_is_collection_empty\", \"StatementsTest#test_is_not_collection_empty\", \"StatementsTest#test_nil\", \"StatementsTest#test_not_nil\", \"StatementsTest#test_one_lq_zero\", \"StatementsTest#test_strings\", \"StatementsTest#test_strings_not_equal\", \"StatementsTest#test_true_eql_true\", \"StatementsTest#test_true_lq_true\", \"StatementsTest#test_true_not_eql_true\", \"StatementsTest#test_var_and_long_string_are_equal\", \"StatementsTest#test_var_and_long_string_are_equal_backwards\", \"StatementsTest#test_var_strings_are_not_equal\", \"StatementsTest#test_var_strings_equal\", \"StatementsTest#test_zero_lq_one\", \"StatementsTest#test_zero_lq_or_equal_one\", \"StatementsTest#test_zero_lq_or_equal_one_involving_nil\", \"StatementsTest#test_zero_lqq_or_equal_one\", \"StrainerTemplateUnitTest#test_add_filter_does_not_include_already_included_module\", \"StrainerTemplateUnitTest#test_add_filter_does_not_raise_when_module_overrides_previously_registered_method\", \"StrainerTemplateUnitTest#test_add_filter_raises_when_module_overrides_registered_public_method_as_protected\", \"StrainerTemplateUnitTest#test_add_filter_raises_when_module_privately_overrides_registered_public_methods\", \"StrainerTemplateUnitTest#test_add_filter_when_wrong_filter_class\", \"TableRowTest#test_blank_string_not_iterable\", \"TableRowTest#test_cols_nil_constant_same_as_evaluated_nil_expression\", \"TableRowTest#test_enumerable_drop\", \"TableRowTest#test_nil_limit_is_treated_as_zero\", \"TableRowTest#test_nil_offset_is_treated_as_zero\", \"TableRowTest#test_offset_and_limit\", \"TableRowTest#test_quoted_fragment\", \"TableRowTest#test_table_col_counter\", \"TableRowTest#test_table_row\", \"TableRowTest#test_table_row_does_not_leak_interrupts\", \"TableRowTest#test_table_row_handles_interrupts\", \"TableRowTest#test_table_row_renders_correct_error_message_for_invalid_parameters\", \"TableRowTest#test_table_row_with_different_cols\", \"TableRowTest#test_tablerow_loop_drop_attributes\", \"TableRowTest#test_tablerow_with_bracketed_access_in_rigid_mode\", \"TableRowTest#test_tablerow_with_cols_attribute_in_rigid_mode\", \"TableRowTest#test_tablerow_with_dotted_access_in_rigid_mode\", \"TableRowTest#test_tablerow_with_empty_collection_in_rigid_mode\", \"TableRowTest#test_tablerow_with_invalid_attribute_strict_vs_rigid\", \"TableRowTest#test_tablerow_with_invalid_expression_strict_vs_rigid\", \"TableRowTest#test_tablerow_with_limit_attribute_in_rigid_mode\", \"TableRowTest#test_tablerow_with_multiple_attributes_in_rigid_mode\", \"TableRowTest#test_tablerow_with_multiple_invalid_attributes_reports_first_in_rigid_mode\", \"TableRowTest#test_tablerow_with_offset_attribute_in_rigid_mode\", \"TableRowTest#test_tablerow_with_range_attribute_in_rigid_mode\", \"TableRowTest#test_tablerow_with_variable_collection_in_rigid_mode\", \"TableRowTest#test_tablerow_without_attributes_in_rigid_mode\", \"TableRowTest#test_tablerow_without_in_keyword_in_rigid_mode\", \"TagDisableableTest#test_block_tag_disabling_multiple_nested_tags\", \"TagDisableableTest#test_block_tag_disabling_nested_tag\", \"TagTest#test_custom_tags_have_a_default_render_to_output_buffer_method_for_backwards_compatibility\", \"TagUnitTest#test_return_raw_text_of_tag\", \"TagUnitTest#test_tag\", \"TagUnitTest#test_tag_name_should_return_name_of_the_tag\", \"TagUnitTest#test_tag_render_to_output_buffer_nil_value\", \"TemplateFactoryUnitTest#test_for_returns_liquid_template_instance\", \"TemplateTest#test_allows_non_string_values_as_source\", \"TemplateTest#test_can_use_drop_as_context\", \"TemplateTest#test_custom_assigns_do_not_persist_on_same_template\", \"TemplateTest#test_custom_assigns_squash_instance_assigns\", \"TemplateTest#test_default_resource_limits_unaffected_by_render_with_context\", \"TemplateTest#test_exception_renderer_that_raises\", \"TemplateTest#test_exception_renderer_that_returns_string\", \"TemplateTest#test_global_filter_option_on_render\", \"TemplateTest#test_global_filter_option_when_native_filters_exist\", \"TemplateTest#test_instance_assigns_persist_on_same_template_object_between_parses\", \"TemplateTest#test_instance_assigns_persist_on_same_template_parsing_between_renders\", \"TemplateTest#test_lambda_is_called_once_from_custom_assigns_over_multiple_parses_and_renders\", \"TemplateTest#test_lambda_is_called_once_from_persistent_assigns_over_multiple_parses_and_renders\", \"TemplateTest#test_nil_value_does_not_raise\", \"TemplateTest#test_persistent_assigns_squash_instance_assigns\", \"TemplateTest#test_raises_error_with_invalid_utf8\", \"TemplateTest#test_render_bang_force_rethrow_errors_on_passed_context\", \"TemplateTest#test_render_length_persists_between_blocks\", \"TemplateTest#test_render_length_uses_number_of_bytes_not_characters\", \"TemplateTest#test_resource_limits_aborts_rendering_after_first_error\", \"TemplateTest#test_resource_limits_hash_in_template_gets_updated_even_if_no_limits_are_set\", \"TemplateTest#test_resource_limits_render_length\", \"TemplateTest#test_resource_limits_render_score\", \"TemplateTest#test_resource_limits_works_with_custom_length_method\", \"TemplateTest#test_source_string_subclass\", \"TemplateTest#test_undefined_drop_methods\", \"TemplateTest#test_undefined_drop_methods_raise\", \"TemplateTest#test_undefined_filters\", \"TemplateTest#test_undefined_filters_raise\", \"TemplateTest#test_undefined_variables\", \"TemplateTest#test_undefined_variables_raise\", \"TemplateTest#test_using_range_literal_works_as_expected\", \"TemplateTest#test_warnings_is_not_exponential_time\", \"TemplateUnitTest#test_invalid_utf8\", \"TemplateUnitTest#test_sets_default_localization_in_context_with_quick_initialization\", \"TemplateUnitTest#test_sets_default_localization_in_document\", \"TemplateUnitTest#test_tags_can_be_looped_over\", \"TemplateUnitTest#test_template_inheritance\", \"TokenizerTest#test_calculate_line_numbers_per_token_with_profiling\", \"TokenizerTest#test_incomplete_curly_braces\", \"TokenizerTest#test_tokenize_blocks\", \"TokenizerTest#test_tokenize_strings\", \"TokenizerTest#test_tokenize_variables\", \"TokenizerTest#test_tokenize_with_nil_source_returns_empty_array\", \"TokenizerTest#test_unmatching_start_and_end\", \"TrimModeTest#test_bug_compatible_pre_trim\", \"TrimModeTest#test_complex_trim\", \"TrimModeTest#test_complex_trim_output\", \"TrimModeTest#test_no_trim_output\", \"TrimModeTest#test_no_trim_tags\", \"TrimModeTest#test_post_and_pre_trim_tags\", \"TrimModeTest#test_post_trim_output\", \"TrimModeTest#test_post_trim_tags\", \"TrimModeTest#test_pre_and_post_trim_tags\", \"TrimModeTest#test_pre_trim_blank_preceding_text\", \"TrimModeTest#test_pre_trim_output\", \"TrimModeTest#test_pre_trim_tags\", \"TrimModeTest#test_raw_output\", \"TrimModeTest#test_right_trim_followed_by_tag\", \"TrimModeTest#test_single_line_inner_tag\", \"TrimModeTest#test_single_line_outer_tag\", \"TrimModeTest#test_single_line_post_tag\", \"TrimModeTest#test_single_line_pre_tag\", \"TrimModeTest#test_standard_output\", \"TrimModeTest#test_standard_tags\", \"TrimModeTest#test_tag_output_with_multiple_blank_lines\", \"TrimModeTest#test_trim_blank\", \"TrimModeTest#test_trim_output\", \"TrimModeTest#test_trim_tags\", \"TrimModeTest#test_variable_output_with_multiple_blank_lines\", \"TrimModeTest#test_whitespace_trim_output\", \"TrimModeTest#test_whitespace_trim_tags\", \"UnlessElseTagTest#test_unless\", \"UnlessElseTagTest#test_unless_else\", \"UnlessElseTagTest#test_unless_else_in_loop\", \"UnlessElseTagTest#test_unless_in_loop\", \"VariableTest#test_assigns_not_polluted_from_template\", \"VariableTest#test_case_tag_calls_to_liquid_value\", \"VariableTest#test_combining_trailing_comma_and_empty_args\", \"VariableTest#test_double_nested_variable_lookup\", \"VariableTest#test_dynamic_find_var\", \"VariableTest#test_dynamic_find_var_with_drop\", \"VariableTest#test_expression_with_whitespace_in_square_brackets\", \"VariableTest#test_false_renders_as_false\", \"VariableTest#test_filter_chain_with_colon_no_args\", \"VariableTest#test_filter_with_colon_but_no_arguments\", \"VariableTest#test_filter_with_single_trailing_comma\", \"VariableTest#test_hash_scoping\", \"VariableTest#test_hash_with_default_proc\", \"VariableTest#test_if_tag_calls_to_liquid_value\", \"VariableTest#test_ignore_unknown\", \"VariableTest#test_multiline_variable\", \"VariableTest#test_multiple_filters_with_trailing_commas\", \"VariableTest#test_nested_array\", \"VariableTest#test_nil_renders_as_empty_string\", \"VariableTest#test_preset_assigns\", \"VariableTest#test_raw_value_variable\", \"VariableTest#test_render_symbol\", \"VariableTest#test_reuse_parsed_template\", \"VariableTest#test_simple_variable\", \"VariableTest#test_simple_with_whitespaces\", \"VariableTest#test_unless_tag_calls_to_liquid_value\", \"VariableTest#test_using_blank_as_variable_name\", \"VariableTest#test_using_empty_as_variable_name\", \"VariableTest#test_variable_lookup_calls_to_liquid_value\", \"VariableTest#test_variable_lookup_should_not_hang_with_invalid_syntax\", \"VariableTest#test_variable_render_calls_to_liquid\", \"VariableUnitTest#test_dashes\", \"VariableUnitTest#test_filter_with_date_parameter\", \"VariableUnitTest#test_filter_with_keyword_arguments\", \"VariableUnitTest#test_filters\", \"VariableUnitTest#test_filters_without_whitespace\", \"VariableUnitTest#test_float\", \"VariableUnitTest#test_integer\", \"VariableUnitTest#test_lax_filter_argument_parsing\", \"VariableUnitTest#test_output_raw_source_of_variable\", \"VariableUnitTest#test_rigid_filter_argument_parsing\", \"VariableUnitTest#test_strict_filter_argument_parsing\", \"VariableUnitTest#test_string_dot\", \"VariableUnitTest#test_string_double_quoted\", \"VariableUnitTest#test_string_single_quoted\", \"VariableUnitTest#test_string_to_filter\", \"VariableUnitTest#test_string_with_special_chars\", \"VariableUnitTest#test_symbol\", \"VariableUnitTest#test_variable\", \"VariableUnitTest#test_variable_lookup_interface\"]","language":"Ruby","test_command":"bundle exec rake test","test_output_parser":"parsers/ruby_minitest_parser.py","image_storage_uri":"s3://rfp-coding-q1/Images/SWE-HARD/shopify__liquid-c357f91e0c677327180c8e745b6e1bf867d65ab2.tar","patch":"diff --git a/lib/liquid.rb b/lib/liquid.rb\nindex 4d0a71a6..09cafe94 100644\n--- a/lib/liquid.rb\n+++ b/lib/liquid.rb\n@@ -67,6 +67,7 @@ require 'liquid/i18n'\n require 'liquid/drop'\n require 'liquid/tablerowloop_drop'\n require 'liquid/forloop_drop'\n+require 'liquid/snippet_drop'\n require 'liquid/extensions'\n require 'liquid/errors'\n require 'liquid/interrupts'\ndiff --git a/lib/liquid/locales/en.yml b/lib/liquid/locales/en.yml\nindex b99d490c..7a9fb71e 100644\n--- a/lib/liquid/locales/en.yml\n+++ b/lib/liquid/locales/en.yml\n@@ -5,6 +5,7 @@\n       block_tag_unexpected_args: \"Syntax Error in '%{tag}' - Valid syntax: {% %{tag} %}{% end%{tag} %}\"\n       assign: \"Syntax Error in 'assign' - Valid syntax: assign [var] = [source]\"\n       capture: \"Syntax Error in 'capture' - Valid syntax: capture [var]\"\n+      snippet: \"Syntax Error in 'snippet' - Valid syntax: snippet [var]\"\n       case: \"Syntax Error in 'case' - Valid syntax: case [condition]\"\n@@ -19,6 +20,7 @@\n       invalid_template_encoding: \"Invalid template encoding\"\n       render: \"Syntax error in tag 'render' - Template name must be a quoted string\"\n+      render_invalid_template_name: \"Syntax error in tag 'render' - Expected a string or identifier, found %{found}\"\n       table_row: \"Syntax Error in 'table_row loop' - Valid syntax: table_row [item] in [collection] cols=3\"\n@@ -29,5 +31,6 @@\n     argument:\n       include: \"Argument error in tag 'include' - Illegal template name\"\n+      render: \"Argument error in tag 'render' - Dynamically chosen templates are not allowed\"\n     disabled:\n       tag: \"usage is not allowed in this context\"\ndiff --git a/lib/liquid/snippet_drop.rb b/lib/liquid/snippet_drop.rb\nnew file mode 100644\n--- /dev/null\n+++ b/lib/liquid/snippet_drop.rb\n@@ -0,0 +1,22 @@\n+# frozen_string_literal: true\n+\n+module Liquid\n+  class SnippetDrop < Drop\n+    attr_reader :body, :name, :filename\n+\n+    def initialize(body, name, filename)\n+      super()\n+      @body = body\n+      @name = name\n+      @filename = filename\n+    end\n+\n+    def to_partial\n+      @body\n+    end\n+\n+    def to_s\n+      'SnippetDrop'\n+    end\n+  end\n+end\ndiff --git a/lib/liquid/tags.rb b/lib/liquid/tags.rb\nindex dff7553f..3ec5e7cf 100644\n--- a/lib/liquid/tags.rb\n+++ b/lib/liquid/tags.rb\n@@ -20,6 +20,7 @@ require_relative \"tags/raw\"\n require_relative \"tags/render\"\n require_relative \"tags/cycle\"\n require_relative \"tags/doc\"\n+require_relative \"tags/snippet\"\n \n module Liquid\n   module Tags\n@@ -44,6 +45,7 @@ module Liquid\n       'echo' => Echo,\n       'tablerow' => TableRow,\n       'doc' => Doc,\n+      'snippet' => Snippet,\n     }.freeze\n   end\n end\ndiff --git a/lib/liquid/tags/render.rb b/lib/liquid/tags/render.rb\nindex 4d29e420..dec725ed 100644\n--- a/lib/liquid/tags/render.rb\n+++ b/lib/liquid/tags/render.rb\n@@ -27,7 +27,7 @@ module Liquid\n   class Render < Tag\n     FOR = 'for'\n-    SYNTAX = /(#{QuotedString}+)(\\s+(with|#{FOR})\\s+(#{QuotedFragment}+))?(\\s+(?:as)\\s+(#{VariableSegment}+))?/o\n+    SYNTAX = /(#{QuotedString}+|#{VariableSegment}+)(\\s+(with|#{FOR})\\s+(#{QuotedFragment}+))?(\\s+(?:as)\\s+(#{VariableSegment}+))?/o\n \n     def render_tag(context, output)\n-      template_name = @template_name_expr\n-      raise ::ArgumentError unless template_name.is_a?(String)\n-      partial = PartialCache.load(template_name, context: context, parse_context: parse_context)\n-      context_variable_name = @alias_name || template_name.split('/').last\n+      template = context.evaluate(@template_name_expr)\n+      if template.respond_to?(:to_partial)\n+        partial = template.to_partial\n+        template_name = template.filename\n+        context_variable_name = @alias_name || template.name\n+      elsif @template_name_expr.is_a?(String)\n+        partial = PartialCache.load(template, context: context, parse_context: parse_context)\n+        template_name = partial.name\n+        context_variable_name = @alias_name || template_name.split('/').last\n+      else\n+        raise ::ArgumentError\n+      end\n \n     def rigid_template_name(p)\n-      p.consume(:string)\n+      return p.consume(:string) if p.look(:string)\n+      return p.consume(:id) if p.look(:id)\n+      found = p.consume || \"nothing\"\n+      raise SyntaxError, options[:locale].t(\"errors.syntax.render_invalid_template_name\", found: found)\n     end\ndiff --git a/lib/liquid/tags/snippet.rb b/lib/liquid/tags/snippet.rb\nnew file mode 100644\n--- /dev/null\n+++ b/lib/liquid/tags/snippet.rb\n@@ -0,0 +1,45 @@\n+# frozen_string_literal: true\n+\n+module Liquid\n+  class Snippet < Block\n+    def initialize(tag_name, markup, options)\n+      super\n+      p = @parse_context.new_parser(markup)\n+      if p.look(:id)\n+        @to = p.consume(:id)\n+        p.consume(:end_of_string)\n+      else\n+        raise SyntaxError, options[:locale].t(\"errors.syntax.snippet\")\n+      end\n+    end\n+\n+    def render_to_output_buffer(context, output)\n+      snippet_drop = SnippetDrop.new(@body, @to, context.template_name)\n+      context.scopes.last[@to] = snippet_drop\n+      context.resource_limits.increment_assign_score(assign_score_of(snippet_drop))\n+      output\n+    end\n+\n+    def blank?\n+      true\n+    end\n+\n+    private\n+\n+    def assign_score_of(snippet_drop)\n+      snippet_drop.body.nodelist.sum { |node| node.to_s.bytesize }\n+    end\n+  end\n+end","test_patch":"diff --git a/test/integration/tags/render_tag_test.rb b/test/integration/tags/render_tag_test.rb\n--- a/test/integration/tags/render_tag_test.rb\n+++ b/test/integration/tags/render_tag_test.rb\n@@ -101,10 +101,6 @@ class RenderTagTest < Minitest::Test\n     end\n   end\n \n-  def test_dynamically_choosen_templates_are_not_allowed\n-    assert_syntax_error(\"{% assign name = 'snippet' %}{% render name %}\")\n-  end\n-\n+  def test_render_tag_with_snippet_drop\n+    assert_template_result(\n+      \"Hello from snippet\",\n+      \"{% snippet my_snippet %}Hello from snippet{% endsnippet %}{% render my_snippet %}\",\n+    )\n+  end\ndiff --git a/test/integration/tags/snippet_test.rb b/test/integration/tags/snippet_test.rb\nnew file mode 100644\n--- /dev/null\n+++ b/test/integration/tags/snippet_test.rb\n@@ -0,0 +1,1087 @@\n+# frozen_string_literal: true\n+require 'test_helper'\n+class SnippetTest < Minitest::Test\n+  include Liquid\n+  # ... 47 test methods for LaxMode, RigidMode, and ResourceLimits\n+end"}
